var Qm=Object.create;var Ma=Object.defineProperty,Km=Object.defineProperties,Jm=Object.getOwnPropertyDescriptor,ev=Object.getOwnPropertyDescriptors,tv=Object.getOwnPropertyNames,Oc=Object.getOwnPropertySymbols,nv=Object.getPrototypeOf,Fc=Object.prototype.hasOwnProperty,rv=Object.prototype.propertyIsEnumerable;var Lc=(e,t,n)=>t in e?Ma(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Ve=(e,t)=>{for(var n in t||={})Fc.call(t,n)&&Lc(e,n,t[n]);if(Oc)for(var n of Oc(t))rv.call(t,n)&&Lc(e,n,t[n]);return e},Mt=(e,t)=>Km(e,ev(t));var kc=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,n)=>(typeof require<"u"?require:t)[n]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});var Pc=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var ov=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of tv(t))!Fc.call(e,s)&&s!==n&&Ma(e,s,{get:()=>t[s],enumerable:!(r=Jm(t,s))||r.enumerable});return e};var iv=(e,t,n)=>(n=e!=null?Qm(nv(e)):{},ov(t||!e||!e.__esModule?Ma(n,"default",{value:e,enumerable:!0}):n,e));var Rg=Pc((jc,Dc)=>{"use strict";(function(e,t){typeof jc=="object"&&typeof Dc<"u"?Dc.exports=t():typeof define=="function"&&define.amd?define(t):e.jSuites=t()})(jc,function(){var e;return function(){var t={195:function(l){(function(f,u){l.exports=u()})(this,function(){return function(q){function u(Re,Ae){this.highOrder=Re,this.lowOrder=Ae}var c=[new u(1779033703,4089235720),new u(3144134277,2227873595),new u(1013904242,4271175723),new u(2773480762,1595750129),new u(1359893119,2917565137),new u(2600822924,725511199),new u(528734635,4215389547),new u(1541459225,327033209)],g=[new u(1116352408,3609767458),new u(1899447441,602891725),new u(3049323471,3964484399),new u(3921009573,2173295548),new u(961987163,4081628472),new u(1508970993,3053834265),new u(2453635748,2937671579),new u(2870763221,3664609560),new u(3624381080,2734883394),new u(310598401,1164996542),new u(607225278,1323610764),new u(1426881987,3590304994),new u(1925078388,4068182383),new u(2162078206,991336113),new u(2614888103,633803317),new u(3248222580,3479774868),new u(3835390401,2666613458),new u(4022224774,944711139),new u(264347078,2341262773),new u(604807628,2007800933),new u(770255983,1495990901),new u(1249150122,1856431235),new u(1555081692,3175218132),new u(1996064986,2198950837),new u(2554220882,3999719339),new u(2821834349,766784016),new u(2952996808,2566594879),new u(3210313671,3203337956),new u(3336571891,1034457026),new u(3584528711,2466948901),new u(113926993,3758326383),new u(338241895,168717936),new u(666307205,1188179964),new u(773529912,1546045734),new u(1294757372,1522805485),new u(1396182291,2643833823),new u(1695183700,2343527390),new u(1986661051,1014477480),new u(2177026350,1206759142),new u(2456956037,344077627),new u(2730485921,1290863460),new u(2820302411,3158454273),new u(3259730800,3505952657),new u(3345764771,106217008),new u(3516065817,3606008344),new u(3600352804,1432725776),new u(4094571909,1467031594),new u(275423344,851169720),new u(430227734,3100823752),new u(506948616,1363258195),new u(659060556,3750685593),new u(883997877,3785050280),new u(958139571,3318307427),new u(1322822218,3812723403),new u(1537002063,2003034995),new u(1747873779,3602036899),new u(1955562222,1575990012),new u(2024104815,1125592928),new u(2227730452,2716904306),new u(2361852424,442776044),new u(2428436474,593698344),new u(2756734187,3733110249),new u(3204031479,2999351573),new u(3329325298,3815920427),new u(3391569614,3928383900),new u(3515267271,566280711),new u(3940187606,3454069534),new u(4118630271,4000239992),new u(116418474,1914138554),new u(174292421,2731055270),new u(289380356,3203993006),new u(460393269,320620315),new u(685471733,587496836),new u(852142971,1086792851),new u(1017036298,365543100),new u(1126000580,2618297676),new u(1288033470,3409855158),new u(1501505948,4234509866),new u(1607167915,987167468),new u(1816402316,1246189591)],D=new Array(64),I,v,p,w,j,b,M,A,O,F,V,_,P=8;function K(Re){return unescape(encodeURIComponent(Re))}function W(Re){for(var Ae=[],Le=(1<<P)-1,Be=Re.length*P,nt=0;nt<Be;nt+=P)Ae[nt>>5]|=(Re.charCodeAt(nt/P)&Le)<<32-P-nt%32;return Ae}function se(Re){for(var Ae="0123456789abcdef",Le="",Be=Re.length*4,nt,st=0;st<Be;st+=1)nt=Re[st>>2]>>(3-st%4)*8,Le+=Ae.charAt(nt>>4&15)+Ae.charAt(nt&15);return Le}function he(Re,Ae){var Le,Be,nt,st;return Le=(Re.lowOrder&65535)+(Ae.lowOrder&65535),Be=(Re.lowOrder>>>16)+(Ae.lowOrder>>>16)+(Le>>>16),nt=(Be&65535)<<16|Le&65535,Le=(Re.highOrder&65535)+(Ae.highOrder&65535)+(Be>>>16),Be=(Re.highOrder>>>16)+(Ae.highOrder>>>16)+(Le>>>16),st=(Be&65535)<<16|Le&65535,new u(st,nt)}function ae(Re,Ae,Le,Be){var nt,st,Tt,Bt;return nt=(Re.lowOrder&65535)+(Ae.lowOrder&65535)+(Le.lowOrder&65535)+(Be.lowOrder&65535),st=(Re.lowOrder>>>16)+(Ae.lowOrder>>>16)+(Le.lowOrder>>>16)+(Be.lowOrder>>>16)+(nt>>>16),Tt=(st&65535)<<16|nt&65535,nt=(Re.highOrder&65535)+(Ae.highOrder&65535)+(Le.highOrder&65535)+(Be.highOrder&65535)+(st>>>16),st=(Re.highOrder>>>16)+(Ae.highOrder>>>16)+(Le.highOrder>>>16)+(Be.highOrder>>>16)+(nt>>>16),Bt=(st&65535)<<16|nt&65535,new u(Bt,Tt)}function we(Re,Ae,Le,Be,nt){var st,Tt,Bt,At;return st=(Re.lowOrder&65535)+(Ae.lowOrder&65535)+(Le.lowOrder&65535)+(Be.lowOrder&65535)+(nt.lowOrder&65535),Tt=(Re.lowOrder>>>16)+(Ae.lowOrder>>>16)+(Le.lowOrder>>>16)+(Be.lowOrder>>>16)+(nt.lowOrder>>>16)+(st>>>16),Bt=(Tt&65535)<<16|st&65535,st=(Re.highOrder&65535)+(Ae.highOrder&65535)+(Le.highOrder&65535)+(Be.highOrder&65535)+(nt.highOrder&65535)+(Tt>>>16),Tt=(Re.highOrder>>>16)+(Ae.highOrder>>>16)+(Le.highOrder>>>16)+(Be.highOrder>>>16)+(nt.highOrder>>>16)+(st>>>16),At=(Tt&65535)<<16|st&65535,new u(At,Bt)}function Me(Re,Ae,Le){return new u(Re.highOrder&Ae.highOrder^Re.highOrder&Le.highOrder^Ae.highOrder&Le.highOrder,Re.lowOrder&Ae.lowOrder^Re.lowOrder&Le.lowOrder^Ae.lowOrder&Le.lowOrder)}function be(Re,Ae,Le){return new u(Re.highOrder&Ae.highOrder^~Re.highOrder&Le.highOrder,Re.lowOrder&Ae.lowOrder^~Re.lowOrder&Le.lowOrder)}function ie(Re,Ae){return Ae<=32?new u(Re.highOrder>>>Ae|Re.lowOrder<<32-Ae,Re.lowOrder>>>Ae|Re.highOrder<<32-Ae):new u(Re.lowOrder>>>Ae|Re.highOrder<<32-Ae,Re.highOrder>>>Ae|Re.lowOrder<<32-Ae)}function ze(Re){var Ae=ie(Re,28),Le=ie(Re,34),Be=ie(Re,39);return new u(Ae.highOrder^Le.highOrder^Be.highOrder,Ae.lowOrder^Le.lowOrder^Be.lowOrder)}function Je(Re){var Ae=ie(Re,14),Le=ie(Re,18),Be=ie(Re,41);return new u(Ae.highOrder^Le.highOrder^Be.highOrder,Ae.lowOrder^Le.lowOrder^Be.lowOrder)}function We(Re){var Ae=ie(Re,1),Le=ie(Re,8),Be=St(Re,7);return new u(Ae.highOrder^Le.highOrder^Be.highOrder,Ae.lowOrder^Le.lowOrder^Be.lowOrder)}function He(Re){var Ae=ie(Re,19),Le=ie(Re,61),Be=St(Re,6);return new u(Ae.highOrder^Le.highOrder^Be.highOrder,Ae.lowOrder^Le.lowOrder^Be.lowOrder)}function St(Re,Ae){return Ae<=32?new u(Re.highOrder>>>Ae,Re.lowOrder>>>Ae|Re.highOrder<<32-Ae):new u(0,Re.highOrder<<32-Ae)}var q=K(q),Se=q.length*P;q=W(q),q[Se>>5]|=128<<24-Se%32,q[(Se+128>>10<<5)+31]=Se;for(var O=0;O<q.length;O+=32){I=c[0],v=c[1],p=c[2],w=c[3],j=c[4],b=c[5],M=c[6],A=c[7];for(var F=0;F<80;F++)F<16?D[F]=new u(q[F*2+O],q[F*2+O+1]):D[F]=ae(He(D[F-2]),D[F-7],We(D[F-15]),D[F-16]),V=we(A,Je(j),be(j,b,M),g[F],D[F]),_=he(ze(I),Me(I,v,p)),A=M,M=b,b=j,j=he(w,V),w=p,p=v,v=I,I=he(V,_);c[0]=he(I,c[0]),c[1]=he(v,c[1]),c[2]=he(p,c[2]),c[3]=he(w,c[3]),c[4]=he(j,c[4]),c[5]=he(b,c[5]),c[6]=he(M,c[6]),c[7]=he(A,c[7])}for(var Ye=[],O=0;O<c.length;O++)Ye.push(c[O].highOrder),Ye.push(c[O].lowOrder);return se(Ye)}})}},n={};function r(l){var f=n[l];if(f!==void 0)return f.exports;var u=n[l]={exports:{}};return t[l].call(u.exports,u,u.exports,r),u.exports}(function(){r.n=function(l){var f=l&&l.__esModule?function(){return l.default}:function(){return l};return r.d(f,{a:f}),f}})(),function(){r.d=function(l,f){for(var u in f)r.o(f,u)&&!r.o(l,u)&&Object.defineProperty(l,u,{enumerable:!0,get:f[u]})}}(),function(){r.o=function(l,f){return Object.prototype.hasOwnProperty.call(l,f)}}();var s={};(function(){"use strict";r.d(s,{default:function(){return Ar}});var l=function(E){document.dictionary||(document.dictionary={});var T=null,m=null,d=Object.keys(E);for(m=0;m<d.length;m++)document.dictionary[d[m]]=E[d[m]]},f=function(E){return typeof document<"u"&&document.dictionary&&document.dictionary[E]||E},u={setDictionary:l,translate:f},g=function(E,T){if(T===!0)window.jSuitesStateControl=window.jSuitesStateControl.filter(function(d){return d!==null}),setTimeout(function(){window.jSuitesStateControl.push(E)},0);else{var m=window.jSuitesStateControl.indexOf(E);m>=0&&window.jSuitesStateControl.splice(m,1)}},D={};D.two=function(E){return E=""+E,E.length==1&&(E="0"+E),E},D.focus=function(E){if(E.innerText.length){var T=document.createRange(),m=window.getSelection(),d=E.childNodes[E.childNodes.length-1];T.setStart(d,d.length),T.collapse(!0),m.removeAllRanges(),m.addRange(T),E.scrollLeft=E.scrollWidth}},D.isNumeric=function(E){return typeof E=="string"&&(E=E.trim()),!isNaN(E)&&E!==null&&E!==""},D.guid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(E){var T=Math.random()*16|0,m=E=="x"?T:T&3|8;return m.toString(16)})},D.getNode=function(){var E=document.getSelection().anchorNode;return E?E.nodeType==3?E.parentNode:E:null},D.hash=function(E){var T=0,m,d;if(E.length===0)return T;for(m=0;m<E.length;m++)d=E.charCodeAt(m),d>32&&(T=(T<<5)-T+d,T|=0);return T},D.randomColor=function(E){var T=-.25,m=("#"+Math.random().toString(16).slice(2,8).toUpperCase()).replace(/[^0-9a-f]/gi,"");m.length<6&&(m=m[0]+m[0]+m[1]+m[1]+m[2]+m[2]);var d=[],B,J;for(J=0;J<3;J++)B=parseInt(m.substr(J*2,2),16),B=Math.round(Math.min(Math.max(0,B+B*T),255)).toString(16),d.push(("00"+B).substr(B.length));return E==!0?"#"+D.two(d[0].toString(16))+D.two(d[1].toString(16))+D.two(d[2].toString(16)):d},D.getWindowWidth=function(){var E=window,T=document,m=T.documentElement,d=T.getElementsByTagName("body")[0],B=E.innerWidth||m.clientWidth||d.clientWidth;return B},D.getWindowHeight=function(){var E=window,T=document,m=T.documentElement,d=T.getElementsByTagName("body")[0],B=E.innerHeight||m.clientHeight||d.clientHeight;return B},D.getPosition=function(E){if(E.changedTouches&&E.changedTouches[0])var T=E.changedTouches[0].pageX,m=E.changedTouches[0].pageY;else var T=window.Event?E.pageX:E.clientX+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft),m=window.Event?E.pageY:E.clientY+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop);return[T,m]},D.click=function(E){if(E.click)E.click();else{var T=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});E.dispatchEvent(T)}},D.findElement=function(E,T){var m=!1;function d(B){B&&!m&&(typeof T=="function"?m=T(B):typeof T=="string"&&B.classList&&B.classList.contains(T)&&(m=B)),B.parentNode&&!m&&d(B.parentNode)}return d(E),m};var I=D;function v(E,T,m){if(E=E.split("."),E.length){let d=this,B=null;for(;E.length>1;)if(B=E.shift(),d.hasOwnProperty(B))d=d[B];else{if(typeof T>"u")return;d[B]={},d=d[B]}if(B=E.shift(),typeof T<"u")return m===!0?delete d[B]:d[B]=T,!0;if(d)return d[B]}return!1}function p(E,T){var m={};m.options={};var d={pointer:null,direction:null,ondragstart:null,ondragend:null,ondrop:null},B=null;for(var J in d)T&&T.hasOwnProperty(J)?m.options[J]=T[J]:m.options[J]=d[J];E.classList.add("jsorting"),E.addEventListener("dragstart",function(L){let H=L.target;if(H.nodeType===3)if(H.parentNode.getAttribute("draggable")==="true")H=H.parentNode;else{L.preventDefault(),L.stopPropagation();return}if(H.getAttribute("draggable")==="true"){let G=Array.prototype.indexOf.call(H.parentNode.children,H);B={element:H,o:G,d:G},H.style.opacity="0.25",typeof m.options.ondragstart=="function"&&m.options.ondragstart(E,H,L),L.dataTransfer.setDragImage(H,0,0)}}),E.addEventListener("dragover",function(L){if(L.preventDefault(),B&&ee(L.target)&&L.target.getAttribute("draggable")=="true"&&B.element!=L.target){if(m.options.direction)var H=L.target.clientWidth/2>L.offsetX;else var H=L.target.clientHeight/2>L.offsetY;H?L.target.parentNode.insertBefore(B.element,L.target):L.target.parentNode.insertBefore(B.element,L.target.nextSibling),B.d=Array.prototype.indexOf.call(L.target.parentNode.children,B.element)}}),E.addEventListener("dragleave",function(L){L.preventDefault()}),E.addEventListener("dragend",function(L){L.preventDefault(),B&&(typeof m.options.ondragend=="function"&&m.options.ondragend(E,B.element,L),B.o<B.d?L.target.parentNode.insertBefore(B.element,L.target.parentNode.children[B.o]):L.target.parentNode.insertBefore(B.element,L.target.parentNode.children[B.o].nextSibling),B.element.style.opacity="",B=null)}),E.addEventListener("drop",function(L){L.preventDefault(),B&&(B.o!==B.d&&typeof m.options.ondrop=="function"&&m.options.ondrop(E,B.o,B.d,B.element,L.target,L),B.element.style.opacity="",B=null)});for(var ee=function(L){var H=!1;function G(oe){oe.className&&oe.classList.contains("jsorting")&&(H=!0),H||G(oe.parentNode)}return G(L),H},k=0;k<E.children.length;k++)E.children[k].hasAttribute("draggable")||E.children[k].setAttribute("draggable","true");return E.val=function(){for(var L=null,H=[],G=0;G<E.children.length;G++)(L=E.children[G].getAttribute("data-id"))&&H.push(L);return H},E}function w(E,T){var m={};(!T.loadUp||typeof T.loadUp!="function")&&(T.loadUp=function(){return!1}),(!T.loadDown||typeof T.loadDown!="function")&&(T.loadDown=function(){return!1}),T.timer||(T.timer=100);var d=null,B=function(J){if(d==null){var ee=!1,k=E.scrollTop;E.scrollTop+E.clientHeight*2>=E.scrollHeight?T.loadDown()&&(k==E.scrollTop&&(E.scrollTop=E.scrollTop-E.clientHeight),ee=!0):E.scrollTop<=E.clientHeight&&T.loadUp()&&(k==E.scrollTop&&(E.scrollTop=E.scrollTop+E.clientHeight),ee=!0),d=setTimeout(function(){d=null},T.timer),ee&&typeof T.onupdate=="function"&&T.onupdate()}};return E.onscroll=function(J){B(J)},E.onwheel=function(J){B(J)},m}function j(){var E=function(T,m){if(Array.isArray(T)){var d={instance:[],complete:m};if(T.length>0)for(var B=0;B<T.length;B++)T[B].multiple=d,d.instance.push(E(T[B]));return d}if(T.data||(T.data={}),T.type&&(T.method=T.type),T.method||(T.method="GET"),T.dataType||(T.dataType="json"),T.data){var J=function(oe,me){var le=[];if(oe){var ce=Object.keys(oe);if(ce.length)for(var Te=0;Te<ce.length;Te++){if(me)var Ie=me+"["+ce[Te]+"]";else var Ie=ce[Te];if(oe[Ie]instanceof FileList)le[Ie]=oe[ce[Te]];else if(oe[ce[Te]]===null||oe[ce[Te]]===void 0)le[Ie]="";else if(typeof oe[ce[Te]]=="object")for(var Ne=J(oe[ce[Te]],Ie),Ge=Object.keys(Ne),lt=0;lt<Ge.length;lt++)le[Ge[lt]]=Ne[Ge[lt]];else le[Ie]=oe[ce[Te]]}}return le},ee=J(T.data),k=Object.keys(ee);if(T.method=="GET"){if(k.length){for(var L=[],B=0;B<k.length;B++)L.push(k[B]+"="+encodeURIComponent(ee[k[B]]));T.url.indexOf("?")<0&&(T.url+="?"),T.url+=L.join("&")}}else for(var L=new FormData,B=0;B<k.length;B++)if(ee[k[B]]instanceof FileList){if(ee[k[B]].length)for(var H=0;H<ee[k[B]].length;H++)L.append(k[B],ee[k[B]][H],ee[k[B]][H].name)}else L.append(k[B],ee[k[B]])}var G=new XMLHttpRequest;return G.open(T.method,T.url,!0),T.requestedWith?G.setRequestHeader("X-Requested-With",T.requestedWith):T.requestedWith!==!1&&G.setRequestHeader("X-Requested-With","XMLHttpRequest"),T.contentType&&G.setRequestHeader("Content-Type",T.contentType),T.method==="POST"?G.setRequestHeader("Accept","application/json"):T.dataType==="blob"?G.responseType="blob":T.contentType||(T.dataType==="json"?G.setRequestHeader("Content-Type","text/json"):T.dataType==="html"&&G.setRequestHeader("Content-Type","text/html")),T.cache!==!0&&(G.setRequestHeader("pragma","no-cache"),G.setRequestHeader("cache-control","no-cache")),T.withCredentials===!0&&(G.withCredentials=!0),typeof T.beforeSend=="function"&&T.beforeSend(G),typeof E.beforeSend=="function"&&E.beforeSend(G),document.ajax&&typeof document.ajax.beforeSend=="function"&&document.ajax.beforeSend(G),G.onerror=function(){T.error&&typeof T.error=="function"&&T.error({message:"Network error: Unable to reach the server.",status:0})},G.ontimeout=function(){T.error&&typeof T.error=="function"&&T.error({message:"Request timed out after "+G.timeout+"ms.",status:0})},G.onload=function(){if(G.status>=200&&G.status<300)if(T.dataType==="json")try{var oe=JSON.parse(G.responseText);T.success&&typeof T.success=="function"&&T.success(oe)}catch(le){T.error&&typeof T.error=="function"&&T.error(le,oe)}else{if(T.dataType==="blob")var oe=G.response;else var oe=G.responseText;T.success&&typeof T.success=="function"&&T.success(oe)}else T.error&&typeof T.error=="function"&&T.error(G.responseText,G.status);if(E.queue&&E.queue.length>0&&E.send(E.queue.shift()),E.requests&&E.requests.length){var me=E.requests.indexOf(G);if(E.requests.splice(me,1),E.requests.length||T.complete&&typeof T.complete=="function"&&T.complete(oe),T.group&&E.oncomplete&&typeof E.oncomplete[T.group]=="function"&&(E.pending(T.group)||(E.oncomplete[T.group](),E.oncomplete[T.group]=null)),T.multiple&&T.multiple.instance){var me=T.multiple.instance.indexOf(G);T.multiple.instance.splice(me,1),T.multiple.instance.length||T.multiple.complete&&typeof T.multiple.complete=="function"&&T.multiple.complete(oe)}}},G.options=T,G.data=L,T.queue===!0&&E.requests.length>0?E.queue.push(G):E.send(G),G};return E.send=function(T){T.data?Array.isArray(T.data)?T.send(T.data.join("&")):T.send(T.data):T.send(),E.requests.push(T)},E.exists=function(T,m){var d=new XMLHttpRequest;d.open("HEAD",T,!1),d.send(),d.status&&m(d.status)},E.pending=function(T){var m=0,d=E.requests;if(d&&d.length)for(var B=0;B<d.length;B++)(!T||T==d[B].options.group)&&m++;return m},E.oncomplete={},E.requests=[],E.queue=[],E}var b=j();function M(){let E={loading:{}};return E.loading.show=function(T){E.loading.element||(E.loading.element=document.createElement("div"),E.loading.element.className="jloading"),document.body.appendChild(E.loading.element),T>0&&setTimeout(function(){E.loading.hide()},T*1e3)},E.loading.hide=function(){E.loading.element&&E.loading.element.parentNode&&document.body.removeChild(E.loading.element)},E.slideLeft=function(T,m,d){m==!0?(T.classList.add("jslide-left-in"),setTimeout(function(){T.classList.remove("jslide-left-in"),typeof d=="function"&&d()},400)):(T.classList.add("jslide-left-out"),setTimeout(function(){T.classList.remove("jslide-left-out"),typeof d=="function"&&d()},400))},E.slideRight=function(T,m,d){m===!0?(T.classList.add("jslide-right-in"),setTimeout(function(){T.classList.remove("jslide-right-in"),typeof d=="function"&&d()},400)):(T.classList.add("jslide-right-out"),setTimeout(function(){T.classList.remove("jslide-right-out"),typeof d=="function"&&d()},400))},E.slideTop=function(T,m,d){m===!0?(T.classList.add("jslide-top-in"),setTimeout(function(){T.classList.remove("jslide-top-in"),typeof d=="function"&&d()},400)):(T.classList.add("jslide-top-out"),setTimeout(function(){T.classList.remove("jslide-top-out"),typeof d=="function"&&d()},400))},E.slideBottom=function(T,m,d){m===!0?(T.classList.add("jslide-bottom-in"),setTimeout(function(){T.classList.remove("jslide-bottom-in"),typeof d=="function"&&d()},400)):(T.classList.add("jslide-bottom-out"),setTimeout(function(){T.classList.remove("jslide-bottom-out"),typeof d=="function"&&d()},100))},E.fadeIn=function(T,m){T.style.display="",T.classList.add("jfade-in"),setTimeout(function(){T.classList.remove("jfade-in"),typeof m=="function"&&m()},2e3)},E.fadeOut=function(T,m){T.classList.add("jfade-out"),setTimeout(function(){T.style.display="none",T.classList.remove("jfade-out"),typeof m=="function"&&m()},1e3)},E}var A=M();function O(){var E={};E.now=function(ee,k){var L=null,H=null,G=null,oe=null,me=null,le=null;return Array.isArray(ee)?(L=ee[0],H=ee[1],G=ee[2],oe=ee[3],me=ee[4],le=ee[5]):(ee||(ee=new Date),L=ee.getFullYear(),H=ee.getMonth()+1,G=ee.getDate(),oe=ee.getHours(),me=ee.getMinutes(),le=ee.getSeconds()),k==!0?I.two(L)+"-"+I.two(H)+"-"+I.two(G):I.two(L)+"-"+I.two(H)+"-"+I.two(G)+" "+I.two(oe)+":"+I.two(me)+":"+I.two(le)},E.toArray=function(ee){var L=ee.split(ee.indexOf("T")!==-1?"T":" "),k=L[1],L=L[0].split("-"),H=parseInt(L[0]),G=parseInt(L[1]),oe=parseInt(L[2]),me=0,le=0;return k&&(k=k.split(":"),me=parseInt(k[0]),le=parseInt(k[1])),[H,G,oe,me,le,0]};var T=Date.UTC(1900,0,0),m=Date.UTC(1900,1,29),d=864e5;E.dateToNum=function(ee){typeof ee=="string"&&(ee=new Date(ee+"  GMT+0"));var k=ee.getTime();return k>=m&&(k+=d),k-=T,k/d},E.numToDate=function(ee){var k=T+ee*d;k>=m&&(k-=d);let L=new Date(k);var H=[L.getUTCFullYear(),L.getUTCMonth()+1,L.getUTCDate(),L.getUTCHours(),L.getUTCMinutes(),L.getUTCSeconds()];return E.now(H)};let B=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],J=["January","February","March","April","May","June","July","August","September","October","November","December"];return Object.defineProperty(E,"weekdays",{get:function(){return B.map(function(ee){return u.translate(ee)})}}),Object.defineProperty(E,"weekdaysShort",{get:function(){return B.map(function(ee){return u.translate(ee).substring(0,3)})}}),Object.defineProperty(E,"months",{get:function(){return J.map(function(ee){return u.translate(ee)})}}),Object.defineProperty(E,"monthsShort",{get:function(){return J.map(function(ee){return u.translate(ee).substring(0,3)})}}),E}var F=O();function V(){var E={text:["@"],currency:["#(.{1})##0?(.{1}0+)?( ?;(.*)?)?","#"],scientific:["0{1}(.{1}0+)?E{1}\\+0+"],percentage:["0{1}(.{1}0+)?%"],numeric:["0{1}(.{1}0+)?"],datetime:["YYYY","YYY","YY","MMMMM","MMMM","MMM","MM","DDDDD","DDDD","DDD","DD","DY","DAY","WD","D","Q","MONTH","MON","HH24","HH12","HH","\\[H\\]","H","AM/PM","MI","SS","MS","Y","M"],general:["A","0","[0-9a-zA-Z$]+","."]},T=function(){if(this.mask.toLowerCase().indexOf("[h]")!==-1){var S=0;this.date[4]&&(S=parseFloat(this.date[4]/60));var R=parseInt(this.date[3])+S;R/=24}else!(this.date[0]&&this.date[1]&&this.date[2])&&(this.date[3]||this.date[4])?R=I.two(this.date[3])+":"+I.two(this.date[4])+":"+I.two(this.date[5]):(this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1),R=I.two(this.date[0])+"-"+I.two(this.date[1])+"-"+I.two(this.date[2]),(this.date[3]||this.date[4]||this.date[5])&&(R+=" "+I.two(this.date[3])+":"+I.two(this.date[4])+":"+I.two(this.date[5])));return R},m=function(){var S="";if(!(this.date[0]&&this.date[1]&&this.date[2])&&(this.date[3]||this.date[4])){if(this.mask.toLowerCase().indexOf("[h]")!==-1)S=parseInt(this.date[3]);else{let Y=parseInt(this.date[3]);Y<13&&this.values.indexOf("PM")!==-1?S=(Y+12)%24:S=Y%24}this.date[4]&&(S+=parseFloat(this.date[4]/60)),this.date[5]&&(S+=parseFloat(this.date[5]/3600)),S/=24}else if(this.date[0]||this.date[1]||this.date[2]||this.date[3]||this.date[4]||this.date[5]){this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1);var R=F.now(this.date);S=F.dateToNum(R)}return isNaN(S)&&(S=""),S},d=function(S){return S===null||S===""||S===void 0},B=function(S){var R=(""+S)[0];return R=="="},J=function(S){return S==="currency"||S==="percentage"||S==="scientific"||S==="numeric"},ee=function(S){if(S&&Number(S)==S)return".";if(this.options.decimal)return this.options.decimal;if(this.locale){var R=Intl.NumberFormat(this.locale).format(1.1);return this.options.decimal=R[1]}else{S||(S=this.mask);var Y=new RegExp("0{1}(.{1})0+","ig"),R=Y.exec(S);if(R&&R[1]&&R[1].length==1)return this.options.decimal=R[1],R[1];var Y=new RegExp("#{1}(.{1})#+","ig"),R=Y.exec(S);R&&R[1]&&R[1].length==1?R[1]===","?this.options.decimal=".":this.options.decimal=",":this.options.decimal="1.1".toLocaleString().substring(1,2)}return this.options.decimal?this.options.decimal:null},k=function(S,R){if(S=="")return"";R||(R=ee.call(this)),S=(""+S).split(R);var Y=S[0].match(/[-]+/g);if(Y&&Y.length?Y=!0:Y=!1,S[0]=S[0].match(/[0-9]+/g),S[0]?(Y&&S[0].unshift("-"),S[0]=S[0].join("")):Y&&(S[0]="-"),S[0]||S[1])S[1]!==void 0&&(S[1]=S[1].match(/[0-9]+/g),S[1]?S[1]=S[1].join(""):S[1]="");else return"";return S},L=function(S,R){if(S==="")return"";var Y=ee.call(this),de=this.options;if(S=k.call(this,S),S==="")return"";var ne=null;if(S[0]&&(de.style==="percent"?ne=parseFloat(S[0])/100:ne=parseFloat(S[0]+".1")),(S[0]==="-"||S[0]==="-00")&&!S[1]&&R&&R.inputType=="deleteContentBackward")return"";var Q=new Intl.NumberFormat(this.locale,de).format(ne);if(Q=Q.split(Y),de.style==="percent"&&Q[0].indexOf("%")!==-1&&(Q[0]=Q[0].replace("%",""),Q[2]="%"),typeof Q[1]<"u"){var ve=Q[1].replace(/[0-9]*/g,"");ve&&(Q[2]=ve)}return S[1]!==void 0?Q[1]=Y+S[1]:Q[1]="",Q.join("")},H=function(S,R){var Y=me.call(S);if(Y){var de=L.call(this,Y,R),ne=de.length-Y.length,Q=oe.call(S)+ne;me.call(S,de,Q,!0)}},G=function(S){var R=k.call(this,S);return R?(R[0]==="-"&&(R[0]="-0"),parseFloat(R.join("."))):null},oe=function(S,R){if(S===void 0)if(this.tagName=="DIV"){var Y=0,de=window.getSelection();if(de&&de.rangeCount!==0){var ne=de.getRangeAt(0),Q=ne.cloneRange();Q.selectNodeContents(this),Q.setEnd(ne.endContainer,ne.endOffset),Y=Q.toString().length}return Y}else return this.selectionStart;else{var ve=me.call(this);if(R){for(var Q=null,Ce=0;Ce<ve.length;Ce++)(ve[Ce].match(/[\-0-9]/g)||ve[Ce]==="."||ve[Ce]===",")&&(Q=Ce);Q===null&&(Q=ve.indexOf(" ")),S>=Q&&(S=Q+1)}if(S>ve.length&&(S=ve.length),S)if(this.tagName=="DIV"){var de=window.getSelection(),ne=document.createRange();this.childNodes[0]&&(ne.setStart(this.childNodes[0],S),de.removeAllRanges(),de.addRange(ne))}else this.selectionStart=S,this.selectionEnd=S}},me=function(S,R,Y){if(this.tagName=="DIV")if(S===void 0){var S=this.innerText;return this.value&&this.value.length>S.length&&(S=this.value),S}else this.innerText!==S&&(this.innerText=S,R&&oe.call(this,R,Y));else{if(S===void 0)return this.value;this.value!==S&&(this.value=S,R&&oe.call(this,R,Y))}},le=F.weekdays,ce=F.weekdaysShort,Te=F.months,Ie=F.monthsShort,Ne={YEAR:function(S,R){var Y=""+new Date().getFullYear();if(typeof this.values[this.index]>"u"&&(this.values[this.index]=""),parseInt(S)>=0&&parseInt(S)<=10&&this.values[this.index].length<R&&(this.values[this.index]+=S),this.values[this.index].length==R){if(R==2)var Y=Y.substr(0,2)+this.values[this.index];else if(R==3)var Y=Y.substr(0,1)+this.values[this.index];else if(R==4)var Y=this.values[this.index];this.date[0]=Y,this.index++}},YYYY:function(S){Ne.YEAR.call(this,S,4)},YYY:function(S){Ne.YEAR.call(this,S,3)},YY:function(S){Ne.YEAR.call(this,S,2)},FIND:function(S,R){if(d(this.values[this.index])&&(this.values[this.index]=""),this.event&&this.event.inputType&&this.event.inputType.indexOf("delete")>-1){this.values[this.index]+=S;return}for(var Y=0,de=0,ne=(this.values[this.index]+S).toLowerCase(),Q=0;Q<R.length;Q++)R[Q].toLowerCase().indexOf(ne)==0&&(Y=Q,de++);if(de>1)this.values[this.index]+=S;else if(de==1){var ve=R[Y].length-this.values[this.index].length-1;return this.position+=ve,this.values[this.index]=R[Y],this.index++,Y}},MMM:function(S){var R=Ne.FIND.call(this,S,Ie);R!==void 0&&(this.date[1]=R+1)},MON:function(S){Ne.MMM.call(this,S)},MMMM:function(S){var R=Ne.FIND.call(this,S,Te);R!==void 0&&(this.date[1]=R+1)},MONTH:function(S){Ne.MMMM.call(this,S)},MMMMM:function(S){d(this.values[this.index])&&(this.values[this.index]="");for(var R=0,Y=0,de=(this.values[this.index]+S).toLowerCase(),ne=0;ne<Te.length;ne++)if(Te[ne][0].toLowerCase().indexOf(de)==0){this.values[this.index]=Te[ne][0],this.date[1]=ne+1,this.index++;break}},MM:function(S){d(this.values[this.index])?parseInt(S)>1&&parseInt(S)<10?(this.date[1]=this.values[this.index]="0"+S,this.index++):parseInt(S)<2&&(this.values[this.index]=S):this.values[this.index]==1&&parseInt(S)<3?(this.date[1]=this.values[this.index]+=S,this.index++):this.values[this.index]==0&&parseInt(S)>0&&parseInt(S)<10&&(this.date[1]=this.values[this.index]+=S,this.index++)},M:function(S){var R=!1;if(parseInt(S)>=0&&parseInt(S)<10)if(d(this.values[this.index]))this.values[this.index]=S,S>1&&(this.date[1]=this.values[this.index],this.index++);else if(this.values[this.index]==1&&parseInt(S)<3)this.date[1]=this.values[this.index]+=S,this.index++;else if(this.values[this.index]==0&&parseInt(S)>0)this.date[1]=this.values[this.index]+=S,this.index++;else var R=!0;else var R=!0;if(R==!0){var Y=parseInt(this.values[this.index]);Y>0&&Y<12&&(this.date[1]=this.values[this.index],this.index++,this.position--)}},D:function(S){var R=!1;if(parseInt(S)>=0&&parseInt(S)<10)if(d(this.values[this.index]))this.values[this.index]=S,parseInt(S)>3&&(this.date[2]=this.values[this.index],this.index++);else if(this.values[this.index]==3&&parseInt(S)<2)this.date[2]=this.values[this.index]+=S,this.index++;else if(this.values[this.index]==1||this.values[this.index]==2)this.date[2]=this.values[this.index]+=S,this.index++;else if(this.values[this.index]==0&&parseInt(S)>0)this.date[2]=this.values[this.index]+=S,this.index++;else var R=!0;else var R=!0;if(R==!0){var Y=parseInt(this.values[this.index]);Y>0&&Y<32&&(this.date[2]=this.values[this.index],this.index++,this.position--)}},DD:function(S){d(this.values[this.index])?parseInt(S)>3&&parseInt(S)<10?(this.date[2]=this.values[this.index]="0"+S,this.index++):parseInt(S)<10&&(this.values[this.index]=S):this.values[this.index]==3&&parseInt(S)<2?(this.date[2]=this.values[this.index]+=S,this.index++):(this.values[this.index]==1||this.values[this.index]==2)&&parseInt(S)<10?(this.date[2]=this.values[this.index]+=S,this.index++):this.values[this.index]==0&&parseInt(S)>0&&parseInt(S)<10&&(this.date[2]=this.values[this.index]+=S,this.index++)},DDD:function(S){Ne.FIND.call(this,S,ce)},DY:function(S){Ne.DDD.call(this,S)},DDDD:function(S){Ne.FIND.call(this,S,le)},DAY:function(S){Ne.DDDD.call(this,S)},HH12:function(S,R){d(this.values[this.index])?parseInt(S)>1&&parseInt(S)<10?(R&&(S=0+S),this.date[3]=this.values[this.index]=S,this.index++):parseInt(S)<10&&(this.values[this.index]=S):this.values[this.index]==1&&parseInt(S)<3?(this.date[3]=this.values[this.index]+=S,this.index++):this.values[this.index]<1&&parseInt(S)<10&&(this.date[3]=this.values[this.index]+=S,this.index++)},HH24:function(S,R){parseInt(S)>=0&&parseInt(S)<10&&(this.values[this.index]==null||this.values[this.index]==""?parseInt(S)>2&&parseInt(S)<10?(R&&(S=0+S),this.date[3]=this.values[this.index]=S,this.index++):parseInt(S)<10&&(this.values[this.index]=S):this.values[this.index]==2&&parseInt(S)<4?(!R&&this.values[this.index]==="0"&&(this.values[this.index]=""),this.date[3]=this.values[this.index]+=S,this.index++):this.values[this.index]<2&&parseInt(S)<10&&(!R&&this.values[this.index]==="0"&&(this.values[this.index]=""),this.date[3]=this.values[this.index]+=S,this.index++))},HH:function(S){Ne.HH24.call(this,S,1)},H:function(S){Ne.HH24.call(this,S,0)},"\\[H\\]":function(S){this.values[this.index]==null&&(this.values[this.index]=""),S.match(/[0-9]/g)?this.date[3]=this.values[this.index]+=S:this.values[this.index].match(/[0-9]/g)&&(this.date[3]=this.values[this.index],this.index++,this.position--)},N60:function(S,R){this.values[this.index]==null||this.values[this.index]==""?parseInt(S)>5&&parseInt(S)<10?(this.date[R]=this.values[this.index]="0"+S,this.index++):parseInt(S)<10&&(this.values[this.index]=S):parseInt(S)<10&&(this.date[R]=this.values[this.index]+=S,this.index++)},MI:function(S){Ne.N60.call(this,S,4)},SS:function(S){Ne.N60.call(this,S,5)},"AM/PM":function(S){typeof this.values[this.index]>"u"&&(this.values[this.index]=""),this.values[this.index]===""?S.match(/a/i)&&this.date[3]<13?this.values[this.index]+="A":S.match(/p/i)&&(this.values[this.index]+="P"):(this.values[this.index]==="A"||this.values[this.index]==="P")&&(this.values[this.index]+="M",this.index++)},WD:function(S){typeof this.values[this.index]>"u"&&(this.values[this.index]=""),parseInt(S)>=0&&parseInt(S)<7&&(this.values[this.index]=S),this.values[this.index].length==1&&this.index++},"0{1}(.{1}0+)?":function(S){var R=ee.call(this),Y=!1;d(this.values[this.index])?this.values[this.index]="":this.values[this.index]=="-"&&(Y=!0);var de=k.call(this,this.values[this.index],R);de&&(this.values[this.index]=de.join(R)),parseInt(S)>=0&&parseInt(S)<10?(this.values[this.index]=="0"&&S>0?this.values[this.index]="":this.values[this.index]=="-0"&&S>0&&(this.values[this.index]="-"),(this.values[this.index]!="0"&&this.values[this.index]!="-0"||S==R)&&(this.values[this.index]+=S)):R&&S==R?this.values[this.index].indexOf(R)==-1&&(this.values[this.index]||(this.values[this.index]="0"),this.values[this.index]+=S):S=="-"&&(Y=!0),Y===!0&&this.values[this.index][0]!=="-"&&(this.values[this.index]="-"+this.values[this.index])},"0{1}(.{1}0+)?E{1}\\+0+":function(S){Ne["0{1}(.{1}0+)?"].call(this,S)},"0{1}(.{1}0+)?%":function(S){Ne["0{1}(.{1}0+)?"].call(this,S),this.values[this.index].match(/[\-0-9]/g)?this.values[this.index]&&this.values[this.index].indexOf("%")==-1&&(this.values[this.index]+="%"):this.values[this.index]=""},"#(.{1})##0?(.{1}0+)?( ?;(.*)?)?":function(S){Ne["0{1}(.{1}0+)?"].call(this,S);var R=ee.call(this),Y=this.tokens[this.index].substr(1,1),de=this.values[this.index][0]==="-",ne=k.call(this,this.values[this.index],R);if(ne!==""){var Q=ne[0].match(/[0-9]/g);if(Q){Q=Q.join("");for(var ve=[],Ce=0,De=Q.length-1;De>=0;De--)ve.push(Q[De]),Ce++,Ce%3||ve.push(Y);ve=ve.reverse(),ne[0]=ve.join(""),ne[0].substr(0,1)==Y&&(ne[0]=ne[0].substr(1))}else ne[0]="";this.values[this.index]=ne.join(R),de&&(this.values[this.index]="-"+this.values[this.index])}},0:function(S){S.match(/[0-9]/g)&&(this.values[this.index]=S,this.index++)},"[0-9a-zA-Z$]+":function(S){d(this.values[this.index])&&(this.values[this.index]="");var R=this.tokens[this.index],Y=this.values[this.index],de=Y.length;R[de]==S?(this.values[this.index]+=S,this.values[this.index]==R&&this.index++):(this.values[this.index]=R,this.index++,S.match(/[\-0-9]/g)&&this.position--)},A:function(S){S.match(/[a-zA-Z]/gi)&&(this.values[this.index]=S,this.index++)},".":function(S){Ne["[0-9a-zA-Z$]+"].call(this,S)},"@":function(S){d(this.values[this.index])&&(this.values[this.index]=""),this.values[this.index]+=S}},Ge=function(S){if(this.type=="general")var R=[].concat(E.general);else var R=[].concat(E.currency,E.datetime,E.percentage,E.scientific,E.numeric,E.text,E.general);var Y=new RegExp(R.join("|"),"gi");return S.match(Y)},lt=function(S){if(this.type)if(this.type=="text")var R=["text"];else if(this.type=="general")var R=["general"];else if(this.type=="datetime")var R=["numeric","datetime","general"];else var R=["currency","percentage","scientific","numeric","general"];else var R=Object.keys(E);for(var Y=0;Y<R.length;Y++)for(var de=R[Y],ne=0;ne<E[de].length;ne++){var Q=new RegExp(E[de][ne],"gi"),ve=S.match(Q);if(ve)return{type:de,method:E[de][ne]}}},pe=function(S){for(var R=[],Y=0;Y<S.length;Y++){var de=lt.call(this,S[Y]);de?R.push(de.method):R.push(null)}for(var Y=0;Y<R.length;Y++)R[Y]=="MM"&&(R[Y-1]&&R[Y-1].indexOf("H")>=0||R[Y-2]&&R[Y-2].indexOf("H")>=0||R[Y+1]&&R[Y+1].indexOf("S")>=0||R[Y+2]&&R[Y+2].indexOf("S")>=0)&&(R[Y]="MI");return R},ue=function(S){var R=lt.call(this,S);if(R)var Y=R.type;if(Y){for(var de=0,ne=Ge.call(this,S),Q=0;Q<ne.length;Q++)R=lt.call(this,ne[Q]),R&&J(R.type)&&de++;de>1&&(Y="general")}return Y},ye=function(){typeof Ne[this.methods[this.index]]=="function"?(Ne[this.methods[this.index]].call(this,this.value[this.position]),this.position++):(this.values[this.index]=this.tokens[this.index],this.index++)},z=function(S){return(""+ +S).replace(/(-?)(\d*)\.?(\d*)e([+-]\d+)/,function(R,Y,de,ne,Q){return Q<0?Y+"0."+Array(1-Q-de.length).join(0)+de+ne:Y+de+ne+Array(Q-ne.length+1).join(0)})},X=function(S,R,Y){var de=null,ne=null,Q={input:null,value:null,options:{},values:[],index:0,position:0,date:[0,0,0,0,0,0],number:0};if(typeof S=="object"){if(Q.input=S.target,Q.value=me.call(S.target),Q.caret=oe.call(S.target),(ne=S.target.getAttribute("data-mask"))&&(Q.mask=ne),(ne=S.target.getAttribute("data-type"))&&(Q.type=ne),S.target.mask?(S.target.mask.options&&(Q.options=S.target.mask.options),S.target.mask.locale&&(Q.locale=S.target.mask.locale)):(ne=S.target.getAttribute("data-locale"))&&(Q.locale=ne,Q.mask&&(Q.options.style=Q.mask)),S.target.attributes&&S.target.attributes.length)for(var ve=0;ve<S.target.attributes.length;ve++){var Ce=S.target.attributes[ve].name,De=S.target.attributes[ve].value;Ce.substr(0,4)=="data"&&(Q.options[Ce.substr(5)]=De)}}else{if(typeof R=="string")Q.mask=R;else for(var Ce=Object.keys(R),ve=0;ve<Ce.length;ve++)Q[Ce[ve]]=R[Ce[ve]];typeof S=="number"&&(ee.call(Q,Q.mask),S=(""+S).replace(".",Q.options.decimal)),Q.value=S,Q.input&&(me.call(Q.input,S),I.focus(Q.input),Q.caret=oe.call(Q.input))}if(!B(Q.value)&&(Q.mask||Q.locale)){if(Q.mask){if(Q.mask=Q.mask.replace(new RegExp(/\[h]/),"|h|"),Q.mask=Q.mask.replace(new RegExp(/\[.*?\]/),""),Q.mask=Q.mask.replace(new RegExp(/\|h\|/),"[h]"),Q.mask.indexOf(";")!==-1){var ne=Q.mask.split(";");Q.mask=ne[0]}if(Q.mask.indexOf("##")!==-1){var xe=Q.mask.split(";");xe[0]&&(typeof S=="object"&&(xe[0]=xe[0].replace(new RegExp(/_\)/g),""),xe[0]=xe[0].replace(new RegExp(/_\(/g),"")),xe[0]=xe[0].replace("*","	"),xe[0]=xe[0].replace(new RegExp(/_-/g),""),xe[0]=xe[0].replace(new RegExp(/_/g),""),xe[0]=xe[0].replace(new RegExp(/"/g),""),xe[0]=xe[0].replace("##0.###","##0.000"),xe[0]=xe[0].replace("##0.##","##0.00"),xe[0]=xe[0].replace("##0.#","##0.0"),xe[0]=xe[0].replace("##0,###","##0,000"),xe[0]=xe[0].replace("##0,##","##0,00"),xe[0]=xe[0].replace("##0,#","##0,0")),Q.mask=xe[0]}if(Q.mask.indexOf("\\")!==-1){var xe=Q.mask.split(";");xe[0]=xe[0].replace(new RegExp(/\\/g),""),Q.mask=xe[0]}Q.type||(Q.type=ue.call(Q,Q.mask)),Q.tokens=Ge.call(Q,Q.mask)}if(typeof S!="object"||!S.inputType||!S.inputType.indexOf("insert")||!S.inputType.indexOf("delete"))if(Q.locale)if(Q.input)H.call(Q,Q.input,S);else var ke=L.call(Q,Q.value);else{for(Q.methods=pe.call(Q,Q.tokens),Q.event=S;Q.position<Q.value.length&&typeof Q.tokens[Q.index]<"u";)ye.call(Q);var ke=Q.values.join("");if(J(Q.type)&&ke!==""){for(;typeof Q.tokens[Q.index]<"u";){var ne=lt.call(Q,Q.tokens[Q.index]);ne&&ne.type=="general"&&(Q.values[Q.index]=Q.tokens[Q.index]),Q.index++}var qe=!0}else var qe=!1;if(ke=Q.values.join(""),Q.input){if(ne=ke.length-Q.value.length,ne>0)var ct=Q.caret+ne;else var ct=Q.caret;me.call(Q.input,ke,ct,qe)}}if(Q.input){var te=null;if(J(Q.type)){let ge=me.call(Q.input);Q.number=G.call(Q,ge),Q.type=="percentage"&&(""+ge).indexOf("%")!==-1?te=X.adjustPrecision(Q.number/100):te=Q.number}else Q.type=="datetime"&&(te=T.call(Q),Q.date[0]&&Q.date[1]&&Q.date[2]&&Q.input.setAttribute("data-completed",!0));te&&Q.input.setAttribute("data-value",te)}if(ke!==void 0)return Y?Q:ke}};return X.adjustPrecision=function(S){if(typeof S=="number"&&!Number.isInteger(S)){let R=S.toString().split(".");if(R[1]&&R[1].length>10){let Y=0,de=R[1][R[1].length-2];if(de==0||de==9){for(let ne=R[1].length-2;ne>0;ne--)if(Y>=0&&R[1][ne]==de){if(Y++,Y>6)break}else{Y=0;break}if(Y)return parseFloat(parseFloat(S).toFixed(R[1].length-1))}}}return S},X.getType=ue,X.prepare=function(S,R){return R||(R={}),Ge.call(R,S)},X.apply=function(S){var R=me.call(S.target);S.key.length==1&&(R+=S.key),me.call(S.target,X(R,S.target.getAttribute("data-mask")))},X.run=function(S,R,Y){return X(S,{mask:R,decimal:Y})},X.extract=function(S,R,Y){if(d(S)||typeof R!="object")return S;if(R=Object.assign({},R),R.options||(R.options={}),!R.mask&&R.format&&(R.mask=R.format),R.mask){if(R.mask.indexOf(";")!==-1){var de=R.mask.split(";");R.mask=de[0]}R.mask=R.mask.replace(new RegExp(/\[h]/),"|h|"),R.mask=R.mask.replace(new RegExp(/\[.*?\]/),""),R.mask=R.mask.replace(new RegExp(/\|h\|/),"[h]")}ee.call(R,R.mask);var ne=null,Q=null;if(R.type=="percent"||R.options.style=="percent"?ne="percentage":R.mask&&(ne=ue.call(R,R.mask)),ne==="text"){var ve={};Q=S}else if(ne==="general"){var ve=X(S,R,!0);Q=S}else if(ne==="datetime"){S instanceof Date&&(S=X.getDateString(S,R.mask));var ve=X(S,R,!0);I.isNumeric(S)?Q=S:Q=m.call(ve)}else if(ne==="scientific"){Q=S,typeof S=="string"&&(Q=Number(Q));var ve=R}else{Q=G.call(R,S),ne==="percentage"&&(""+S).indexOf("%")!==-1&&(Q/=100);var ve=R}return ve.value=Q,!ve.type&&ne&&(ve.type=ne),Y?ve:Q},X.render=function(S,R,Y,de){if(d(S)||typeof R!="object")return S;if(R=Object.assign({},R),R.options||(R.options={}),!R.mask&&R.format&&(R.mask=R.format),R.mask){if(R.mask.indexOf(";")!==-1){var ne=R.mask.split(";");Y||(ne[0]=ne[0].replace(new RegExp(/_\)/g),""),ne[0]=ne[0].replace(new RegExp(/_\(/g),"")),R.mask=ne[0]}R.mask=R.mask.replace(new RegExp(/\[h]/),"|h|"),R.mask=R.mask.replace(new RegExp(/\[.*?\]/),""),R.mask=R.mask.replace(new RegExp(/\|h\|/),"[h]")}var Q=null;R.type=="percent"||R.options.style=="percent"?Q="percentage":R.mask?Q=ue.call(R,R.mask):S instanceof Date&&(Q="datetime");var ve=!1;if(Q=="datetime"||R.type=="calendar"){var ne=X.getDateString(S,R.mask);ne&&(S=ne),R.mask&&Y&&(ve=!0)}else if(Q!=="text")if(typeof S=="string"&&e.isNumeric(S)&&(S=Number(S)),Q==="percentage"&&(S=X.adjustPrecision(S*100)),typeof S=="number"){var ne=null;if(R.mask&&Y){var Ce=ee.call(R,R.mask);if(Q==="scientific")if(R.mask.indexOf(Ce)!==-1){let ge=R.mask.split("E");ge=ge[0].split(Ce),ge=""+ge[1].match(/[0-9]+/g),ge=ge.length,ne=S.toExponential(ge)}else ne=S.toExponential(0);else{if(R.mask.indexOf(Ce)!==-1){Ce=R.mask.split(Ce),Ce=""+Ce[1].match(/[0-9]+/g),Ce=Ce.length,ne=S.toFixed(Ce);let ge=S.toString().split("."),Ee=ge[1];Ee&&Ee.length>Ce&&Ee[Ee.length-1]==="5"&&(ne=parseFloat(ge[0]+"."+Ee+"1").toFixed(Ce))}else S.toString().indexOf(Ce)!==-1&&(ne=S.toFixed(0));(""+ne).indexOf("e")!==-1&&(ne=z(ne))}}else if(R.locale&&Y){var Ce=(""+S).split(".");if(R.options){typeof Ce[1]>"u"&&(Ce[1]="");var xe=Ce[1].length;if(R.options.minimumFractionDigits>xe)for(var De=0;De<R.options.minimumFractionDigits-xe;De++)Ce[1]+="0"}Ce[1].length?ne=Ce.join("."):ne=Ce[0];var xe=Ce[1].length;R.options&&R.options.maximumFractionDigits<xe&&(ne=parseFloat(ne).toFixed(R.options.maximumFractionDigits))}else ne=z(S);ne!==null&&(S=ne,ee.call(R,R.mask),R.options.decimal&&(S=S.replace(".",R.options.decimal)))}else R.mask&&Y&&(ve=!0);if(ve){var ke=R.mask.length-S.length;if(ke>0)for(var De=0;De<ke;De++)S+=" "}if(Q==="scientific")if(!Y)S=z(S);else return S;if(Q==="numeric"&&de===!1&&typeof S=="string")return S;if(S=X(S,R),Y&&Q==="numeric"){var qe=R.mask.match(new RegExp(/^[0]+$/gm));if(qe&&qe.length===1){var ct=qe[0].length;if(ct>3)for(S=""+S;S.length<ct;)S="0"+S}}return S},X.set=function(S,R){if(R){S.setAttribute("data-mask",R);var Y=new Event("input",{bubbles:!0,cancelable:!0});S.dispatchEvent(Y)}},X.extractDateFromString=function(S,R){var Y=X(S,{mask:R},!0);if(S>0&&Number(S)==S&&(Y.values.join("")!==Y.value||Y.type=="numeric")){var de=new Date(Math.round((S-25569)*86400*1e3));return de.getFullYear()+"-"+I.two(de.getMonth())+"-"+I.two(de.getDate())+" 00:00:00"}var ne=!1;return Y.values&&Y.values.length===Y.tokens.length&&Y.values[Y.values.length-1].length>=Y.tokens[Y.tokens.length-1].length&&(ne=!0),Y.date[0]&&Y.date[1]&&(Y.date[2]||ne)?(Y.date[2]||(Y.date[2]=1),Y.date[0]+"-"+I.two(Y.date[1])+"-"+I.two(Y.date[2])+" "+I.two(Y.date[3])+":"+I.two(Y.date[4])+":"+I.two(Y.date[5])):""},X.getDateString=function(S,R){if(!R)var R={};if(R&&typeof R=="object"){if(R.format)var Y=R.format;else if(R.mask)var Y=R.mask}else var Y=R;if(Y||(Y="YYYY-MM-DD"),Y.indexOf("[h]")>=0){var de=0;if(S&&I.isNumeric(S)&&(de=parseFloat(24*Number(S)),Y.indexOf("mm")>=0)){var ne=(""+de).split(".");if(ne[1]){var Q=60*parseFloat("0."+ne[1]);Q=parseFloat(Q.toFixed(2))}else var Q=0;de=parseInt(ne[0])+":"+I.two(Q)}return de}S instanceof Date?S=F.now(S):S&&I.isNumeric(S)&&(S=F.numToDate(S));for(var ve=["DAY","WD","DDDD","DDD","DD","D","Q","HH24","HH12","HH","H","AM/PM","MI","SS","MS","YYYY","YYY","YY","Y","MONTH","MON","MMMMM","MMMM","MMM","MM","M","."],Ce=new RegExp(ve.join("|"),"gi"),De=Y.match(Ce),xe=0;xe<De.length;xe++)De[xe].toUpperCase()=="MM"&&(De[xe-1]&&De[xe-1].toUpperCase().indexOf("H")>=0||De[xe-2]&&De[xe-2].toUpperCase().indexOf("H")>=0||De[xe+1]&&De[xe+1].toUpperCase().indexOf("S")>=0||De[xe+2]&&De[xe+2].toUpperCase().indexOf("S")>=0)&&(De[xe]="mi");var ke={tokens:De};if(S){var Q=""+S,qe=Q.indexOf("T")!==-1?"T":" ";Q=Q.split(qe);var ne=0,ct=0,te=0;Q[1]&&(ne=Q[1].split(":"),ct=ne[1]?ne[1]:0,te=ne[2]?ne[2]:0,ne=ne[0]?ne[0]:0),Q=Q[0].split("-");let Xe=new Date(Q[0],Q[1],0).getDate();if(Q[0]&&Q[1]&&Q[2]&&Q[0]>0&&Q[1]>0&&Q[1]<13&&Q[2]>0&&Q[2]<=Xe){ke.data=[Q[0],Q[1],Q[2],ne,ct,te],ke.value=[];for(var ge=new Date(ke.data[0],ke.data[1]-1,ke.data[2],ke.data[3],ke.data[4],ke.data[5]),Ee=function(Ct){var Nt=this.tokens[Ct],Qe=Nt.toUpperCase(),Ue=null;Qe==="YYYY"?Ue=this.data[0]:Qe==="YYY"?Ue=this.data[0].substring(1,4):Qe==="YY"?Ue=this.data[0].substring(2,4):Qe==="Y"?Ue=this.data[0].substring(3,4):Nt==="MON"?Ue=F.months[ge.getMonth()].substr(0,3).toUpperCase():Nt==="mon"?Ue=F.months[ge.getMonth()].substr(0,3).toLowerCase():Nt==="MONTH"?Ue=F.months[ge.getMonth()].toUpperCase():Nt==="month"?Ue=F.months[ge.getMonth()].toLowerCase():Qe==="MMMMM"?Ue=F.months[ge.getMonth()].substr(0,1):Qe==="MMMM"||Nt==="Month"?Ue=F.months[ge.getMonth()]:Qe==="MMM"||Nt=="Mon"?Ue=F.months[ge.getMonth()].substr(0,3):Qe==="MM"?Ue=I.two(this.data[1]):Qe==="M"?Ue=ge.getMonth()+1:Nt==="DAY"?Ue=F.weekdays[ge.getDay()].toUpperCase():Nt==="day"?Ue=F.weekdays[ge.getDay()].toLowerCase():Qe==="DDDD"||Nt=="Day"?Ue=F.weekdays[ge.getDay()]:Qe==="DDD"?Ue=F.weekdays[ge.getDay()].substr(0,3):Qe==="DD"?Ue=I.two(this.data[2]):Qe==="D"?Ue=parseInt(this.data[2]):Qe==="Q"?Ue=Math.floor((ge.getMonth()+3)/3):Qe==="HH24"||Qe==="HH"?(Ue=this.data[3],Ue>12&&this.tokens.indexOf("am/pm")!==-1&&(Ue-=12),Ue=I.two(Ue)):Qe==="HH12"?this.data[3]>12?Ue=I.two(this.data[3]-12):Ue=I.two(this.data[3]):Qe==="H"?(Ue=this.data[3],Ue>12&&this.tokens.indexOf("am/pm")!==-1&&(Ue-=12,Ue=I.two(Ue))):Qe==="MI"?Ue=I.two(this.data[4]):Qe==="SS"?Ue=I.two(this.data[5]):Qe==="MS"?Ue=ge.getMilliseconds():Qe==="AM/PM"?this.data[3]>=12?Ue="PM":Ue="AM":Qe==="WD"&&(Ue=F.weekdays[ge.getDay()]),Ue===null?this.value[Ct]=this.tokens[Ct]:this.value[Ct]=Ue},xe=0;xe<ke.tokens.length;xe++)Ee.call(ke,xe);S=ke.value.join("")}else S=""}return S},X}var _=V();function P(){var E=function(T,m){if(T.calendar)return T.calendar.setOptions(m,!0);var d={type:"calendar"};d.options={},d.date=null,d.setOptions=function(z,X){var S={type:"default",validRange:null,startingDay:null,format:"DD/MM/YYYY",readonly:!0,today:!1,time:!1,resetButton:!0,placeholder:"",months:F.monthsShort,monthsFull:F.months,weekdays:F.weekdays,textDone:u.translate("Done"),textReset:u.translate("Reset"),textUpdate:u.translate("Update"),value:null,fullscreen:!1,opened:!1,onopen:null,onclose:null,onchange:null,onupdate:null,mode:null,position:null,dataType:null,controls:!0,autoSelect:!0};for(var R in S)z&&z.hasOwnProperty(R)?d.options[R]=z[R]:(typeof d.options[R]>"u"||X===!0)&&(d.options[R]=S[R]);if(d.options.resetButton==!1?L.style.display="none":L.style.display="",d.options.readonly?T.setAttribute("readonly","readonly"):T.removeAttribute("readonly"),d.options.placeholder?T.setAttribute("placeholder",d.options.placeholder):T.removeAttribute("placeholder"),I.isNumeric(d.options.value)&&d.options.value>0&&(d.options.value=E.numToDate(d.options.value),d.options.dataType="numeric"),L.innerHTML=d.options.textReset,H.innerHTML=d.options.textDone,lt.innerHTML=d.options.textUpdate,d.options.format&&T.setAttribute("data-mask",d.options.format.toLowerCase()),!d.options.value&&d.options.today)var Y=E.now();else var Y=d.options.value;return Y&&(d.options.value=null,d.setValue(Y)),d},d.open=function(z){if(!k.classList.contains("jcalendar-focus")&&!k.classList.contains("jcalendar-inline")){if(E.current=d,g(d,!0),d.getDays(),d.options.type=="year-month-picker"&&d.getMonths(),d.options.time&&(pe.value=d.date[3],ue.value=d.date[4]),k.classList.add("jcalendar-focus"),I.getWindowWidth()<800||d.options.fullscreen)k.classList.add("jcalendar-fullsize"),A.slideBottom(oe,1);else{k.classList.remove("jcalendar-fullsize");var X=T.getBoundingClientRect(),S=oe.getBoundingClientRect();if(d.options.position)G.style.position="fixed",window.innerHeight<X.bottom+S.height?G.style.top=X.top-(S.height+2)+"px":G.style.top=X.top+X.height+2+"px",G.style.left=X.left+"px";else{if(window.innerHeight<X.bottom+S.height){var R=-1*(X.height+S.height+2);R+X.top<0&&(R=-1*(X.top+X.height)),G.style.top=R+"px"}else G.style.top="2px";if(window.innerWidth<X.left+S.width){var R=window.innerWidth-(X.left+S.width+20);G.style.left=R+"px"}else G.style.left="0px"}}typeof d.options.onopen=="function"&&d.options.onopen(T)}},d.close=function(z,X){if(d.options.autoSelect!==!0&&typeof X>"u"&&(X=!1),k.classList.contains("jcalendar-focus")){if(X!==!1){var S=k.querySelector(".jcalendar-selected");if(typeof X=="string")var R=X;else if(!S||S.classList.contains("jcalendar-disabled"))var R=d.options.value;else var R=d.getValue();d.setValue(R)}else{let Y=d.options.value||"";d.options.value=null,d.setValue(Y)}!z&&typeof d.options.onclose=="function"&&d.options.onclose(T),k.classList.remove("jcalendar-focus"),g(d,!1),E.current=null}return d.options.value},d.prev=function(){d.options.mode=="years"?(d.date[0]=d.date[0]-12,d.getYears()):d.options.mode=="months"?(d.date[0]=parseInt(d.date[0])-1,d.getMonths()):(d.date[1]<2?(d.date[0]=d.date[0]-1,d.date[1]=12):d.date[1]=d.date[1]-1,d.getDays())},d.next=function(){d.options.mode=="years"?(d.date[0]=parseInt(d.date[0])+12,d.getYears()):d.options.mode=="months"?(d.date[0]=parseInt(d.date[0])+1,d.getMonths()):(d.date[1]>11?(d.date[0]=parseInt(d.date[0])+1,d.date[1]=1):d.date[1]=parseInt(d.date[1])+1,d.getDays())},d.setToday=function(){var z=new Date().toISOString().substr(0,10);return d.setValue(z),z},d.setValue=function(z){z||(z=""+z);var X=z,S=d.options.value;if(S!=X){if(X){var R=d.setLabel(X,d.options),de=X.split(" ");de[1]||(de[1]="00:00:00");var Y=de[1].split(":"),de=de[0].split("-"),ne=parseInt(de[0]),Q=parseInt(de[1]),ve=parseInt(de[2]),Ce=parseInt(Y[0]),De=parseInt(Y[1]);d.date=[ne,Q,ve,Ce,De,0];var z=d.setLabel(X,d.options),xe=E.now(new Date(ne,Q-1,ve),!0);if(d.options.validRange){if(!d.options.validRange[0]||xe>=d.options.validRange[0])var ke=!0;else var ke=!1;if(!d.options.validRange[1]||xe<=d.options.validRange[1])var qe=!0;else var qe=!1;ke&&qe?(T.classList.remove("jcalendar_warning"),T.title=""):(T.classList.add("jcalendar_warning"),T.title=u.translate("Date outside the valid range"))}else T.classList.remove("jcalendar_warning"),T.title=""}else{d.date=null;var z="";T.classList.remove("jcalendar_warning"),T.title=""}d.options.value=X,typeof d.options.onchange=="function"&&d.options.onchange(T,X,S),T.value!=z&&(T.value=z,typeof T.oninput=="function"&&T.oninput({type:"input",target:T,value:T.value}))}d.date&&(d.getDays(),d.options.type=="year-month-picker"&&d.getMonths())},d.getValue=function(){return d.date?d.options.time?I.two(d.date[0])+"-"+I.two(d.date[1])+"-"+I.two(d.date[2])+" "+I.two(d.date[3])+":"+I.two(d.date[4])+":"+I.two(0):I.two(d.date[0])+"-"+I.two(d.date[1])+"-"+I.two(d.date[2])+" "+I.two(0)+":"+I.two(0)+":"+I.two(0):""},d.update=function(z,X){if(!z.classList.contains("jcalendar-disabled")){var S=k.querySelector(".jcalendar-selected");S&&S.classList.remove("jcalendar-selected"),z.classList.add("jcalendar-selected"),z.classList.contains("jcalendar-set-month")?(d.date[1]=X,d.date[2]=1):d.date[2]=z.innerText,d.options.time?(d.date[3]=pe.value,d.date[4]=ue.value):d.close(null,!0)}ee()},d.reset=function(){d.setValue(""),d.date=null,d.close(!1,!1)},d.getDays=function(){d.options.mode="days";var ve=new Date,z=d.date&&I.isNumeric(d.date[0])?d.date[0]:parseInt(ve.getFullYear()),X=d.date&&I.isNumeric(d.date[1])?d.date[1]:parseInt(ve.getMonth())+1,S=d.date&&I.isNumeric(d.date[2])?d.date[2]:parseInt(ve.getDate()),R=d.date&&I.isNumeric(d.date[3])?d.date[3]:parseInt(ve.getHours()),Y=d.date&&I.isNumeric(d.date[4])?d.date[4]:parseInt(ve.getMinutes());d.date=[z,X,S,R,Y,0],me.innerHTML=z,le.innerHTML=d.options.months[X-1];var de=ve.getMonth()==X-1&&ve.getFullYear()==z,ne=ve.getDate(),ve=new Date(z,X,0,0,0),Q=ve.getDate(),ve=new Date(z,X-1,0,0,0),Ce=ve.getDay()+1,qe=d.options.startingDay||0;Ce=Ce-qe,Te.innerHTML="";var De=document.createElement("tr");De.setAttribute("align","center"),Te.appendChild(De);for(var xe=0;xe<7;xe++){var ke=document.createElement("td");ke.classList.add("jcalendar-weekday"),ke.innerHTML=d.options.weekdays[qe].substr(0,1),De.appendChild(ke),qe++,qe>6&&(qe=0)}for(var qe=0,ct=0,te=0;te<6;te++){var De=document.createElement("tr");De.setAttribute("align","center"),De.style.height="34px";for(var xe=0;xe<7;xe++){var ke=document.createElement("td");if(ke.classList.add("jcalendar-set-day"),qe>=Ce&&qe<Ce+Q){ct++,ke.innerHTML=ct,ct==S&&ke.classList.add("jcalendar-selected"),de&&ne==ct&&(ke.style.fontWeight="bold");var ge=E.now(new Date(z,X-1,ct),!0);if(d.options.validRange){if(!d.options.validRange[0]||ge>=d.options.validRange[0])var Ee=!0;else var Ee=!1;if(!d.options.validRange[1]||ge<=d.options.validRange[1])var Fe=!0;else var Fe=!1;Ee&&Fe||ke.classList.add("jcalendar-disabled")}}De.appendChild(ke),qe++}Te.appendChild(De)}d.options.time?Ne.style.display="":Ne.style.display="none",ee()},d.getMonths=function(){d.options.mode="months";var z=d.options.months,X=d.options.value,S=new Date,R=parseInt(S.getFullYear()),Y=parseInt(S.getMonth())+1,de=d.date&&I.isNumeric(d.date[0])?d.date[0]:R,ne=d.date&&I.isNumeric(d.date[1])?d.date[1]:Y;me.innerHTML=d.date[0],le.innerHTML=z[ne-1];var Q=document.createElement("table");Q.setAttribute("width","100%");for(var ve=null,Ce=0;Ce<12;Ce++){if(!(Ce%4)){var ve=document.createElement("tr");ve.setAttribute("align","center"),Q.appendChild(ve)}var De=document.createElement("td");if(De.classList.add("jcalendar-set-month"),De.setAttribute("data-value",Ce+1),De.innerText=z[Ce],d.options.validRange){var xe=de+"-"+I.two(Ce+1);if(!d.options.validRange[0]||xe>=d.options.validRange[0].substr(0,7))var ke=!0;else var ke=!1;if(!d.options.validRange[1]||xe<=d.options.validRange[1].substr(0,7))var qe=!0;else var qe=!1;ke&&qe||De.classList.add("jcalendar-disabled")}Ce+1==ne&&De.classList.add("jcalendar-selected"),R==de&&Ce+1==Y&&(De.style.fontWeight="bold"),ve.appendChild(De)}Te.innerHTML='<tr><td colspan="7"></td></tr>',Te.children[0].children[0].appendChild(Q),ee()},d.getYears=function(){d.options.mode="years";for(var z=new Date,X=z.getFullYear(),S=d.date&&I.isNumeric(d.date[0])?d.date[0]:parseInt(z.getFullYear()),R=[],Y=0;Y<25;Y++)R[Y]=parseInt(d.date[0])+(Y-12);var de=document.createElement("table");de.setAttribute("width","100%");for(var Y=0;Y<25;Y++){if(!(Y%5)){var ne=document.createElement("tr");ne.setAttribute("align","center"),de.appendChild(ne)}var Q=document.createElement("td");Q.classList.add("jcalendar-set-year"),Q.innerText=R[Y],S==R[Y]&&Q.classList.add("jcalendar-selected"),X==R[Y]&&(Q.style.fontWeight="bold"),ne.appendChild(Q)}Te.innerHTML='<tr><td colspan="7"></td></tr>',Te.firstChild.firstChild.appendChild(de),ee()},d.setLabel=function(z,X){return E.getDateString(z,X)},d.fromFormatted=function(z,X){return E.extractDateFromString(z,X)};var B=function(z){var X=I.findElement(z.target,"jcalendar-container");if(X){var S=z.target.className;if(S=="jcalendar-prev")d.prev();else if(S=="jcalendar-next")d.next();else if(S=="jcalendar-month")d.getMonths();else if(S=="jcalendar-year")d.getYears();else if(S=="jcalendar-set-year")d.date[0]=z.target.innerText,d.options.type=="year-month-picker"?d.getMonths():d.getDays();else if(z.target.classList.contains("jcalendar-set-month")){var R=parseInt(z.target.getAttribute("data-value"));d.options.type=="year-month-picker"?d.update(z.target,R):(d.date[1]=R,d.getDays())}else S=="jcalendar-confirm"||S=="jcalendar-update"||S=="jcalendar-close"?d.close(null,!0):S=="jcalendar-backdrop"?d.close(!1,!1):S=="jcalendar-reset"?d.reset():z.target.classList.contains("jcalendar-set-day")&&z.target.innerText&&d.update(z.target)}else d.close(!1,!1)},J=function(z){if(z.target.value&&z.target.value.length>3){var X=E.extractDateFromString(z.target.value,d.options.format);X&&d.setValue(X)}},ee=function(){var z=k.querySelector(".jcalendar-selected");z&&z.classList.contains("jcalendar-disabled")?(lt.setAttribute("disabled","disabled"),pe.setAttribute("disabled","disabled"),ue.setAttribute("disabled","disabled")):(lt.removeAttribute("disabled"),pe.removeAttribute("disabled"),ue.removeAttribute("disabled")),typeof d.options.onupdate=="function"&&d.options.onupdate(T,d.getValue())},k=null,L=null,H=null,G=null,oe=null,me=null,le=null,ce=null,Te=null,Ie=null,Ne=null,Ge=null,lt=null,pe=null,ue=null,ye=function(){T.tagName=="INPUT"&&T.value&&(m.value=T.value),L=document.createElement("div"),L.className="jcalendar-reset",H=document.createElement("div"),H.className="jcalendar-confirm",Ie=document.createElement("div"),Ie.className="jcalendar-controls",Ie.style.borderBottom="1px solid #ddd",Ie.appendChild(L),Ie.appendChild(H),G=document.createElement("div"),G.className="jcalendar-container",oe=document.createElement("div"),oe.className="jcalendar-content",G.appendChild(oe),T.tagName=="DIV"?(k=T,k.classList.add("jcalendar-inline")):(oe.appendChild(Ie),k=document.createElement("div"),k.className="jcalendar"),k.classList.add("jcalendar-container"),k.appendChild(G);var z=document.createElement("div");z.className="jcalendar-table",oe.appendChild(z);var X=document.createElement("td");X.setAttribute("colspan","2"),X.className="jcalendar-prev",me=document.createElement("span"),me.className="jcalendar-year",le=document.createElement("span"),le.className="jcalendar-month";var S=document.createElement("td");S.className="jcalendar-header",S.setAttribute("colspan","3"),S.appendChild(le),S.appendChild(me);var R=document.createElement("td");R.setAttribute("colspan","2"),R.className="jcalendar-next";var Y=document.createElement("thead"),de=document.createElement("tr");de.appendChild(X),de.appendChild(S),de.appendChild(R),Y.appendChild(de),ce=document.createElement("table"),Te=document.createElement("tbody"),ce.setAttribute("cellpadding","0"),ce.setAttribute("cellspacing","0"),ce.appendChild(Y),ce.appendChild(Te),z.appendChild(ce),pe=document.createElement("select"),pe.className="jcalendar-select",pe.onchange=function(){d.date[3]=this.value,typeof d.options.onupdate=="function"&&d.options.onupdate(T,d.getValue())};for(var ne=0;ne<24;ne++){var Q=document.createElement("option");Q.value=ne,Q.innerHTML=I.two(ne),pe.appendChild(Q)}ue=document.createElement("select"),ue.className="jcalendar-select",ue.onchange=function(){d.date[4]=this.value,typeof d.options.onupdate=="function"&&d.options.onupdate(T,d.getValue())};for(var ne=0;ne<60;ne++){var Q=document.createElement("option");Q.value=ne,Q.innerHTML=I.two(ne),ue.appendChild(Q)}var ve=document.createElement("div");ve.className="jcalendar-controls",Ne=document.createElement("div"),Ne.className="jcalendar-time",Ne.style.maxWidth="140px",Ne.appendChild(pe),Ne.appendChild(ue),lt=document.createElement("button"),lt.setAttribute("type","button"),lt.className="jcalendar-update",Ge=document.createElement("div"),Ge.style.flexGrow="10",Ge.appendChild(lt),ve.appendChild(Ne),T.tagName=="INPUT"&&ve.appendChild(Ge),oe.appendChild(ve);var Ce=document.createElement("div");Ce.className="jcalendar-backdrop",k.appendChild(Ce),T.addEventListener("keyup",J),k.addEventListener("swipeleft",function(De){A.slideLeft(ce,0,function(){d.next(),A.slideRight(ce,1)}),De.preventDefault(),De.stopPropagation()}),k.addEventListener("swiperight",function(De){A.slideRight(ce,0,function(){d.prev(),A.slideLeft(ce,1)}),De.preventDefault(),De.stopPropagation()}),"ontouchend"in document.documentElement?(k.addEventListener("touchend",B),T.addEventListener("touchend",d.open)):(k.addEventListener("mouseup",B),T.addEventListener("mouseup",d.open)),E.hasEvents||(E.hasEvents=!0,document.addEventListener("keydown",E.keydown)),d.setOptions(m),T.tagName=="INPUT"?(T.parentNode.insertBefore(k,T.nextSibling),T.setAttribute("autocomplete","off"),T.classList.add("jcalendar-input"),T.value=d.setLabel(d.getValue(),d.options)):(d.getDays(),d.options.time&&(pe.value=d.date[3],ue.value=d.date[4])),d.options.opened==!0&&d.open(),d.options.controls==!1&&G.classList.add("jcalendar-hide-controls"),T.change=d.setValue,T.val=function(De){if(De===void 0)return d.getValue();d.setValue(De)},T.calendar=k.calendar=d};return ye(),d};return E.keydown=function(T){var m=null;(m=E.current)&&(T.which==13?m.close(!1,!0):T.which==27&&m.close(!1,!1))},E.prettify=function(T,m){if(!m)var m={justNow:"Just now",xMinutesAgo:"{0}m ago",xHoursAgo:"{0}h ago",xDaysAgo:"{0}d ago",xWeeksAgo:"{0}w ago",xMonthsAgo:"{0} mon ago",xYearsAgo:"{0}y ago"};T.indexOf("GMT")===-1&&T.indexOf("Z")===-1&&(T+=" GMT");var d=new Date,B=new Date(T),J=parseInt((d-B)/1e3/60);if(String.prototype.format=function(k){return this.replace("{0}",k)},J==0)var ee=m.justNow;else if(J<90)var ee=m.xMinutesAgo.format(J);else if(J<1440)var ee=m.xHoursAgo.format(Math.round(J/60));else if(J<20160)var ee=m.xDaysAgo.format(Math.round(J/1440));else if(J<43200)var ee=m.xWeeksAgo.format(Math.round(J/10080));else if(J<1036800)var ee=m.xMonthsAgo.format(Math.round(J/43200));else var ee=m.xYearsAgo.format(Math.round(J/525600));return ee},E.prettifyAll=function(){for(var T=document.querySelectorAll(".prettydate"),m=0;m<T.length;m++)T[m].getAttribute("data-date")?T[m].innerHTML=E.prettify(T[m].getAttribute("data-date")):T[m].innerHTML&&(T[m].setAttribute("title",T[m].innerHTML),T[m].setAttribute("data-date",T[m].innerHTML),T[m].innerHTML=E.prettify(T[m].innerHTML))},E.now=F.now,E.toArray=F.toArray,E.dateToNum=F.dateToNum,E.numToDate=F.numToDate,E.weekdays=F.weekdays,E.months=F.months,E.weekdaysShort=F.weekdaysShort,E.monthsShort=F.monthsShort,E.extractDateFromString=_.extractDateFromString,E.getDateString=_.getDateString,E}var K=P();function W(){var E={material:[["#ffebee","#fce4ec","#f3e5f5","#e8eaf6","#e3f2fd","#e0f7fa","#e0f2f1","#e8f5e9","#f1f8e9","#f9fbe7","#fffde7","#fff8e1","#fff3e0","#fbe9e7","#efebe9","#fafafa","#eceff1"],["#ffcdd2","#f8bbd0","#e1bee7","#c5cae9","#bbdefb","#b2ebf2","#b2dfdb","#c8e6c9","#dcedc8","#f0f4c3","#fff9c4","#ffecb3","#ffe0b2","#ffccbc","#d7ccc8","#f5f5f5","#cfd8dc"],["#ef9a9a","#f48fb1","#ce93d8","#9fa8da","#90caf9","#80deea","#80cbc4","#a5d6a7","#c5e1a5","#e6ee9c","#fff59d","#ffe082","#ffcc80","#ffab91","#bcaaa4","#eeeeee","#b0bec5"],["#e57373","#f06292","#ba68c8","#7986cb","#64b5f6","#4dd0e1","#4db6ac","#81c784","#aed581","#dce775","#fff176","#ffd54f","#ffb74d","#ff8a65","#a1887f","#e0e0e0","#90a4ae"],["#ef5350","#ec407a","#ab47bc","#5c6bc0","#42a5f5","#26c6da","#26a69a","#66bb6a","#9ccc65","#d4e157","#ffee58","#ffca28","#ffa726","#ff7043","#8d6e63","#bdbdbd","#78909c"],["#f44336","#e91e63","#9c27b0","#3f51b5","#2196f3","#00bcd4","#009688","#4caf50","#8bc34a","#cddc39","#ffeb3b","#ffc107","#ff9800","#ff5722","#795548","#9e9e9e","#607d8b"],["#e53935","#d81b60","#8e24aa","#3949ab","#1e88e5","#00acc1","#00897b","#43a047","#7cb342","#c0ca33","#fdd835","#ffb300","#fb8c00","#f4511e","#6d4c41","#757575","#546e7a"],["#d32f2f","#c2185b","#7b1fa2","#303f9f","#1976d2","#0097a7","#00796b","#388e3c","#689f38","#afb42b","#fbc02d","#ffa000","#f57c00","#e64a19","#5d4037","#616161","#455a64"],["#c62828","#ad1457","#6a1b9a","#283593","#1565c0","#00838f","#00695c","#2e7d32","#558b2f","#9e9d24","#f9a825","#ff8f00","#ef6c00","#d84315","#4e342e","#424242","#37474f"],["#b71c1c","#880e4f","#4a148c","#1a237e","#0d47a1","#006064","#004d40","#1b5e20","#33691e","#827717","#f57f17","#ff6f00","#e65100","#bf360c","#3e2723","#212121","#263238"]],fire:[["0b1a6d","840f38","b60718","de030b","ff0c0c","fd491c","fc7521","faa331","fbb535","ffc73a"],["071147","5f0b28","930513","be0309","ef0000","fa3403","fb670b","f9991b","faad1e","ffc123"],["03071e","370617","6a040f","9d0208","d00000","dc2f02","e85d04","f48c06","faa307","ffba08"],["020619","320615","61040d","8c0207","bc0000","c82a02","d05203","db7f06","e19405","efab00"],["020515","2d0513","58040c","7f0206","aa0000","b62602","b94903","c57205","ca8504","d89b00"]],baby:[["eddcd2","fff1e6","fde2e4","fad2e1","c5dedd","dbe7e4","f0efeb","d6e2e9","bcd4e6","99c1de"],["e1c4b3","ffd5b5","fab6ba","f5a8c4","aacecd","bfd5cf","dbd9d0","baceda","9dc0db","7eb1d5"],["daa990","ffb787","f88e95","f282a9","8fc4c3","a3c8be","cec9b3","9dbcce","82acd2","649dcb"],["d69070","ff9c5e","f66770","f05f8f","74bbb9","87bfae","c5b993","83aac3","699bca","4d89c2"],["c97d5d","f58443","eb4d57","e54a7b","66a9a7","78ae9c","b5a67e","7599b1","5c88b7","4978aa"]],chart:[["#C1D37F","#4C5454","#FFD275","#66586F","#D05D5B","#C96480","#95BF8F","#6EA240","#0F0F0E","#EB8258","#95A3B3","#995D81"]]},T=function(m){return E[m]?E[m]:E.material};return T.get=function(m){return E[m]?E[m]:E},T.set=function(m,d){E[m]=d},T}var se=W();function he(E,T){var m={};m.options={};var d={data:[],position:null,allowCreate:!1,allowChangePosition:!1,onclick:null,onload:null,onchange:null,oncreate:null,ondelete:null,onbeforecreate:null,onchangeposition:null,animation:!1,hideHeaders:!1,padding:null,palette:null,maxWidth:null};for(var B in d)T&&T.hasOwnProperty(B)?m.options[B]=T[B]:m.options[B]=d[B];E.classList.add("jtabs");var J=null,ee=null,k=null;let L=function(le){m.options.animation&&setTimeout(function(){let ce=m.headers.children[le].getBoundingClientRect();m.options.palette==="modern"?(k.style.width=ce.width-4+"px",k.style.left=m.headers.children[le].offsetLeft+2+"px"):(k.style.width=ce.width+"px",k.style.left=m.headers.children[le].offsetLeft+"px"),m.options.position==="bottom"?k.style.top="0px":k.style.bottom="0px"},50)};var H=function(le){typeof m.headers.scrollTo=="function"?m.headers.scrollTo({left:le,behavior:"smooth"}):m.headers.scrollLeft=le,le<=1?J.classList.add("disabled"):J.classList.remove("disabled"),le>=m.headers.scrollWidth-m.headers.offsetWidth?ee.classList.add("disabled"):ee.classList.remove("disabled"),m.headers.scrollWidth<=m.headers.offsetWidth?(J.style.display="none",ee.style.display="none"):(J.style.display="",ee.style.display="")};if(m.setBorder=L,m.open=function(le){let ce=Array.from(m.content.children);if(m.content.children[le]){for(var Te=null,Ie=0;Ie<m.headers.children.length;Ie++)m.headers.children[Ie].classList.contains("jtabs-selected")&&(Te=Ie),m.headers.children[Ie].classList.remove("jtabs-selected"),m.headers.children[Ie].removeAttribute("aria-selected"),m.content.children[Ie]&&m.content.children[Ie].classList.remove("jtabs-selected");if(m.headers.children[le].classList.add("jtabs-selected"),m.headers.children[le].setAttribute("aria-selected","true"),m.content.children[le]&&m.content.children[le].classList.add("jtabs-selected"),Te!=le&&typeof m.options.onchange=="function"&&m.content.children[le]&&m.options.onchange(E,m,le,m.headers.children[le],m.content.children[le]),m.options.hideHeaders==!0&&m.headers.children.length<3&&m.options.allowCreate==!1)m.headers.parentNode.style.display="none";else{m.headers.parentNode.style.display="";var Ne=m.headers.children[le].offsetLeft,Ge=Ne+m.headers.children[le].offsetWidth,lt=m.headers.scrollLeft,pe=lt+m.headers.offsetWidth;lt<=Ne&&pe>=Ge||H(Ne-1),L(le)}}},m.selectIndex=function(le){var ce=Array.prototype.indexOf.call(m.headers.children,le);return ce>=0&&m.open(ce),ce},m.rename=function(le,ce){ce||(ce=prompt("New title",m.headers.children[le].innerText)),m.headers.children[le].innerText=ce,L(m.getActive())},m.create=function(le,ce){if(typeof m.options.onbeforecreate=="function"){var Te=m.options.onbeforecreate(E,le);if(Te===!1)return!1;le=Te}var Ie=m.appendElement(le);return typeof m.options.oncreate=="function"&&m.options.oncreate(E,Ie),L(m.getActive()),Ie},m.remove=function(le){return m.deleteElement(le)},m.nextNumber=function(){for(var le=0,ce=0;ce<m.headers.children.length;ce++){var Te=m.headers.children[ce].innerText.match(/[0-9].*/);Te>le&&(le=parseInt(Te))}return le?le++:le=1,le},m.deleteElement=function(le){let ce=m.getActive();if(m.headers.children[le])m.headers.removeChild(m.headers.children[le]),m.content.removeChild(m.content.children[le]);else return!1;if(ce===le)m.open(0);else{let Te=m.getActive()||0;L(Te)}typeof m.options.ondelete=="function"&&m.options.ondelete(E,le)},m.appendElement=function(le,ce,Te,Ie){if(!le)var le=prompt("Title?","");if(le){let lt=I.guid(),pe=I.guid();var Ne=document.createElement("div");Ne.setAttribute("id",pe),Ne.setAttribute("role","tabpanel"),Ne.setAttribute("aria-labelledby",lt);var Ge=document.createElement("div");if(Ge.setAttribute("id",lt),Ge.setAttribute("role","tab"),Ge.setAttribute("aria-controls",pe),Ge.innerHTML=le,Ge.content=Ne,typeof Ie>"u")m.content.appendChild(Ne),m.headers.insertBefore(Ge,m.headers.lastChild);else{let ue=m.content.children[Ie];ue?m.content.insertBefore(Ne,ue):m.content.appendChild(Ne),ue=m.headers.children[Ie]||m.headers.lastChild,m.headers.insertBefore(Ge,ue)}return m.options.allowChangePosition&&Ge.setAttribute("draggable","true"),Te!==!1&&m.selectIndex(Ge),typeof ce=="function"&&ce(Ne,Ge),Ne}},m.getActive=function(){for(var le=0;le<m.headers.children.length;le++)if(m.headers.children[le].classList.contains("jtabs-selected"))return le;return!1},m.updateContent=function(le,ce){if(typeof ce!="string")var Te=ce;else{var Te=document.createElement("div");Te.innerHTML=ce}m.content.children[le].classList.contains("jtabs-selected")&&ce.classList.add("jtabs-selected"),m.content.replaceChild(ce,m.content.children[le]),L()},m.updatePosition=function(le,ce,Te,Ie){if(le>ce?m.content.insertBefore(m.content.children[le],m.content.children[ce]):m.content.insertBefore(m.content.children[le],m.content.children[ce].nextSibling),Ie!==!1)m.open(ce);else{let Ne=m.getActive();ce<Ne&&m.setBorder(Ne)}!Te&&typeof m.options.onchangeposition=="function"&&m.options.onchangeposition(m.headers,le,ce)},m.move=function(le,ce,Te,Ie){le>ce?m.headers.insertBefore(m.headers.children[le],m.headers.children[ce]):m.headers.insertBefore(m.headers.children[le],m.headers.children[ce].nextSibling),m.updatePosition(le,ce,Te,Ie)},m.setBorder=L,m.init=function(){E.innerHTML="",m.headers=document.createElement("div"),m.content=document.createElement("div"),m.headers.classList.add("jtabs-headers"),m.headers.setAttribute("role","tablist"),m.content.classList.add("jtabs-content"),m.content.setAttribute("role","region"),m.content.setAttribute("aria-label","Tab Panels"),m.options.palette?E.classList.add("jtabs-modern"):E.classList.remove("jtabs-modern"),m.options.padding&&(m.content.style.padding=parseInt(m.options.padding)+"px");var le=document.createElement("div");le.className="jtabs-headers-container",le.appendChild(m.headers),m.options.maxWidth&&(le.style.maxWidth=parseInt(m.options.maxWidth)+"px");var ce=document.createElement("div");if(ce.className="jtabs-controls",ce.setAttribute("draggable","false"),le.appendChild(ce),m.options.position=="bottom"?(E.appendChild(m.content),E.appendChild(le)):(E.appendChild(le),E.appendChild(m.content)),m.options.allowCreate==!0){var Te=document.createElement("div");Te.className="jtabs-add",Te.onclick=function(){m.create()},ce.appendChild(Te)}J=document.createElement("div"),J.className="jtabs-prev",J.onclick=function(){H(m.headers.scrollLeft-m.headers.offsetWidth)},ce.appendChild(J),ee=document.createElement("div"),ee.className="jtabs-next",ee.onclick=function(){H(m.headers.scrollLeft+m.headers.offsetWidth)},ce.appendChild(ee);for(var Ie=0;Ie<m.options.data.length;Ie++){if(m.options.data[Ie].titleElement)var Ne=m.options.data[Ie].titleElement;else var Ne=document.createElement("div");if(m.options.data[Ie].icon){var Ge=document.createElement("div"),lt=document.createElement("i");lt.classList.add("material-icons"),lt.innerHTML=m.options.data[Ie].icon,Ge.appendChild(lt),Ne.appendChild(Ge)}if(m.options.data[Ie].title){var pe=document.createTextNode(m.options.data[Ie].title);Ne.appendChild(pe)}if(m.options.data[Ie].width&&(Ne.style.width=m.options.data[Ie].width),m.options.data[Ie].contentElement)var ue=m.options.data[Ie].contentElement;else{var ue=document.createElement("div");ue.innerHTML=m.options.data[Ie].content}m.headers.appendChild(Ne),m.content.appendChild(ue)}k=document.createElement("div"),k.className="jtabs-border",m.headers.appendChild(k),m.options.animation&&E.classList.add("jtabs-animation"),m.headers.addEventListener("click",function(ye){if(ye.target.parentNode.classList.contains("jtabs-headers"))var z=ye.target;else if(ye.target.tagName=="I")var z=ye.target.parentNode.parentNode;else var z=ye.target.parentNode;var X=m.selectIndex(z);typeof m.options.onclick=="function"&&m.options.onclick(E,m,X,m.headers.children[X],m.content.children[X])}),m.headers.addEventListener("contextmenu",function(ye){m.selectIndex(ye.target)}),m.headers.children.length&&m.open(0),H(0),m.options.allowChangePosition==!0&&p(m.headers,{direction:1,ondrop:function(ye,z,X){m.updatePosition(z,X)}}),typeof m.options.onload=="function"&&m.options.onload(E,m)},E.children[0]&&E.children[0].children.length)for(var G=0;G<E.children[0].children.length;G++){var oe=m.options.data&&m.options.data[G]?m.options.data[G]:{};E.children[1]&&E.children[1].children[G]?(oe.titleElement=E.children[0].children[G],oe.contentElement=E.children[1].children[G]):oe.contentElement=E.children[0].children[G],m.options.data[G]=oe}var me=!1;if(m.options.data)for(var G=0;G<m.options.data.length;G++)m.options.data[G].url&&(b({url:m.options.data[G].url,type:"GET",dataType:"text/html",index:G,success:function(ce){m.options.data[this.index].content=ce},complete:function(){m.init()}}),me=!0);return me||m.init(),E.tabs=m,m}function ae(E,T){if(E.color)return E.color.setOptions(T,!0);var m={type:"color"};m.options={};var d=null,B=null,J=null,ee=null,k=null,L=null,H=null;m.setOptions=function(R,Y){var de={placeholder:"",value:null,onopen:null,onclose:null,onchange:null,closeOnChange:!0,palette:null,position:null,doneLabel:"Done",resetLabel:"Reset",fullscreen:!1,opened:!1};R||(R={}),R&&!R.palette&&(R.palette=se());for(var ne in de)R&&R.hasOwnProperty(ne)?m.options[ne]=R[ne]:(typeof m.options[ne]>"u"||Y===!0)&&(m.options[ne]=de[ne]);return ee&&(ee.innerHTML=m.options.resetLabel),k&&(k.innerHTML=m.options.doneLabel),m.options.palette&&H&&H.updateContent(0,Te()),typeof m.options.value=="string"&&(E.value=m.options.value,E.tagName==="INPUT"&&(E.style.color=E.value,E.style.backgroundColor=E.value)),m.options.placeholder?E.setAttribute("placeholder",m.options.placeholder):E.getAttribute("placeholder")&&E.removeAttribute("placeholder"),m},m.select=function(R){var Y=d.querySelector(".jcolor-selected");Y&&Y.classList.remove("jcolor-selected"),m.values[R]&&m.values[R].classList.add("jcolor-selected"),m.options.value=R},m.open=function(){if(!d.classList.contains("jcolor-focus")){g(m,!0),d.classList.add("jcolor-focus"),m.options.value&&m.select(m.options.value),J.style.marginTop="",J.style.marginLeft="";var R=J.getBoundingClientRect(),Y=I.getWindowWidth(),de=I.getWindowHeight();if(Y<800||m.options.fullscreen==!0?(J.classList.add("jcolor-fullscreen"),A.slideBottom(J,1),B.style.display="block"):(J.classList.contains("jcolor-fullscreen")&&(J.classList.remove("jcolor-fullscreen"),B.style.display=""),m.options.position?J.style.position="fixed":J.style.position="",R.left+R.width>Y&&(J.style.marginLeft=-1*(R.left+R.width-(Y-20))+"px"),R.top+R.height>de&&(J.style.marginTop=-1*(R.top+R.height-(de-20))+"px")),typeof m.options.onopen=="function"&&m.options.onopen(E,m),H.setBorder(H.getActive()),m.options.value){var ne=ce(m.options.value);ye.forEach(function(Q,ve){Q.value=ne[ve],Q.dispatchEvent(new Event("input"))})}}},m.close=function(R){return d.classList.contains("jcolor-focus")&&(d.classList.remove("jcolor-focus"),B.style.display="",!R&&typeof m.options.onclose=="function"&&m.options.onclose(E,m),g(m,!1)),m.options.value},m.setValue=function(R){R||(R=""),R!=m.options.value&&(m.options.value=R,ue=R,m.select(R),typeof m.options.onchange=="function"&&m.options.onchange(E,R,m),E.value!=m.options.value&&(E.value=m.options.value,E.tagName==="INPUT"&&(E.style.color=E.value,E.style.backgroundColor=E.value),typeof E.oninput=="function"&&E.oninput({type:"input",target:E,value:E.value})),m.options.closeOnChange==!0&&m.close())},m.getValue=function(){return m.options.value};var G=!1,oe=function(R){var Y=R.toString(16);return Y.length===1?"0"+Y:Y},me=function(R,Y,de){return"#"+oe(R)+oe(Y)+oe(de)},le=function(R){return parseInt("0x"+R)},ce=function(R){return[le(R.substr(1,2)),le(R.substr(3,2)),le(R.substr(5,2))]},Te=function(){var R=document.createElement("div");R.className="jcolor-grid",m.values=[];var Y=document.createElement("table");Y.setAttribute("cellpadding","7"),Y.setAttribute("cellspacing","0");for(var de=0;de<m.options.palette.length;de++){for(var ne=document.createElement("tr"),Q=0;Q<m.options.palette[de].length;Q++){var ve=document.createElement("td"),Ce=m.options.palette[de][Q];Ce.length<7&&Ce.substr(0,1)!=="#"&&(Ce="#"+Ce),ve.style.backgroundColor=Ce,ve.setAttribute("data-value",Ce),ve.innerHTML="",ne.appendChild(ve),m.options.value==Ce&&ve.classList.add("jcolor-selected"),m.values[Ce]=ve}Y.appendChild(ne)}return R.appendChild(Y),R},Ie=document.createElement("canvas");Ie.width=200,Ie.height=160;var Ne=Ie.getContext("2d"),Ge=function(){var R=L.firstChild.getBoundingClientRect();Ie.width=R.width-14,lt()},lt=function(){var R=Ne.createLinearGradient(0,0,Ie.width,0);R.addColorStop(0,"rgb(255,0,0)"),R.addColorStop(.15,"rgb(255,0,255)"),R.addColorStop(.33,"rgb(0,0,255)"),R.addColorStop(.49,"rgb(0,255,255)"),R.addColorStop(.67,"rgb(0,255,0)"),R.addColorStop(.84,"rgb(255,255,0)"),R.addColorStop(1,"rgb(255,0,0)"),Ne.fillStyle=R,Ne.fillRect(0,0,Ie.width,Ie.height),R=Ne.createLinearGradient(0,0,0,Ie.height),R.addColorStop(0,"rgba(255,255,255,1)"),R.addColorStop(.5,"rgba(255,255,255,0)"),R.addColorStop(.5,"rgba(0,0,0,0)"),R.addColorStop(1,"rgba(0,0,0,1)"),Ne.fillStyle=R,Ne.fillRect(0,0,Ie.width,Ie.height)},pe=function(){var R=document.createElement("div");R.className="jcolor-hsl";var Y=document.createElement("div");Y.className="jcolor-point";var de=document.createElement("div");de.appendChild(Ie),de.appendChild(Y),R.appendChild(de);var ne=function(Q,ve,Ce){if(Q===1){var De=R.getBoundingClientRect(),xe=ve-De.left,ke=Ce-De.top;xe<0&&(xe=0),ke<0&&(ke=0),xe>De.width&&(xe=De.width),ke>De.height&&(ke=De.height),Y.style.left=xe+"px",Y.style.top=ke+"px";var qe=Ne.getImageData(xe,ke,1,1).data;ue=me(qe[0],qe[1],qe[2])}};return R.addEventListener("mousedown",function(Q){ne(Q.buttons,Q.clientX,Q.clientY)}),R.addEventListener("mousemove",function(Q){ne(Q.buttons,Q.clientX,Q.clientY)}),R.addEventListener("touchmove",function(Q){ne(1,Q.changedTouches[0].clientX,Q.changedTouches[0].clientY)}),R},ue="",ye=[],z=function(){if(ue!=="")for(var R=0;R<ye.length;R++){var Y=ce(ue);Y[R]=0;var de="linear-gradient(90deg, rgb(";de+=Y.join(", "),de+="), rgb(",Y[R]=255,de+=Y.join(", "),de+="))",ye[R].style.backgroundImage=de}},X=function(){var R=document.createElement("div");R.className="jcolor-sliders";var Y=document.createElement("div"),de=function(Ce){var De=document.createElement("div");De.className="jcolor-sliders-input-container";var xe=document.createElement("label");xe.innerText=Ce;var ke=document.createElement("div");ke.className="jcolor-sliders-input-subcontainer";var qe=document.createElement("input");qe.type="range",qe.min=0,qe.max=255,qe.value=0,qe.setAttribute("aria-label","Color value"),qe.setAttribute("aria-valuemin","0"),qe.setAttribute("aria-valuemax","255"),qe.setAttribute("aria-valuenow","0"),De.appendChild(xe),ke.appendChild(qe);var ct=document.createElement("div");return ct.innerText=qe.value,qe.addEventListener("input",function(){ct.innerText=qe.value}),ke.appendChild(ct),De.appendChild(ke),Y.appendChild(De),qe};ye=[de("Red"),de("Green"),de("Blue")],R.appendChild(Y);var ne=document.createElement("div");ne.className="jcolor-sliders-final-color";var Q=document.createElement("div");Q.style.visibility="hidden",Q.innerText="a",ne.appendChild(Q);var ve=function(){var Ce=me(parseInt(ye[0].value),parseInt(ye[1].value),parseInt(ye[2].value));Q.innerText=Ce,Q.style.color=Ce,Q.style.removeProperty("visibility"),ue=Ce};return ye.forEach(function(Ce){Ce.addEventListener("input",function(){ve(),z()})}),R.appendChild(ne),R},S=function(){m.setOptions(T),E.tagName=="INPUT"&&(E.classList.add("jcolor-input"),E.readOnly=!0),d=document.createElement("div"),d.className="jcolor",B=document.createElement("div"),B.className="jcolor-backdrop",d.appendChild(B),J=document.createElement("div"),J.className="jcolor-content";var R=document.createElement("div");R.className="jcolor-controls",J.appendChild(R),ee=document.createElement("div"),ee.className="jcolor-reset",ee.innerHTML=m.options.resetLabel,R.appendChild(ee),k=document.createElement("div"),k.className="jcolor-close",k.innerHTML=m.options.doneLabel,R.appendChild(k),L=document.createElement("div"),J.appendChild(L),H=he(L,{animation:!0,data:[{title:"Grid",contentElement:Te()},{title:"Spectrum",contentElement:pe()},{title:"Sliders",contentElement:X()}],onchange:function(Y,de,ne){if(ne===1)Ge();else{var Q=ue!==""?ue:m.getValue();if(ne===2&&Q){var ve=ce(Q);ye.forEach(function(Ce,De){Ce.value=ve[De],Ce.dispatchEvent(new Event("input"))})}}},palette:"modern"}),d.appendChild(J),E.tagName=="INPUT"?E.parentNode.insertBefore(d,E.nextSibling):E.appendChild(d),d.addEventListener("click",function(Y){if(Y.target.tagName=="TD"){var de=Y.target.getAttribute("data-value");de&&m.setValue(de)}else Y.target.classList.contains("jcolor-reset")?(m.setValue(""),m.close()):Y.target.classList.contains("jcolor-close")?(H.getActive()>0&&m.setValue(ue),m.close()):Y.target.classList.contains("jcolor-backdrop")?m.close():m.open()}),E.addEventListener("mouseup",function(Y){m.open()}),window.addEventListener("resize",function(){d.classList.contains("jcolor-focus")&&H.getActive()==1&&Ge()}),m.options.opened==!0&&m.open(),E.change=m.setValue,E.val=function(Y){if(Y===void 0)return m.getValue();m.setValue(Y)},E.color=m,d.color=m};return m.toHex=function(R){var Y=function(de){return("0"+parseInt(de).toString(16)).slice(-2)};if(R)return/^#[0-9A-F]{6}$/i.test(R)?R:(R=R.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/),R&&R.length?"#"+Y(R[1])+Y(R[2])+Y(R[3]):"")},S(),m}function we(){var E=function(T,m){var d={type:"contextmenu"};d.options={};var B={items:null,onclick:null};for(var J in B)m&&m.hasOwnProperty(J)?d.options[J]=m[J]:d.options[J]=B[J];T.classList.add("jcontextmenu"),d.open=function(L,H){if(H&&(d.options.items=H,d.create(H)),E.current&&E.current.close(),g(d,!0),T.classList.add("jcontextmenu-focus"),E.current=d,d.options.items&&d.options.items.length>0||T.children.length){if(L.target)if(L.changedTouches&&L.changedTouches[0])G=L.changedTouches[0].clientX,oe=L.changedTouches[0].clientY;else var G=L.clientX,oe=L.clientY;else var G=L.x,oe=L.y;var me=T.getBoundingClientRect();if(window.innerHeight<oe+me.height){var le=oe-me.height;le<0&&(le=0),T.style.top=le+"px"}else T.style.top=oe+"px";window.innerWidth<G+me.width?G-me.width>0?T.style.left=G-me.width+"px":T.style.left="10px":T.style.left=G+"px"}},d.isOpened=function(){return!!T.classList.contains("jcontextmenu-focus")},d.close=function(){T.classList.contains("jcontextmenu-focus")&&T.classList.remove("jcontextmenu-focus"),g(d,!1)},d.create=function(L){T.innerHTML="";var H=ee();T.appendChild(H);for(var G=0;G<L.length;G++){var oe=k(L[G]);T.appendChild(oe)}};function ee(){var L=document.createElement("div");L.classList.add("header"),L.addEventListener("click",function(oe){oe.preventDefault(),oe.stopPropagation()});var H=document.createElement("a");H.classList.add("title"),H.innerHTML=u.translate("Menu"),L.appendChild(H);var G=document.createElement("a");return G.classList.add("close"),G.innerHTML=u.translate("close"),G.addEventListener("click",function(oe){d.close()}),L.appendChild(G),L}function k(L){if(L.type&&(L.type=="line"||L.type=="divisor"))var H=document.createElement("hr");else{var H=document.createElement("div"),G=document.createElement("a");if(G.innerHTML=L.title,L.tooltip&&H.setAttribute("title",L.tooltip),L.icon&&H.setAttribute("data-icon",L.icon),L.id&&(H.id=L.id),L.disabled?H.className="jcontextmenu-disabled":L.onclick&&(H.method=L.onclick,H.addEventListener("mousedown",function(Ge){Ge.preventDefault()}),H.addEventListener("mouseup",function(Ge){this.method(this,Ge)})),H.appendChild(G),L.submenu){var oe=document.createElement("span");oe.innerHTML="&#9658;",H.appendChild(oe),H.classList.add("jcontexthassubmenu");var me=document.createElement("div");me.classList.add("jcontextmenu"),me.setAttribute("tabindex","900");for(var le=L.submenu,ce=0;ce<le.length;ce++){var Te=k(le[ce]);me.appendChild(Te)}H.appendChild(me)}else if(L.shortcut){var Ie=document.createElement("span");Ie.innerHTML=L.shortcut,H.appendChild(Ie)}}return H}return typeof d.options.onclick=="function"&&T.addEventListener("click",function(L){d.options.onclick(d,L)}),d.options.items&&d.create(d.options.items),window.addEventListener("mousewheel",function(){d.close()}),T.contextmenu=d,d};return E}var Me=we();function be(){var E=function(T,m){if(T.dropdown)return T.dropdown.setOptions(m,!0);var d={type:"dropdown"};d.options={};var B=function(z,X){z&&z.length&&(d.options.sortResults!==!1&&(typeof d.options.sortResults=="function"?z.sort(d.options.sortResults):z.sort(J)),d.setData(z)),typeof d.options.onload=="function"&&d.options.onload(T,d,z,X),X&&k(X),X==null&&(d.options.value=""),T.value=d.options.value,d.options.opened==!0&&d.open()},J=function(z,X){var S,R;return typeof z=="string"?S=z:z.text?S=z.text:z.name&&(S=z.name),typeof X=="string"?R=X:X.text?R=X.text:X.name&&(R=X.name),typeof S=="string"||typeof R=="string"?(typeof S!="string"&&(S=""+S),typeof R!="string"&&(R=""+R),S.localeCompare(R)):S-R},ee=function(){d.value={};for(var z=0;z<d.items.length;z++)d.items[z].selected==!0&&(d.items[z].element&&d.items[z].element.classList.remove("jdropdown-selected"),d.items[z].selected=null);d.options.value="",T.value=""},k=function(z){if(ee(),z!==null)if(!z)typeof d.value[""]<"u"&&(d.value[""]="");else{Array.isArray(z)||(z=(""+z).split(";"));for(var X=0;X<z.length;X++)d.value[z[X]]=""}for(var X=0;X<d.items.length;X++)typeof d.value[L(X)]<"u"&&(d.items[X].element&&d.items[X].element.classList.add("jdropdown-selected"),d.items[X].selected=!0,d.value[L(X)]=H(X));d.options.value=Object.keys(d.value).join(";"),d.header.value=d.getText()},L=function(z,X){if(d.options.format)var S="id";else var S="value";return d.items[z]?X!==void 0?d.items[z].data[S]=X:d.items[z].data[S]:""},H=function(z,X){if(d.options.format)var S="name";else var S="text";return d.items[z]?X!==void 0?d.items[z].data[S]=X:d.items[z].data[S]:""},G=function(){return Object.keys(d.value)},oe=function(){for(var z=[],X=Object.keys(d.value),S=0;S<X.length;S++)z.push(d.value[X[S]]);return z};d.setOptions=function(z,X){z||(z={});var S={url:null,data:[],format:0,multiple:!1,autocomplete:!1,remoteSearch:!1,lazyLoading:!1,type:null,width:null,maxWidth:null,opened:!1,value:null,placeholder:"",newOptions:!1,position:!1,onchange:null,onload:null,onopen:null,onclose:null,onfocus:null,onblur:null,oninsert:null,onbeforeinsert:null,onsearch:null,onbeforesearch:null,sortResults:!1,autofocus:!1,prompt:null,allowEmpty:!0};for(var R in S)z&&z.hasOwnProperty(R)?d.options[R]=z[R]:(typeof d.options[R]>"u"||X===!0)&&(d.options[R]=S[R]);return(d.options.remoteSearch==!0||d.options.type==="searchbar")&&(d.options.autocomplete=!0),d.options.newOptions==!0?d.header.classList.add("jdropdown-add"):d.header.classList.remove("jdropdown-add"),d.options.autocomplete==!0?d.header.removeAttribute("readonly"):d.header.setAttribute("readonly","readonly"),d.options.placeholder?d.header.setAttribute("placeholder",d.options.placeholder):d.header.removeAttribute("placeholder"),T.classList.remove("jdropdown-searchbar"),T.classList.remove("jdropdown-picker"),T.classList.remove("jdropdown-list"),d.options.type=="searchbar"?T.classList.add("jdropdown-searchbar"):d.options.type=="list"?T.classList.add("jdropdown-list"):d.options.type=="picker"?T.classList.add("jdropdown-picker"):I.getWindowWidth()<800?d.options.autocomplete?(T.classList.add("jdropdown-searchbar"),d.options.type="searchbar"):(T.classList.add("jdropdown-picker"),d.options.type="picker"):(d.options.width?(T.style.width=d.options.width,T.style.minWidth=d.options.width):(T.style.removeProperty("width"),T.style.removeProperty("min-width")),T.classList.add("jdropdown-default"),d.options.type="default"),d.options.type=="searchbar"?me.appendChild(Te):le.insertBefore(Te,le.firstChild),d.options.url&&!z.data?b({url:d.options.url,method:"GET",dataType:"json",success:function(Y){Y&&B(Y,d.options.value)}}):B(d.options.data,d.options.value),d};var me=null,le=null,ce=null,Te=null,Ie=null,Ne=null,Ge=null,lt=function(){if(m||(m={}),T.tagName=="SELECT"){var z=E.extractFromDom(T,m);T=z.el,m=z.options}!m.placeholder&&T.getAttribute("placeholder")&&(m.placeholder=T.getAttribute("placeholder")),d.value={},d.items=[],d.groups=[],d.search="",d.results=null,T.classList.add("jdropdown"),me=document.createElement("div"),me.className="jdropdown-container-header",d.header=document.createElement("input"),d.header.className="jdropdown-header jss_object",d.header.type="text",d.header.setAttribute("autocomplete","off"),d.header.onfocus=function(){typeof d.options.onfocus=="function"&&d.options.onfocus(T)},d.header.onblur=function(){typeof d.options.onblur=="function"&&d.options.onblur(T)},d.header.onkeyup=function(X){d.options.autocomplete==!0&&!Ge?(d.search!=d.header.value.trim()&&(Ge=setTimeout(function(){d.find(d.header.value.trim()),Ge=null},400)),T.classList.contains("jdropdown-focus")||d.open()):d.options.autocomplete||d.next(X.key)},E.hasEvents||(E.hasEvents=!0,document.addEventListener("keydown",E.keydown)),le=document.createElement("div"),le.className="jdropdown-container",ce=document.createElement("div"),ce.className="jdropdown-content",Te=document.createElement("div"),Te.className="jdropdown-close",Te.textContent="Done",Ie=document.createElement("div"),Ie.className="jdropdown-reset",Ie.textContent="x",Ie.onclick=function(){d.reset(),d.close()},Ne=document.createElement("div"),Ne.className="jdropdown-backdrop",me.appendChild(d.header),le.appendChild(ce),T.appendChild(me),T.appendChild(le),T.appendChild(Ne),d.setOptions(m),"ontouchsend"in document.documentElement?T.addEventListener("touchsend",E.mouseup):T.addEventListener("mouseup",E.mouseup),d.options.lazyLoading==!0&&w(ce,{loadUp:d.loadUp,loadDown:d.loadDown}),ce.onwheel=function(X){X.stopPropagation()},T.change=d.setValue,T.val=function(X){if(X===void 0)return d.getValue(!!d.options.multiple);d.setValue(X)},T.dropdown=d};d.getUrl=function(){return d.options.url},d.setUrl=function(z,X){d.options.url=z,b({url:d.options.url,method:"GET",dataType:"json",success:function(S){d.setData(S),typeof X=="function"&&X(d)}})},d.setId=function(z,X){if(d.options.format)var S="id";else var S="value";typeof z=="object"?z[S]=X:d.items[z].data[S]=X};let pe=function(z,X){if(!z){let Y=d.options.autocomplete==!0?d.header.value:"";if(z=prompt(u.translate("Add A New Option"),Y),!z)return!1}if(X||(X=I.guid()),d.options.format)var S={id:X,name:z};else var S={value:X,text:z};if(typeof d.options.onbeforeinsert=="function"){let Y=d.options.onbeforeinsert(d,S);if(Y===!1)return!1;Y&&(S=Y)}d.options.data.push(S);var R=d.createItem(S);return ce.appendChild(R.element),typeof d.options.oninsert=="function"&&d.options.oninsert(d,S,R),ce.style.display=="none"&&(ce.style.display=""),d.results&&d.results.push(R),S};d.add=function(z,X){return typeof d.options.prompt=="function"?d.options.prompt.call(d,pe):pe(z,X)},d.createItem=function(z,X,S){d.options.format?(!z.id&&z.value!==void 0&&(z.id=z.value),!z.name&&z.text!==void 0&&(z.name=z.text)):(!z.value&&z.id!==void 0&&(z.value=z.id),!z.text&&z.name!==void 0&&(z.text=z.name));var R={};if(R.element=document.createElement("div"),R.element.className="jdropdown-item",R.element.indexValue=d.items.length,R.data=z,X&&(R.group=X),z.id&&R.element.setAttribute("id",z.id),z.disabled==!0&&R.element.setAttribute("data-disabled",!0),z.tooltip&&R.element.setAttribute("title",z.tooltip),z.image){var Y=document.createElement("img");Y.className="jdropdown-image",Y.src=z.image,z.title||Y.classList.add("jdropdown-image-small"),R.element.appendChild(Y)}else if(z.icon){var de=document.createElement("span");de.className="jdropdown-icon material-icons",de.innerText=z.icon,z.title||de.classList.add("jdropdown-icon-small"),z.color&&(de.style.color=z.color),R.element.appendChild(de)}else if(z.color){var ne=document.createElement("div");ne.className="jdropdown-color",ne.style.backgroundColor=z.color,R.element.appendChild(ne)}if(d.options.format)var Q=z.name;else var Q=z.text;var ve=document.createElement("div");if(ve.className="jdropdown-description",ve.textContent=Q||"&nbsp;",z.title){var Ce=document.createElement("div");Ce.className="jdropdown-title",Ce.innerText=z.title,ve.appendChild(Ce)}if(d.options.format)var De=z.id;else var De=z.value;return d.value[De]&&(R.element.classList.add("jdropdown-selected"),R.selected=!0),d.items.push(R),R.element.appendChild(ve),R},d.appendData=function(z){if(z.length){for(var X=[],S=[],R=0;R<z.length;R++)z[R].group?(S[z[R].group]||(S[z[R].group]=[]),S[z[R].group].push(R)):X.push(R);var Y=0,de=Object.keys(S);if(de.length>0)for(var R=0;R<de.length;R++){var ne=document.createElement("div");ne.className="jdropdown-group";var Q=document.createElement("div");Q.className="jdropdown-group-name",Q.textContent=de[R];var ve=document.createElement("i");ve.className="jdropdown-group-arrow jdropdown-group-arrow-down",Q.appendChild(ve);var Ce=document.createElement("div");Ce.className="jdropdown-group-items";for(var De=0;De<S[de[R]].length;De++){var xe=d.createItem(z[S[de[R]][De]],ne,de[R]);(d.options.lazyLoading==!1||Y<200)&&(Ce.appendChild(xe.element),Y++)}ne.appendChild(Q),ne.appendChild(Ce),d.groups.push(ne),Ce.children.length>0&&ce.appendChild(ne)}if(X.length)for(var R=0;R<X.length;R++){var xe=d.createItem(z[X[R]]);(d.options.lazyLoading==!1||Y<200)&&(ce.appendChild(xe.element),Y++)}}},d.setData=function(z){if(ee(),ce.textContent="",d.header.value="",d.items=[],z&&z.length){for(var X=0;X<z.length;X++)typeof z[X]!="object"&&(d.options.format?z[X]={id:z[X],name:z[X]}:z[X]={value:z[X],text:z[X]});d.appendData(z),d.options.data=z}else d.options.data=[];d.close()},d.getData=function(){return d.options.data},d.getPosition=function(z){for(var X=0;X<d.items.length;X++)if(L(X)==z)return X;return!1},d.getText=function(z){var X=oe();return z?X:X.join("; ")},d.getValue=function(z){var X=G();return z?X:X.join(";")};var ue=function(z){T.value!=d.options.value&&(T.value=d.options.value,typeof T.oninput=="function"&&T.oninput({type:"input",target:T,value:T.value})),typeof d.options.onchange=="function"&&d.options.onchange(T,d,z,d.options.value)};d.setValue=function(z){var X=d.getValue();Array.isArray(z)&&(z=z.join(";")),X!==z&&(k(z),ue(X))},d.resetSelected=function(){d.setValue(null)},d.selectIndex=function(S,X){var S=parseInt(S);if(d.items&&d.items[S]&&(X===!0||d.items[S].data.disabled!==!0))if(d.setCursor(S,!1),!d.options.multiple)d.items[S].selected?d.options.allowEmpty!==!1&&d.setValue(null):d.setValue(L(S)),d.close();else{var R=d.options.value;d.items[S].selected?(d.items[S].element.classList.remove("jdropdown-selected"),d.items[S].selected=!1,delete d.value[L(S)]):(d.items[S].element.classList.add("jdropdown-selected"),d.items[S].selected=!0,d.value[L(S)]=H(S)),d.options.value=Object.keys(d.value).join(";"),d.options.autocomplete==!1&&(d.header.value=oe().join("; ")),ue(R)}},d.selectItem=function(z){d.selectIndex(z.indexValue)};var ye=function(z,X){for(var S=0;S<X.length;S++)if(d.options.format){if(X[S].id==z)return!0}else if(X[S].value==z)return!0;return!1};return d.find=function(z){if(d.search==z.trim())return!1;if(d.search=z,d.setCursor(),d.groups.length)for(var X=0;X<d.groups.length;X++)d.groups[X].lastChild.textContent="";if(ce.textContent="",d.options.remoteSearch==!0){d.results=null;var S=d.options.url;let Ce={url:S,method:"GET",data:{q:z},dataType:"json",success:function(De){d.items=[];var xe=Object.keys(d.value);if(xe.length)for(var ke=0;ke<xe.length;ke++)ye(xe[ke],De)||(d.options.format?De.unshift({id:xe[ke],name:d.value[xe[ke]]}):De.unshift({value:xe[ke],text:d.value[xe[ke]]}));d.appendData(De),De.length?ce.style.display="":ce.style.display="none",typeof d.options.onsearch=="function"&&d.options.onsearch(d,De)}};if(typeof d.options.onbeforesearch=="function"){let De=d.options.onbeforesearch(d,Ce);if(De===!1)return;typeof De=="object"&&(Ce=De)}b(Ce)}else{z=new RegExp(z,"gi");for(var R=[],X=0;X<d.items.length;X++){var Y=H(X),de=d.items[X].data.title||"",ne=d.items[X].data.group||"",Q=d.items[X].data.synonym||"";Q&&(Q=Q.join(" ")),(z==null||d.items[X].selected==!0||Y.toString().match(z)||de.match(z)||ne.match(z)||Q.match(z))&&R.push(d.items[X])}if(!R.length)ce.style.display="none",d.results=null;else{ce.style.display="",d.results=R;var ve=R.length||0;d.options.lazyLoading==!0&&ve>200&&(ve=200);for(var X=0;X<ve;X++)d.results[X].group?(d.results[X].group.parentNode||ce.appendChild(d.results[X].group),d.results[X].group.lastChild.appendChild(d.results[X].element)):ce.appendChild(d.results[X].element)}}d.options.autofocus==!0&&d.first()},d.open=function(){if(!T.classList.contains("jdropdown-focus")){E.current=d,g(d,!0),T.classList.add("jdropdown-focus"),I.getWindowWidth()<800&&(d.options.type==null||d.options.type=="picker")&&A.slideBottom(le,1),d.options.autocomplete==!0&&(d.header.value=d.search,d.header.focus());var z=G();if(z[0]){var X=d.getPosition(z[0]);X!==!1&&d.setCursor(X)}if(!d.options.type||d.options.type=="default"){var S=T.getBoundingClientRect(),R=le.getBoundingClientRect();d.options.position?(le.style.position="fixed",window.innerHeight<S.bottom+R.height?(le.style.top="",le.style.bottom=window.innerHeight-S.top+1+"px"):(le.style.top=S.bottom+"px",le.style.bottom=""),le.style.left=S.left+"px"):window.innerHeight<S.bottom+R.height?(le.style.top="",le.style.bottom=S.height+1+"px"):(le.style.top="",le.style.bottom=""),le.style.minWidth=S.width+"px",d.options.maxWidth&&(le.style.maxWidth=d.options.maxWidth),!d.items.length&&d.options.autocomplete==!0?ce.style.display="none":ce.style.display=""}}typeof d.options.onopen=="function"&&d.options.onopen(T)},d.close=function(z){return T.classList.contains("jdropdown-focus")&&(d.header.value=d.getText(),d.setCursor(),!z&&typeof d.options.onclose=="function"&&d.options.onclose(T),d.header.blur&&d.header.blur(),T.classList.remove("jdropdown-focus"),g(d,!1),E.current=null),d.getValue()},d.setCursor=function(z,X){if(d.currentIndex!=null&&d.items&&d.items[d.currentIndex]&&d.items[d.currentIndex].element.classList.remove("jdropdown-cursor"),z==null)d.currentIndex=null;else if(z=parseInt(z),d.items[z].element.parentNode&&(d.items[z].element.classList.add("jdropdown-cursor"),d.currentIndex=z,X!==!1&&d.items[d.currentIndex].element)){var S=ce.scrollTop,R=d.items[d.currentIndex].element;ce.scrollTop=R.offsetTop-R.scrollTop+R.clientTop-95}},d.resetCursor=d.setCursor,d.updateCursor=d.setCursor,d.reset=function(){d.setCursor(),d.setValue(null)},d.first=function(){d.options.lazyLoading===!0&&d.loadFirst();var z=ce.querySelectorAll(".jdropdown-item");if(z.length){var X=z[0].indexValue;d.setCursor(X)}},d.last=function(){d.options.lazyLoading===!0&&d.loadLast();var z=ce.querySelectorAll(".jdropdown-item");if(z.length){var X=z[z.length-1].indexValue;d.setCursor(X)}},d.next=function(z){var X=null;if(z){if(z.length==1){var S=d.currentIndex||-1;z=z.toLowerCase();var R=null,Y=null,de=ce.querySelectorAll(".jdropdown-item");if(de.length){for(var ne=0;ne<de.length;ne++)if(de[ne].indexValue>S&&(R=d.items[de[ne].indexValue])&&(Y=R.element.innerText[0])&&(Y=Y.toLowerCase(),z==Y)){X=de[ne].indexValue;break}d.setCursor(X)}}}else if(d.currentIndex==null||d.currentIndex==null)d.first();else{var Q=d.items[d.currentIndex].element,ve=Q.nextElementSibling;ve?(ve.classList.contains("jdropdown-group")&&(ve=ve.lastChild.firstChild),X=ve.indexValue):Q.parentNode.classList.contains("jdropdown-group-items")&&((ve=Q.parentNode.parentNode.nextElementSibling)&&(ve.classList.contains("jdropdown-group")?ve=ve.lastChild.firstChild:ve.classList.contains("jdropdown-item")?X=ve.indexValue:ve=null),ve&&(X=ve.indexValue)),X!==null&&d.setCursor(X)}},d.prev=function(){var z=null;if(d.currentIndex===null)d.first();else{var X=d.items[d.currentIndex].element,S=X.previousElementSibling;S?(S.classList.contains("jdropdown-group")&&(S=S.lastChild.lastChild),z=S.indexValue):X.parentNode.classList.contains("jdropdown-group-items")&&((S=X.parentNode.parentNode.previousElementSibling)&&(S.classList.contains("jdropdown-group")?S=S.lastChild.lastChild:S.classList.contains("jdropdown-item")?z=S.indexValue:S=null),S&&(z=S.indexValue))}z!==null&&d.setCursor(z)},d.loadFirst=function(){if(d.results)var z=d.results;else var z=d.items;var X=z.length||0;d.options.lazyLoading==!0&&X>200&&(X=200),ce.textContent="";for(var S=0;S<X;S++)z[S].group?(z[S].group.parentNode||ce.appendChild(z[S].group),z[S].group.lastChild.appendChild(z[S].element)):ce.appendChild(z[S].element);ce.scrollTop=0},d.loadLast=function(){if(d.results)var z=d.results;else var z=d.items;var X=z.length;if(X>200){X=X-200,ce.textContent="";for(var S=X;S<z.length;S++)z[S].group?(z[S].group.parentNode||ce.appendChild(z[S].group),z[S].group.lastChild.appendChild(z[S].element)):ce.appendChild(z[S].element);ce.scrollTop=ce.scrollHeight}},d.loadUp=function(){var z=!1;if(d.results)var X=d.results;else var X=d.items;var S=ce.querySelectorAll(".jdropdown-item"),R=S[0].indexValue;R=d.items[R];var Y=X.indexOf(R)-1;if(Y>0){for(var de=0;Y>0&&X[Y]&&de<200;)X[Y].group?(X[Y].group.parentNode||ce.insertBefore(X[Y].group,ce.firstChild),X[Y].group.lastChild.insertBefore(X[Y].element,X[Y].group.lastChild.firstChild)):ce.insertBefore(X[Y].element,ce.firstChild),Y--,de++;z=!0}return z},d.loadDown=function(){var z=!1;if(d.results)var X=d.results;else var X=d.items;var S=ce.querySelectorAll(".jdropdown-item"),R=S[S.length-1].indexValue;R=d.items[R];var Y=X.indexOf(R)+1;if(Y<X.length){for(var de=0;Y<X.length&&X[Y]&&de<200;)X[Y].group?(X[Y].group.parentNode||ce.appendChild(X[Y].group),X[Y].group.lastChild.appendChild(X[Y].element)):ce.appendChild(X[Y].element),Y++,de++;z=!0}return z},lt(),d};return E.keydown=function(T){var m=null;if(m=E.current){if(T.which==13||T.which==9)m.header.value&&m.currentIndex==null&&m.options.newOptions?m.add():(m.currentIndex==null&&m.options.autocomplete==!0&&m.header.value!=""&&m.find(m.header.value),m.selectIndex(m.currentIndex));else if(T.which==38)m.currentIndex==null?m.first():m.currentIndex>0&&m.prev(),T.preventDefault();else if(T.which==40)m.currentIndex==null?m.first():m.currentIndex+1<m.items.length&&m.next(),T.preventDefault();else if(T.which==36)m.first(),T.target.classList.contains("jdropdown-header")||T.preventDefault();else if(T.which==35)m.last(),T.target.classList.contains("jdropdown-header")||T.preventDefault();else if(T.which==27)m.close();else if(T.which==33){if(m.currentIndex==null)m.first();else if(m.currentIndex>0)for(var d=0;d<7;d++)m.prev();T.preventDefault()}else if(T.which==34){if(m.currentIndex==null)m.first();else if(m.currentIndex+1<m.items.length)for(var d=0;d<7;d++)m.next();T.preventDefault()}}},E.mouseup=function(T){var m=I.findElement(T.target,"jdropdown");if(m){var d=m.dropdown;if(T.target.classList.contains("jdropdown-header"))if(m.classList.contains("jdropdown-focus")&&m.classList.contains("jdropdown-default")){var B=m.getBoundingClientRect();if(T.changedTouches&&T.changedTouches[0])var J=T.changedTouches[0].clientX,ee=T.changedTouches[0].clientY;else var J=T.clientX,ee=T.clientY;B.width-(J-B.left)<30?T.target.classList.contains("jdropdown-add")?d.add():d.close():d.options.autocomplete==!1&&d.close()}else d.open();else if(T.target.classList.contains("jdropdown-group-name")){var k=T.target.nextSibling.children;if(T.target.nextSibling.style.display!="none")for(var L=0;L<k.length;L++)k[L].style.display!="none"&&d.selectItem(k[L])}else T.target.classList.contains("jdropdown-group-arrow")?T.target.classList.contains("jdropdown-group-arrow-down")?(T.target.classList.remove("jdropdown-group-arrow-down"),T.target.classList.add("jdropdown-group-arrow-up"),T.target.parentNode.nextSibling.style.display="none"):(T.target.classList.remove("jdropdown-group-arrow-up"),T.target.classList.add("jdropdown-group-arrow-down"),T.target.parentNode.nextSibling.style.display=""):T.target.classList.contains("jdropdown-item")?d.selectItem(T.target):T.target.classList.contains("jdropdown-image")||T.target.classList.contains("jdropdown-description")?d.selectItem(T.target.parentNode):T.target.classList.contains("jdropdown-title")?d.selectItem(T.target.parentNode.parentNode):(T.target.classList.contains("jdropdown-close")||T.target.classList.contains("jdropdown-backdrop"))&&d.close()}},E.extractFromDom=function(T,m){var d=T;if(m||(m={}),T.getAttribute("multiple")&&(!m||m.multiple==null)&&(m.multiple=!0),T.getAttribute("placeholder")&&(!m||m.placeholder==null)&&(m.placeholder=T.getAttribute("placeholder")),T.getAttribute("data-autocomplete")&&(!m||m.autocomplete==null)&&(m.autocomplete=!0),(!m||m.width==null)&&(m.width=T.offsetWidth),T.value&&(!m||m.value==null)&&(m.value=T.value),!m||m.data==null){m.data=[];for(var B=0;B<T.children.length;B++)if(T.children[B].tagName=="OPTGROUP")for(var J=0;J<T.children[B].children.length;J++)m.data.push({value:T.children[B].children[J].value,text:T.children[B].children[J].textContent,group:T.children[B].getAttribute("label")});else m.data.push({value:T.children[B].value,text:T.children[B].textContent})}(!m||m.onchange==null)&&(m.onchange=function(k,L,H,G){m.multiple==!0?obj.items[L].classList.contains("jdropdown-selected")?d.options[L].setAttribute("selected","selected"):d.options[L].removeAttribute("selected"):d.value=G});var ee=document.createElement("div");return T.parentNode.insertBefore(ee,T),T.style.display="none",T=ee,{el:T,options:m}},E}var ie=be();function ze(E,T){if(E.picker)return E.picker.setOptions(T,!0);var m={type:"picker"};m.options={};var d=null,B=null,J=function(L){return L instanceof Element||L instanceof HTMLDocument},ee=function(){B.innerHTML="";for(var L=Object.keys(m.options.data),H=0;H<L.length;H++){var G=document.createElement("div");G.classList.add("jpicker-item"),G.setAttribute("role","option"),G.k=L[H],G.v=m.options.data[L[H]];var oe=m.getLabel(L[H],G);J(oe)?G.appendChild(oe):G.innerHTML=oe,B.appendChild(G)}};m.setOptions=function(L,H){var G={value:0,data:null,render:null,onchange:null,onmouseover:null,onselect:null,onopen:null,onclose:null,onload:null,width:null,header:!0,right:!1,bottom:!1,content:!1,columns:null,grid:null,height:null};L&&L.options&&(L.data=L.options);for(var oe in G)L&&L.hasOwnProperty(oe)?m.options[oe]=L[oe]:(typeof m.options[oe]>"u"||H===!0)&&(m.options[oe]=G[oe]);return m.options.header===!1?d.style.display="none":d.style.display="",m.options.width?d.style.width=parseInt(m.options.width)+"px":d.style.width="",m.options.height?(B.style.maxHeight=m.options.height+"px",B.style.overflow="scroll"):B.style.overflow="",m.options.columns>0&&(m.options.grid?(B.classList.add("jpicker-grid"),B.style.gridTemplateColumns="repeat("+m.options.grid+", 1fr)"):(B.classList.add("jpicker-columns"),B.style.width=m.options.width?m.options.width:36*m.options.columns+"px")),isNaN(parseInt(m.options.value))&&(m.options.value=0),ee(),m.setValue(m.options.value),m},m.getValue=function(){return m.options.value},m.setValue=function(L,H){if(m.setLabel(L),m.options.value=String(L),E.value!=m.options.value&&(E.value=m.options.value,typeof E.oninput=="function"&&E.oninput({type:"input",target:E,value:E.value})),B.children[L]&&B.children[L].getAttribute("type")!=="generic"&&m.close(),H&&typeof m.options.onchange=="function"){var G=m.options.data[L];m.options.onchange(E,m,G,G,L,H)}},m.getLabel=function(L,H){var G=m.options.data[L]||null;return typeof m.options.render=="function"&&(G=m.options.render(G,H)),G},m.setLabel=function(L){var H;m.options.content?H='<i class="material-icons">'+m.options.content+"</i>":H=m.getLabel(L,null),J(H)?(d.innerHTML="",d.appendChild(H)):d.innerHTML=H},m.open=function(){if(!E.classList.contains("jpicker-focus")){g(m,!0),E.classList.add("jpicker-focus"),E.focus();var L=0,H=0;B.style.marginLeft="";var G=d.getBoundingClientRect(),oe=B.getBoundingClientRect();window.innerHeight<G.bottom+oe.height||m.options.bottom?L=-1*(oe.height+4):L=G.height+4,m.options.right===!0&&(H=-1*oe.width+G.width),oe.left+H<0&&(H=H+oe.left+10),oe.left+oe.width>window.innerWidth&&(H=-1*(10+oe.left+oe.width-window.innerWidth)),B.style.marginTop=parseInt(L)+"px",B.style.marginLeft=parseInt(H)+"px",typeof m.options.onopen=="function"&&m.options.onopen(E,m)}},m.close=function(){E.classList.contains("jpicker-focus")&&(E.classList.remove("jpicker-focus"),g(m,!1),typeof m.options.onclose=="function"&&m.options.onclose(E,m))};var k=function(){let L=I.guid();E.classList.add("jpicker"),E.setAttribute("role","combobox"),E.setAttribute("aria-haspopup","listbox"),E.setAttribute("aria-expanded","false"),E.setAttribute("aria-controls",L),E.setAttribute("tabindex","0"),E.onmousedown=function(H){E.classList.contains("jpicker-focus")||m.open()},d=document.createElement("div"),d.classList.add("jpicker-header"),B=document.createElement("div"),B.setAttribute("id",L),B.setAttribute("role","listbox"),B.classList.add("jpicker-content"),B.onclick=function(H){var G=I.findElement(H.target,"jpicker-item");G&&G.parentNode===B&&m.setValue(G.k,H)},E.appendChild(d),E.appendChild(B),E.value=T.value||0,m.setOptions(T),typeof m.options.onload=="function"&&m.options.onload(E,m),E.change=m.setValue,E.val=function(H){if(H===void 0)return m.getValue();m.setValue(H)},E.picker=m};return k(),m}function Je(E,T){var m={type:"toolbar"};m.options={};var d={app:null,container:!1,badge:!1,title:!1,responsive:!1,maxWidth:null,bottom:!0,items:[]};for(var B in d)T&&T.hasOwnProperty(B)?m.options[B]=T[B]:m.options[B]=d[B];!E&&T.app&&T.app.el&&(E=document.createElement("div"),T.app.el.appendChild(E));var J=document.createElement("div");J.classList.add("jtoolbar-item"),J.classList.add("jtoolbar-arrow");var ee=document.createElement("div");ee.classList.add("jtoolbar-floating"),J.appendChild(ee),m.selectItem=function(L){for(var H=k.children,G=0;G<H.length;G++)L!=H[G]&&H[G].classList.remove("jtoolbar-selected");L.classList.add("jtoolbar-selected")},m.hide=function(){A.slideBottom(E,0,function(){E.style.display="none"})},m.show=function(){E.style.display="",A.slideBottom(E,1)},m.get=function(){return E},m.setBadge=function(L,H){k.children[L].children[1].firstChild.innerHTML=H},m.destroy=function(){toolbar.remove(),E.innerHTML=""},m.update=function(L,H){for(var G=0;G<k.children.length;G++){var oe=k.children[G];typeof oe.updateState=="function"&&oe.updateState(E,m,oe,L,H)}for(var G=0;G<ee.children.length;G++){var oe=ee.children[G];typeof oe.updateState=="function"&&oe.updateState(E,m,oe,L,H)}},m.create=function(L){k.innerHTML="";for(var H=0;H<L.length;H++){var G=document.createElement("div");if(G.classList.add("jtoolbar-item"),L[H].width&&(G.style.width=parseInt(L[H].width)+"px"),L[H].k&&(G.k=L[H].k),L[H].tooltip&&(G.setAttribute("title",L[H].tooltip),G.setAttribute("aria-label",L[H].tooltip)),L[H].id&&G.setAttribute("id",L[H].id),L[H].updateState&&(G.updateState=L[H].updateState),L[H].active&&G.classList.add("jtoolbar-active"),L[H].disabled&&G.classList.add("jtoolbar-disabled"),L[H].type=="select"||L[H].type=="dropdown")ze(G,L[H]);else if(L[H].type=="divisor")G.classList.add("jtoolbar-divisor");else if(L[H].type=="label")G.classList.add("jtoolbar-label"),G.innerHTML=L[H].content;else{var oe=document.createElement("i");if(typeof L[H].class>"u")oe.classList.add("material-icons");else for(var me=L[H].class.split(" "),le=0;le<me.length;le++)oe.classList.add(me[le]);if(oe.innerHTML=L[H].content?L[H].content:"",G.setAttribute("role","button"),G.appendChild(oe),m.options.badge==!0){var ce=document.createElement("div");ce.classList.add("jbadge");var Te=document.createElement("div");Te.innerHTML=L[H].badge?L[H].badge:"",ce.appendChild(Te),G.appendChild(ce)}if(L[H].title)if(m.options.title==!0){var Ie=document.createElement("span");Ie.innerHTML=L[H].title,G.appendChild(Ie)}else G.setAttribute("title",L[H].title);m.options.app&&L[H].route&&(G.route=L[H].route,G.onclick=function(){m.options.app.pages(this.route)},m.options.app.pages(L[H].route,{toolbarItem:G,closed:!0})),typeof L[H].render=="function"&&L[H].render(G,L[H])}L[H].onclick&&(G.onclick=L[H].onclick.bind(L[H],E,m,G)),k.appendChild(G)}setTimeout(function(){m.refresh()},0)},m.open=function(){J.classList.add("jtoolbar-arrow-selected");var L=E.getBoundingClientRect(),H=ee.getBoundingClientRect();H.bottom>window.innerHeight||m.options.bottom?ee.style.bottom="0":ee.style.removeProperty("bottom"),ee.style.right="0",J.children[0].focus(),g(m,!0)},m.close=function(){J.classList.remove("jtoolbar-arrow-selected"),g(m,!1)},m.refresh=function(){if(m.options.responsive==!0){var L=E.parentNode.getBoundingClientRect();m.options.maxWidth||(m.options.maxWidth=L.width);var H=parseInt(m.options.maxWidth);for(J.parentNode&&J.parentNode.removeChild(J);ee.firstChild;)k.appendChild(ee.firstChild);if(H<k.offsetWidth)for(H-=50;k.lastChild&&H<k.offsetWidth;)ee.insertBefore(k.lastChild,ee.firstChild);ee.children.length>0&&k.appendChild(J)}},m.setReadonly=function(L){L=L?"add":"remove",E.classList[L]("jtoolbar-disabled")},E.onclick=function(L){var H=I.findElement(L.target,"jtoolbar-item");H&&m.selectItem(H),L.target.classList.contains("jtoolbar-arrow")&&m.open()},window.addEventListener("resize",function(){m.refresh()}),E.classList.add("jtoolbar"),E.innerHTML="",m.options.container==!0&&E.classList.add("jtoolbar-container");var k=document.createElement("div");return E.appendChild(k),m.options.app&&E.classList.add("jtoolbar-mobile"),m.create(m.options.items),E.toolbar=m,m}function We(){var E=function(T,m){var d={type:"editor"};d.options={};var B={url:null,value:"",snippet:null,toolbar:!0,toolbarOnTop:!1,remoteParser:null,placeholder:null,filterPaste:!0,dropZone:!0,dropAsSnippet:!1,acceptImages:!0,acceptFiles:!1,maxFileSize:5e6,allowImageResize:!0,maxHeight:null,height:null,focus:!1,onclick:null,onfocus:null,onblur:null,onload:null,onkeyup:null,onkeydown:null,onchange:null,extensions:null,type:null};for(var J in B)m&&m.hasOwnProperty(J)?d.options[J]=m[J]:d.options[J]=B[J];var ee=null,k=null,L=[];d.el=T,typeof d.options.onclick=="function"&&(T.onclick=function(te){d.options.onclick(T,d,te)}),T.classList.add("jeditor-container");var H=document.createElement("div");H.className="jsnippet",H.setAttribute("contenteditable",!1);var G=document.createElement("div");if(G.className="jeditor-toolbar",d.editor=document.createElement("div"),d.editor.setAttribute("contenteditable",!0),d.editor.setAttribute("spellcheck",!1),d.editor.classList.add("jeditor"),d.options.placeholder&&d.editor.setAttribute("data-placeholder",d.options.placeholder),(d.options.maxHeight||d.options.height)&&(d.editor.style.overflowY="auto",d.options.maxHeight&&(d.editor.style.maxHeight=d.options.maxHeight),d.options.height&&(d.editor.style.height=d.options.height)),d.options.url)b({url:d.options.url,dataType:"html",success:function(te){d.editor.innerHTML=te,E.setCursor(d.editor,d.options.focus=="initial")}});else if(d.options.value)d.editor.innerHTML=d.options.value;else for(var oe=0;oe<T.children.length;oe++)d.editor.appendChild(T.children[oe]);T.innerHTML="";var me=function(te){typeof d.options.onchange=="function"&&d.options.onchange(T,d,te),d.options.value=d.getData(),T.value!=d.options.value&&(T.value=d.options.value,typeof T.oninput=="function"&&T.oninput({type:"input",target:T,value:T.value}))},le=function(te){var ge=document.createElement("div");ge.innerHTML=te;var Ee=ge.querySelectorAll("img");if(Ee.length)for(var Fe=0;Fe<Ee.length;Fe++)d.addImage(Ee[Fe].src)},ce=function(te){var ge,Ee;if(window.getSelection&&(ge=window.getSelection(),ge.rangeCount)){Ee=ge.getRangeAt(0);var Fe=Ee.toString();Ee.deleteContents(),Ee.insertNode(te),Ee.setStartAfter(te),Ee.setEndAfter(te),ge.removeAllRanges(),ge.addRange(Ee)}},Te=function(){var te=null;if(te=H.children[0]){te.classList.contains("jslider-grid")||te.classList.add("jslider-grid");var ge=te.children.length;te.setAttribute("data-number",ge>4?4:ge),ge>4?te.setAttribute("data-total",ge-4):te.removeAttribute("data-total")}},Ie=function(te){H.innerHTML||d.appendSnippet({}),H.children[0].appendChild(te),Te()};d.appendSnippet=function(te){H.innerHTML="";for(var ge=["image","title","description","host","url"],Ee=0;Ee<ge.length;Ee++){var Fe=document.createElement("div");if(Fe.className="jsnippet-"+ge[Ee],Fe.setAttribute("data-k",ge[Ee]),H.appendChild(Fe),te[ge[Ee]])if(ge[Ee]=="image"){Array.isArray(te.image)||(te.image=[te.image]);for(var dt=0;dt<te.image.length;dt++){var Xe=document.createElement("img");Xe.src=te.image[dt],Fe.appendChild(Xe)}}else Fe.innerHTML=te[ge[Ee]]}d.editor.appendChild(document.createElement("br")),d.editor.appendChild(H)},d.setData=function(te){typeof te=="object"?d.editor.innerHTML=te.content:d.editor.innerHTML=te,d.options.focus&&E.setCursor(d.editor,!0),L=[]},d.getFiles=function(){for(var te=d.editor.querySelectorAll(".jfile"),ge=[],Ee=0;Ee<te.length;Ee++)L[te[Ee].src]&&ge.push(L[te[Ee].src]);return ge},d.getText=function(){return d.editor.innerText},d.getData=function(te){if(te){var ge={content:""};if(H.innerHTML){var Ee=0;ge.snippet={};for(var Fe=0;Fe<H.children.length;Fe++){var dt=H.children[Fe].getAttribute("data-k");if(dt)if(dt=="image"){ge.snippet.image||(ge.snippet.image=[]);for(var Xe=0;Xe<H.children[Fe].children.length;Xe++)ge.snippet.image.push(H.children[Fe].children[Xe].getAttribute("src"))}else ge.snippet[dt]=H.children[Fe].innerHTML}}var Ct=Object.keys(L);if(Ct.length){ge.files=[];for(var Fe=0;Fe<Ct.length;Fe++)ge.files.push(L[Ct[Fe]])}var Nt=document.createElement("div");Nt.innerHTML=d.editor.innerHTML;var Qe=Nt.querySelector(".jsnippet");Qe&&Qe.remove();var Ue=Nt.innerHTML;Ue=Ue.replace(/<br>/g,`
`),Ue=Ue.replace(/<\/div>/g,`</div>
`),Ue=Ue.replace(/<(?:.|\n)*?>/gm,""),ge.content=Ue.trim(),ke("getData",ge)}else var ge=d.editor.innerHTML;return ge},d.reset=function(){d.editor.innerHTML="",H.innerHTML="",L=[]},d.addPdf=function(te){if(te.result.substr(0,4)!="data")console.error("Invalid source");else{var ge=document.createElement("canvas");ge.width=60,ge.height=60;var Ee=new Image,Fe=ge.getContext("2d");Fe.drawImage(Ee,0,0,ge.width,ge.height),ge.toBlob(function(dt){var Xe=document.createElement("img");Xe.src=window.URL.createObjectURL(dt),Xe.title=te.name,Xe.className="jfile pdf",L[Xe.src]={file:Xe.src,extension:"pdf",content:te.result},document.execCommand("insertHtml",!1,Xe.outerHTML)})}},d.addImage=function(te,ge){if(d.options.acceptImages)if(te||(te=""),te.substr(0,4)!="data"&&!d.options.remoteParser)console.error("remoteParser not defined in your initialization");else{if(te.substr(0,4)=="data"){var Ee=te.split(";");Ee=Ee[0].split("/"),Ee=Ee[1]}else{var Ee=te.substr(te.lastIndexOf(".")+1);te=d.options.remoteParser+te}var Fe=new Image;Fe.onload=function(){var Xe=document.createElement("canvas");Xe.width=Fe.width,Xe.height=Fe.height;var Ct=Xe.getContext("2d");Ct.drawImage(Fe,0,0,Xe.width,Xe.height),Xe.toBlob(function(Nt){var Qe=document.createElement("img");Qe.src=window.URL.createObjectURL(Nt),Qe.classList.add("jfile"),Qe.setAttribute("tabindex","900"),Qe.setAttribute("width",Fe.width),Qe.setAttribute("height",Fe.height),L[Qe.src]={file:Qe.src,extension:Ee,content:Xe.toDataURL()},d.options.dropAsSnippet||ge?(Ie(Qe),L[Qe.src].snippet=!0):document.execCommand("insertHtml",!1,Qe.outerHTML),me()})},Fe.src=te}},d.addFile=function(te){for(var ge=[],Ee=0;Ee<te.length;Ee++)if(te[Ee].size>d.options.maxFileSize)alert("The file is too big");else{var Fe=te[Ee].type.split("/");Fe[0]=="image"?Fe=1:Fe[1]=="pdf"?Fe=2:Fe=0,Fe?(ge[Ee]=new FileReader,ge[Ee].index=Ee,ge[Ee].type=Fe,ge[Ee].name=te[Ee].name,ge[Ee].date=te[Ee].lastModified,ge[Ee].size=te[Ee].size,ge[Ee].addEventListener("load",function(dt){dt.target.type==2?d.options.acceptFiles==!0&&d.addPdf(dt.target):d.addImage(dt.target.result)},!1),ge[Ee].readAsDataURL(te[Ee])):alert("The extension is not allowed")}},d.destroy=function(){d.editor.removeEventListener("mouseup",Ce),d.editor.removeEventListener("mousedown",De),d.editor.removeEventListener("mousemove",xe),d.editor.removeEventListener("keyup",Q),d.editor.removeEventListener("keydown",ve),d.editor.removeEventListener("dragstart",X),d.editor.removeEventListener("dragenter",S),d.editor.removeEventListener("dragover",R),d.editor.removeEventListener("drop",Y),d.editor.removeEventListener("paste",z),d.editor.removeEventListener("blur",de),d.editor.removeEventListener("focus",ne),T.editor=null,T.classList.remove("jeditor-container"),G.remove(),H.remove(),d.editor.remove()},d.upload=function(){I.click(d.file)};let Ne=["html","body","address","span","div","h1","h2","h3","h4","h5","h6","p","b","i","blockquote","strong","em","ul","ol","li","a","code","pre","hr","br","img","figure","picture","figcaption","iframe","table","thead","tbody","tfoot","tr","th","td","caption","u","del","ins","sub","sup","small","mark","input","textarea","select","option","button","label","fieldset","legend","audio","video","abbr","cite","kbd","section","article","nav","aside","header","footer","main","details","summary","svg","line","source"],Ge=["width","height","align","border","src","tabindex"],lt=["color","font-weight","font-size","background","background-color","margin"],pe=function(te){if(te.tagName&&Ne.indexOf(te.tagName.toLowerCase())===-1&&te.innerText&&(te.innerHTML=te.innerText),te.attributes&&te.attributes.length){let ge=null,Ee=te.getAttribute("style");if(Ee){ge=[];let dt=Ee.split(";");for(let Xe=0;Xe<dt.length;Xe++){let Ct=dt[Xe].trim().split(":");if(lt.indexOf(Ct[0].trim())>=0){let Nt=Ct.shift();Ct=Ct.join(":"),ge.push(Nt+":"+Ct)}}}te.tagName.toUpperCase()==="IMG"&&(!d.options.acceptImages||!te.src?te.parentNode.removeChild(te):(te.setAttribute("tabindex","900"),d.addImage(te.src)));let Fe=[];for(let dt=0;dt<te.attributes.length;dt++)Fe.push(te.attributes[dt].name);Fe.length&&Fe.forEach(function(dt){Ge.indexOf(dt)===-1?te.removeAttribute(dt):te.attributes&&te.attributes[oe]&&te.attributes[oe].value.indexOf("<")!==-1&&te.attributes[oe].value.replace("<","&#60;")}),te.style="",ge&&ge.length&&te.setAttribute("style",ge.join(";"))}if(te.children.length)for(let ge=te.children.length;ge>0;ge--)pe(te.children[ge-1])};var ue=function(te){var ge=window.getSelection(),Ee=document.createRange();Ee.selectNode(te),ge.addRange(Ee)},ye=function(te){te&&(te=te.replace(new RegExp("<!--(.*?)-->","gsi"),""));var ge=new DOMParser,Ee=ge.parseFromString(te,"text/html");pe(Ee);var Fe=document.createElement("div");return Fe.innerHTML=Ee.firstChild.innerHTML,Fe},z=function(te){if(d.options.filterPaste==!0){if(te.clipboardData||te.originalEvent.clipboardData)var ge=(te.originalEvent||te).clipboardData.getData("text/html"),Ee=(te.originalEvent||te).clipboardData.getData("text/plain"),Fe=(te.originalEvent||te).clipboardData.files;else if(window.clipboardData)var ge=window.clipboardData.getData("Html"),Ee=window.clipboardData.getData("Text"),Fe=window.clipboardData.files;if(Fe.length)d.addFile(Fe);else if(!ge)ge=Ee.split(`\r
`),te.target.innerText?(ge=ge.map(function(Xe){return"<div>"+Xe+"</div>"}),document.execCommand("insertText",!1,ge.join(""))):ge.map(function(Xe){var Ct=document.createElement("div");Ct.innerText=Xe,d.editor.appendChild(Ct)});else{var dt=ye(ge);document.execCommand("insertHtml",!1,dt.innerHTML)}te.preventDefault()}},X=function(te){k&&k.e&&te.preventDefault()},S=function(te){k||d.options.dropZone==!1||(T.classList.add("jeditor-dragging"),te.preventDefault())},R=function(te){k||d.options.dropZone==!1||(ee&&clearTimeout(ee),ee=setTimeout(function(){T.classList.remove("jeditor-dragging")},100),te.preventDefault())},Y=function(te){if(!(k||d.options.dropZone==!1)){var ge=null;document.caretRangeFromPoint?ge=document.caretRangeFromPoint(te.clientX,te.clientY):te.rangeParent&&(ge=document.createRange(),ge.setStart(te.rangeParent,te.rangeOffset));var Ee=window.getSelection();Ee.removeAllRanges(),Ee.addRange(ge),Ee.anchorNode.parentNode.focus();var Fe=(te.originalEvent||te).dataTransfer.getData("text/html"),dt=(te.originalEvent||te).dataTransfer.getData("text/plain"),Xe=(te.originalEvent||te).dataTransfer.files;Xe.length?d.addFile(Xe):dt&&le(Fe),T.classList.remove("jeditor-dragging"),te.preventDefault()}},de=function(te){ke("onevent",te),me(te),typeof d.options.onblur=="function"&&d.options.onblur(T,d,te)},ne=function(te){typeof d.options.onfocus=="function"&&d.options.onfocus(T,d,te)},Q=function(te){d.editor.innerHTML||(d.editor.innerHTML="<div><br></div>"),typeof d.options.onkeyup=="function"&&d.options.onkeyup(T,d,te)},ve=function(te){if(ke("onevent",te),te.key=="Delete"&&te.target.tagName=="IMG"){var ge=te.target.parentNode;ue(te.target),ge.classList.contains("jsnippet-image")&&Te()}typeof d.options.onkeydown=="function"&&d.options.onkeydown(T,d,te)},Ce=function(te){if(k&&k.e&&(k.e.classList.remove("resizing"),k.e.changed==!0)){var ge=k.e.cloneNode();ge.width=parseInt(k.e.style.width)||k.e.getAttribute("width"),ge.height=parseInt(k.e.style.height)||k.e.getAttribute("height"),k.e.style.width="",k.e.style.height="",ue(k.e),document.execCommand("insertHtml",!1,ge.outerHTML)}k=!1},De=function(te){var ge=function(Xe){var Ct=Xe.getBoundingClientRect();Ct.width-(te.clientX-Ct.left)<40&&te.clientY-Ct.top<40&&(Xe.innerHTML="",Xe.remove())};if(te.target.tagName=="IMG")if(te.target.style.cursor){var Ee=te.target.getBoundingClientRect();k={e:te.target,x:te.clientX,y:te.clientY,w:Ee.width,h:Ee.height,d:te.target.style.cursor},te.target.getAttribute("width")||te.target.setAttribute("width",Ee.width),te.target.getAttribute("height")||te.target.setAttribute("height",Ee.height);var Fe=window.getSelection();if(Fe.rangeCount)for(var dt=0;dt<Fe.rangeCount;dt++)Fe.removeRange(Fe.getRangeAt(dt));te.target.classList.add("resizing")}else k=!0;else te.target.classList.contains("jsnippet")?ge(te.target):te.target.parentNode.classList.contains("jsnippet")&&ge(te.target.parentNode),k=!0},xe=function(te){if(te.target.tagName=="IMG"&&!te.target.parentNode.classList.contains("jsnippet-image")&&d.options.allowImageResize==!0&&te.target.getAttribute("tabindex")){var ge=te.target.getBoundingClientRect();te.clientY-ge.top<5?ge.width-(te.clientX-ge.left)<5?te.target.style.cursor="ne-resize":te.clientX-ge.left<5?te.target.style.cursor="nw-resize":te.target.style.cursor="n-resize":ge.height-(te.clientY-ge.top)<5?ge.width-(te.clientX-ge.left)<5?te.target.style.cursor="se-resize":te.clientX-ge.left<5?te.target.style.cursor="sw-resize":te.target.style.cursor="s-resize":ge.width-(te.clientX-ge.left)<5?te.target.style.cursor="e-resize":te.clientX-ge.left<5?te.target.style.cursor="w-resize":te.target.style.cursor=""}if(te.which==1&&k&&k.d){if(k.d=="e-resize"||k.d=="ne-resize"||k.d=="se-resize")if(k.e.style.width=k.w+(te.clientX-k.x),te.shiftKey){var Ee=(te.clientX-k.x)*(k.h/k.w);k.e.style.height=k.h+Ee}else var Ee=null;Ee||(k.d=="s-resize"||k.d=="se-resize"||k.d=="sw-resize")&&(te.shiftKey||(k.e.style.height=k.h+(te.clientY-k.y))),k.e.changed=!0}},ke=function(te,ge){if(d.options.extensions){var Ee=Object.keys(d.options.extensions);if(Ee.length)for(var Fe=0;Fe<Ee.length;Fe++)d.options.extensions[Ee[Fe]]&&typeof d.options.extensions[Ee[Fe]][te]=="function"&&d.options.extensions[Ee[Fe]][te].call(d,ge)}},qe=function(){if(d.options.extensions){var te=Object.keys(d.options.extensions);if(te.length)for(var ge=0;ge<te.length;ge++)d.options.extensions[te[ge]]&&typeof d.options.extensions[te[ge]]=="function"&&(d.options.extensions[te[ge]]=d.options.extensions[te[ge]](T,d))}};if(document.addEventListener("mouseup",Ce),document.addEventListener("mousemove",xe),d.editor.addEventListener("mousedown",De),d.editor.addEventListener("keyup",Q),d.editor.addEventListener("keydown",ve),d.editor.addEventListener("dragstart",X),d.editor.addEventListener("dragenter",S),d.editor.addEventListener("dragover",R),d.editor.addEventListener("drop",Y),d.editor.addEventListener("paste",z),d.editor.addEventListener("focus",ne),d.editor.addEventListener("blur",de),T.appendChild(d.editor),d.options.snippet&&d.appendSnippet(d.options.snippet),d.options.toolbar){if(Array.isArray(d.options.toolbar))var ct={container:!0,responsive:!0,items:d.options.toolbar};else if(d.options.toolbar===!0)var ct={container:!0,responsive:!0,items:[]};else var ct=d.options.toolbar;ct.items&&ct.items.length||(ct.items=E.getDefaultToolbar(d)),d.options.toolbarOnTop?(T.classList.add("toolbar-on-top"),T.insertBefore(G,T.firstChild)):(d.editor.style.padding="15px",T.appendChild(G)),Je(G,ct),G.addEventListener("click",function(){d.editor.focus()})}return d.file=document.createElement("input"),d.file.style.display="none",d.file.type="file",d.file.setAttribute("accept","image/*"),d.file.onchange=function(){d.addFile(this.files)},T.appendChild(d.file),d.options.focus&&E.setCursor(d.editor,d.options.focus=="initial"),T.change=d.setData,T.val=function(te){if(te===void 0){var ge=T.getAttribute("data-html")!=="true";return d.getData(ge)}else d.setData(te)},qe(),T.editor=d,typeof d.options.onload=="function"&&d.options.onload(T,d,d.editor),d};return E.setCursor=function(T,m){T.focus(),document.execCommand("selectAll");var d=window.getSelection(),B=d.getRangeAt(0);if(m==!0)var J=B.startContainer,ee=0;else var J=B.endContainer,ee=J.length;B.setStart(J,ee),B.setEnd(J,ee),d.removeAllRanges(),d.addRange(B)},E.getDefaultToolbar=function(T){var m=function(B,J,ee){if(!ee.color){var k=null,L=ae(ee,{onchange:function(H,G){ee.k==="color"?document.execCommand("foreColor",!1,G):document.execCommand("backColor",!1,G)}});ee.color.open()}},d=[];return d.push({content:"undo",onclick:function(){document.execCommand("undo")}}),d.push({content:"redo",onclick:function(){document.execCommand("redo")}}),d.push({type:"divisor"}),T.options.toolbarOnTop&&(d.push({type:"select",width:"140px",options:["Default","Verdana","Arial","Courier New"],render:function(B){return'<span style="font-family:'+B+'">'+B+"</span>"},onchange:function(B,J,ee,k,L){document.execCommand("fontName",!1,k)}}),d.push({type:"select",content:"format_size",options:["x-small","small","medium","large","x-large"],render:function(B){return'<span style="font-size:'+B+'">'+B+"</span>"},onchange:function(B,J,ee,k,L){document.execCommand("fontSize",!1,parseInt(L)+1)}}),d.push({type:"select",options:["format_align_left","format_align_center","format_align_right","format_align_justify"],render:function(B){return'<i class="material-icons">'+B+"</i>"},onchange:function(B,J,ee,k,L){var H=["JustifyLeft","justifyCenter","justifyRight","justifyFull"];document.execCommand(H[L])}}),d.push({type:"divisor"}),d.push({content:"format_color_text",k:"color",onclick:m}),d.push({content:"format_color_fill",k:"background-color",onclick:m})),d.push({content:"format_bold",onclick:function(B,J,ee){document.execCommand("bold"),document.queryCommandState("bold")?ee.classList.add("selected"):ee.classList.remove("selected")}}),d.push({content:"format_italic",onclick:function(B,J,ee){document.execCommand("italic"),document.queryCommandState("italic")?ee.classList.add("selected"):ee.classList.remove("selected")}}),d.push({content:"format_underline",onclick:function(B,J,ee){document.execCommand("underline"),document.queryCommandState("underline")?ee.classList.add("selected"):ee.classList.remove("selected")}}),d.push({type:"divisor"}),d.push({content:"format_list_bulleted",onclick:function(B,J,ee){document.execCommand("insertUnorderedList"),document.queryCommandState("insertUnorderedList")?ee.classList.add("selected"):ee.classList.remove("selected")}}),d.push({content:"format_list_numbered",onclick:function(B,J,ee){document.execCommand("insertOrderedList"),document.queryCommandState("insertOrderedList")?ee.classList.add("selected"):ee.classList.remove("selected")}}),d.push({content:"format_indent_increase",onclick:function(B,J,ee){document.execCommand("indent",!0,null),document.queryCommandState("indent")?ee.classList.add("selected"):ee.classList.remove("selected")}}),d.push({content:"format_indent_decrease",onclick:function(){document.execCommand("outdent"),document.queryCommandState("outdent")?this.classList.add("selected"):this.classList.remove("selected")}}),T.options.toolbarOnTop&&(d.push({type:"divisor"}),d.push({content:"photo",onclick:function(){T.upload()}}),d.push({type:"select",content:"table_view",columns:8,grid:8,right:!0,options:["0x0","1x0","2x0","3x0","4x0","5x0","6x0","7x0","0x1","1x1","2x1","3x1","4x1","5x1","6x1","7x1","0x2","1x2","2x2","3x2","4x2","5x2","6x2","7x2","0x3","1x3","2x3","3x3","4x3","5x3","6x3","7x3","0x4","1x4","2x4","3x4","4x4","5x4","6x4","7x4","0x5","1x5","2x5","3x5","4x5","5x5","6x5","7x5","0x6","1x6","2x6","3x6","4x6","5x6","6x6","7x6","0x7","1x7","2x7","3x7","4x7","5x7","6x7","7x7"],render:function(B,J){J&&(J.onmouseover=this.onmouseover,B=B.split("x"),J.setAttribute("data-x",B[0]),J.setAttribute("data-y",B[1]));var ee=document.createElement("div");return J.style.margin="1px",J.style.border="1px solid #ddd",ee},onmouseover:function(B){for(var J=parseInt(B.target.getAttribute("data-x")),ee=parseInt(B.target.getAttribute("data-y")),k=0;k<B.target.parentNode.children.length;k++){var L=B.target.parentNode.children[k],H=parseInt(L.getAttribute("data-x")),G=parseInt(L.getAttribute("data-y"));H<=J&&G<=ee?(L.style.backgroundColor="#cae1fc",L.style.borderColor="#2977ff"):(L.style.backgroundColor="",L.style.borderColor="#ddd")}},onchange:function(B,J,ee){ee=ee.split("x");for(var k=document.createElement("table"),L=document.createElement("tbody"),H=0;H<=ee[1];H++){for(var G=document.createElement("tr"),oe=0;oe<=ee[0];oe++){var me=document.createElement("td");me.innerHTML="",G.appendChild(me)}L.appendChild(G)}k.appendChild(L),k.setAttribute("width","100%"),k.setAttribute("cellpadding","6"),k.setAttribute("cellspacing","0"),document.execCommand("insertHTML",!1,k.outerHTML)}})),d},E}var He=We();function St(){var E=function(T,m){var d={};d.options={};var B={type:"big",title:"Untitled",width:510,height:472};for(var J in B)m&&m.hasOwnProperty(J)?d.options[J]=m[J]:d.options[J]=B[J];var ee=function(){for(var H=document.createElement("div");T.children[0];)H.appendChild(T.children[0]);for(d.content=document.createElement("div"),d.content.className="jfloating_content",d.content.innerHTML=T.innerHTML;H.children[0];)d.content.appendChild(H.children[0]);d.container=document.createElement("div"),d.container.className="jfloating",d.container.appendChild(d.content),d.options.title?d.container.setAttribute("title",d.options.title):d.container.classList.add("no-title"),d.options.width&&(d.container.style.width=parseInt(d.options.width)+"px"),d.options.height&&(d.container.style.height=parseInt(d.options.height)+"px"),T.innerHTML="",T.appendChild(d.container)},k=function(){d.container&&d.container.addEventListener("click",function(H){var G=H.target.getBoundingClientRect();if(H.target.classList.contains("jfloating")){if(H.changedTouches&&H.changedTouches[0])var oe=H.changedTouches[0].clientX,me=H.changedTouches[0].clientY;else var oe=H.clientX,me=H.clientY;G.width-(oe-G.left)<50&&me-G.top<50?setTimeout(function(){d.close()},100):d.setState()}})},L=function(){d.container.classList.add("jfloating-"+d.options.type)};return d.state={isMinized:!1},d.setState=function(){d.state.isMinized?d.container.classList.remove("jfloating-minimized"):d.container.classList.add("jfloating-minimized"),d.state.isMinized=!d.state.isMinized},d.close=function(){Components.elements.splice(E.elements.indexOf(d.container),1),d.updatePosition(),T.remove()},d.updatePosition=function(){for(var H=0;H<E.elements.length;H++){var G=E.elements[H],oe=E.elements[H-1];G.style.right=H*(oe?oe.offsetWidth:G.offsetWidth)*1.01+"px"}},d.init=function(){ee(),k(),L(),E.elements.push(d.container),d.updatePosition(),T.floating=d},d.init(),d};return E.elements=[],E}var q=St();function Se(){let E=function(k){return!isNaN(k)&&k!==null&&(typeof k!="string"||k.trim()!=="")},T={between:function(k,L){return k>=L[0]&&k<=L[1]},"not between":function(k,L){return k<L[0]||k>L[1]},"<":function(k,L){return k<L[0]},"<=":function(k,L){return k<=L[0]},">":function(k,L){return k>L[0]},">=":function(k,L){return k>=L[0]},"=":function(k,L){return k==L[0]},"!=":function(k,L){return k!=L[0]}},m={"valid date":function(){return!0},"=":function(k,L){return k===L[0]},"!=":function(k,L){return k!==L[0]},"<":function(k,L){return k<L[0]},"<=":function(k,L){return k<=L[0]},">":function(k,L){return k>L[0]},">=":function(k,L){return k>=L[0]},between:function(k,L){return k>=L[0]&&k<=L[1]},"not between":function(k,L){return k<L[0]||k>L[1]}},d={contains:function(k,L){return k.includes(L[0])},"not contains":function(k,L){return!k.includes(L[0])},"begins with":function(k,L){return k.startsWith(L[0])},"ends with":function(k,L){return k.endsWith(L[0])},"=":function(k,L){return k===L[0]},"!=":function(k,L){return k!==L[0]},"valid email":function(k){var L=new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);return L.test(k)},"valid url":function(k){var L=new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/ig);return L.test(k)}},B=function(k,L){return typeof B[L.type]=="function"?L.allowBlank&&(typeof k>"u"||k===""||k===null)?!0:B[L.type].call(this,k,L):null};B.url=function(k){var L=new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/ig);return!!L.test(k)},B.email=function(k){var L=new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);return!!(k&&L.test(k))},B.required=function(k){return!!(k&&k.trim())},B.empty=function(k){return typeof k>"u"||k===null||typeof k=="string"&&!k.toString().trim()},B["not exist"]=B.empty,B.notEmpty=function(k){return!B.empty(k)},B.exist=B.notEmpty,B.number=function(k,L){if(!E(k))return!1;if(!L||!L.criteria)return!0;if(!T[L.criteria])return!1;let H=L.value.map(function(G){return parseFloat(G)});return T[L.criteria](k,H)},B.login=function(k){let L=new RegExp(/^[a-zA-Z0-9._-]+$/);return!!(k&&L.test(k))},B.list=function(k,L){let H=typeof k;if(H!=="string"&&H!=="number")return!1;let G;return typeof L.value[0]=="string"?L.source?G=L.source:G=L.value[0].split(","):G=L.value[0],Array.isArray(G)?G.findIndex(function(me){return me==k})>-1:!1};let J=function(){let k=new Date;return k.setHours(0,0,0,0),k},ee={"one year ago":function(){let k=J();return k.setFullYear(k.getFullYear()-1),k},"one month ago":function(){let k=J();return k.setMonth(k.getMonth()-1),k},"one week ago":function(){let k=J();return k.setDate(k.getDate()-7),k},yesterday:function(){let k=J();return k.setDate(k.getDate()-1),k},today:J,tomorrow:function(){let k=J();return k.setDate(k.getDate()+1),k}};return B.date=function(k,L){if(E(k)&&k>0&&k<1e6&&(k=F.numToDate(k)),new Date(k)=="Invalid Date")return!1;if(!L||!L.criteria)return!0;if(!m[L.criteria])return!1;let H=L.value.map(function(G){return typeof G=="string"&&ee[G]?ee[G]().getTime():new Date(G).getTime()});return m[L.criteria](new Date(k).getTime(),H)},B.text=function(k,L){if(typeof k>"u"||k===null)k="";else if(typeof k!="string")return!1;return!L||!L.criteria?!0:d[L.criteria]?d[L.criteria](k,L.value):!1},B.textLength=function(k,L){let H;return typeof k=="string"?H=k.length:typeof k<"u"&&k!==null&&typeof k.toString=="function"?H=k.toString().length:H=0,B.number(H,L)},B}var Ye=Se();function Re(){var E=function(T,m){var d={};d.options={};var B={url:null,message:"Are you sure? There are unsaved information in your form",ignore:!1,currentHash:null,submitButton:null,validations:null,onbeforeload:null,onload:null,onbeforesave:null,onsave:null,onbeforeremove:null,onremove:null,onerror:function(L,H){alert(H)}};for(var J in B)m&&m.hasOwnProperty(J)?d.options[J]=m[J]:d.options[J]=B[J];d.options.validations||(d.options.validations={}),d.options.submitButton||(d.options.submitButton=T.querySelector("input[type=submit]")),d.options.submitButton&&d.options.url&&(d.options.submitButton.onclick=function(){d.save()}),d.options.validations.email||(d.options.validations.email=Ye.email),d.options.validations.length||(d.options.validations.length=Ye.length),d.options.validations.required||(d.options.validations.required=Ye.required),d.setUrl=function(L){d.options.url=L},d.load=function(){b({url:d.options.url,method:"GET",dataType:"json",queue:!0,success:function(L){if(typeof d.options.onbeforeload=="function"){var H=d.options.onbeforeload(T,L);H&&(L=H)}E.setElements(T,L),typeof d.options.onload=="function"&&d.options.onload(T,L)}})},d.save=function(){var L=d.validate();if(L)d.options.onerror(T,L);else{var H=E.getElements(T,!0);if(typeof d.options.onbeforesave=="function"){var H=d.options.onbeforesave(T,H);if(H===!1)return}b({url:d.options.url,method:"POST",dataType:"json",data:H,success:function(G){typeof d.options.onsave=="function"&&d.options.onsave(T,H,G)}})}},d.remove=function(){if(typeof d.options.onbeforeremove=="function"){var L=d.options.onbeforeremove(T,d);if(L===!1)return!1}b({url:d.options.url,method:"DELETE",dataType:"json",success:function(H){typeof d.options.onremove=="function"&&d.options.onremove(T,d,H),d.reset()}})};var ee=function(L){L.classList.add("error"),d.options.submitButton&&d.options.submitButton.setAttribute("disabled",!0);var H=L.getAttribute("data-error")||"There is an error in the form";return L.setAttribute("title",H),H},k=function(L){var H=!1;L.classList.remove("error"),L.removeAttribute("title");for(var G=T.querySelectorAll("input, select, textarea, div[name]"),oe=0;oe<G.length;oe++)G[oe].getAttribute("data-validation")&&G[oe].classList.contains("error")&&(H=!0);d.options.submitButton&&(H?d.options.submitButton.setAttribute("disabled",!0):d.options.submitButton.removeAttribute("disabled"))};return d.validateElement=function(L){var H=!1,G=E.getValue(L),oe=L.getAttribute("data-validation");return typeof d.options.validations[oe]=="function"&&!d.options.validations[oe](G,L)?H=ee(L):L.classList.contains("error")&&k(L),H},d.reset=function(){for(var L=null,H=T.querySelectorAll("input, select, textarea, div[name]"),G=0;G<H.length;G++)(L=H[G].getAttribute("name"))&&(H[G].type=="checkbox"||H[G].type=="radio"?H[G].checked=!1:typeof H[G].val=="function"?H[G].val(""):H[G].value="")},d.validate=function(){for(var L=[],H=T.querySelectorAll("input, select, textarea, div[name]"),G=0;G<H.length;G++)if(H[G].getAttribute("data-validation")){var oe=d.validateElement(H[G]);oe&&L.push(oe)}return L.length>0?L.join("<br>"):!1},d.getError=function(){return!!d.validation()},d.setHash=function(){return d.getHash(E.getElements(T))},d.getHash=function(L){var H=0,G,oe;if(L.length===0)return H;for(G=0;G<L.length;G++)oe=L.charCodeAt(G),H=(H<<5)-H+oe,H|=0;return H},d.isChanged=function(){var L=d.setHash();return d.options.currentHash!=L},d.resetTracker=function(){d.options.currentHash=d.setHash(),d.options.ignore=!1},d.setIgnore=function(L){d.options.ignore=!!L},setTimeout(function(){d.options.currentHash=d.setHash()},1e3),T.addEventListener("keyup",function(L){L.target.getAttribute("data-validation")&&d.validateElement(L.target)}),E.hasEvents||(window.addEventListener("beforeunload",function(L){if(d.isChanged()&&d.options.ignore==!1){var H=d.options.message?d.options.message:"o/";return H?(typeof L>"u"&&(L=window.event),L&&(L.returnValue=H),H):void 0}}),E.hasEvents=!0),T.form=d,d};return E.getValue=function(T){var m=null;if(T.type=="checkbox")T.checked==!0&&(m=T.value||!0);else if(T.type=="radio")T.checked==!0&&(m=T.value);else if(T.type=="file")m=T.files;else if(T.tagName=="select"&&T.multiple==!0){m=[];for(var d=T.querySelectorAll("options[selected]"),B=0;B<d.length;B++)m.push(d[B].value)}else typeof T.val=="function"?m=T.val():m=T.value||"";return m},E.getElements=function(T,m){for(var d={},B=null,J=T.querySelectorAll("input, select, textarea, div[name]"),ee=0;ee<J.length;ee++)(B=J[ee].getAttribute("name"))&&(d[B]=E.getValue(J[ee])||"");return m==!0?d:JSON.stringify(d)},E.setElements=function(T,m){for(var d=null,B=null,J=T.querySelectorAll("input, select, textarea, div[name]"),ee=0;ee<J.length;ee++){var k=J[ee].getAttribute("type");if(d=J[ee].getAttribute("name")){if(d=d.replace(new RegExp(/\[(.*?)\]/ig),".$1"),B=null,d.match(/\./)){var L=v.call(m,d)||"";typeof L<"u"&&(B=L)}else typeof m[d]<"u"&&(B=m[d]);B!==null&&(k=="checkbox"||k=="radio"?J[ee].checked=!!B:k=="file"||(typeof J[ee].val=="function"?J[ee].val(B):J[ee].value=B))}}},E}var Ae=Re();function Le(){var E=function(){var m=null,d=function(k){if(k.which==27)for(var L=document.querySelectorAll(".jmodal"),H=0;H<L.length;H++)L[H].parentNode.modal.close()},B=function(k){let L=k.composedPath();var H=I.findElement(L[0],"jmodal");if(H){var G=H.getBoundingClientRect();if(k.changedTouches&&k.changedTouches[0])var oe=k.changedTouches[0].clientX,me=k.changedTouches[0].clientY;else var oe=k.clientX,me=k.clientY;G.width-(oe-G.left)<50&&me-G.top<50&&H.parentNode.modal.close()}m&&(m.element.style.cursor="auto",m=null)},J=function(k){let L=k.composedPath();var H=I.findElement(L[0],"jmodal");if(H){var G=H.getBoundingClientRect();if(k.changedTouches&&k.changedTouches[0])var oe=k.changedTouches[0].clientX,me=k.changedTouches[0].clientY;else var oe=k.clientX,me=k.clientY;G.width-(oe-G.left)<50&&me-G.top<50||me-G.top<50&&(document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),m={left:G.left,top:G.top,x:k.clientX,y:k.clientY,width:G.width,height:G.height,element:H})}},ee=function(k){if(m){if(k=k||window.event,k.buttons)var L=k.buttons;else if(k.button)var L=k.button;else var L=k.which;L?(m.element.style.top=m.top+(k.clientY-m.y)+m.height/2+"px",m.element.style.left=m.left+(k.clientX-m.x)+m.width/2+"px",m.element.style.cursor="move"):m.element.style.cursor="auto"}};document.addEventListener("keydown",d),document.addEventListener("mouseup",B),document.addEventListener("mousedown",J),document.addEventListener("mousemove",ee)},T=function(m,d){var B={};B.options={};var J={url:null,onopen:null,onclose:null,onload:null,closed:!1,width:null,height:null,title:null,padding:null,backdrop:!0,icon:null};for(var ee in J)d&&d.hasOwnProperty(ee)?B.options[ee]=d[ee]:B.options[ee]=J[ee];!B.options.title&&m.getAttribute("title")&&(B.options.title=m.getAttribute("title"));for(var k=document.createElement("div");m.children[0];)k.appendChild(m.children[0]);for(B.title=document.createElement("div"),B.title.className="jmodal_title",B.options.icon&&B.title.setAttribute("data-icon",B.options.icon),B.content=document.createElement("div"),B.content.className="jmodal_content",B.content.innerHTML=m.innerHTML;k.children[0];)B.content.appendChild(k.children[0]);if(B.container=document.createElement("div"),B.container.className="jmodal",B.container.appendChild(B.title),B.container.appendChild(B.content),B.options.padding&&(B.content.style.padding=B.options.padding),B.options.width&&(B.container.style.width=B.options.width),B.options.height&&(B.container.style.height=B.options.height),B.options.title){var L=document.createElement("h4");L.innerText=B.options.title,B.title.appendChild(L)}if(m.innerHTML="",m.style.display="none",m.appendChild(B.container),B.options.backdrop){var H=document.createElement("div");H.className="jmodal_backdrop",H.onclick=function(){B.close()},m.appendChild(H)}return B.open=function(){m.style.display="block";var G=B.container.getBoundingClientRect();I.getWindowWidth()<G.width?(B.container.style.top="",B.container.style.left="",B.container.classList.add("jmodal_fullscreen"),A.slideBottom(B.container,1)):B.options.backdrop&&(H.style.display="block"),typeof B.options.onopen=="function"&&B.options.onopen(m,B)},B.resetPosition=function(){B.container.style.top="",B.container.style.left=""},B.isOpen=function(){return m.style.display!="none"},B.close=function(){B.isOpen()&&(m.style.display="none",B.options.backdrop&&(H.style.display=""),B.container.classList.remove("jmodal_fullscreen"),typeof B.options.onclose=="function"&&B.options.onclose(m,B))},B.options.url?b({url:B.options.url,method:"GET",dataType:"text/html",success:function(G){B.content.innerHTML=G,B.options.closed||B.open(),typeof B.options.onload=="function"&&B.options.onload(B)}}):(B.options.closed||B.open(),typeof B.options.onload=="function"&&B.options.onload(B)),m.modal=B,E(),E=function(){},B};return T}var Be=Le();function nt(){var E=function(T){var m={};m.options={};var d={icon:null,name:"Notification",date:null,error:null,title:null,message:null,timeout:4e3,autoHide:!0,closeable:!0};for(var B in d)T&&T.hasOwnProperty(B)?m.options[B]=T[B]:m.options[B]=d[B];var J=document.createElement("div");J.className="jnotification",m.options.error&&J.classList.add("jnotification-error");var ee=document.createElement("div");ee.className="jnotification-container",J.appendChild(ee);var k=document.createElement("div");k.className="jnotification-header",ee.appendChild(k);var L=document.createElement("div");if(L.className="jnotification-image",k.appendChild(L),m.options.icon){var H=document.createElement("img");H.src=m.options.icon,L.appendChild(H)}var G=document.createElement("div");if(G.className="jnotification-name",G.innerHTML=m.options.name,k.appendChild(G),m.options.closeable==!0){var oe=document.createElement("div");oe.className="jnotification-close",oe.onclick=function(){m.hide()},k.appendChild(oe)}var me=document.createElement("div");me.className="jnotification-date",k.appendChild(me);var le=document.createElement("div");if(le.className="jnotification-content",ee.appendChild(le),m.options.title){var ce=document.createElement("div");ce.className="jnotification-title",ce.innerHTML=m.options.title,le.appendChild(ce)}var Te=document.createElement("div");if(Te.className="jnotification-message",Te.innerHTML=m.options.message,le.appendChild(Te),m.show=function(){document.body.appendChild(J),I.getWindowWidth()>800?A.fadeIn(J):A.slideTop(J,1)},m.hide=function(){I.getWindowWidth()>800?A.fadeOut(J,function(){J.parentNode&&(J.parentNode.removeChild(J),Ie&&clearTimeout(Ie))}):A.slideTop(J,0,function(){J.parentNode&&(J.parentNode.removeChild(J),Ie&&clearTimeout(Ie))})},m.show(),m.options.autoHide==!0)var Ie=setTimeout(function(){m.hide()},m.options.timeout);return I.getWindowWidth()<800&&J.addEventListener("swipeup",function(Ne){m.hide(),Ne.preventDefault(),Ne.stopPropagation()}),m};return E.isVisible=function(){var T=document.querySelector(".jnotification");return!!(T&&T.parentNode)},E}var st=nt();function Tt(E,T){var m={};m.options={};var d={value:0,onchange:null,width:null};for(var B in d)T&&T.hasOwnProperty(B)?m.options[B]=T[B]:m.options[B]=d[B];E.classList.add("jprogressbar"),E.setAttribute("tabindex",1),E.setAttribute("data-value",m.options.value);var J=document.createElement("div");J.style.width=m.options.value+"%",J.style.color="#fff",E.appendChild(J),m.options.width&&(E.style.width=m.options.width),m.setValue=function(k){k=parseInt(k),m.options.value=k,J.style.width=k+"%",E.setAttribute("data-value",k+"%"),k<6?E.style.color="#000":E.style.color="#fff",m.options.value=k,typeof m.options.onchange=="function"&&m.options.onchange(E,k),E.value!=m.options.value&&(E.value=m.options.value,typeof E.oninput=="function"&&E.oninput({type:"input",target:E,value:E.value}))},m.getValue=function(){return m.options.value};var ee=function(k){if(k.which){var L=E.getBoundingClientRect();if(k.changedTouches&&k.changedTouches[0])var H=k.changedTouches[0].clientX,G=k.changedTouches[0].clientY;else var H=k.clientX,G=k.clientY;m.setValue(Math.round((H-L.left)/L.width*100))}};return"touchstart"in document.documentElement?(E.addEventListener("touchstart",ee),E.addEventListener("touchend",ee)):(E.addEventListener("mousedown",ee),E.addEventListener("mousemove",ee)),E.change=m.setValue,E.val=function(k){if(k===void 0)return m.getValue();m.setValue(k)},E.progressbar=m,m}function Bt(E,T){if(E.rating)return E.rating.setOptions(T,!0);var m={};m.options={},m.setOptions=function(B,J){var ee={number:5,value:0,tooltip:["Very bad","Bad","Average","Good","Very good"],onchange:null};for(var k in ee)B&&B.hasOwnProperty(k)?m.options[k]=B[k]:(typeof m.options[k]>"u"||J===!0)&&(m.options[k]=ee[k]);E.innerHTML="";for(var L=0;L<m.options.number;L++){var H=document.createElement("div");H.setAttribute("data-index",L+1),H.setAttribute("title",m.options.tooltip[L]),E.appendChild(H)}if(m.options.value)for(var L=0;L<m.options.number;L++)L<m.options.value&&E.children[L].classList.add("jrating-selected");return m},m.setValue=function(B){for(var J=0;J<m.options.number;J++)J<B?E.children[J].classList.add("jrating-selected"):(E.children[J].classList.remove("jrating-over"),E.children[J].classList.remove("jrating-selected"));m.options.value=B,typeof m.options.onchange=="function"&&m.options.onchange(E,B),E.value!=m.options.value&&(E.value=m.options.value,typeof E.oninput=="function"&&E.oninput({type:"input",target:E,value:E.value}))},m.getValue=function(){return m.options.value};var d=function(){m.setOptions(T),E.classList.add("jrating"),E.addEventListener("click",function(B){var J=B.target.getAttribute("data-index");J!=null&&(J==m.options.value?m.setValue(0):m.setValue(J))}),E.addEventListener("mouseover",function(B){for(var J=B.target.getAttribute("data-index"),ee=0;ee<m.options.number;ee++)ee<J?E.children[ee].classList.add("jrating-over"):E.children[ee].classList.remove("jrating-over")}),E.addEventListener("mouseout",function(B){for(var J=0;J<m.options.number;J++)E.children[J].classList.remove("jrating-over")}),E.change=m.setValue,E.val=function(B){if(B===void 0)return m.getValue();m.setValue(B)},E.rating=m};return d(),m}function At(E,T){if(E.search)return E.search;var m=null,d=function(H){if(H.target.classList.contains("jsearch_item"))var G=H.target;else var G=H.target.parentNode;k.selectIndex(G),H.preventDefault()},B=function(H){if(typeof k.options.onsearch=="function"){var G=k.options.onsearch(k,H);G&&(H=G)}if(L.innerHTML="",!H.length)E.style.display="";else{E.style.display="block";for(var oe=H.length<11?H.length:10,me=0;me<oe;me++){if(typeof H[me]=="string")var le=H[me],ce=H[me];else{var le=H[me].text;!le&&H[me].name&&(le=H[me].name);var ce=H[me].value;!ce&&H[me].id&&(ce=H[me].id)}var Te=document.createElement("div");Te.setAttribute("data-value",ce),Te.setAttribute("data-text",le),Te.className="jsearch_item",H[me].id&&Te.setAttribute("id",H[me].id),k.options.forceSelect&&me==0&&Te.classList.add("selected");var Ie=document.createElement("img");H[me].image?Ie.src=H[me].image:Ie.style.display="none",Te.appendChild(Ie);var Ne=document.createElement("div");Ne.innerHTML=le,Te.appendChild(Ne),L.appendChild(Te)}}},J=function(H){if(H!=k.terms)if(k.terms=H,k.options.forceSelect?m=0:m=null,Array.isArray(k.options.data)){var G=function(me){if(typeof me=="string"){if((""+me).toLowerCase().search(H.toLowerCase())>=0)return!0}else for(var le in me){var ce=me[le];if((""+ce).toLowerCase().search(H.toLowerCase())>=0)return!0}return!1},oe=k.options.data.filter(function(me){return G(me)});B(oe)}else b({url:k.options.data+H,method:"GET",dataType:"json",success:function(me){B(me)}})},ee=null,k=function(H){ee&&clearTimeout(ee),ee=setTimeout(function(){J(H)},500)};T.forceSelect===null&&(T.forceSelect=!0),k.options={data:T.data||null,input:T.input||null,searchByNode:T.searchByNode||null,onselect:T.onselect||null,forceSelect:T.forceSelect,onsearch:T.onsearch||null,onbeforesearch:T.onbeforesearch||null},k.selectIndex=function(H){var G=H.getAttribute("id"),oe=H.getAttribute("data-text"),me=H.getAttribute("data-value"),le=H.children[0].src||"";typeof k.options.onselect=="function"&&k.options.onselect(k,oe,me,G,le),k.close()},k.open=function(){E.style.display="block"},k.close=function(){ee&&clearTimeout(ee),k.terms="",L.innerHTML="",E.style.display=""},k.isOpened=function(){return!!E.style.display},k.keydown=function(H){k.isOpened()&&(H.key=="Enter"?m!==null&&L.children[m]?(k.selectIndex(L.children[m]),H.preventDefault()):k.close():H.key==="ArrowUp"?(m!==null&&L.children[0]&&(L.children[m].classList.remove("selected"),!k.options.forceSelect&&m===0?m=null:(m=Math.max(0,m-1),L.children[m].classList.add("selected"))),H.preventDefault()):H.key==="ArrowDown"&&(m==null?m=-1:L.children[m].classList.remove("selected"),m<9&&L.children[m+1]&&m++,L.children[m].classList.add("selected"),H.preventDefault()))},k.keyup=function(H){if(!k.options.searchByNode&&k.options.input)if(k.options.input.tagName==="DIV")var G=k.options.input.innerText;else var G=k.options.input.value;else{var oe=I.getNode();if(oe)var G=oe.innerText}if(typeof k.options.onbeforesearch=="function"){var me=k.options.onbeforesearch(k,G);if(me)G=me;else if(me===!1)return}k(G)},k.blur=function(H){k.close()},k.options.input&&(k.options.input.addEventListener("keyup",k.keyup),k.options.input.addEventListener("keydown",k.keydown),k.options.input.addEventListener("blur",k.blur));var L=document.createElement("div");return L.classList.add("jsearch_container"),L.onmousedown=d,E.appendChild(L),E.classList.add("jsearch"),E.search=k,k}function Xt(E,T){var m={};if(m.options={},m.currentImage=null,T&&(m.options=T),E.setAttribute("tabindex","900"),m.options.items=[],!E.classList.contains("jslider")){if(E.classList.add("jslider"),E.classList.add("unselectable"),m.options.height&&(E.style.minHeight=parseInt(m.options.height)+"px"),m.options.width&&(E.style.width=parseInt(m.options.width)+"px"),m.options.grid){E.classList.add("jslider-grid");var d=E.children.length;d>4&&E.setAttribute("data-total",d-4),E.setAttribute("data-number",d>4?4:d)}var B=document.createElement("div");if(B.classList.add("jslider-counter"),E.children.length>0)for(var J=0;J<E.children.length;J++){m.options.items.push(E.children[J]);var ee=document.createElement("div");ee.onclick=function(){var oe=Array.prototype.slice.call(B.children).indexOf(this);m.show(m.currentImage=m.options.items[oe])},B.appendChild(ee)}var k=document.createElement("div");k.className="jslider-caption";var L=document.createElement("div"),H=document.createElement("div");H.className="jslider-close",H.innerHTML="",H.onclick=function(){m.close()},L.appendChild(k),L.appendChild(H)}m.updateCounter=function(oe){for(var me=0;me<B.children.length;me++)if(B.children[me].classList.contains("jslider-counter-focus")){B.children[me].classList.remove("jslider-counter-focus");break}B.children[oe].classList.add("jslider-counter-focus")},m.show=function(oe){if(!oe)var oe=E.children[0];E.classList.add("jslider-focus"),E.classList.remove("jslider-grid"),E.appendChild(L),E.appendChild(B);var me=m.options.items.indexOf(oe);m.updateCounter(me);for(var le=0;le<E.children.length;le++)E.children[le].style.display="";oe.style.display="block",oe.previousElementSibling?E.classList.add("jslider-left"):E.classList.remove("jslider-left"),oe.nextElementSibling&&oe.nextElementSibling.tagName=="IMG"?E.classList.add("jslider-right"):E.classList.remove("jslider-right"),m.currentImage=oe,m.currentImage.offsetHeight>m.currentImage.offsetWidth&&m.currentImage.classList.add("jslider-vertical"),L.children[0].innerText=m.currentImage.getAttribute("title")},m.open=function(){m.show(),typeof m.options.onopen=="function"&&m.options.onopen(E)},m.close=function(){E.classList.remove("jslider-focus"),E.classList.remove("jslider-left"),E.classList.remove("jslider-right"),m.options.grid&&E.classList.add("jslider-grid");for(var oe=0;oe<E.children.length;oe++)E.children[oe].style.display="";B.remove(),L.remove(),m.currentImage=null,typeof m.options.onclose=="function"&&m.options.onclose(E)},m.reset=function(){E.innerHTML=""},m.next=function(){var oe=m.currentImage.nextElementSibling;oe&&oe.tagName==="IMG"&&m.show(m.currentImage.nextElementSibling)},m.prev=function(){m.currentImage.previousElementSibling&&m.show(m.currentImage.previousElementSibling)};var G=function(oe){if(oe.target.tagName=="IMG")m.show(oe.target);else if(!oe.target.classList.contains("jslider-close")&&!(oe.target.parentNode.classList.contains("jslider-counter")||oe.target.classList.contains("jslider-counter"))){var me=oe.offsetX||oe.changedTouches[0].clientX;oe.target.clientWidth-me<40?m.next():me<40&&m.prev()}};return"ontouchend"in document.documentElement?E.addEventListener("touchend",G):E.addEventListener("mouseup",G),E.addEventListener("swipeleft",function(oe){m.next(),oe.preventDefault(),oe.stopPropagation()}),E.addEventListener("swiperight",function(oe){m.prev(),oe.preventDefault(),oe.stopPropagation()}),E.addEventListener("keydown",function(oe){oe.which==27&&m.close()}),E.slider=m,m}function yn(E,T){if(E.tags)return E.tags.setOptions(T,!0);var m={type:"tags"};m.options={};var d=function(){return!!(m.options.limit&&E.children.length>=m.options.limit)},B=null,J=null;m.setOptions=function(pe,ue){var ye={value:"",limit:null,search:null,placeholder:null,validation:null,onbeforepaste:null,onbeforechange:null,onremoveitem:null,onlimit:null,onchange:null,onfocus:null,onblur:null,onload:null};for(var z in ye)pe&&pe.hasOwnProperty(z)?m.options[z]=pe[z]:(typeof m.options[z]>"u"||ue===!0)&&(m.options[z]=ye[z]);return m.options.placeholder?E.setAttribute("data-placeholder",m.options.placeholder):E.removeAttribute("data-placeholder"),E.placeholder=m.options.placeholder,m.setValue(m.options.value),H(),m.options.search?J||(J=document.createElement("div"),E.parentNode.insertBefore(J,E.nextSibling),B=At(J,{data:m.options.search,onselect:function(X,S,R){m.selectIndex(S,R)}})):J&&(B=null,J.remove(),J=null),m},m.add=function(pe,ue){if(typeof m.options.onbeforechange=="function"){var ye=m.options.onbeforechange(E,m,m.options.value,pe);if(ye===!1)return!1;ye!=null&&(pe=ye)}if(B&&B.close(),d())typeof m.options.onlimit=="function"?m.options.onlimit(m,m.options.limit):alert(u.translate("You reach the limit number of entries")+" "+m.options.limit);else{var z=I.getNode();if(z&&z.parentNode&&z.parentNode.classList.contains("jtags")&&z.nextSibling&&!(z.nextSibling.innerText&&z.nextSibling.innerText.trim()))X=z.nextSibling;else{if(E.lastChild&&(E.lastChild.innerText.trim()||E.removeChild(E.lastChild)),!pe||typeof pe=="string")var X=k(pe,pe,z);else for(var S=0;S<=pe.length;S++)if(!d()){if(!pe[S]||typeof pe[S]=="string")var R=pe[S]||"",Y=null;else var R=pe[S].text,Y=pe[S].value;var X=k(R,Y)}L()}ue&&ee(X)}},m.setLimit=function(pe){m.options.limit=pe;for(var ue=E.children.length-pe;E.children.length>pe;)E.removeChild(E.lastChild)},m.remove=function(pe){pe.parentNode.removeChild(pe),E.children.length?L():m.add("",!0),typeof m.options.onremoveitem=="function"&&m.options.onremoveitem(E,m,pe)},m.getData=function(){for(var pe=[],ue=0;ue<E.children.length;ue++){var ye=E.children[ue].innerText.replace(`
`,""),z=E.children[ue].getAttribute("data-value");z||(z=ye),(ye||z)&&pe.push({text:ye,value:z})}return pe},m.getValue=function(pe){var ue=null;if(pe!=null)ue=E.children[pe].getAttribute("data-value"),ue||(ue=E.children[pe].innerText.replace(`
`,""));else{for(var ye=[],z=0;z<E.children.length;z++)ue=E.children[z].innerText.replace(`
`,""),ue&&ye.push(m.getValue(z));ue=ye.join(",")}return ue},m.setValue=function(pe){if(!pe)m.reset();else if(E.value!=pe)if(Array.isArray(pe))m.add(pe);else{var ue=(""+pe).trim(),ye=oe(ue);E.innerHTML="",m.add(ye)}},m.reset=function(){E.classList.add("jtags-empty"),E.innerHTML="<div></div>",L()},m.isValid=function(){for(var pe=0,ue=0;ue<E.children.length;ue++)E.children[ue].classList.contains("jtags_error")&&pe++;return pe==0},m.selectIndex=function(pe,ue){var ye=I.getNode();ye&&(ye.innerText=pe,ue&&ye.setAttribute("data-value",ue),ye.classList.remove("jtags_error"),d()||m.add("",!0))},m.search=function(pe){var ue=pe.innerText},m.destroy=function(){E.removeEventListener("mouseup",Ie),E.removeEventListener("keydown",le),E.removeEventListener("keyup",ce),E.removeEventListener("paste",Te),E.removeEventListener("focus",Ne),E.removeEventListener("blur",Ge),E.parentNode.removeChild(E)};var ee=function(pe){if(E.children.length){var ue=document.createRange(),ye=window.getSelection();if(!pe)var pe=E.childNodes[E.childNodes.length-1];ue.setStart(pe,pe.length),ue.collapse(!0),ye.removeAllRanges(),ye.addRange(ue),E.scrollLeft=E.scrollWidth}},k=function(pe,ue,ye){var z=document.createElement("div");return z.textContent=pe||"",ue&&z.setAttribute("data-value",ue),ye&&ye.parentNode.classList.contains("jtags")?E.insertBefore(z,ye.nextSibling):E.appendChild(z),z},L=function(){var pe=m.getValue();pe!=m.options.value&&(m.options.value=pe,typeof m.options.onchange=="function"&&m.options.onchange(E,m,m.options.value),E.value!=m.options.value&&(E.value=m.options.value,typeof E.oninput=="function"&&E.oninput({type:"input",target:E,value:E.value}))),H()},H=function(){for(var pe=0;pe<E.children.length;pe++)E.children[pe].tagName==="DIV"&&(m.getValue(pe)?(E.children[pe].classList.add("jtags_label"),typeof m.options.validation=="function"&&m.getValue(pe)?m.options.validation(E.children[pe],E.children[pe].innerText,E.children[pe].getAttribute("data-value"))?E.children[pe].classList.remove("jtags_error"):E.children[pe].classList.add("jtags_error"):E.children[pe].classList.remove("jtags_error")):E.children[pe].classList.remove("jtags_label"));G()},G=function(){E.innerText.trim()?E.classList.remove("jtags-empty"):(!E.children.length||E.children[0].tagName==="BR")&&(E.innerHTML="",ee(k()))},oe=function(pe){var ue=[],ye="";if(pe=pe.trim(),pe){for(var z=0;z<pe.length;z++)pe[z]==","||pe[z]==";"||pe[z]==`
`?ye&&(ue.push(ye.trim()),ye=""):ye+=pe[z];ye&&ue.push(ye)}return ue},me=0,le=function(pe){if(me=window.getSelection().anchorOffset,G(),pe.key==="Tab"||pe.key===";"||pe.key===","){var ue=window.getSelection().anchorOffset;ue>1&&(d()?typeof m.options.onlimit=="function"&&m.options.onlimit(m,m.options.limit):m.add("",!0)),pe.preventDefault()}else if(pe.key=="Enter"){if(!B||!B.isOpened()){var ue=window.getSelection().anchorOffset;ue>1&&(d()||m.add("",!0)),pe.preventDefault()}}else pe.key=="Backspace"&&E.children.length==1&&window.getSelection().anchorOffset<1&&pe.preventDefault();B&&B.keydown(pe),G()},ce=function(pe){if(pe.which==39){var ue=window.getSelection().anchorOffset;ue>1&&ue==me&&m.add("",!0)}else pe.which==13||pe.which==38||pe.which==40?pe.preventDefault():B&&B.keyup(pe);H()},Te=function(pe){if(pe.clipboardData||pe.originalEvent.clipboardData)var ue=(pe.originalEvent||pe).clipboardData.getData("text/plain");else if(window.clipboardData)var ue=window.clipboardData.getData("Text");var ye=oe(ue);if(typeof m.options.onbeforepaste=="function"){var z=m.options.onbeforepaste(E,m,ye);if(z===!1)return pe.preventDefault(),!1;z&&(ye=z)}ye.length>1?(m.add(ye,!0),pe.preventDefault()):ye[0]&&(document.execCommand("insertText",!1,ye[0]),pe.preventDefault())},Ie=function(pe){if(pe.target.parentNode&&pe.target.parentNode.classList.contains("jtags")&&(pe.target.classList.contains("jtags_label")||pe.target.classList.contains("jtags_error"))){var ue=pe.target.getBoundingClientRect();ue.width-(pe.clientX-ue.left)<16&&m.remove(pe.target)}pe.target==E&&ee()},Ne=function(){E.classList.contains("jtags-focus")||((!E.children.length||m.getValue(E.children.length-1))&&(d()||k("")),typeof m.options.onfocus=="function"&&m.options.onfocus(E,m,m.getValue()),E.classList.add("jtags-focus"))},Ge=function(){if(E.classList.contains("jtags-focus")){B&&B.close();for(var pe=0;pe<E.children.length-1;pe++)m.getValue(pe)||E.removeChild(E.children[pe]);L(),E.classList.remove("jtags-focus"),typeof m.options.onblur=="function"&&m.options.onblur(E,m,m.getValue())}},lt=function(){"touchend"in document.documentElement?E.addEventListener("touchend",Ie):E.addEventListener("mouseup",Ie),E.addEventListener("keydown",le),E.addEventListener("keyup",ce),E.addEventListener("paste",Te),E.addEventListener("focus",Ne),E.addEventListener("blur",Ge),E.setAttribute("contenteditable",!0),E.classList.add("jtags"),m.setOptions(T),typeof m.options.onload=="function"&&m.options.onload(E,m),E.change=m.setValue,E.val=function(pe){if(pe===void 0)return m.getValue();m.setValue(pe)},E.tags=m};return lt(),m}function Qt(E,T){var m={};m.options={};var d={type:"image",extension:"*",input:!1,minWidth:!1,maxWidth:null,maxHeight:null,maxJpegSizeBytes:null,onchange:null,multiple:!1,remoteParser:null};for(var B in d)T&&T.hasOwnProperty(B)?m.options[B]=T[B]:m.options[B]=d[B];m.options.multiple==!0&&E.setAttribute("data-multiple",!0),E.content=[],E.classList.add("jupload"),m.options.input==!0&&E.classList.add("input"),m.add=function(H){if(m.options.multiple==!1&&(E.content=[],E.innerText=""),m.options.type=="image"){var G=document.createElement("img");G.setAttribute("src",H.file),G.setAttribute("tabindex",-1),E.getAttribute("name")||(G.className="jfile",G.content=H),E.appendChild(G)}else{if(H.name)var oe=H.name;else var oe=H.file;var me=document.createElement("div");me.innerText=oe||m.options.type,me.classList.add("jupload-item"),me.setAttribute("tabindex",-1),E.appendChild(me)}H.content&&(H.file=I.guid()),E.content.push(H),typeof m.options.onchange=="function"&&m.options.onchange(E,H)},m.addFromFile=function(H){var G=H.type.split("/");if(G[0]==m.options.type){var oe=new FileReader;oe.addEventListener("load",function(me){var le={file:me.srcElement.result,extension:H.name.substr(H.name.lastIndexOf(".")+1),name:H.name,size:H.size,lastmodified:H.lastModified,content:me.srcElement.result};m.add(le)}),oe.readAsDataURL(H)}else alert(u.translate("This extension is not allowed"))},m.addFromUrl=function(H){if(H.substr(0,4)!="data"&&!m.options.remoteParser)console.error("remoteParser not defined in your initialization");else if(H.substr(0,4)=="data"){var G=H.split(";");G=G[0].split("/");var oe=G[0].replace("data:","");if(oe==m.options.type){var me={file:H,name:"",extension:G[1],content:H};m.add(me)}else alert(m.options.text.extensionNotAllowed)}else{var G=H.substr(H.lastIndexOf(".")+1);H=m.options.remoteParser+H,b({url:H,type:"GET",dataType:"blob",success:function(ce){}})}};var J=function(H,G){for(var oe=.92,me=null,le=H.toDataURL(G,oe);m.options.maxJpegSizeBytes&&G==="image/jpeg"&&le.length>m.options.maxJpegSizeBytes&&le.length!==me;)oe*=.9,me=le.length,le=H.toDataURL(G,oe);return le},ee=m.options.type+"/"+m.options.extension,k=document.createElement("input");k.type="file",k.setAttribute("accept",ee),k.onchange=function(){for(var H=0;H<this.files.length;H++)m.addFromFile(this.files[H])},m.options.multiple==!0&&k.setAttribute("multiple",!0);var L=null;return E.addEventListener("click",function(H){L=null,!E.children.length||H.target===E?I.click(k):H.target.parentNode==E&&(L=H.target)}),E.addEventListener("dblclick",function(H){I.click(k)}),E.addEventListener("dragenter",function(H){E.style.border="1px dashed #000"}),E.addEventListener("dragleave",function(H){E.style.border="1px solid #eee"}),E.addEventListener("dragstop",function(H){E.style.border="1px solid #eee"}),E.addEventListener("dragover",function(H){H.preventDefault()}),E.addEventListener("keydown",function(H){if(L&&H.which==46){var G=Array.prototype.indexOf.call(E.children,L);G>=0&&(E.content.splice(G,1),L.remove(),L=null)}}),E.addEventListener("drop",function(H){H.preventDefault(),H.stopPropagation();var G=(H.originalEvent||H).dataTransfer.getData("text/html"),oe=(H.originalEvent||H).dataTransfer.files;if(oe.length)for(var me=0;me<H.dataTransfer.files.length;me++)m.addFromFile(H.dataTransfer.files[me]);else if(G){m.options.multiple==!1&&(E.innerText="");var le=document.createElement("div");le.innerHTML=G;var ce=le.querySelectorAll("img");if(ce.length)for(var me=0;me<ce.length;me++)m.addFromUrl(ce[me].src)}return E.style.border="1px solid #eee",!1}),E.val=function(H){if(H===void 0)return E.content&&E.content.length?E.content:null;if(E.innerText="",E.content=[],H)if(Array.isArray(H))for(var G=0;G<H.length;G++)typeof H[G]=="string"?m.add({file:H[G]}):m.add(H[G]);else typeof H=="string"&&m.add({file:H})},E.upload=E.image=m,m}var fi=r(195),pi=r.n(fi),Ut=Mt(Ve(Ve({},u),I),{version:"5.8.5",setExtensions:function(E){if(typeof E=="object")for(var T=Object.keys(E),m=0;m<T.length;m++)Ut[T[m]]=E[T[m]]},tracking:g,path:v,sorting:p,lazyLoading:w,ajax:b,animation:A,calendar:K,color:ae,contextmenu:Me,dropdown:ie,editor:He,floating:q,form:Ae,mask:_,modal:Be,notification:st,palette:se,picker:ze,progressbar:Tt,rating:Bt,search:At,slider:Xt,tabs:he,tags:yn,toolbar:Je,upload:Qt,validations:Ye});Ut.image=Qt,Ut.image.create=function(E){var T=document.createElement("img");return T.setAttribute("src",E.file),T.className="jfile",T.setAttribute("tabindex",-1),T.content=E,T},Ut.tracker=Ae,Ut.loading=A.loading,Ut.sha512=pi(),typeof document<"u"&&function(){if(typeof window.jSuitesStateControl>"u")window.jSuitesStateControl=[];else return;let E=function(ue,ye){return ue[ye.type]&&ue[ye.type]==ye||ue.component&&ue.component==ye?!0:ue.parentNode?E(ue.parentNode,ye):!1},T=function(ue){let ye=window.jSuitesStateControl;if(ye&&ye.length>0)for(let z=0;z<ye.length;z++)ye[z]&&!E(ue,ye[z])&&ye[z].close()},m=15,d=null,B=!1,J={x:null,y:null},ee=document.createElement("div");ee.classList.add("jtooltip");let k=function(ue){return ue&&(ue.shadowRoot||ue.tagName&&ue.tagName.includes("-"))},L=function(ue){let ye,z,X=ue.path||ue.composedPath&&ue.composedPath();return X?(z=X[0],z&&k(z)&&!z.shadowRoot&&ue.toElement&&(z=ue.toElement)):(ue.target&&k(ue.target)?ye=ue.target.shadowRoot:ye=document,z=ye.elementFromPoint(x,y)),z},H=function(ue){if(ue.changedTouches&&ue.changedTouches[0])var ye=ue.changedTouches[0].clientX,z=ue.changedTouches[0].clientY;else var ye=ue.clientX,z=ue.clientY;let X=L(ue),S=X&&X.tagName==="DIV"&&X.getAttribute("contentEditable"),R=Ut.findElement(X,"jpanel");if(R&&!R.classList.contains("readonly")&&!S){let Y=R.getBoundingClientRect(),de=0;R.style.rotate&&(de=parseFloat(R.style.rotate));let ne="move";X.getAttribute("data-action")?ne=X.getAttribute("data-action"):R.style.cursor?ne="resize":R.style.cursor="move",B={action:ne,a:de,e:R,x:ye,y:z,l:Y.left,t:Y.top,b:Y.bottom,r:Y.right,w:Y.width,h:Y.height,d:R.style.cursor,actioned:!1},R.style.width||(R.style.width=Y.width+"px"),R.style.height||(R.style.height=Y.height+"px")}else B=!1;T(X),Te(ue)},G=function(ue,ye,z,X,S,R){let Y=z-ue,de=X-ye,ne=S-ue,Q=R-ye,ve=Math.atan2(de,Y),De=Math.atan2(Q,ne)-ve;return De=De*(180/Math.PI),De<0&&(De+=360),De},oe=function(ue){B&&B.e&&(typeof B.e.refresh=="function"&&J.actioned&&B.e.refresh(),B.e.style.cursor=""),J={x:null,y:null},B=!1},me=function(ue){if(B){let R=ue.clientX||ue.pageX,Y=ue.clientY||ue.pageY;if(J.x==null&&J.y==null&&(J.x=R,J.y=Y),B.action==="move"){var ye=R-J.x,z=Y-J.y,X=B.e.offsetTop+z,S=B.e.offsetLeft+ye;B.e.style.top=X+"px",B.e.style.left=S+"px",typeof B.e.refresh=="function"&&(J.actioned=!0,B.e.refresh("position",X,S))}else if(B.action==="rotate"){let de=B.l+B.w/2,ne=B.t+B.h/2,Q=G(de,ne,B.x,B.y,R,Y);Q=Q+B.a%360,Q=Math.round(Q/2)*2,B.e.style.rotate=`${Q}deg`,typeof B.e.refresh=="function"&&(J.actioned=!0,B.e.refresh("rotate",Q))}else if(B.action==="resize"){let de=null,ne=null,Q=null,ve=null;B.d=="e-resize"||B.d=="ne-resize"||B.d=="se-resize"?(Q=B.e.offsetWidth+(R-J.x),ue.shiftKey&&(ve=B.e.offsetHeight+(R-J.x)*(B.e.offsetHeight/B.e.offsetWidth))):(B.d==="w-resize"||B.d=="nw-resize"||B.d=="sw-resize")&&(ne=B.e.offsetLeft+(R-J.x),Q=B.e.offsetLeft+B.e.offsetWidth-ne,ue.shiftKey&&(ve=B.e.offsetHeight-(R-J.x)*(B.e.offsetHeight/B.e.offsetWidth))),B.d=="s-resize"||B.d=="se-resize"||B.d=="sw-resize"?ve||(ve=B.e.offsetHeight+(Y-J.y)):(B.d==="n-resize"||B.d=="ne-resize"||B.d=="nw-resize")&&(de=B.e.offsetTop+(Y-J.y),ve=B.e.offsetTop+B.e.offsetHeight-de),de&&(B.e.style.top=de+"px"),ne&&(B.e.style.left=ne+"px"),Q&&(B.e.style.width=Q+"px"),ve&&(B.e.style.height=ve+"px"),typeof B.e.refresh=="function"&&(J.actioned=!0,B.e.refresh("dimensions",Q,ve))}J.x=R,J.y=Y}else{let R=L(ue),Y=Ut.findElement(R,"jpanel");if(Y){if(Y.classList.contains("jpanel-controls")){let ne=R.getAttribute("data-position");ne?Y.style.cursor=ne:Y.style.cursor=""}else if(Y.getAttribute("tabindex")){let ne=Y.getBoundingClientRect();ue.clientY-ne.top<m?ne.width-(ue.clientX-ne.left)<m?Y.style.cursor="ne-resize":ue.clientX-ne.left<m?Y.style.cursor="nw-resize":Y.style.cursor="n-resize":ne.height-(ue.clientY-ne.top)<m?ne.width-(ue.clientX-ne.left)<m?Y.style.cursor="se-resize":ue.clientX-ne.left<m?Y.style.cursor="sw-resize":Y.style.cursor="s-resize":ne.width-(ue.clientX-ne.left)<m?Y.style.cursor="e-resize":ue.clientX-ne.left<m?Y.style.cursor="w-resize":Y.style.cursor=""}}}},le=["n","ne","e","se","s","sw","w","nw","rotate"];le.forEach(function(ue,ye){le[ye]=document.createElement("div"),le[ye].classList.add("jpanel-action"),ue==="rotate"?le[ye].setAttribute("data-action","rotate"):(le[ye].setAttribute("data-action","resize"),le[ye].setAttribute("data-position",ue+"-resize"))});let ce,Te=function(ue){let ye=L(ue),z=Ut.findElement(ye,"jpanel");z&&!z.classList.contains("readonly")&&z.classList.contains("jpanel-controls")?(z.append(...le),z.classList.contains("jpanel-rotate")||le[le.length-1].remove(),ce=z):Ie(ue)},Ie=function(ue){ce&&(le.forEach(function(ye){ye.remove()}),ce=null)},Ne=function(ue){var z=L(ue).getAttribute("data-tooltip");if(z){if(ee.innerText=z,ue.changedTouches&&ue.changedTouches[0])var X=ue.changedTouches[0].clientX,S=ue.changedTouches[0].clientY;else var X=ue.clientX,S=ue.clientY;ee.style.top=S+"px",ee.style.left=X+"px",document.body.appendChild(ee)}else ee.innerText&&(ee.innerText="",document.body.removeChild(ee))},Ge=function(ue){var ye=document.activeElement;if(ye&&typeof ye.contextmenu=="function")ye.contextmenu(ue),ue.preventDefault(),ue.stopImmediatePropagation();else if(ye=Ut.findElement(ue.target,function(X){return X.tagName&&X.getAttribute("aria-contextmenu-id")}),ye){var z=document.querySelector("#"+ye);z?(z.contextmenu.open(ue),ue.preventDefault(),ue.stopImmediatePropagation()):console.error("JSUITES: contextmenu id not found: "+ye)}},lt=function(ue){let ye=document.activeElement;ye&&ue.key==="Delete"&&typeof ye.delete=="function"&&(ye.delete(),ue.preventDefault(),ue.stopImmediatePropagation());let z=window.jSuitesStateControl;z&&z.length>0&&(ye=z[z.length-1],ye&&ue.key==="Escape"&&typeof ye.isOpened=="function"&&typeof ye.close=="function"&&ye.isOpened()&&(ye.close(),ue.preventDefault(),ue.stopImmediatePropagation()))},pe=function(ue){(ue.target.getAttribute("data-mask")||ue.target.mask)&&Ut.mask(ue)};document.addEventListener("focusin",Te),document.addEventListener("mouseup",oe),document.addEventListener("mousedown",H),document.addEventListener("mousemove",me),document.addEventListener("mouseover",Ne),document.addEventListener("keydown",lt),document.addEventListener("contextmenu",Ge),document.addEventListener("input",pe)}();var Ar=Ut})(),e=s.default}(),e})});var Og=Pc((exports,module)=>{"use strict";!jSuites&&typeof kc=="function"&&(jSuites=Rg());var jSuites;(function(e,t){typeof exports=="object"&&typeof module<"u"?module.exports=t():typeof define=="function"&&define.amd?define(t):e.jspreadsheet=t()})(exports,function(){var jspreadsheet;return function(){var __webpack_modules__={463:function(e){var t;e.exports=(function(){var n={765:function(f,u){var c;c=function(g){g.version="1.0.2";var D=Math;function I(be,ie){for(var ze=0,Je=0;ze<be.length;++ze)Je=ie*Je+be[ze];return Je}function v(be,ie,ze,Je,We){if(ie===0)return ze;if(ie===1)return Je;for(var He=2/be,St=Je,q=1;q<ie;++q)St=Je*q*He+We*ze,ze=Je,Je=St;return St}function p(be,ie,ze,Je,We){return function(He,St){if(Je){if(He===0)return Je==1?-1/0:1/0;if(He<0)return NaN}return St===0?be(He):St===1?ie(He):St<0?NaN:v(He,St|=0,be(He),ie(He),We)}}var w,j,b,M,A,O,F,V,_,P,K,W,se,he=function(){var be=.636619772,ie=[57568490574,-13362590354,6516196407e-1,-1121442418e-2,77392.33017,-184.9052456].reverse(),ze=[57568490411,1029532985,9494680718e-3,59272.64853,267.8532712,1].reverse(),Je=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),We=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934935152e-16].reverse();function He(Ae){var Le=0,Be=0,nt=0,st=Ae*Ae;if(Ae<8)Le=(Be=I(ie,st))/(nt=I(ze,st));else{var Tt=Ae-.785398164;Be=I(Je,st=64/st),nt=I(We,st),Le=D.sqrt(be/Ae)*(D.cos(Tt)*Be-D.sin(Tt)*nt*8/Ae)}return Le}var St=[72362614232,-7895059235,2423968531e-1,-2972611439e-3,15704.4826,-30.16036606].reverse(),q=[144725228442,2300535178,1858330474e-2,99447.43394,376.9991397,1].reverse(),Se=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),Ye=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function Re(Ae){var Le=0,Be=0,nt=0,st=Ae*Ae,Tt=D.abs(Ae)-2.356194491;return Math.abs(Ae)<8?Le=(Be=Ae*I(St,st))/(nt=I(q,st)):(Be=I(Se,st=64/st),nt=I(Ye,st),Le=D.sqrt(be/D.abs(Ae))*(D.cos(Tt)*Be-D.sin(Tt)*nt*8/D.abs(Ae)),Ae<0&&(Le=-Le)),Le}return function Ae(Le,Be){if(Be=Math.round(Be),!isFinite(Le))return isNaN(Le)?Le:0;if(Be<0)return(Be%2?-1:1)*Ae(Le,-Be);if(Le<0)return(Be%2?-1:1)*Ae(-Le,Be);if(Be===0)return He(Le);if(Be===1)return Re(Le);if(Le===0)return 0;var nt=0;if(Le>Be)nt=v(Le,Be,He(Le),Re(Le),-1);else{for(var st=!1,Tt=0,Bt=0,At=1,Xt=0,yn=2/Le,Qt=2*D.floor((Be+D.floor(D.sqrt(40*Be)))/2);Qt>0;Qt--)Xt=Qt*yn*At-Tt,Tt=At,At=Xt,D.abs(At)>1e10&&(At*=1e-10,Tt*=1e-10,nt*=1e-10,Bt*=1e-10),st&&(Bt+=At),st=!st,Qt==Be&&(nt=Tt);nt/=Bt=2*Bt-At}return nt}}(),ae=(w=.636619772,j=[-2957821389,7062834065,-5123598036e-1,1087988129e-2,-86327.92757,228.4622733].reverse(),b=[40076544269,7452499648e-1,7189466438e-3,47447.2647,226.1030244,1].reverse(),M=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),A=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934945152e-16].reverse(),O=[-4900604943e3,127527439e4,-51534381390,7349264551e-1,-4237922726e-3,8511.937935].reverse(),F=[249958057e5,424441966400,3733650367,2245904002e-2,102042.605,354.9632885,1].reverse(),V=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),_=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse(),p(function(be){var ie=0,ze=0,Je=0,We=be*be,He=be-.785398164;return be<8?ie=(ze=I(j,We))/(Je=I(b,We))+w*he(be,0)*D.log(be):(ze=I(M,We=64/We),Je=I(A,We),ie=D.sqrt(w/be)*(D.sin(He)*ze+D.cos(He)*Je*8/be)),ie},function(be){var ie=0,ze=0,Je=0,We=be*be,He=be-2.356194491;return be<8?ie=(ze=be*I(O,We))/(Je=I(F,We))+w*(he(be,1)*D.log(be)-1/be):(ze=I(V,We=64/We),Je=I(_,We),ie=D.sqrt(w/be)*(D.sin(He)*ze+D.cos(He)*Je*8/be)),ie},0,1,-1)),we=(P=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),K=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),W=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),se=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse(),function be(ie,ze){if((ze=Math.round(ze))===0)return function(Ye){return Ye<=3.75?I(P,Ye*Ye/14.0625):D.exp(D.abs(Ye))/D.sqrt(D.abs(Ye))*I(K,3.75/D.abs(Ye))}(ie);if(ze===1)return function(Ye){return Ye<3.75?Ye*I(W,Ye*Ye/14.0625):(Ye<0?-1:1)*D.exp(D.abs(Ye))/D.sqrt(D.abs(Ye))*I(se,3.75/D.abs(Ye))}(ie);if(ze<0)return NaN;if(D.abs(ie)===0)return 0;if(ie==1/0)return 1/0;var Je,We=0,He=2/D.abs(ie),St=0,q=1,Se=0;for(Je=2*D.round((ze+D.round(D.sqrt(40*ze)))/2);Je>0;Je--)Se=Je*He*q+St,St=q,q=Se,D.abs(q)>1e10&&(q*=1e-10,St*=1e-10,We*=1e-10),Je==ze&&(We=St);return We*=be(ie,0)/q,ie<0&&ze%2?-We:We}),Me=function(){var be=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),ie=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse(),ze=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),Je=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();return p(function(We){return We<=2?-D.log(We/2)*we(We,0)+I(be,We*We/4):D.exp(-We)/D.sqrt(We)*I(ie,2/We)},function(We){return We<=2?D.log(We/2)*we(We,1)+1/We*I(ze,We*We/4):D.exp(-We)/D.sqrt(We)*I(Je,2/We)},0,2,1)}();g.besselj=he,g.bessely=ae,g.besseli=we,g.besselk=Me},c(typeof DO_NOT_EXPORT_BESSEL>"u"?u:{})},162:function(f){var u;f.exports=(u=function(c,g){var D=Array.prototype.concat,I=Array.prototype.slice,v=Object.prototype.toString;function p(_,P){var K=_>P?_:P;return c.pow(10,17-~~(c.log(K>0?K:-K)*c.LOG10E))}var w=Array.isArray||function(_){return v.call(_)==="[object Array]"};function j(_){return v.call(_)==="[object Function]"}function b(_){return typeof _=="number"&&_-_==0}function M(){return new M._init(arguments)}function A(){return 0}function O(){return 1}function F(_,P){return _===P?1:0}M.fn=M.prototype,M._init=function(_){if(w(_[0]))if(w(_[0][0])){j(_[1])&&(_[0]=M.map(_[0],_[1]));for(var P=0;P<_[0].length;P++)this[P]=_[0][P];this.length=_[0].length}else this[0]=j(_[1])?M.map(_[0],_[1]):_[0],this.length=1;else if(b(_[0]))this[0]=M.seq.apply(null,_),this.length=1;else{if(_[0]instanceof M)return M(_[0].toArray());this[0]=[],this.length=1}return this},M._init.prototype=M.prototype,M._init.constructor=M,M.utils={calcRdx:p,isArray:w,isFunction:j,isNumber:b,toVector:function(_){return D.apply([],_)}},M._random_fn=c.random,M.setRandom=function(_){if(typeof _!="function")throw new TypeError("fn is not a function");M._random_fn=_},M.extend=function(_){var P,K;if(arguments.length===1){for(K in _)M[K]=_[K];return this}for(P=1;P<arguments.length;P++)for(K in arguments[P])_[K]=arguments[P][K];return _},M.rows=function(_){return _.length||1},M.cols=function(_){return _[0].length||1},M.dimensions=function(_){return{rows:M.rows(_),cols:M.cols(_)}},M.row=function(_,P){return w(P)?P.map(function(K){return M.row(_,K)}):_[P]},M.rowa=function(_,P){return M.row(_,P)},M.col=function(_,P){if(w(P)){var K=M.arange(_.length).map(function(){return new Array(P.length)});return P.forEach(function(he,ae){M.arange(_.length).forEach(function(we){K[we][ae]=_[we][he]})}),K}for(var W=new Array(_.length),se=0;se<_.length;se++)W[se]=[_[se][P]];return W},M.cola=function(_,P){return M.col(_,P).map(function(K){return K[0]})},M.diag=function(_){for(var P=M.rows(_),K=new Array(P),W=0;W<P;W++)K[W]=[_[W][W]];return K},M.antidiag=function(_){for(var P=M.rows(_)-1,K=new Array(P),W=0;P>=0;P--,W++)K[W]=[_[W][P]];return K},M.transpose=function(_){var P,K,W,se,he,ae=[];for(w(_[0])||(_=[_]),K=_.length,W=_[0].length,he=0;he<W;he++){for(P=new Array(K),se=0;se<K;se++)P[se]=_[se][he];ae.push(P)}return ae.length===1?ae[0]:ae},M.map=function(_,P,K){var W,se,he,ae,we;for(w(_[0])||(_=[_]),se=_.length,he=_[0].length,ae=K?_:new Array(se),W=0;W<se;W++)for(ae[W]||(ae[W]=new Array(he)),we=0;we<he;we++)ae[W][we]=P(_[W][we],W,we);return ae.length===1?ae[0]:ae},M.cumreduce=function(_,P,K){var W,se,he,ae,we;for(w(_[0])||(_=[_]),se=_.length,he=_[0].length,ae=K?_:new Array(se),W=0;W<se;W++)for(ae[W]||(ae[W]=new Array(he)),he>0&&(ae[W][0]=_[W][0]),we=1;we<he;we++)ae[W][we]=P(ae[W][we-1],_[W][we]);return ae.length===1?ae[0]:ae},M.alter=function(_,P){return M.map(_,P,!0)},M.create=function(_,P,K){var W,se,he=new Array(_);for(j(P)&&(K=P,P=_),W=0;W<_;W++)for(he[W]=new Array(P),se=0;se<P;se++)he[W][se]=K(W,se);return he},M.zeros=function(_,P){return b(P)||(P=_),M.create(_,P,A)},M.ones=function(_,P){return b(P)||(P=_),M.create(_,P,O)},M.rand=function(_,P){return b(P)||(P=_),M.create(_,P,M._random_fn)},M.identity=function(_,P){return b(P)||(P=_),M.create(_,P,F)},M.symmetric=function(_){var P,K,W=_.length;if(_.length!==_[0].length)return!1;for(P=0;P<W;P++)for(K=0;K<W;K++)if(_[K][P]!==_[P][K])return!1;return!0},M.clear=function(_){return M.alter(_,A)},M.seq=function(_,P,K,W){j(W)||(W=!1);var se,he=[],ae=p(_,P),we=(P*ae-_*ae)/((K-1)*ae),Me=_;for(se=0;Me<=P&&se<K;Me=(_*ae+we*ae*++se)/ae)he.push(W?W(Me,se):Me);return he},M.arange=function(_,P,K){var W,se=[];if(K=K||1,P===g&&(P=_,_=0),_===P||K===0)return[];if(_<P&&K<0)return[];if(_>P&&K>0)return[];if(K>0)for(W=_;W<P;W+=K)se.push(W);else for(W=_;W>P;W+=K)se.push(W);return se},M.slice=function(){function _(P,K,W,se){var he,ae=[],we=P.length;if(K===g&&W===g&&se===g)return M.copy(P);if(se=se||1,(K=(K=K||0)>=0?K:we+K)===(W=(W=W||P.length)>=0?W:we+W)||se===0)return[];if(K<W&&se<0)return[];if(K>W&&se>0)return[];if(se>0)for(he=K;he<W;he+=se)ae.push(P[he]);else for(he=K;he>W;he+=se)ae.push(P[he]);return ae}return function(P,K){var W,se;return b((K=K||{}).row)?b(K.col)?P[K.row][K.col]:_(M.rowa(P,K.row),(W=K.col||{}).start,W.end,W.step):b(K.col)?_(M.cola(P,K.col),(se=K.row||{}).start,se.end,se.step):(se=K.row||{},W=K.col||{},_(P,se.start,se.end,se.step).map(function(he){return _(he,W.start,W.end,W.step)}))}}(),M.sliceAssign=function(_,P,K){var W,se;if(b(P.row)){if(b(P.col))return _[P.row][P.col]=K;P.col=P.col||{},P.col.start=P.col.start||0,P.col.end=P.col.end||_[0].length,P.col.step=P.col.step||1,W=M.arange(P.col.start,c.min(_.length,P.col.end),P.col.step);var he=P.row;return W.forEach(function(we,Me){_[he][we]=K[Me]}),_}if(b(P.col)){P.row=P.row||{},P.row.start=P.row.start||0,P.row.end=P.row.end||_.length,P.row.step=P.row.step||1,se=M.arange(P.row.start,c.min(_[0].length,P.row.end),P.row.step);var ae=P.col;return se.forEach(function(we,Me){_[we][ae]=K[Me]}),_}return K[0].length===g&&(K=[K]),P.row.start=P.row.start||0,P.row.end=P.row.end||_.length,P.row.step=P.row.step||1,P.col.start=P.col.start||0,P.col.end=P.col.end||_[0].length,P.col.step=P.col.step||1,se=M.arange(P.row.start,c.min(_.length,P.row.end),P.row.step),W=M.arange(P.col.start,c.min(_[0].length,P.col.end),P.col.step),se.forEach(function(we,Me){W.forEach(function(be,ie){_[we][be]=K[Me][ie]})}),_},M.diagonal=function(_){var P=M.zeros(_.length,_.length);return _.forEach(function(K,W){P[W][W]=K}),P},M.copy=function(_){return _.map(function(P){return b(P)?P:P.map(function(K){return K})})};var V=M.prototype;return V.length=0,V.push=Array.prototype.push,V.sort=Array.prototype.sort,V.splice=Array.prototype.splice,V.slice=Array.prototype.slice,V.toArray=function(){return this.length>1?I.call(this):I.call(this)[0]},V.map=function(_,P){return M(M.map(this,_,P))},V.cumreduce=function(_,P){return M(M.cumreduce(this,_,P))},V.alter=function(_){return M.alter(this,_),this},function(_){for(var P=0;P<_.length;P++)(function(K){V[K]=function(W){var se,he=this;return W?(setTimeout(function(){W.call(he,V[K].call(he))}),this):(se=M[K](this),w(se)?M(se):se)}})(_[P])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(_){for(var P=0;P<_.length;P++)(function(K){V[K]=function(W,se){var he=this;return se?(setTimeout(function(){se.call(he,V[K].call(he,W))}),this):M(M[K](this,W))}})(_[P])}("row col".split(" ")),function(_){for(var P=0;P<_.length;P++)(function(K){V[K]=function(){return M(M[K].apply(null,arguments))}})(_[P])}("create zeros ones rand identity".split(" ")),M}(Math),function(c,g){var D=c.utils.isFunction;function I(w,j){return w-j}function v(w,j,b){return g.max(j,g.min(w,b))}c.sum=function(w){for(var j=0,b=w.length;--b>=0;)j+=w[b];return j},c.sumsqrd=function(w){for(var j=0,b=w.length;--b>=0;)j+=w[b]*w[b];return j},c.sumsqerr=function(w){for(var j,b=c.mean(w),M=0,A=w.length;--A>=0;)M+=(j=w[A]-b)*j;return M},c.sumrow=function(w){for(var j=0,b=w.length;--b>=0;)j+=w[b];return j},c.product=function(w){for(var j=1,b=w.length;--b>=0;)j*=w[b];return j},c.min=function(w){for(var j=w[0],b=0;++b<w.length;)w[b]<j&&(j=w[b]);return j},c.max=function(w){for(var j=w[0],b=0;++b<w.length;)w[b]>j&&(j=w[b]);return j},c.unique=function(w){for(var j={},b=[],M=0;M<w.length;M++)j[w[M]]||(j[w[M]]=!0,b.push(w[M]));return b},c.mean=function(w){return c.sum(w)/w.length},c.meansqerr=function(w){return c.sumsqerr(w)/w.length},c.geomean=function(w){var j=w.map(g.log),b=c.mean(j);return g.exp(b)},c.median=function(w){var j=w.length,b=w.slice().sort(I);return 1&j?b[j/2|0]:(b[j/2-1]+b[j/2])/2},c.cumsum=function(w){return c.cumreduce(w,function(j,b){return j+b})},c.cumprod=function(w){return c.cumreduce(w,function(j,b){return j*b})},c.diff=function(w){var j,b=[],M=w.length;for(j=1;j<M;j++)b.push(w[j]-w[j-1]);return b},c.rank=function(w){var j,b=[],M={};for(j=0;j<w.length;j++)M[V=w[j]]?M[V]++:(M[V]=1,b.push(V));var A=b.sort(I),O={},F=1;for(j=0;j<A.length;j++){var V,_=M[V=A[j]],P=(F+(F+_-1))/2;O[V]=P,F+=_}return w.map(function(K){return O[K]})},c.mode=function(w){var j,b=w.length,M=w.slice().sort(I),A=1,O=0,F=0,V=[];for(j=0;j<b;j++)M[j]===M[j+1]?A++:(A>O?(V=[M[j]],O=A,F=0):A===O&&(V.push(M[j]),F++),A=1);return F===0?V[0]:V},c.range=function(w){return c.max(w)-c.min(w)},c.variance=function(w,j){return c.sumsqerr(w)/(w.length-(j?1:0))},c.pooledvariance=function(w){return w.reduce(function(j,b){return j+c.sumsqerr(b)},0)/(w.reduce(function(j,b){return j+b.length},0)-w.length)},c.deviation=function(w){for(var j=c.mean(w),b=w.length,M=new Array(b),A=0;A<b;A++)M[A]=w[A]-j;return M},c.stdev=function(w,j){return g.sqrt(c.variance(w,j))},c.pooledstdev=function(w){return g.sqrt(c.pooledvariance(w))},c.meandev=function(w){for(var j=c.mean(w),b=[],M=w.length-1;M>=0;M--)b.push(g.abs(w[M]-j));return c.mean(b)},c.meddev=function(w){for(var j=c.median(w),b=[],M=w.length-1;M>=0;M--)b.push(g.abs(w[M]-j));return c.median(b)},c.coeffvar=function(w){return c.stdev(w)/c.mean(w)},c.quartiles=function(w){var j=w.length,b=w.slice().sort(I);return[b[g.round(j/4)-1],b[g.round(j/2)-1],b[g.round(3*j/4)-1]]},c.quantiles=function(w,j,b,M){var A,O,F,V,_,P=w.slice().sort(I),K=[j.length],W=w.length;for(b===void 0&&(b=.375),M===void 0&&(M=.375),A=0;A<j.length;A++)F=W*(O=j[A])+(b+O*(1-b-M)),V=g.floor(v(F,1,W-1)),_=v(F-V,0,1),K[A]=(1-_)*P[V-1]+_*P[V];return K},c.percentile=function(w,j,b){var M=w.slice().sort(I),A=j*(M.length+(b?1:-1))+(b?0:1),O=parseInt(A),F=A-O;return O+1<M.length?M[O-1]+F*(M[O]-M[O-1]):M[O-1]},c.percentileOfScore=function(w,j,b){var M,A,O=0,F=w.length,V=!1;for(b==="strict"&&(V=!0),A=0;A<F;A++)M=w[A],(V&&M<j||!V&&M<=j)&&O++;return O/F},c.histogram=function(w,j){j=j||4;var b,M=c.min(w),A=(c.max(w)-M)/j,O=w.length,F=[];for(b=0;b<j;b++)F[b]=0;for(b=0;b<O;b++)F[g.min(g.floor((w[b]-M)/A),j-1)]+=1;return F},c.covariance=function(w,j){var b,M=c.mean(w),A=c.mean(j),O=w.length,F=new Array(O);for(b=0;b<O;b++)F[b]=(w[b]-M)*(j[b]-A);return c.sum(F)/(O-1)},c.corrcoeff=function(w,j){return c.covariance(w,j)/c.stdev(w,1)/c.stdev(j,1)},c.spearmancoeff=function(w,j){return w=c.rank(w),j=c.rank(j),c.corrcoeff(w,j)},c.stanMoment=function(w,j){for(var b=c.mean(w),M=c.stdev(w),A=w.length,O=0,F=0;F<A;F++)O+=g.pow((w[F]-b)/M,j);return O/w.length},c.skewness=function(w){return c.stanMoment(w,3)},c.kurtosis=function(w){return c.stanMoment(w,4)-3};var p=c.prototype;(function(w){for(var j=0;j<w.length;j++)(function(b){p[b]=function(M,A){var O=[],F=0,V=this;if(D(M)&&(A=M,M=!1),A)return setTimeout(function(){A.call(V,p[b].call(V,M))}),this;if(this.length>1){for(V=M===!0?this:this.transpose();F<V.length;F++)O[F]=c[b](V[F]);return O}return c[b](this[0],M)}})(w[j])})("cumsum cumprod".split(" ")),function(w){for(var j=0;j<w.length;j++)(function(b){p[b]=function(M,A){var O=[],F=0,V=this;if(D(M)&&(A=M,M=!1),A)return setTimeout(function(){A.call(V,p[b].call(V,M))}),this;if(this.length>1){for(b!=="sumrow"&&(V=M===!0?this:this.transpose());F<V.length;F++)O[F]=c[b](V[F]);return M===!0?c[b](c.utils.toVector(O)):O}return c[b](this[0],M)}})(w[j])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(w){for(var j=0;j<w.length;j++)(function(b){p[b]=function(){var M,A=[],O=0,F=this,V=Array.prototype.slice.call(arguments);if(D(V[V.length-1])){M=V[V.length-1];var _=V.slice(0,V.length-1);return setTimeout(function(){M.call(F,p[b].apply(F,_))}),this}M=void 0;var P=function(K){return c[b].apply(F,[K].concat(V))};if(this.length>1){for(F=F.transpose();O<F.length;O++)A[O]=P(F[O]);return A}return P(this[0])}})(w[j])}("quantiles percentileOfScore".split(" "))}(u,Math),function(c,g){c.gammaln=function(D){var I,v,p,w=0,j=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],b=1.000000000190015;for(p=(v=I=D)+5.5,p-=(I+.5)*g.log(p);w<6;w++)b+=j[w]/++v;return g.log(2.5066282746310007*b/I)-p},c.loggam=function(D){var I,v,p,w,j,b,M,A=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(I=D,M=0,D==1||D==2)return 0;for(D<=7&&(I=D+(M=g.floor(7-D))),v=1/(I*I),p=2*g.PI,j=A[9],b=8;b>=0;b--)j*=v,j+=A[b];if(w=j/I+.5*g.log(p)+(I-.5)*g.log(I)-I,D<=7)for(b=1;b<=M;b++)w-=g.log(I-1),I-=1;return w},c.gammafn=function(D){var I,v,p,w,j=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],b=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],M=!1,A=0,O=0,F=0,V=D;if(D>171.6243769536076)return 1/0;if(V<=0){if(!(w=V%1+36e-17))return 1/0;M=(1&V?-1:1)*g.PI/g.sin(g.PI*w),V=1-V}for(p=V,v=V<1?V++:(V-=A=(0|V)-1)-1,I=0;I<8;++I)F=(F+j[I])*v,O=O*v+b[I];if(w=F/O+1,p<V)w/=p;else if(p>V)for(I=0;I<A;++I)w*=V,V++;return M&&(w=M/w),w},c.gammap=function(D,I){return c.lowRegGamma(D,I)*c.gammafn(D)},c.lowRegGamma=function(D,I){var v,p=c.gammaln(D),w=D,j=1/D,b=j,M=I+1-D,A=1/1e-30,O=1/M,F=O,V=1,_=-~(8.5*g.log(D>=1?D:1/D)+.4*D+17);if(I<0||D<=0)return NaN;if(I<D+1){for(;V<=_;V++)j+=b*=I/++w;return j*g.exp(-I+D*g.log(I)-p)}for(;V<=_;V++)F*=(O=1/(O=(v=-V*(V-D))*O+(M+=2)))*(A=M+v/A);return 1-F*g.exp(-I+D*g.log(I)-p)},c.factorialln=function(D){return D<0?NaN:c.gammaln(D+1)},c.factorial=function(D){return D<0?NaN:c.gammafn(D+1)},c.combination=function(D,I){return D>170||I>170?g.exp(c.combinationln(D,I)):c.factorial(D)/c.factorial(I)/c.factorial(D-I)},c.combinationln=function(D,I){return c.factorialln(D)-c.factorialln(I)-c.factorialln(D-I)},c.permutation=function(D,I){return c.factorial(D)/c.factorial(D-I)},c.betafn=function(D,I){if(!(D<=0||I<=0))return D+I>170?g.exp(c.betaln(D,I)):c.gammafn(D)*c.gammafn(I)/c.gammafn(D+I)},c.betaln=function(D,I){return c.gammaln(D)+c.gammaln(I)-c.gammaln(D+I)},c.betacf=function(D,I,v){var p,w,j,b,M=1e-30,A=1,O=I+v,F=I+1,V=I-1,_=1,P=1-O*D/F;for(g.abs(P)<M&&(P=M),b=P=1/P;A<=100&&(P=1+(w=A*(v-A)*D/((V+(p=2*A))*(I+p)))*P,g.abs(P)<M&&(P=M),_=1+w/_,g.abs(_)<M&&(_=M),b*=(P=1/P)*_,P=1+(w=-(I+A)*(O+A)*D/((I+p)*(F+p)))*P,g.abs(P)<M&&(P=M),_=1+w/_,g.abs(_)<M&&(_=M),b*=j=(P=1/P)*_,!(g.abs(j-1)<3e-7));A++);return b},c.gammapinv=function(D,I){var v,p,w,j,b,M,A=0,O=I-1,F=c.gammaln(I);if(D>=1)return g.max(100,I+100*g.sqrt(I));if(D<=0)return 0;for(I>1?(b=g.log(O),M=g.exp(O*(b-1)-F),j=D<.5?D:1-D,v=(2.30753+.27061*(p=g.sqrt(-2*g.log(j))))/(1+p*(.99229+.04481*p))-p,D<.5&&(v=-v),v=g.max(.001,I*g.pow(1-1/(9*I)-v/(3*g.sqrt(I)),3))):v=D<(p=1-I*(.253+.12*I))?g.pow(D/p,1/I):1-g.log(1-(D-p)/(1-p));A<12;A++){if(v<=0)return 0;if((v-=p=(w=(c.lowRegGamma(I,v)-D)/(p=I>1?M*g.exp(-(v-O)+O*(g.log(v)-b)):g.exp(-v+O*g.log(v)-F)))/(1-.5*g.min(1,w*((I-1)/v-1))))<=0&&(v=.5*(v+p)),g.abs(p)<1e-8*v)break}return v},c.erf=function(D){var I,v,p,w,j=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],b=j.length-1,M=!1,A=0,O=0;for(D<0&&(D=-D,M=!0),v=4*(I=2/(2+D))-2;b>0;b--)p=A,A=v*A-O+j[b],O=p;return w=I*g.exp(-D*D+.5*(j[0]+v*A)-O),M?w-1:1-w},c.erfc=function(D){return 1-c.erf(D)},c.erfcinv=function(D){var I,v,p,w,j=0;if(D>=2)return-100;if(D<=0)return 100;for(w=D<1?D:2-D,I=-.70711*((2.30753+.27061*(p=g.sqrt(-2*g.log(w/2))))/(1+p*(.99229+.04481*p))-p);j<2;j++)I+=(v=c.erfc(I)-w)/(1.1283791670955126*g.exp(-I*I)-I*v);return D<1?I:-I},c.ibetainv=function(D,I,v){var p,w,j,b,M,A,O,F,V,_,P=I-1,K=v-1,W=0;if(D<=0)return 0;if(D>=1)return 1;for(I>=1&&v>=1?(j=D<.5?D:1-D,A=(2.30753+.27061*(b=g.sqrt(-2*g.log(j))))/(1+b*(.99229+.04481*b))-b,D<.5&&(A=-A),O=(A*A-3)/6,F=2/(1/(2*I-1)+1/(2*v-1)),V=A*g.sqrt(O+F)/F-(1/(2*v-1)-1/(2*I-1))*(O+.8333333333333334-2/(3*F)),A=I/(I+v*g.exp(2*V))):(p=g.log(I/(I+v)),w=g.log(v/(I+v)),A=D<(b=g.exp(I*p)/I)/(V=b+(M=g.exp(v*w)/v))?g.pow(I*V*D,1/I):1-g.pow(v*V*(1-D),1/v)),_=-c.gammaln(I)-c.gammaln(v)+c.gammaln(I+v);W<10;W++){if(A===0||A===1)return A;if((A-=b=(M=(c.ibeta(A,I,v)-D)/(b=g.exp(P*g.log(A)+K*g.log(1-A)+_)))/(1-.5*g.min(1,M*(P/A-K/(1-A)))))<=0&&(A=.5*(A+b)),A>=1&&(A=.5*(A+b+1)),g.abs(b)<1e-8*A&&W>0)break}return A},c.ibeta=function(D,I,v){var p=D===0||D===1?0:g.exp(c.gammaln(I+v)-c.gammaln(I)-c.gammaln(v)+I*g.log(D)+v*g.log(1-D));return!(D<0||D>1)&&(D<(I+1)/(I+v+2)?p*c.betacf(D,I,v)/I:1-p*c.betacf(1-D,v,I)/v)},c.randn=function(D,I){var v,p,w,j,b;if(I||(I=D),D)return c.create(D,I,function(){return c.randn()});do v=c._random_fn(),p=1.7156*(c._random_fn()-.5),b=(w=v-.449871)*w+(j=g.abs(p)+.386595)*(.196*j-.25472*w);while(b>.27597&&(b>.27846||p*p>-4*g.log(v)*v*v));return p/v},c.randg=function(D,I,v){var p,w,j,b,M,A,O=D;if(v||(v=I),D||(D=1),I)return(A=c.zeros(I,v)).alter(function(){return c.randg(D)}),A;D<1&&(D+=1),p=D-.3333333333333333,w=1/g.sqrt(9*p);do{do b=1+w*(M=c.randn());while(b<=0);b*=b*b,j=c._random_fn()}while(j>1-.331*g.pow(M,4)&&g.log(j)>.5*M*M+p*(1-b+g.log(b)));if(D==O)return p*b;do j=c._random_fn();while(j===0);return g.pow(j,1/O)*p*b},function(D){for(var I=0;I<D.length;I++)(function(v){c.fn[v]=function(){return c(c.map(this,function(p){return c[v](p)}))}})(D[I])}("gammaln gammafn factorial factorialln".split(" ")),function(D){for(var I=0;I<D.length;I++)(function(v){c.fn[v]=function(){return c(c[v].apply(null,arguments))}})(D[I])}("randn".split(" "))}(u,Math),function(c,g){function D(v,p,w,j){for(var b,M=0,A=1,O=1,F=1,V=0,_=0;g.abs((O-_)/O)>j;)_=O,A=F+(b=-(p+V)*(p+w+V)*v/(p+2*V)/(p+2*V+1))*A,O=(M=O+b*M)+(b=(V+=1)*(w-V)*v/(p+2*V-1)/(p+2*V))*O,M/=F=A+b*F,A/=F,O/=F,F=1;return O/p}function I(v,p,w){var j=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],b=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],M=.5*v;if(M>=8)return 1;var A,O=2*c.normal.cdf(M,0,1,1,0)-1;O=O>=g.exp(-50/w)?g.pow(O,w):0;for(var F=M,V=(8-M)/(A=v>3?2:3),_=F+V,P=0,K=w-1,W=1;W<=A;W++){for(var se=0,he=.5*(_+F),ae=.5*(_-F),we=1;we<=12;we++){var Me,be=he+ae*(6<we?j[(Me=12-we+1)-1]:-j[(Me=we)-1]),ie=be*be;if(ie>60)break;var ze=2*c.normal.cdf(be,0,1,1,0)*.5-2*c.normal.cdf(be,v,1,1,0)*.5;ze>=g.exp(-30/K)&&(se+=ze=b[Me-1]*g.exp(-.5*ie)*g.pow(ze,K))}P+=se*=2*ae*w/g.sqrt(2*g.PI),F=_,_+=V}return(O+=P)<=g.exp(-30/p)?0:(O=g.pow(O,p))>=1?1:O}(function(v){for(var p=0;p<v.length;p++)(function(w){c[w]=function j(b,M,A){return this instanceof j?(this._a=b,this._b=M,this._c=A,this):new j(b,M,A)},c.fn[w]=function(j,b,M){var A=c[w](j,b,M);return A.data=this,A},c[w].prototype.sample=function(j){var b=this._a,M=this._b,A=this._c;return j?c.alter(j,function(){return c[w].sample(b,M,A)}):c[w].sample(b,M,A)},function(j){for(var b=0;b<j.length;b++)(function(M){c[w].prototype[M]=function(A){var O=this._a,F=this._b,V=this._c;return A||A===0||(A=this.data),typeof A!="number"?c.fn.map.call(A,function(_){return c[w][M](_,O,F,V)}):c[w][M](A,O,F,V)}})(j[b])}("pdf cdf inv".split(" ")),function(j){for(var b=0;b<j.length;b++)(function(M){c[w].prototype[M]=function(){return c[w][M](this._a,this._b,this._c)}})(j[b])}("mean median mode variance".split(" "))})(v[p])})("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),c.extend(c.beta,{pdf:function(v,p,w){return v>1||v<0?0:p==1&&w==1?1:p<512&&w<512?g.pow(v,p-1)*g.pow(1-v,w-1)/c.betafn(p,w):g.exp((p-1)*g.log(v)+(w-1)*g.log(1-v)-c.betaln(p,w))},cdf:function(v,p,w){return v>1||v<0?1*(v>1):c.ibeta(v,p,w)},inv:function(v,p,w){return c.ibetainv(v,p,w)},mean:function(v,p){return v/(v+p)},median:function(v,p){return c.ibetainv(.5,v,p)},mode:function(v,p){return(v-1)/(v+p-2)},sample:function(v,p){var w=c.randg(v);return w/(w+c.randg(p))},variance:function(v,p){return v*p/(g.pow(v+p,2)*(v+p+1))}}),c.extend(c.centralF,{pdf:function(v,p,w){var j;return v<0?0:p<=2?v===0&&p<2?1/0:v===0&&p===2?1:1/c.betafn(p/2,w/2)*g.pow(p/w,p/2)*g.pow(v,p/2-1)*g.pow(1+p/w*v,-(p+w)/2):(j=p*v/(w+v*p),p*(w/(w+v*p))/2*c.binomial.pdf((p-2)/2,(p+w-2)/2,j))},cdf:function(v,p,w){return v<0?0:c.ibeta(p*v/(p*v+w),p/2,w/2)},inv:function(v,p,w){return w/(p*(1/c.ibetainv(v,p/2,w/2)-1))},mean:function(v,p){return p>2?p/(p-2):void 0},mode:function(v,p){return v>2?p*(v-2)/(v*(p+2)):void 0},sample:function(v,p){return 2*c.randg(v/2)/v/(2*c.randg(p/2)/p)},variance:function(v,p){if(!(p<=4))return 2*p*p*(v+p-2)/(v*(p-2)*(p-2)*(p-4))}}),c.extend(c.cauchy,{pdf:function(v,p,w){return w<0?0:w/(g.pow(v-p,2)+g.pow(w,2))/g.PI},cdf:function(v,p,w){return g.atan((v-p)/w)/g.PI+.5},inv:function(v,p,w){return p+w*g.tan(g.PI*(v-.5))},median:function(v){return v},mode:function(v){return v},sample:function(v,p){return c.randn()*g.sqrt(1/(2*c.randg(.5)))*p+v}}),c.extend(c.chisquare,{pdf:function(v,p){return v<0?0:v===0&&p===2?.5:g.exp((p/2-1)*g.log(v)-v/2-p/2*g.log(2)-c.gammaln(p/2))},cdf:function(v,p){return v<0?0:c.lowRegGamma(p/2,v/2)},inv:function(v,p){return 2*c.gammapinv(v,.5*p)},mean:function(v){return v},median:function(v){return v*g.pow(1-2/(9*v),3)},mode:function(v){return v-2>0?v-2:0},sample:function(v){return 2*c.randg(v/2)},variance:function(v){return 2*v}}),c.extend(c.exponential,{pdf:function(v,p){return v<0?0:p*g.exp(-p*v)},cdf:function(v,p){return v<0?0:1-g.exp(-p*v)},inv:function(v,p){return-g.log(1-v)/p},mean:function(v){return 1/v},median:function(v){return 1/v*g.log(2)},mode:function(){return 0},sample:function(v){return-1/v*g.log(c._random_fn())},variance:function(v){return g.pow(v,-2)}}),c.extend(c.gamma,{pdf:function(v,p,w){return v<0?0:v===0&&p===1?1/w:g.exp((p-1)*g.log(v)-v/w-c.gammaln(p)-p*g.log(w))},cdf:function(v,p,w){return v<0?0:c.lowRegGamma(p,v/w)},inv:function(v,p,w){return c.gammapinv(v,p)*w},mean:function(v,p){return v*p},mode:function(v,p){if(v>1)return(v-1)*p},sample:function(v,p){return c.randg(v)*p},variance:function(v,p){return v*p*p}}),c.extend(c.invgamma,{pdf:function(v,p,w){return v<=0?0:g.exp(-(p+1)*g.log(v)-w/v-c.gammaln(p)+p*g.log(w))},cdf:function(v,p,w){return v<=0?0:1-c.lowRegGamma(p,w/v)},inv:function(v,p,w){return w/c.gammapinv(1-v,p)},mean:function(v,p){return v>1?p/(v-1):void 0},mode:function(v,p){return p/(v+1)},sample:function(v,p){return p/c.randg(v)},variance:function(v,p){if(!(v<=2))return p*p/((v-1)*(v-1)*(v-2))}}),c.extend(c.kumaraswamy,{pdf:function(v,p,w){return v===0&&p===1?w:v===1&&w===1?p:g.exp(g.log(p)+g.log(w)+(p-1)*g.log(v)+(w-1)*g.log(1-g.pow(v,p)))},cdf:function(v,p,w){return v<0?0:v>1?1:1-g.pow(1-g.pow(v,p),w)},inv:function(v,p,w){return g.pow(1-g.pow(1-v,1/w),1/p)},mean:function(v,p){return p*c.gammafn(1+1/v)*c.gammafn(p)/c.gammafn(1+1/v+p)},median:function(v,p){return g.pow(1-g.pow(2,-1/p),1/v)},mode:function(v,p){if(v>=1&&p>=1&&v!==1&&p!==1)return g.pow((v-1)/(v*p-1),1/v)},variance:function(){throw new Error("variance not yet implemented")}}),c.extend(c.lognormal,{pdf:function(v,p,w){return v<=0?0:g.exp(-g.log(v)-.5*g.log(2*g.PI)-g.log(w)-g.pow(g.log(v)-p,2)/(2*w*w))},cdf:function(v,p,w){return v<0?0:.5+.5*c.erf((g.log(v)-p)/g.sqrt(2*w*w))},inv:function(v,p,w){return g.exp(-1.4142135623730951*w*c.erfcinv(2*v)+p)},mean:function(v,p){return g.exp(v+p*p/2)},median:function(v){return g.exp(v)},mode:function(v,p){return g.exp(v-p*p)},sample:function(v,p){return g.exp(c.randn()*p+v)},variance:function(v,p){return(g.exp(p*p)-1)*g.exp(2*v+p*p)}}),c.extend(c.noncentralt,{pdf:function(v,p,w){return g.abs(w)<1e-14?c.studentt.pdf(v,p):g.abs(v)<1e-14?g.exp(c.gammaln((p+1)/2)-w*w/2-.5*g.log(g.PI*p)-c.gammaln(p/2)):p/v*(c.noncentralt.cdf(v*g.sqrt(1+2/p),p+2,w)-c.noncentralt.cdf(v,p,w))},cdf:function(v,p,w){var j=1e-14;if(g.abs(w)<j)return c.studentt.cdf(v,p);var b=!1;v<0&&(b=!0,w=-w);for(var M=c.normal.cdf(-w,0,1),A=j+1,O=A,F=v*v/(v*v+p),V=0,_=g.exp(-w*w/2),P=g.exp(-w*w/2-.5*g.log(2)-c.gammaln(1.5))*w;V<200||O>j||A>j;)O=A,V>0&&(_*=w*w/(2*V),P*=w*w/(2*(V+.5))),M+=.5*(A=_*c.beta.cdf(F,V+.5,p/2)+P*c.beta.cdf(F,V+1,p/2)),V++;return b?1-M:M}}),c.extend(c.normal,{pdf:function(v,p,w){return g.exp(-.5*g.log(2*g.PI)-g.log(w)-g.pow(v-p,2)/(2*w*w))},cdf:function(v,p,w){return .5*(1+c.erf((v-p)/g.sqrt(2*w*w)))},inv:function(v,p,w){return-1.4142135623730951*w*c.erfcinv(2*v)+p},mean:function(v){return v},median:function(v){return v},mode:function(v){return v},sample:function(v,p){return c.randn()*p+v},variance:function(v,p){return p*p}}),c.extend(c.pareto,{pdf:function(v,p,w){return v<p?0:w*g.pow(p,w)/g.pow(v,w+1)},cdf:function(v,p,w){return v<p?0:1-g.pow(p/v,w)},inv:function(v,p,w){return p/g.pow(1-v,1/w)},mean:function(v,p){if(!(p<=1))return p*g.pow(v,p)/(p-1)},median:function(v,p){return v*(p*g.SQRT2)},mode:function(v){return v},variance:function(v,p){if(!(p<=2))return v*v*p/(g.pow(p-1,2)*(p-2))}}),c.extend(c.studentt,{pdf:function(v,p){return p=p>1e100?1e100:p,1/(g.sqrt(p)*c.betafn(.5,p/2))*g.pow(1+v*v/p,-(p+1)/2)},cdf:function(v,p){var w=p/2;return c.ibeta((v+g.sqrt(v*v+p))/(2*g.sqrt(v*v+p)),w,w)},inv:function(v,p){var w=c.ibetainv(2*g.min(v,1-v),.5*p,.5);return w=g.sqrt(p*(1-w)/w),v>.5?w:-w},mean:function(v){return v>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(v){return c.randn()*g.sqrt(v/(2*c.randg(v/2)))},variance:function(v){return v>2?v/(v-2):v>1?1/0:void 0}}),c.extend(c.weibull,{pdf:function(v,p,w){return v<0||p<0||w<0?0:w/p*g.pow(v/p,w-1)*g.exp(-g.pow(v/p,w))},cdf:function(v,p,w){return v<0?0:1-g.exp(-g.pow(v/p,w))},inv:function(v,p,w){return p*g.pow(-g.log(1-v),1/w)},mean:function(v,p){return v*c.gammafn(1+1/p)},median:function(v,p){return v*g.pow(g.log(2),1/p)},mode:function(v,p){return p<=1?0:v*g.pow((p-1)/p,1/p)},sample:function(v,p){return v*g.pow(-g.log(c._random_fn()),1/p)},variance:function(v,p){return v*v*c.gammafn(1+2/p)-g.pow(c.weibull.mean(v,p),2)}}),c.extend(c.uniform,{pdf:function(v,p,w){return v<p||v>w?0:1/(w-p)},cdf:function(v,p,w){return v<p?0:v<w?(v-p)/(w-p):1},inv:function(v,p,w){return p+v*(w-p)},mean:function(v,p){return .5*(v+p)},median:function(v,p){return c.mean(v,p)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(v,p){return v/2+p/2+(p/2-v/2)*(2*c._random_fn()-1)},variance:function(v,p){return g.pow(p-v,2)/12}}),c.extend(c.binomial,{pdf:function(v,p,w){return w===0||w===1?p*w===v?1:0:c.combination(p,v)*g.pow(w,v)*g.pow(1-w,p-v)},cdf:function(v,p,w){var j,b=1e-10;if(v<0)return 0;if(v>=p)return 1;if(w<0||w>1||p<=0)return NaN;var M=w,A=(v=g.floor(v))+1,O=p-v,F=A+O,V=g.exp(c.gammaln(F)-c.gammaln(O)-c.gammaln(A)+A*g.log(M)+O*g.log(1-M));return j=M<(A+1)/(F+2)?V*D(M,A,O,b):1-V*D(1-M,O,A,b),g.round(1/b*(1-j))/(1/b)}}),c.extend(c.negbin,{pdf:function(v,p,w){return v===v>>>0&&(v<0?0:c.combination(v+p-1,p-1)*g.pow(1-w,v)*g.pow(w,p))},cdf:function(v,p,w){var j=0,b=0;if(v<0)return 0;for(;b<=v;b++)j+=c.negbin.pdf(b,p,w);return j}}),c.extend(c.hypgeom,{pdf:function(v,p,w,j){if(v!=v|0)return!1;if(v<0||v<w-(p-j)||v>j||v>w)return 0;if(2*w>p)return 2*j>p?c.hypgeom.pdf(p-w-j+v,p,p-w,p-j):c.hypgeom.pdf(j-v,p,p-w,j);if(2*j>p)return c.hypgeom.pdf(w-v,p,w,p-j);if(w<j)return c.hypgeom.pdf(v,p,j,w);for(var b=1,M=0,A=0;A<v;A++){for(;b>1&&M<j;)b*=1-w/(p-M),M++;b*=(j-A)*(w-A)/((A+1)*(p-w-j+A+1))}for(;M<j;M++)b*=1-w/(p-M);return g.min(1,g.max(0,b))},cdf:function(v,p,w,j){if(v<0||v<w-(p-j))return 0;if(v>=j||v>=w)return 1;if(2*w>p)return 2*j>p?c.hypgeom.cdf(p-w-j+v,p,p-w,p-j):1-c.hypgeom.cdf(j-v-1,p,p-w,j);if(2*j>p)return 1-c.hypgeom.cdf(w-v-1,p,w,p-j);if(w<j)return c.hypgeom.cdf(v,p,j,w);for(var b=1,M=1,A=0,O=0;O<v;O++){for(;b>1&&A<j;){var F=1-w/(p-A);M*=F,b*=F,A++}b+=M*=(j-O)*(w-O)/((O+1)*(p-w-j+O+1))}for(;A<j;A++)b*=1-w/(p-A);return g.min(1,g.max(0,b))}}),c.extend(c.poisson,{pdf:function(v,p){return p<0||v%1!=0||v<0?0:g.pow(p,v)*g.exp(-p)/c.factorial(v)},cdf:function(v,p){var w=[],j=0;if(v<0)return 0;for(;j<=v;j++)w.push(c.poisson.pdf(j,p));return c.sum(w)},mean:function(v){return v},variance:function(v){return v},sampleSmall:function(v){var p=1,w=0,j=g.exp(-v);do w++,p*=c._random_fn();while(p>j);return w-1},sampleLarge:function(v){var p,w,j,b,M,A,O,F,V,_,P=v;for(b=g.sqrt(P),M=g.log(P),A=.02483*(O=.931+2.53*b)-.059,F=1.1239+1.1328/(O-3.4),V=.9277-3.6224/(O-2);;)if(w=g.random()-.5,j=g.random(),_=.5-g.abs(w),p=g.floor((2*A/_+O)*w+P+.43),_>=.07&&j<=V||!(p<0||_<.013&&j>_)&&g.log(j)+g.log(F)-g.log(A/(_*_)+O)<=p*M-P-c.loggam(p+1))return p},sample:function(v){return v<10?this.sampleSmall(v):this.sampleLarge(v)}}),c.extend(c.triangular,{pdf:function(v,p,w,j){return w<=p||j<p||j>w?NaN:v<p||v>w?0:v<j?2*(v-p)/((w-p)*(j-p)):v===j?2/(w-p):2*(w-v)/((w-p)*(w-j))},cdf:function(v,p,w,j){return w<=p||j<p||j>w?NaN:v<=p?0:v>=w?1:v<=j?g.pow(v-p,2)/((w-p)*(j-p)):1-g.pow(w-v,2)/((w-p)*(w-j))},inv:function(v,p,w,j){return w<=p||j<p||j>w?NaN:v<=(j-p)/(w-p)?p+(w-p)*g.sqrt(v*((j-p)/(w-p))):p+(w-p)*(1-g.sqrt((1-v)*(1-(j-p)/(w-p))))},mean:function(v,p,w){return(v+p+w)/3},median:function(v,p,w){return w<=(v+p)/2?p-g.sqrt((p-v)*(p-w))/g.sqrt(2):w>(v+p)/2?v+g.sqrt((p-v)*(w-v))/g.sqrt(2):void 0},mode:function(v,p,w){return w},sample:function(v,p,w){var j=c._random_fn();return j<(w-v)/(p-v)?v+g.sqrt(j*(p-v)*(w-v)):p-g.sqrt((1-j)*(p-v)*(p-w))},variance:function(v,p,w){return(v*v+p*p+w*w-v*p-v*w-p*w)/18}}),c.extend(c.arcsine,{pdf:function(v,p,w){return w<=p?NaN:v<=p||v>=w?0:2/g.PI*g.pow(g.pow(w-p,2)-g.pow(2*v-p-w,2),-.5)},cdf:function(v,p,w){return v<p?0:v<w?2/g.PI*g.asin(g.sqrt((v-p)/(w-p))):1},inv:function(v,p,w){return p+(.5-.5*g.cos(g.PI*v))*(w-p)},mean:function(v,p){return p<=v?NaN:(v+p)/2},median:function(v,p){return p<=v?NaN:(v+p)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(v,p){return(v+p)/2+(p-v)/2*g.sin(2*g.PI*c.uniform.sample(0,1))},variance:function(v,p){return p<=v?NaN:g.pow(p-v,2)/8}}),c.extend(c.laplace,{pdf:function(v,p,w){return w<=0?0:g.exp(-g.abs(v-p)/w)/(2*w)},cdf:function(v,p,w){return w<=0?0:v<p?.5*g.exp((v-p)/w):1-.5*g.exp(-(v-p)/w)},mean:function(v){return v},median:function(v){return v},mode:function(v){return v},variance:function(v,p){return 2*p*p},sample:function(v,p){var w,j=c._random_fn()-.5;return v-p*((w=j)/g.abs(w))*g.log(1-2*g.abs(j))}}),c.extend(c.tukey,{cdf:function(v,p,w){var j=p,b=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],M=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(v<=0)return 0;if(w<2||j<2)return NaN;if(!Number.isFinite(v))return 1;if(w>25e3)return I(v,1,j);var A,O=.5*w,F=O*g.log(w)-w*g.log(2)-c.gammaln(O),V=O-1,_=.25*w;A=w<=100?1:w<=800?.5:w<=5e3?.25:.125,F+=g.log(A);for(var P=0,K=1;K<=50;K++){for(var W=0,se=(2*K-1)*A,he=1;he<=16;he++){var ae,we;8<he?(ae=he-8-1,we=F+V*g.log(se+b[ae]*A)-(b[ae]*A+se)*_):(ae=he-1,we=F+V*g.log(se-b[ae]*A)+(b[ae]*A-se)*_),we>=-30&&(W+=I(8<he?v*g.sqrt(.5*(b[ae]*A+se)):v*g.sqrt(.5*(-b[ae]*A+se)),1,j)*M[ae]*g.exp(we))}if(K*A>=1&&W<=1e-14)break;P+=W}if(W>1e-14)throw new Error("tukey.cdf failed to converge");return P>1&&(P=1),P},inv:function(v,p,w){if(w<2||p<2)return NaN;if(v<0||v>1)return NaN;if(v===0)return 0;if(v===1)return 1/0;var j,b=function(V,_,P){var K=.5-.5*V,W=g.sqrt(g.log(1/(K*K))),se=W+((((-453642210148e-16*W-.204231210125)*W-.342242088547)*W-1)*W+.322232421088)/((((.0038560700634*W+.10353775285)*W+.531103462366)*W+.588581570495)*W+.099348462606);P<120&&(se+=(se*se*se+se)/P/4);var he=.8832-.2368*se;return P<120&&(he+=-1.214/P+1.208*se/P),se*(he*g.log(_-1)+1.4142)}(v,p,w),M=c.tukey.cdf(b,p,w)-v;j=M>0?g.max(0,b-1):b+1;for(var A,O=c.tukey.cdf(j,p,w)-v,F=1;F<50;F++)if(A=j-O*(j-b)/(O-M),M=O,b=j,A<0&&(A=0,O=-v),O=c.tukey.cdf(A,p,w)-v,j=A,g.abs(j-b)<1e-4)return A;throw new Error("tukey.inv failed to converge")}})}(u,Math),function(c,g){var D,I,v=Array.prototype.push,p=c.utils.isArray;function w(j){return p(j)||j instanceof c}c.extend({add:function(j,b){return w(b)?(w(b[0])||(b=[b]),c.map(j,function(M,A,O){return M+b[A][O]})):c.map(j,function(M){return M+b})},subtract:function(j,b){return w(b)?(w(b[0])||(b=[b]),c.map(j,function(M,A,O){return M-b[A][O]||0})):c.map(j,function(M){return M-b})},divide:function(j,b){return w(b)?(w(b[0])||(b=[b]),c.multiply(j,c.inv(b))):c.map(j,function(M){return M/b})},multiply:function(j,b){var M,A,O,F,V,_,P,K;if(j.length===void 0&&b.length===void 0)return j*b;if(V=j.length,_=j[0].length,P=c.zeros(V,O=w(b)?b[0].length:_),K=0,w(b)){for(;K<O;K++)for(M=0;M<V;M++){for(F=0,A=0;A<_;A++)F+=j[M][A]*b[A][K];P[M][K]=F}return V===1&&K===1?P[0][0]:P}return c.map(j,function(W){return W*b})},outer:function(j,b){return c.multiply(j.map(function(M){return[M]}),[b])},dot:function(j,b){w(j[0])||(j=[j]),w(b[0])||(b=[b]);for(var M,A,O=j[0].length===1&&j.length!==1?c.transpose(j):j,F=b[0].length===1&&b.length!==1?c.transpose(b):b,V=[],_=0,P=O.length,K=O[0].length;_<P;_++){for(V[_]=[],M=0,A=0;A<K;A++)M+=O[_][A]*F[_][A];V[_]=M}return V.length===1?V[0]:V},pow:function(j,b){return c.map(j,function(M){return g.pow(M,b)})},exp:function(j){return c.map(j,function(b){return g.exp(b)})},log:function(j){return c.map(j,function(b){return g.log(b)})},abs:function(j){return c.map(j,function(b){return g.abs(b)})},norm:function(j,b){var M=0,A=0;for(isNaN(b)&&(b=2),w(j[0])&&(j=j[0]);A<j.length;A++)M+=g.pow(g.abs(j[A]),b);return g.pow(M,1/b)},angle:function(j,b){return g.acos(c.dot(j,b)/(c.norm(j)*c.norm(b)))},aug:function(j,b){var M,A=[];for(M=0;M<j.length;M++)A.push(j[M].slice());for(M=0;M<A.length;M++)v.apply(A[M],b[M]);return A},inv:function(j){for(var b,M=j.length,A=j[0].length,O=c.identity(M,A),F=c.gauss_jordan(j,O),V=[],_=0;_<M;_++)for(V[_]=[],b=A;b<F[0].length;b++)V[_][b-A]=F[_][b];return V},det:function j(b){if(b.length===2)return b[0][0]*b[1][1]-b[0][1]*b[1][0];for(var M=0,A=0;A<b.length;A++){for(var O=[],F=1;F<b.length;F++){O[F-1]=[];for(var V=0;V<b.length;V++)V<A?O[F-1][V]=b[F][V]:V>A&&(O[F-1][V-1]=b[F][V])}var _=A%2?-1:1;M+=j(O)*b[0][A]*_}return M},gauss_elimination:function(j,b){var M,A,O,F,V=0,_=0,P=j.length,K=j[0].length,W=1,se=0,he=[];for(M=(j=c.aug(j,b))[0].length,V=0;V<P;V++){for(A=j[V][V],_=V,F=V+1;F<K;F++)A<g.abs(j[F][V])&&(A=j[F][V],_=F);if(_!=V)for(F=0;F<M;F++)O=j[V][F],j[V][F]=j[_][F],j[_][F]=O;for(_=V+1;_<P;_++)for(W=j[_][V]/j[V][V],F=V;F<M;F++)j[_][F]=j[_][F]-W*j[V][F]}for(V=P-1;V>=0;V--){for(se=0,_=V+1;_<=P-1;_++)se+=he[_]*j[V][_];he[V]=(j[V][M-1]-se)/j[V][V]}return he},gauss_jordan:function(j,b){var M,A,O,F=c.aug(j,b),V=F.length,_=F[0].length,P=0;for(A=0;A<V;A++){var K=A;for(O=A+1;O<V;O++)g.abs(F[O][A])>g.abs(F[K][A])&&(K=O);var W=F[A];for(F[A]=F[K],F[K]=W,O=A+1;O<V;O++)for(P=F[O][A]/F[A][A],M=A;M<_;M++)F[O][M]-=F[A][M]*P}for(A=V-1;A>=0;A--){for(P=F[A][A],O=0;O<A;O++)for(M=_-1;M>A-1;M--)F[O][M]-=F[A][M]*F[O][A]/P;for(F[A][A]/=P,M=V;M<_;M++)F[A][M]/=P}return F},triaUpSolve:function(j,b){var M,A=j[0].length,O=c.zeros(1,A)[0],F=!1;return b[0].length!=null&&(b=b.map(function(V){return V[0]}),F=!0),c.arange(A-1,-1,-1).forEach(function(V){M=c.arange(V+1,A).map(function(_){return O[_]*j[V][_]}),O[V]=(b[V]-c.sum(M))/j[V][V]}),F?O.map(function(V){return[V]}):O},triaLowSolve:function(j,b){var M,A=j[0].length,O=c.zeros(1,A)[0],F=!1;return b[0].length!=null&&(b=b.map(function(V){return V[0]}),F=!0),c.arange(A).forEach(function(V){M=c.arange(V).map(function(_){return j[V][_]*O[_]}),O[V]=(b[V]-c.sum(M))/j[V][V]}),F?O.map(function(V){return[V]}):O},lu:function(j){var b,M=j.length,A=c.identity(M),O=c.zeros(j.length,j[0].length);return c.arange(M).forEach(function(F){O[0][F]=j[0][F]}),c.arange(1,M).forEach(function(F){c.arange(F).forEach(function(V){b=c.arange(V).map(function(_){return A[F][_]*O[_][V]}),A[F][V]=(j[F][V]-c.sum(b))/O[V][V]}),c.arange(F,M).forEach(function(V){b=c.arange(F).map(function(_){return A[F][_]*O[_][V]}),O[F][V]=j[b.length][V]-c.sum(b)})}),[A,O]},cholesky:function(j){var b,M=j.length,A=c.zeros(j.length,j[0].length);return c.arange(M).forEach(function(O){b=c.arange(O).map(function(F){return g.pow(A[O][F],2)}),A[O][O]=g.sqrt(j[O][O]-c.sum(b)),c.arange(O+1,M).forEach(function(F){b=c.arange(O).map(function(V){return A[O][V]*A[F][V]}),A[F][O]=(j[O][F]-c.sum(b))/A[O][O]})}),A},gauss_jacobi:function(j,b,M,A){for(var O,F,V,_,P=0,K=0,W=j.length,se=[],he=[],ae=[];P<W;P++)for(se[P]=[],he[P]=[],ae[P]=[],K=0;K<W;K++)P>K?(se[P][K]=j[P][K],he[P][K]=ae[P][K]=0):P<K?(he[P][K]=j[P][K],se[P][K]=ae[P][K]=0):(ae[P][K]=j[P][K],se[P][K]=he[P][K]=0);for(V=c.multiply(c.multiply(c.inv(ae),c.add(se,he)),-1),F=c.multiply(c.inv(ae),b),O=M,_=c.add(c.multiply(V,M),F),P=2;g.abs(c.norm(c.subtract(_,O)))>A;)O=_,_=c.add(c.multiply(V,O),F),P++;return _},gauss_seidel:function(j,b,M,A){for(var O,F,V,_,P,K=0,W=j.length,se=[],he=[],ae=[];K<W;K++)for(se[K]=[],he[K]=[],ae[K]=[],O=0;O<W;O++)K>O?(se[K][O]=j[K][O],he[K][O]=ae[K][O]=0):K<O?(he[K][O]=j[K][O],se[K][O]=ae[K][O]=0):(ae[K][O]=j[K][O],se[K][O]=he[K][O]=0);for(_=c.multiply(c.multiply(c.inv(c.add(ae,se)),he),-1),V=c.multiply(c.inv(c.add(ae,se)),b),F=M,P=c.add(c.multiply(_,M),V),K=2;g.abs(c.norm(c.subtract(P,F)))>A;)F=P,P=c.add(c.multiply(_,F),V),K+=1;return P},SOR:function(j,b,M,A,O){for(var F,V,_,P,K,W=0,se=j.length,he=[],ae=[],we=[];W<se;W++)for(he[W]=[],ae[W]=[],we[W]=[],F=0;F<se;F++)W>F?(he[W][F]=j[W][F],ae[W][F]=we[W][F]=0):W<F?(ae[W][F]=j[W][F],he[W][F]=we[W][F]=0):(we[W][F]=j[W][F],he[W][F]=ae[W][F]=0);for(P=c.multiply(c.inv(c.add(we,c.multiply(he,O))),c.subtract(c.multiply(we,1-O),c.multiply(ae,O))),_=c.multiply(c.multiply(c.inv(c.add(we,c.multiply(he,O))),b),O),V=M,K=c.add(c.multiply(P,M),_),W=2;g.abs(c.norm(c.subtract(K,V)))>A;)V=K,K=c.add(c.multiply(P,V),_),W++;return K},householder:function(j){for(var b,M,A,O,F=j.length,V=j[0].length,_=0,P=[],K=[];_<F-1;_++){for(b=0,O=_+1;O<V;O++)b+=j[O][_]*j[O][_];for(b=(j[_+1][_]>0?-1:1)*g.sqrt(b),M=g.sqrt((b*b-j[_+1][_]*b)/2),(P=c.zeros(F,1))[_+1][0]=(j[_+1][_]-b)/(2*M),A=_+2;A<F;A++)P[A][0]=j[A][_]/(2*M);K=c.subtract(c.identity(F,V),c.multiply(c.multiply(P,c.transpose(P)),2)),j=c.multiply(K,c.multiply(j,K))}return j},QR:(D=c.sum,I=c.arange,function(j){var b,M,A,O=j.length,F=j[0].length,V=c.zeros(F,F);for(j=c.copy(j),M=0;M<F;M++){for(V[M][M]=g.sqrt(D(I(O).map(function(_){return j[_][M]*j[_][M]}))),b=0;b<O;b++)j[b][M]=j[b][M]/V[M][M];for(A=M+1;A<F;A++)for(V[M][A]=D(I(O).map(function(_){return j[_][M]*j[_][A]})),b=0;b<O;b++)j[b][A]=j[b][A]-j[b][M]*V[M][A]}return[j,V]}),lstsq:function(j,b){var M=!1;b[0].length===void 0&&(b=b.map(function(se){return[se]}),M=!0);var A=c.QR(j),O=A[0],F=A[1],V=j[0].length,_=c.slice(O,{col:{end:V}}),P=function(se){var he=(se=c.copy(se)).length,ae=c.identity(he);return c.arange(he-1,-1,-1).forEach(function(we){c.sliceAssign(ae,{row:we},c.divide(c.slice(ae,{row:we}),se[we][we])),c.sliceAssign(se,{row:we},c.divide(c.slice(se,{row:we}),se[we][we])),c.arange(we).forEach(function(Me){var be=c.multiply(se[Me][we],-1),ie=c.slice(se,{row:Me}),ze=c.multiply(c.slice(se,{row:we}),be);c.sliceAssign(se,{row:Me},c.add(ie,ze));var Je=c.slice(ae,{row:Me}),We=c.multiply(c.slice(ae,{row:we}),be);c.sliceAssign(ae,{row:Me},c.add(Je,We))})}),ae}(c.slice(F,{row:{end:V}})),K=c.transpose(_);K[0].length===void 0&&(K=[K]);var W=c.multiply(c.multiply(P,K),b);return W.length===void 0&&(W=[[W]]),M?W.map(function(se){return se[0]}):W},jacobi:function(j){for(var b,M,A,O,F,V,_,P=1,K=j.length,W=c.identity(K,K),se=[];P===1;){for(F=j[0][1],A=0,O=1,b=0;b<K;b++)for(M=0;M<K;M++)b!=M&&F<g.abs(j[b][M])&&(F=g.abs(j[b][M]),A=b,O=M);for(V=j[A][A]===j[O][O]?j[A][O]>0?g.PI/4:-g.PI/4:g.atan(2*j[A][O]/(j[A][A]-j[O][O]))/2,(_=c.identity(K,K))[A][A]=g.cos(V),_[A][O]=-g.sin(V),_[O][A]=g.sin(V),_[O][O]=g.cos(V),W=c.multiply(W,_),j=c.multiply(c.multiply(c.inv(_),j),_),P=0,b=1;b<K;b++)for(M=1;M<K;M++)b!=M&&g.abs(j[b][M])>.001&&(P=1)}for(b=0;b<K;b++)se.push(j[b][b]);return[W,se]},rungekutta:function(j,b,M,A,O,F){var V,_,P;if(F===2)for(;A<=M;)O+=((V=b*j(A,O))+(_=b*j(A+b,O+V)))/2,A+=b;if(F===4)for(;A<=M;)O+=((V=b*j(A,O))+2*(_=b*j(A+b/2,O+V/2))+2*(P=b*j(A+b/2,O+_/2))+b*j(A+b,O+P))/6,A+=b;return O},romberg:function(j,b,M,A){for(var O,F,V,_,P,K=0,W=(M-b)/2,se=[],he=[],ae=[];K<A/2;){for(P=j(b),V=b,_=0;V<=M;V+=W,_++)se[_]=V;for(O=se.length,V=1;V<O-1;V++)P+=(V%2!=0?4:2)*j(se[V]);P=W/3*(P+j(M)),ae[K]=P,W/=2,K++}for(F=ae.length,O=1;F!==1;){for(V=0;V<F-1;V++)he[V]=(g.pow(4,O)*ae[V+1]-ae[V])/(g.pow(4,O)-1);F=he.length,ae=he,he=[],O++}return ae},richardson:function(j,b,M,A){function O(we,Me){for(var be,ie=0,ze=we.length;ie<ze;ie++)we[ie]===Me&&(be=ie);return be}for(var F,V,_,P,K,W=g.abs(M-j[O(j,M)+1]),se=0,he=[],ae=[];A>=W;)F=O(j,M+A),V=O(j,M),he[se]=(b[F]-2*b[V]+b[2*V-F])/(A*A),A/=2,se++;for(P=he.length,_=1;P!=1;){for(K=0;K<P-1;K++)ae[K]=(g.pow(4,_)*he[K+1]-he[K])/(g.pow(4,_)-1);P=ae.length,he=ae,ae=[],_++}return he},simpson:function(j,b,M,A){for(var O,F=(M-b)/A,V=j(b),_=[],P=b,K=0,W=1;P<=M;P+=F,K++)_[K]=P;for(O=_.length;W<O-1;W++)V+=(W%2!=0?4:2)*j(_[W]);return F/3*(V+j(M))},hermite:function(j,b,M,A){for(var O,F=j.length,V=0,_=0,P=[],K=[],W=[],se=[];_<F;_++){for(P[_]=1,O=0;O<F;O++)_!=O&&(P[_]*=(A-j[O])/(j[_]-j[O]));for(K[_]=0,O=0;O<F;O++)_!=O&&(K[_]+=1/(j[_]-j[O]));W[_]=(1-2*(A-j[_])*K[_])*(P[_]*P[_]),se[_]=(A-j[_])*(P[_]*P[_]),V+=W[_]*b[_]+se[_]*M[_]}return V},lagrange:function(j,b,M){for(var A,O,F=0,V=0,_=j.length;V<_;V++){for(O=b[V],A=0;A<_;A++)V!=A&&(O*=(M-j[A])/(j[V]-j[A]));F+=O}return F},cubic_spline:function(j,b,M){for(var A,O,F=j.length,V=0,_=[],P=[],K=[],W=[],se=[],he=[];V<F-1;V++)W[V]=j[V+1]-j[V];for(K[0]=0,V=1;V<F-1;V++)K[V]=3/W[V]*(b[V+1]-b[V])-3/W[V-1]*(b[V]-b[V-1]);for(V=1;V<F-1;V++)_[V]=[],P[V]=[],_[V][V-1]=W[V-1],_[V][V]=2*(W[V-1]+W[V]),_[V][V+1]=W[V],P[V][0]=K[V];for(O=c.multiply(c.inv(_),P),A=0;A<F-1;A++)se[A]=(b[A+1]-b[A])/W[A]-W[A]*(O[A+1][0]+2*O[A][0])/3,he[A]=(O[A+1][0]-O[A][0])/(3*W[A]);for(A=0;A<F&&!(j[A]>M);A++);return b[A-=1]+(M-j[A])*se[A]+c.sq(M-j[A])*O[A]+(M-j[A])*c.sq(M-j[A])*he[A]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(j){var b,M,A,O,F,V=j.length,_=j[0].length,P=0,K=[],W=[],se=[],he=[],ae=[],we=[],Me=[];for(P=0;P<V;P++)K[P]=c.sum(j[P])/_;for(P=0;P<_;P++)for(ae[P]=[],b=0;b<V;b++)ae[P][b]=j[b][P]-K[b];for(ae=c.transpose(ae),P=0;P<V;P++)for(we[P]=[],b=0;b<V;b++)we[P][b]=c.dot([ae[P]],[ae[b]])/(_-1);for(F=(A=c.jacobi(we))[0],W=A[1],Me=c.transpose(F),P=0;P<W.length;P++)for(b=P;b<W.length;b++)W[P]<W[b]&&(M=W[P],W[P]=W[b],W[b]=M,se=Me[P],Me[P]=Me[b],Me[b]=se);for(O=c.transpose(ae),P=0;P<V;P++)for(he[P]=[],b=0;b<O.length;b++)he[P][b]=c.dot([Me[P]],[O[b]]);return[j,W,Me,he]}}),function(j){for(var b=0;b<j.length;b++)(function(M){c.fn[M]=function(A,O){var F=this;return O?(setTimeout(function(){O.call(F,c.fn[M].call(F,A))},15),this):typeof c[M](this,A)=="number"?c[M](this,A):c(c[M](this,A))}})(j[b])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(u,Math),function(c,g){var D=[].slice,I=c.utils.isNumber,v=c.utils.isArray;function p(w,j,b,M){if(w>1||b>1||w<=0||b<=0)throw new Error("Proportions should be greater than 0 and less than 1");var A=(w*j+b*M)/(j+M);return(w-b)/g.sqrt(A*(1-A)*(1/j+1/M))}c.extend({zscore:function(){var w=D.call(arguments);return I(w[1])?(w[0]-w[1])/w[2]:(w[0]-c.mean(w[1]))/c.stdev(w[1],w[2])},ztest:function(){var w,j=D.call(arguments);return v(j[1])?(w=c.zscore(j[0],j[1],j[3]),j[2]===1?c.normal.cdf(-g.abs(w),0,1):2*c.normal.cdf(-g.abs(w),0,1)):j.length>2?(w=c.zscore(j[0],j[1],j[2]),j[3]===1?c.normal.cdf(-g.abs(w),0,1):2*c.normal.cdf(-g.abs(w),0,1)):(w=j[0],j[1]===1?c.normal.cdf(-g.abs(w),0,1):2*c.normal.cdf(-g.abs(w),0,1))}}),c.extend(c.fn,{zscore:function(w,j){return(w-this.mean())/this.stdev(j)},ztest:function(w,j,b){var M=g.abs(this.zscore(w,b));return j===1?c.normal.cdf(-M,0,1):2*c.normal.cdf(-M,0,1)}}),c.extend({tscore:function(){var w=D.call(arguments);return w.length===4?(w[0]-w[1])/(w[2]/g.sqrt(w[3])):(w[0]-c.mean(w[1]))/(c.stdev(w[1],!0)/g.sqrt(w[1].length))},ttest:function(){var w,j=D.call(arguments);return j.length===5?(w=g.abs(c.tscore(j[0],j[1],j[2],j[3])),j[4]===1?c.studentt.cdf(-w,j[3]-1):2*c.studentt.cdf(-w,j[3]-1)):I(j[1])?(w=g.abs(j[0]),j[2]==1?c.studentt.cdf(-w,j[1]-1):2*c.studentt.cdf(-w,j[1]-1)):(w=g.abs(c.tscore(j[0],j[1])),j[2]==1?c.studentt.cdf(-w,j[1].length-1):2*c.studentt.cdf(-w,j[1].length-1))}}),c.extend(c.fn,{tscore:function(w){return(w-this.mean())/(this.stdev(!0)/g.sqrt(this.cols()))},ttest:function(w,j){return j===1?1-c.studentt.cdf(g.abs(this.tscore(w)),this.cols()-1):2*c.studentt.cdf(-g.abs(this.tscore(w)),this.cols()-1)}}),c.extend({anovafscore:function(){var w,j,b,M,A,O,F,V,_=D.call(arguments);if(_.length===1){for(A=new Array(_[0].length),F=0;F<_[0].length;F++)A[F]=_[0][F];_=A}for(j=new Array,F=0;F<_.length;F++)j=j.concat(_[F]);for(b=c.mean(j),w=0,F=0;F<_.length;F++)w+=_[F].length*g.pow(c.mean(_[F])-b,2);for(w/=_.length-1,O=0,F=0;F<_.length;F++)for(M=c.mean(_[F]),V=0;V<_[F].length;V++)O+=g.pow(_[F][V]-M,2);return w/(O/(j.length-_.length))},anovaftest:function(){var w,j,b,M,A=D.call(arguments);if(I(A[0]))return 1-c.centralF.cdf(A[0],A[1],A[2]);var O=c.anovafscore(A);for(w=A.length-1,b=0,M=0;M<A.length;M++)b+=A[M].length;return j=b-w-1,1-c.centralF.cdf(O,w,j)},ftest:function(w,j,b){return 1-c.centralF.cdf(w,j,b)}}),c.extend(c.fn,{anovafscore:function(){return c.anovafscore(this.toArray())},anovaftes:function(){var w,j=0;for(w=0;w<this.length;w++)j+=this[w].length;return c.ftest(this.anovafscore(),this.length-1,j-this.length)}}),c.extend({qscore:function(){var w,j,b,M,A,O=D.call(arguments);return I(O[0])?(w=O[0],j=O[1],b=O[2],M=O[3],A=O[4]):(w=c.mean(O[0]),j=c.mean(O[1]),b=O[0].length,M=O[1].length,A=O[2]),g.abs(w-j)/(A*g.sqrt((1/b+1/M)/2))},qtest:function(){var w,j=D.call(arguments);j.length===3?(w=j[0],j=j.slice(1)):j.length===7?(w=c.qscore(j[0],j[1],j[2],j[3],j[4]),j=j.slice(5)):(w=c.qscore(j[0],j[1],j[2]),j=j.slice(3));var b=j[0],M=j[1];return 1-c.tukey.cdf(w,M,b-M)},tukeyhsd:function(w){for(var j=c.pooledstdev(w),b=w.map(function(_){return c.mean(_)}),M=w.reduce(function(_,P){return _+P.length},0),A=[],O=0;O<w.length;++O)for(var F=O+1;F<w.length;++F){var V=c.qtest(b[O],b[F],w[O].length,w[F].length,j,M,w.length);A.push([[O,F],V])}return A}}),c.extend({normalci:function(){var w,j=D.call(arguments),b=new Array(2);return w=j.length===4?g.abs(c.normal.inv(j[1]/2,0,1)*j[2]/g.sqrt(j[3])):g.abs(c.normal.inv(j[1]/2,0,1)*c.stdev(j[2])/g.sqrt(j[2].length)),b[0]=j[0]-w,b[1]=j[0]+w,b},tci:function(){var w,j=D.call(arguments),b=new Array(2);return w=j.length===4?g.abs(c.studentt.inv(j[1]/2,j[3]-1)*j[2]/g.sqrt(j[3])):g.abs(c.studentt.inv(j[1]/2,j[2].length-1)*c.stdev(j[2],!0)/g.sqrt(j[2].length)),b[0]=j[0]-w,b[1]=j[0]+w,b},significant:function(w,j){return w<j}}),c.extend(c.fn,{normalci:function(w,j){return c.normalci(w,j,this.toArray())},tci:function(w,j){return c.tci(w,j,this.toArray())}}),c.extend(c.fn,{oneSidedDifferenceOfProportions:function(w,j,b,M){var A=p(w,j,b,M);return c.ztest(A,1)},twoSidedDifferenceOfProportions:function(w,j,b,M){var A=p(w,j,b,M);return c.ztest(A,2)}})}(u,Math),u.models=function(){function c(g,D){var I=g.length,v=D[0].length-1,p=I-v-1,w=u.lstsq(D,g),j=u.multiply(D,w.map(function(V){return[V]})).map(function(V){return V[0]}),b=u.subtract(g,j),M=u.mean(g),A=u.sum(j.map(function(V){return Math.pow(V-M,2)})),O=u.sum(g.map(function(V,_){return Math.pow(V-j[_],2)})),F=A+O;return{exog:D,endog:g,nobs:I,df_model:v,df_resid:p,coef:w,predict:j,resid:b,ybar:M,SST:F,SSE:A,SSR:O,R2:A/F}}return{ols:function(g,D){var I=c(g,D),v=function(j){var b,M,A=(b=j.exog,M=b[0].length,u.arange(M).map(function(W){var se=u.arange(M).filter(function(he){return he!==W});return c(u.col(b,W).map(function(he){return he[0]}),u.col(b,se))})),O=Math.sqrt(j.SSR/j.df_resid),F=A.map(function(W){var se=W.SST,he=W.R2;return O/Math.sqrt(se*(1-he))}),V=j.coef.map(function(W,se){return(W-0)/F[se]}),_=V.map(function(W){var se=u.studentt.cdf(W,j.df_resid);return 2*(se>.5?1-se:se)}),P=u.studentt.inv(.975,j.df_resid),K=j.coef.map(function(W,se){var he=P*F[se];return[W-he,W+he]});return{se:F,t:V,p:_,sigmaHat:O,interval95:K}}(I),p=function(j){var b,M,A,O=j.R2/j.df_model/((1-j.R2)/j.df_resid);return{F_statistic:O,pvalue:1-(b=O,M=j.df_model,A=j.df_resid,u.beta.cdf(b/(A/M+b),M/2,A/2))}}(I),w=1-(1-I.R2)*((I.nobs-1)/I.df_resid);return I.t=v,I.f=p,I.adjust_R2=w,I}}}(),u.extend({buildxmatrix:function(){for(var c=new Array(arguments.length),g=0;g<arguments.length;g++)c[g]=[1].concat(arguments[g]);return u(c)},builddxmatrix:function(){for(var c=new Array(arguments[0].length),g=0;g<arguments[0].length;g++)c[g]=[1].concat(arguments[0][g]);return u(c)},buildjxmatrix:function(c){for(var g=new Array(c.length),D=0;D<c.length;D++)g[D]=c[D];return u.builddxmatrix(g)},buildymatrix:function(c){return u(c).transpose()},buildjymatrix:function(c){return c.transpose()},matrixmult:function(c,g){var D,I,v,p,w;if(c.cols()==g.rows()){if(g.rows()>1){for(p=[],D=0;D<c.rows();D++)for(p[D]=[],I=0;I<g.cols();I++){for(w=0,v=0;v<c.cols();v++)w+=c.toArray()[D][v]*g.toArray()[v][I];p[D][I]=w}return u(p)}for(p=[],D=0;D<c.rows();D++)for(p[D]=[],I=0;I<g.cols();I++){for(w=0,v=0;v<c.cols();v++)w+=c.toArray()[D][v]*g.toArray()[I];p[D][I]=w}return u(p)}},regress:function(c,g){var D=u.xtranspxinv(c),I=c.transpose(),v=u.matrixmult(u(D),I);return u.matrixmult(v,g)},regresst:function(c,g,D){var I=u.regress(c,g),v={anova:{}},p=u.jMatYBar(c,I);v.yBar=p;var w=g.mean();v.anova.residuals=u.residuals(g,p),v.anova.ssr=u.ssr(p,w),v.anova.msr=v.anova.ssr/(c[0].length-1),v.anova.sse=u.sse(g,p),v.anova.mse=v.anova.sse/(g.length-(c[0].length-1)-1),v.anova.sst=u.sst(g,w),v.anova.mst=v.anova.sst/(g.length-1),v.anova.r2=1-v.anova.sse/v.anova.sst,v.anova.r2<0&&(v.anova.r2=0),v.anova.fratio=v.anova.msr/v.anova.mse,v.anova.pvalue=u.anovaftest(v.anova.fratio,c[0].length-1,g.length-(c[0].length-1)-1),v.anova.rmse=Math.sqrt(v.anova.mse),v.anova.r2adj=1-v.anova.mse/v.anova.mst,v.anova.r2adj<0&&(v.anova.r2adj=0),v.stats=new Array(c[0].length);for(var j,b,M,A=u.xtranspxinv(c),O=0;O<I.length;O++)j=Math.sqrt(v.anova.mse*Math.abs(A[O][O])),b=Math.abs(I[O]/j),M=u.ttest(b,g.length-c[0].length-1,D),v.stats[O]=[I[O],j,b,M];return v.regress=I,v},xtranspx:function(c){return u.matrixmult(c.transpose(),c)},xtranspxinv:function(c){var g=u.matrixmult(c.transpose(),c);return u.inv(g)},jMatYBar:function(c,g){var D=u.matrixmult(c,g);return new u(D)},residuals:function(c,g){return u.matrixsubtract(c,g)},ssr:function(c,g){for(var D=0,I=0;I<c.length;I++)D+=Math.pow(c[I]-g,2);return D},sse:function(c,g){for(var D=0,I=0;I<c.length;I++)D+=Math.pow(c[I]-g[I],2);return D},sst:function(c,g){for(var D=0,I=0;I<c.length;I++)D+=Math.pow(c[I]-g,2);return D},matrixsubtract:function(c,g){for(var D=new Array(c.length),I=0;I<c.length;I++){D[I]=new Array(c[I].length);for(var v=0;v<c[I].length;v++)D[I][v]=c[I][v]-g[I][v]}return u(D)}}),u.jStat=u,u)},960:function(f,u,c){let g=c(592);f.exports=function(D){function I(O,F){let V=F.split("."),_=O;for(let P of V){if(_==null)return;_=_[P]}return _}for(let O=0;O<Object.keys(g).length;O++){let F,V=Object.keys(g)[O],_=[];if(typeof g[V]=="object"){_=Object.keys(g[V]),F=Object.values(g[V]);for(let P=0;P<F.length;P++)if(typeof F[P]=="object"){let K=_[P];g[V][K]&&(_=[..._,...Object.keys(g[V][K]).map(W=>K+"."+W)],_.splice(_.indexOf(K),1))}}if(_.length<1)D[V]=g[V];else for(let P=0;P<_.length;P++)typeof I(g[V],_[P])=="function"&&(D[V]=I(g[V],_[P]))}let v=function(O){return typeof O=="number"&&(O=parseInt(O)),O},p=null,w=null,j=null;D.TABLE=function(){return j},D.COLUMN=D.COL=function(){return j.tracking&&j.tracking.push(A.getColumnNameFromCoords(v(p),v(w))),v(p)+1},D.ROW=function(){return j.tracking&&j.tracking.push(A.getColumnNameFromCoords(v(p),v(w))),v(w)+1},D.CELL=function(){return A.getColumnNameFromCoords(p,w)},D.VALUE=function(O,F,V){return j.getValueFromCoords(v(O)-1,v(F)-1,V)},D.THISROWCELL=function(O){return j.getValueFromCoords(v(O)-1,v(w))};let b=function(O,F){for(let V=0;V<O.length;V++){let _=A.getTokensFromRange(O[V]);F=F.replace(O[V],"["+_.join(",")+"]")}return F},M=function(O){return typeof O=="string"&&(O=O.trim()),!isNaN(O)&&O!==null&&O!==""},A=function(O,F,V,_,P){j=P,p=V,w=_;let K="",W={};if(F)if(F.size){let ae,we=null;F.forEach(function(Me,be){ae=be.replace(/!/g,"."),ae.indexOf(".")!==-1&&(ae=ae.split("."),W[ae[0]]=!0)}),ae=Object.keys(W);for(let Me=0;Me<ae.length;Me++)K+="var "+ae[Me]+" = {};";F.forEach(function(Me,be){ae=be.replace(/!/g,"."),Me===null||M(Me)||(we=Me.match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g),we&&we.length&&(Me=updateRanges(we,Me))),ae.indexOf(".")>0?K+=ae+" = "+F.get(be)+`;
`:K+="var "+ae+" = "+Me+`;
`})}else{let ae=Object.keys(F);if(ae.length){let we,Me={};for(let be=0;be<ae.length;be++)if(we=ae[be].replace(/\!/g,"."),we.indexOf(".")>0){let ie=ie.split(".");Me[ie[0]]={}}we=Object.keys(Me);for(let be=0;be<we.length;be++)K+="var "+we[be]+" = {};";for(let be=0;be<ae.length;be++){if(we=ae[be].replace(/!/g,"."),F[ae[be]]!==null&&!M(F[ae[be]])){let ie=F[ae[be]].match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g);ie&&ie.length&&(F[ae[be]]=b(ie,F[ae[be]]))}we.indexOf(".")>0?K+=we+" = "+F[ae[be]]+`;
`:K+="var "+we+" = "+F[ae[be]]+`;
`}}}let se=(O=function(ae,we){let Me="",be=0,ie=["=","!",">","<"];for(let ze=0;ze<ae.length;ze++)ae[ze]==='"'&&(be=be===0?1:0),be===1?Me+=ae[ze]:(Me+=ae[ze].toUpperCase(),ze>0&&ae[ze]==="="&&ie.indexOf(ae[ze-1])===-1&&ie.indexOf(ae[ze+1])===-1&&(Me+="="));return Me=Me.replace(/\^/g,"**"),Me=Me.replace(/<>/g,"!="),Me=Me.replace(/&/g,"+"),Me=Me.replace(/\$/g,""),Me}(O=(O=O.replace(/\$/g,"")).replace(/!/g,"."))).match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g);se&&se.length&&(O=b(se,O));let he=new Function(K+"; return "+O)();return he===null&&(he=0),he};return A.getColumnNameFromCoords=function(O,F){return _="",(V=parseInt(O))>701?(_+=String.fromCharCode(64+parseInt(V/676)),_+=String.fromCharCode(64+parseInt(V%676/26))):V>25&&(_+=String.fromCharCode(64+parseInt(V/26))),_+String.fromCharCode(65+V%26)+(parseInt(F)+1);var V,_},A.getCoordsFromColumnName=function(O){var F=/^[a-zA-Z]+/.exec(O);if(F){for(var V=0,_=0;_<F[0].length;_++)V+=parseInt(F[0].charCodeAt(_)-64)*Math.pow(26,F[0].length-1-_);--V<0&&(V=0);var P=parseInt(/[0-9]+$/.exec(O))||null;return P>0&&P--,[V,P]}},A.getRangeFromTokens=function(O){O=O.filter(function(P){return P!="#REF!"});for(var F="",V="",_=0;_<O.length;_++)O[_].indexOf(".")>=0?F=".":O[_].indexOf("!")>=0&&(F="!"),F&&(V=O[_].split(F),O[_]=V[1],V=V[0]+F);return O.sort(function(P,K){var W=Helpers.getCoordsFromColumnName(P),se=Helpers.getCoordsFromColumnName(K);return W[1]>se[1]?1:W[1]<se[1]?-1:W[0]>se[0]?1:W[0]<se[0]?-1:0}),O.length?V+(O[0]+":")+O[O.length-1]:"#REF!"},A.getTokensFromRange=function(O){if(O.indexOf(".")>0){var F=O.split(".");O=F[1],F=F[0]+"."}else O.indexOf("!")>0?(F=O.split("!"),O=F[1],F=F[0]+"!"):F="";O=O.split(":");var V=A.getCoordsFromColumnName(O[0]),_=A.getCoordsFromColumnName(O[1]);if(V[0]<=_[0])var P=V[0],K=_[0];else P=_[0],K=V[0];if(V[1]===null&&_[1]==null)for(var W=null,se=null,he=Object.keys(vars),ae=0;ae<he.length;ae++){var we=A.getCoordsFromColumnName(he[ae]);we[0]===V[0]&&(W===null||we[1]<W)&&(W=we[1]),we[0]===_[0]&&(se===null||we[1]>se)&&(se=we[1])}else V[1]<=_[1]?(W=V[1],se=_[1]):(W=_[1],se=V[1]);for(var Me=[],be=W;be<=se;be++){var ie=[];for(ae=P;ae<=K;ae++)ie.push(F+A.getColumnNameFromCoords(ae,be));Me.push(ie)}return Me},A.setFormula=function(O){let F=Object.keys(O);for(let V=0;V<F.length;V++)typeof O[F[V]]=="function"&&(D[F[V]]=O[F[V]])},A.basic=!0,A}(typeof window>"u"?c.g:window)},592:function(f,u,c){"use strict";var g=c(162),D=c(765);let I=new Error("#NULL!"),v=new Error("#DIV/0!"),p=new Error("#VALUE!"),w=new Error("#REF!"),j=new Error("#NAME?"),b=new Error("#NUM!"),M=new Error("#N/A"),A=new Error("#ERROR!"),O=new Error("#GETTING_DATA");var F=Object.freeze({__proto__:null,data:O,div0:v,error:A,na:M,name:j,nil:I,num:b,ref:w,value:p});function V(o){let a=[];return _(o,h=>{a.push(h)}),a}function _(o,a){let h=-1,C=o.length;for(;++h<C&&a(o[h],h,o)!==!1;);return o}function P(o){let a,h=o.length;for(;h--;)if(a=o[h],typeof a!="number")if(a!==!0)if(a!==!1){if(typeof a=="string"){let C=q(a);o[h]=C instanceof Error?0:C}}else o[h]=0;else o[h]=1;return o}function K(o,a){if(!o)return p;o.every(N=>Array.isArray(N))&&o.length!==0||(o=[[...o]]),o.map((N,U)=>{N.map((Z,re)=>{Z||(o[U][re]=0)})});let h=o.reduce((N,U,Z)=>U.length>o[N].length?Z:N,0),C=o[h].length;return o.map(N=>[...N,...Array(C-N.length).fill(a||0)])}function W(){let o;if(arguments.length===1){let h=arguments[0];o=(a=h)!=null&&typeof a.length=="number"&&typeof a!="string"?V.apply(null,arguments):[h]}else o=Array.from(arguments);for(var a;!he(o);)o=se(o);return o}function se(o){return o&&o.reduce?o.reduce((a,h)=>{let C=Array.isArray(a),N=Array.isArray(h);return C&&N?a.concat(h):C?(a.push(h),a):N?[a].concat(h):[a,h]}):[o]}function he(o){if(!o)return!1;for(let a=0;a<o.length;++a)if(Array.isArray(o[a]))return!1;return!0}function ae(o,a){return a=a||1,o&&typeof o.slice=="function"?o.slice(a):o}function we(o){return o?o[0].map((a,h)=>o.map(C=>C[h])):p}function Me(o,a){let h=null;return _(o,(C,N)=>{if(C[0]===a)return h=N,!1}),h??p}function be(){for(let o=0;o<arguments.length;o++)if(arguments[o]instanceof Error)return arguments[o]}function ie(){let o=arguments.length;for(;o--;)if(arguments[o]instanceof Error)return!0;return!1}function ze(o){return Math.round(o*1e14)/1e14}function Je(){return W.apply(null,arguments).filter(o=>typeof o=="number")}function We(o){if(typeof o=="boolean"||o instanceof Error)return o;if(typeof o=="number")return o!==0;if(typeof o=="string"){let a=o.toUpperCase();if(a==="TRUE")return!0;if(a==="FALSE")return!1}return o instanceof Date&&!isNaN(o)||p}function He(o){if(!isNaN(o)){if(o instanceof Date)return new Date(o);let a=parseFloat(o);return a<0||a>=2958466?b:function(h){h<60&&(h+=1);let C=Math.floor(h-25569),N=new Date(86400*C*1e3),U=h-Math.floor(h)+1e-7,Z=Math.floor(86400*U),re=Z%60;Z-=re;let fe=Math.floor(Z/3600),je=Math.floor(Z/60)%60,_e=N.getUTCDate(),$e=N.getUTCMonth();return h>=60&&h<61&&(_e=29,$e=1),new Date(N.getUTCFullYear(),$e,_e,fe,je,re)}(a)}return typeof o!="string"||(o=/(\d{4})-(\d\d?)-(\d\d?)$/.test(o)?new Date(o+"T00:00:00.000"):new Date(o),isNaN(o))?p:o}function St(o){let a,h=o.length;for(;h--;){if(a=He(o[h]),a===p)return a;o[h]=a}return o}function q(o){return o instanceof Error?o:o==null?0:(typeof o=="boolean"&&(o=+o),isNaN(o)||o===""?p:parseFloat(o))}function Se(o){let a,h;if(!o||(a=o.length)===0)return p;for(;a--;){if(o[a]instanceof Error)return o[a];if(h=q(o[a]),h instanceof Error)return h;o[a]=h}return o}function Ye(o){return o instanceof Error?o:o==null?"":o.toString()}function Re(){let o=arguments.length;for(;o--;)if(typeof arguments[o]=="string")return!0;return!1}function Ae(o){return o!=null}let Le="=",Be=[">",">=","<","<=","=","<>"],nt="operator",st="literal",Tt=[nt,st],Bt=nt,At=st;function Xt(o,a){if(Tt.indexOf(a)===-1)throw new Error("Unsupported token type: "+a);return{value:o,type:a}}function yn(o){return function(a){let h="",C=[];for(let N=0;N<a.length;N++){let U=a[N];N===0&&Be.indexOf(U)>=0?C.push(Xt(U,Bt)):h+=U}return h.length>0&&C.push(Xt(function(N){return typeof N!="string"||/^\d+(\.\d+)?$/.test(N)&&(N=N.indexOf(".")===-1?parseInt(N,10):parseFloat(N)),N}(h),At)),C.length>0&&C[0].type!==Bt&&C.unshift(Xt(Le,Bt)),C}(function(a){let h=a.length,C=[],N=0,U="",Z="";for(;N<h;){let re=a.charAt(N);switch(re){case">":case"<":case"=":Z+=re,U.length>0&&(C.push(U),U="");break;default:Z.length>0&&(C.push(Z),Z=""),U+=re}N++}return U.length>0&&C.push(U),Z.length>0&&C.push(Z),C}(o))}let Qt=function(o){let a=[],h;for(let C=0;C<o.length;C++){let N=o[C];switch(N.type){case Bt:h=N.value;break;case At:a.push(N.value)}}return function(C,N){let U=!1;switch(N){case">":U=C[0]>C[1];break;case">=":U=C[0]>=C[1];break;case"<":U=C[0]<C[1];break;case"<=":U=C[0]<=C[1];break;case"=":U=C[0]==C[1];break;case"<>":U=C[0]!=C[1]}return U}(a,h)},fi={};function pi(o){return[p,w,v,b,j,I].indexOf(o)>=0||typeof o=="number"&&(isNaN(o)||!isFinite(o))}function Ut(o){return pi(o)||o===M}function ha(o){return o===!0||o===!1}function Ar(o){return typeof o=="number"&&!isNaN(o)&&isFinite(o)}function E(o){return typeof o=="string"}function T(){let o=[];for(let a=0;a<arguments.length;++a){let h=!1,C=arguments[a];for(let N=0;N<o.length&&(h=o[N]===C,!h);++N);h||o.push(C)}return o}function m(o,a,h,C){if(!a||!h)return M;C=!(C===0||C===!1);let N=M,U=typeof o=="number",Z=!1;for(let re=0;re<a.length;re++){let fe=a[re];if(fe[0]===o){N=h<fe.length+1?fe[h-1]:w;break}!Z&&(U&&C&&fe[0]<=o||C&&typeof fe[0]=="string"&&fe[0].localeCompare(o)<0)&&(N=h<fe.length+1?fe[h-1]:w),U&&fe[0]>o&&(Z=!0)}return N}function d(){let o=W(arguments).filter(Ae);if(o.length===0)return v;let a=be.apply(void 0,o);if(a)return a;let h=Je(o),C=h.length,N,U=0,Z=0;for(let re=0;re<C;re++)U+=h[re],Z+=1;return N=U/Z,isNaN(N)&&(N=b),N}function B(){let o=W(arguments).filter(Ae);if(o.length===0)return v;let a=be.apply(void 0,o);if(a)return a;let h=o,C=h.length,N,U=0,Z=0;for(let re=0;re<C;re++){let fe=h[re];typeof fe=="number"&&(U+=fe),fe===!0&&U++,fe!==null&&Z++}return N=U/Z,isNaN(N)&&(N=b),N}fi.TYPE=o=>{switch(o){case I:return 1;case v:return 2;case p:return 3;case w:return 4;case j:return 5;case b:return 6;case M:return 7;case O:return 8}return M};let J={DIST:function(o,a,h,C,N,U){return arguments.length<4?p:(N=N===void 0?0:N,U=U===void 0?1:U,ie(o=q(o),a=q(a),h=q(h),N=q(N),U=q(U))?p:(o=(o-N)/(U-N),C?g.beta.cdf(o,a,h):g.beta.pdf(o,a,h)))},INV:(o,a,h,C,N)=>(C=C===void 0?0:C,N=N===void 0?1:N,ie(o=q(o),a=q(a),h=q(h),C=q(C),N=q(N))?p:g.beta.inv(o,a,h)*(N-C)+C)},ee={DIST:(o,a,h,C)=>ie(o=q(o),a=q(a),h=q(h),C=q(C))?p:C?g.binomial.cdf(o,a,h):g.binomial.pdf(o,a,h)};ee.DIST.RANGE=(o,a,h,C)=>{if(C=C===void 0?h:C,ie(o=q(o),a=q(a),h=q(h),C=q(C)))return p;let N=0;for(let U=h;U<=C;U++)N+=Ct(o,U)*Math.pow(a,U)*Math.pow(1-a,o-U);return N},ee.INV=(o,a,h)=>{if(ie(o=q(o),a=q(a),h=q(h)))return p;let C=0;for(;C<=o;){if(g.binomial.cdf(C,o,a)>=h)return C;C++}};let k={DIST:(o,a,h)=>ie(o=q(o),a=q(a))?p:h?g.chisquare.cdf(o,a):g.chisquare.pdf(o,a)};k.DIST.RT=(o,a)=>!o|!a?M:o<1||a>Math.pow(10,10)?b:typeof o!="number"||typeof a!="number"?p:1-g.chisquare.cdf(o,a),k.INV=(o,a)=>ie(o=q(o),a=q(a))?p:g.chisquare.inv(o,a),k.INV.RT=(o,a)=>!o|!a?M:o<0||o>1||a<1||a>Math.pow(10,10)?b:typeof o!="number"||typeof a!="number"?p:g.chisquare.inv(1-o,a),k.TEST=function(o,a){if(arguments.length!==2)return M;if(!(o instanceof Array&&a instanceof Array)||o.length!==a.length||o[0]&&a[0]&&o[0].length!==a[0].length)return p;let h=o.length,C,N,U;for(N=0;N<h;N++)o[N]instanceof Array||(C=o[N],o[N]=[],o[N].push(C)),a[N]instanceof Array||(C=a[N],a[N]=[],a[N].push(C));let Z=o[0].length,re=Z===1?h-1:(h-1)*(Z-1),fe=0,je=Math.PI;for(N=0;N<h;N++)for(U=0;U<Z;U++)fe+=Math.pow(o[N][U]-a[N][U],2)/a[N][U];return Math.round(1e6*function(_e,$e){let Pe=Math.exp(-.5*_e);$e%2==1&&(Pe*=Math.sqrt(2*_e/je));let Ke=$e;for(;Ke>=2;)Pe=Pe*_e/Ke,Ke-=2;let pt=Pe,yt=$e;for(;pt>1e-10*Pe;)yt+=2,pt=pt*_e/yt,Pe+=pt;return 1-Pe}(fe,re))/1e6};let L={};function H(){return Je(W(arguments)).length}function G(){let o=W(arguments);return o.length-oe(o)}function oe(){let o=W(arguments),a,h=0;for(let C=0;C<o.length;C++)a=o[C],a!=null&&a!==""||h++;return h}L.NORM=(o,a,h)=>ie(o=q(o),a=q(a),h=q(h))?p:g.normalci(1,o,a,h)[1]-1,L.T=(o,a,h)=>ie(o=q(o),a=q(a),h=q(h))?p:g.tci(1,o,a,h)[1]-1;let me={P:(o,a)=>{if(ie(o=Se(W(o)),a=Se(W(a))))return p;let h=g.mean(o),C=g.mean(a),N=0,U=o.length;for(let Z=0;Z<U;Z++)N+=(o[Z]-h)*(a[Z]-C);return N/U},S:(o,a)=>ie(o=Se(W(o)),a=Se(W(a)))?p:g.covariance(o,a)},le={DIST:(o,a,h)=>ie(o=q(o),a=q(a))?p:h?g.exponential.cdf(o,a):g.exponential.pdf(o,a)},ce={};function Te(o,a,h){if(ie(o=q(o),a=Se(W(a)),h=Se(W(h))))return p;let C=g.mean(h),N=g.mean(a),U=h.length,Z=0,re=0;for(let je=0;je<U;je++)Z+=(h[je]-C)*(a[je]-N),re+=Math.pow(h[je]-C,2);let fe=Z/re;return N-fe*C+fe*o}function Ie(o){return(o=q(o))instanceof Error?o:o===0||parseInt(o,10)===o&&o<0?b:g.gammafn(o)}function Ne(o){return(o=q(o))instanceof Error?o:g.gammaln(o)}ce.DIST=(o,a,h,C)=>ie(o=q(o),a=q(a),h=q(h))?p:C?g.centralF.cdf(o,a,h):g.centralF.pdf(o,a,h),ce.DIST.RT=function(o,a,h){return arguments.length!==3?M:o<0||a<1||h<1?b:typeof o!="number"||typeof a!="number"||typeof h!="number"?p:1-g.centralF.cdf(o,a,h)},ce.INV=(o,a,h)=>ie(o=q(o),a=q(a),h=q(h))?p:o<=0||o>1?b:g.centralF.inv(o,a,h),ce.INV.RT=function(o,a,h){return arguments.length!==3?M:o<0||o>1||a<1||a>Math.pow(10,10)||h<1||h>Math.pow(10,10)?b:typeof o!="number"||typeof a!="number"||typeof h!="number"?p:g.centralF.inv(1-o,a,h)},ce.TEST=(o,a)=>{if(!o||!a||!(o instanceof Array&&a instanceof Array))return M;if(o.length<2||a.length<2)return v;let h=(U,Z)=>{let re=0;for(let fe=0;fe<U.length;fe++)re+=Math.pow(U[fe]-Z,2);return re},C=ar(o)/o.length,N=ar(a)/a.length;return h(o,C)/(o.length-1)/(h(a,N)/(a.length-1))},Ie.DIST=function(o,a,h,C){return arguments.length!==4?M:o<0||a<=0||h<=0||typeof o!="number"||typeof a!="number"||typeof h!="number"?p:C?g.gamma.cdf(o,a,h,!0):g.gamma.pdf(o,a,h,!1)},Ie.INV=function(o,a,h){return arguments.length!==3?M:o<0||o>1||a<=0||h<=0?b:typeof o!="number"||typeof a!="number"||typeof h!="number"?p:g.gamma.inv(o,a,h)},Ne.PRECISE=function(o){return arguments.length!==1?M:o<=0?b:typeof o!="number"?p:g.gammaln(o)};let Ge={};function lt(o,a){return ie(o=Se(W(o)),a=q(a))?o:a<0||o.length<a?p:o.sort((h,C)=>C-h)[a-1]}function pe(o,a){if(ie(o=Se(W(o)),a=Se(W(a))))return p;let h=g.mean(o),C=g.mean(a),N=a.length,U=0,Z=0;for(let fe=0;fe<N;fe++)U+=(a[fe]-C)*(o[fe]-h),Z+=Math.pow(a[fe]-C,2);let re=U/Z;return[re,h-re*C]}Ge.DIST=(o,a,h,C,N)=>{if(ie(o=q(o),a=q(a),h=q(h),C=q(C)))return p;function U(Z,re,fe,je){return Ct(fe,Z)*Ct(je-fe,re-Z)/Ct(je,re)}return N?function(Z,re,fe,je){let _e=0;for(let $e=0;$e<=Z;$e++)_e+=U($e,re,fe,je);return _e}(o,a,h,C):U(o,a,h,C)};let ue={};function ye(){let o=W(arguments),a=be.apply(void 0,o);if(a)return a;let h=Je(o);return h.length===0?0:Math.max.apply(Math,h)}function z(){let o=W(arguments),a=be.apply(void 0,o);if(a)return a;let h=P(o),C=g.median(h);return isNaN(C)&&(C=b),C}function X(){let o=W(arguments),a=be.apply(void 0,o);if(a)return a;let h=Je(o);return h.length===0?0:Math.min.apply(Math,h)}ue.DIST=(o,a,h,C)=>ie(o=q(o),a=q(a),h=q(h))?p:C?g.lognormal.cdf(o,a,h):g.lognormal.pdf(o,a,h),ue.INV=(o,a,h)=>ie(o=q(o),a=q(a),h=q(h))?p:g.lognormal.inv(o,a,h);let S={MULT:function(){let o=Se(W(arguments));if(o instanceof Error)return o;let a=o.length,h={},C,N=[],U=0;for(let Z=0;Z<a;Z++)C=o[Z],h[C]=h[C]?h[C]+1:1,h[C]>U&&(U=h[C],N=[]),h[C]===U&&(N[N.length]=C);return N},SNGL:function(){let o=Se(W(arguments));return o instanceof Error?o:S.MULT(o).sort((a,h)=>a-h)[0]}},R={DIST:(o,a,h,C)=>ie(o=q(o),a=q(a),h=q(h))?p:C?g.negbin.cdf(o,a,h):g.negbin.pdf(o,a,h)},Y={};function de(o,a){if(ie(a=Se(W(a)),o=Se(W(o))))return p;let h=g.mean(o),C=g.mean(a),N=o.length,U=0,Z=0,re=0;for(let fe=0;fe<N;fe++)U+=(o[fe]-h)*(a[fe]-C),Z+=Math.pow(o[fe]-h,2),re+=Math.pow(a[fe]-C,2);return U/Math.sqrt(Z*re)}Y.DIST=(o,a,h,C)=>ie(o=q(o),a=q(a),h=q(h))?p:h<=0?b:C?g.normal.cdf(o,a,h):g.normal.pdf(o,a,h),Y.INV=(o,a,h)=>ie(o=q(o),a=q(a),h=q(h))?p:g.normal.inv(o,a,h),Y.S={},Y.S.DIST=(o,a)=>(o=q(o))instanceof Error?p:a?g.normal.cdf(o,0,1):g.normal.pdf(o,0,1),Y.S.INV=o=>(o=q(o))instanceof Error?p:g.normal.inv(o,0,1);let ne={EXC:(o,a)=>{if(ie(o=Se(W(o)),a=q(a)))return p;let h=(o=o.sort((U,Z)=>U-Z)).length;if(a<1/(h+1)||a>1-1/(h+1))return b;let C=a*(h+1)-1,N=Math.floor(C);return ze(C===N?o[C]:o[N]+(C-N)*(o[N+1]-o[N]))},INC:(o,a)=>{if(ie(o=Se(W(o)),a=q(a)))return p;let h=a*((o=o.sort((N,U)=>N-U)).length-1),C=Math.floor(h);return ze(h===C?o[h]:o[C]+(h-C)*(o[C+1]-o[C]))}},Q={EXC:(o,a,h)=>{if(h=h===void 0?3:h,ie(o=Se(W(o)),a=q(a),h=q(h)))return p;o=o.sort((_e,$e)=>_e-$e);let C=T.apply(null,o),N=o.length,U=C.length,Z=Math.pow(10,h),re=0,fe=!1,je=0;for(;!fe&&je<U;)a===C[je]?(re=(o.indexOf(C[je])+1)/(N+1),fe=!0):a>=C[je]&&(a<C[je+1]||je===U-1)&&(re=(o.indexOf(C[je])+1+(a-C[je])/(C[je+1]-C[je]))/(N+1),fe=!0),je++;return Math.floor(re*Z)/Z},INC:(o,a,h)=>{if(h=h===void 0?3:h,ie(o=Se(W(o)),a=q(a),h=q(h)))return p;o=o.sort((_e,$e)=>_e-$e);let C=T.apply(null,o),N=o.length,U=C.length,Z=Math.pow(10,h),re=0,fe=!1,je=0;for(;!fe&&je<U;)a===C[je]?(re=o.indexOf(C[je])/(N-1),fe=!0):a>=C[je]&&(a<C[je+1]||je===U-1)&&(re=(o.indexOf(C[je])+(a-C[je])/(C[je+1]-C[je]))/(N-1),fe=!0),je++;return Math.floor(re*Z)/Z}},ve={DIST:(o,a,h)=>ie(o=q(o),a=q(a))?p:h?g.poisson.cdf(o,a):g.poisson.pdf(o,a)},Ce={EXC:(o,a)=>{if(ie(o=Se(W(o)),a=q(a)))return p;switch(a){case 1:return ne.EXC(o,.25);case 2:return ne.EXC(o,.5);case 3:return ne.EXC(o,.75);default:return b}},INC:(o,a)=>{if(ie(o=Se(W(o)),a=q(a)))return p;switch(a){case 1:return ne.INC(o,.25);case 2:return ne.INC(o,.5);case 3:return ne.INC(o,.75);default:return b}}},De={};function xe(){let o=Se(W(arguments));if(o instanceof Error)return o;let a=g.mean(o),h=o.length,C=0;for(let N=0;N<h;N++)C+=Math.pow(o[N]-a,3);return h*C/((h-1)*(h-2)*Math.pow(g.stdev(o,!0),3))}function ke(o,a){return ie(o=Se(W(o)),a=q(a))?o:o.sort((h,C)=>h-C)[a-1]}De.AVG=(o,a,h)=>{if(ie(o=q(o),a=Se(W(a))))return p;let C=(h=h||!1)?(Z,re)=>Z-re:(Z,re)=>re-Z,N=(a=(a=W(a)).sort(C)).length,U=0;for(let Z=0;Z<N;Z++)a[Z]===o&&U++;return U>1?(2*a.indexOf(o)+U+1)/2:a.indexOf(o)+1},De.EQ=(o,a,h)=>{if(ie(o=q(o),a=Se(W(a))))return p;let C=(h=h||!1)?(N,U)=>N-U:(N,U)=>U-N;return(a=a.sort(C)).indexOf(o)+1},xe.P=function(){let o=Se(W(arguments));if(o instanceof Error)return o;let a=g.mean(o),h=o.length,C=0,N=0;for(let U=0;U<h;U++)N+=Math.pow(o[U]-a,3),C+=Math.pow(o[U]-a,2);return N/=h,C/=h,N/Math.pow(C,1.5)};let qe={P:function(){let o=te.P.apply(this,arguments),a=Math.sqrt(o);return isNaN(a)&&(a=b),a},S:function(){let o=te.S.apply(this,arguments);return Math.sqrt(o)}},ct={DIST:(o,a,h)=>h!==1&&h!==2?b:h===1?ct.DIST.RT(o,a):ct.DIST["2T"](o,a)};ct.DIST["2T"]=function(o,a){return arguments.length!==2?M:o<0||a<1?b:typeof o!="number"||typeof a!="number"?p:2*(1-g.studentt.cdf(o,a))},ct.DIST.RT=function(o,a){return arguments.length!==2?M:o<0||a<1?b:typeof o!="number"||typeof a!="number"?p:1-g.studentt.cdf(o,a)},ct.INV=(o,a)=>ie(o=q(o),a=q(a))?p:g.studentt.inv(o,a),ct.INV["2T"]=(o,a)=>(o=q(o),a=q(a),o<=0||o>1||a<1?b:ie(o,a)?p:Math.abs(g.studentt.inv(o/2,a))),ct.TEST=(o,a)=>{if(ie(o=Se(W(o)),a=Se(W(a))))return p;let h=g.mean(o),C=g.mean(a),N,U=0,Z=0;for(N=0;N<o.length;N++)U+=Math.pow(o[N]-h,2);for(N=0;N<a.length;N++)Z+=Math.pow(a[N]-C,2);U/=o.length-1,Z/=a.length-1;let re=Math.abs(h-C)/Math.sqrt(U/o.length+Z/a.length);return ct.DIST["2T"](re,o.length+a.length-2)};let te={};function ge(){let o=W(arguments),a=o.length,h=0,C=0,N=B(o);for(let U=0;U<a;U++){let Z=o[U];h+=Math.pow(typeof Z=="number"?Z-N:Z===!0?1-N:0-N,2),Z!==null&&C++}return h/(C-1)}function Ee(){let o=W(arguments),a=o.length,h=0,C=0,N=B(o),U;for(let Z=0;Z<a;Z++){let re=o[Z];h+=Math.pow(typeof re=="number"?re-N:re===!0?1-N:0-N,2),re!==null&&C++}return U=h/C,isNaN(U)&&(U=b),U}te.P=function(){let o=Je(W(arguments)),a=o.length,h=0,C=d(o),N;for(let U=0;U<a;U++)h+=Math.pow(o[U]-C,2);return N=h/a,isNaN(N)&&(N=b),N},te.S=function(){let o=Je(W(arguments)),a=o.length,h=0,C=d(o);for(let N=0;N<a;N++)h+=Math.pow(o[N]-C,2);return h/(a-1)};let Fe={DIST:(o,a,h,C)=>ie(o=q(o),a=q(a),h=q(h))?p:C?1-Math.exp(-Math.pow(o/h,a)):Math.pow(o,a-1)*Math.exp(-Math.pow(o/h,a))*a/Math.pow(h,a)},dt={};function Xe(o,a,h){let C=be(o=q(o),a=q(a),h=q(h));if(C)return C;if(a===0)return 0;a=Math.abs(a);let N=-Math.floor(Math.log(a)/Math.log(10));return o>=0?An(Math.ceil(o/a)*a,N):h===0?-An(Math.floor(Math.abs(o)/a)*a,N):-An(Math.ceil(Math.abs(o)/a)*a,N)}function Ct(o,a){return be(o=q(o),a=q(a))||(o<a?b:Qe(o)/(Qe(a)*Qe(o-a)))}dt.TEST=(o,a,h)=>{if(ie(o=Se(W(o)),a=q(a)))return p;h=h||qe.S(o);let C=o.length;return 1-Y.S.DIST((d(o)-a)/(h/Math.sqrt(C)),!0)},Xe.MATH=Xe,Xe.PRECISE=Xe;let Nt=[];function Qe(o){if((o=q(o))instanceof Error)return o;let a=Math.floor(o);return a===0||a===1?1:(Nt[a]>0||(Nt[a]=Qe(a-1)*a),Nt[a])}function Ue(o,a){let h=be(o=q(o),a=q(a));if(h)return h;if(a===0)return 0;if(!(o>=0&&a>0||o<=0&&a<0))return b;a=Math.abs(a);let C=-Math.floor(Math.log(a)/Math.log(10));return o>=0?An(Math.floor(o/a)*a,C):-An(Math.ceil(Math.abs(o)/a),C)}Ue.MATH=(o,a,h)=>{if(a instanceof Error)return a;a=a===void 0?0:a;let C=be(o=q(o),a=q(a),h=q(h));if(C)return C;if(a===0)return 0;a=a?Math.abs(a):1;let N=-Math.floor(Math.log(a)/Math.log(10));return o>=0?An(Math.floor(o/a)*a,N):h===0||h===void 0?-An(Math.ceil(Math.abs(o)/a)*a,N):-An(Math.floor(Math.abs(o)/a)*a,N)},Ue.PRECISE=Ue.MATH;let Fg={CEILING:Xe};function Ec(o,a){let h=be(o=q(o),a=q(a));if(h)return h;if(o===0&&a===0)return b;let C=Math.pow(o,a);return isNaN(C)?b:C}function ga(){let o=W(arguments).filter(C=>C!=null);if(o.length===0)return 0;let a=Se(o);if(a instanceof Error)return a;let h=1;for(let C=0;C<a.length;C++)h*=a[C];return h}function An(o,a){return be(o=q(o),a=q(a))||+(Math.round(+(o+"e"+a))+"e"+-1*a)}function ar(){let o=0;return _(V(arguments),a=>{if(o instanceof Error)return!1;if(a instanceof Error)o=a;else if(typeof a=="number")o+=a;else if(typeof a=="string"){let h=parseFloat(a);!isNaN(h)&&(o+=h)}else if(Array.isArray(a)){let h=ar.apply(null,a);h instanceof Error?o=h:o+=h}}),o}var kg=Object.freeze({__proto__:null,ADD:function(o,a){return arguments.length!==2?M:be(o=q(o),a=q(a))||o+a},DIVIDE:function(o,a){return arguments.length!==2?M:be(o=q(o),a=q(a))||(a===0?v:o/a)},EQ:function(o,a){return arguments.length!==2?M:o instanceof Error?o:a instanceof Error?a:(o===null&&(o=void 0),a===null&&(a=void 0),o===a)},GT:function(o,a){return arguments.length!==2?M:o instanceof Error?o:a instanceof Error?a:(Re(o,a)?(o=Ye(o),a=Ye(a)):(o=q(o),a=q(a)),be(o,a)||o>a)},GTE:function(o,a){return arguments.length!==2?M:(Re(o,a)?(o=Ye(o),a=Ye(a)):(o=q(o),a=q(a)),be(o,a)||o>=a)},LT:function(o,a){return arguments.length!==2?M:(Re(o,a)?(o=Ye(o),a=Ye(a)):(o=q(o),a=q(a)),be(o,a)||o<a)},LTE:function(o,a){return arguments.length!==2?M:(Re(o,a)?(o=Ye(o),a=Ye(a)):(o=q(o),a=q(a)),be(o,a)||o<=a)},MINUS:function(o,a){return arguments.length!==2?M:be(o=q(o),a=q(a))||o-a},MULTIPLY:function(o,a){return arguments.length!==2?M:be(o=q(o),a=q(a))||o*a},NE:function(o,a){return arguments.length!==2?M:o instanceof Error?o:a instanceof Error?a:(o===null&&(o=void 0),a===null&&(a=void 0),o!==a)},POW:function(o,a){return arguments.length!==2?M:Ec(o,a)}});let Pg=new Date(Date.UTC(1900,0,1)),Vg=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],Hg=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],hi=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];function vo(o,a,h){h=h.toUpperCase(),o=He(o),a=He(a);let C=o.getFullYear(),N=o.getMonth(),U=o.getDate(),Z=a.getFullYear(),re=a.getMonth(),fe=a.getDate(),je;switch(h){case"Y":je=Math.floor(va(o,a));break;case"D":je=lr(a,o);break;case"M":je=re-N+12*(Z-C),fe<U&&je--;break;case"MD":U<=fe?je=fe-U:(re===0?(o.setFullYear(Z-1),o.setMonth(12)):(o.setFullYear(Z),o.setMonth(re-1)),je=lr(a,o));break;case"YM":je=re-N+12*(Z-C),fe<U&&je--,je%=12;break;case"YD":re>N||re===N&&fe<U?o.setFullYear(Z):o.setFullYear(Z-1),je=lr(a,o)}return je}function gi(o){let a=new Date(o);return a.setHours(0,0,0,0),a}function lr(o,a){return o=He(o),a=He(a),o instanceof Error?o:a instanceof Error?a:Ic(gi(o))-Ic(gi(a))}function Gn(o,a,h){if(h=We(h||"false"),o=He(o),a=He(a),o instanceof Error)return o;if(a instanceof Error)return a;if(h instanceof Error)return h;let C=o.getMonth(),N,U,Z=a.getMonth();if(h)N=o.getDate()===31?30:o.getDate(),U=a.getDate()===31?30:a.getDate();else{let re=new Date(o.getFullYear(),C+1,0).getDate(),fe=new Date(a.getFullYear(),Z+1,0).getDate();N=o.getDate()===re?30:o.getDate(),a.getDate()===fe?N<30?(Z++,U=1):U=30:U=a.getDate()}return 360*(a.getFullYear()-o.getFullYear())+30*(Z-C)+(U-N)}function xc(o){if((o=He(o))instanceof Error)return o;(o=gi(o)).setDate(o.getDate()+4-(o.getDay()||7));let a=new Date(o.getFullYear(),0,1);return Math.ceil(((o-a)/864e5+1)/7)}function mi(o,a,h){return mi.INTL(o,a,1,h)}function vi(o,a,h){return vi.INTL(o,a,1,h)}function ma(o){return new Date(o,1,29).getMonth()===1}function bi(o,a){return Math.ceil((a-o)/1e3/60/60/24)}function va(o,a,h){if((o=He(o))instanceof Error)return o;if((a=He(a))instanceof Error)return a;h=h||0;let C=o.getDate(),N=o.getMonth()+1,U=o.getFullYear(),Z=a.getDate(),re=a.getMonth()+1,fe=a.getFullYear();switch(h){case 0:return C===31&&Z===31?(C=30,Z=30):C===31?C=30:C===30&&Z===31&&(Z=30),(Z+30*re+360*fe-(C+30*N+360*U))/360;case 1:{let je=(Ke,pt)=>{let yt=Ke.getFullYear(),Jt=new Date(yt,2,1);if(ma(yt)&&Ke<Jt&&pt>=Jt)return!0;let _t=pt.getFullYear(),Yn=new Date(_t,2,1);return ma(_t)&&pt>=Yn&&Ke<Yn},_e=365;if(U===fe||U+1===fe&&(N>re||N===re&&C>=Z))return(U===fe&&ma(U)||je(o,a)||re===1&&Z===29)&&(_e=366),bi(o,a)/_e;let $e=fe-U+1,Pe=(new Date(fe+1,0,1)-new Date(U,0,1))/1e3/60/60/24/$e;return bi(o,a)/Pe}case 2:return bi(o,a)/360;case 3:return bi(o,a)/365;case 4:return(Z+30*re+360*fe-(C+30*N+360*U))/360}}function Ic(o){let a=o>-22038912e5?2:1;return Math.ceil((o-Pg)/864e5)+a}function Mc(o){return(o=q(o))===0?p:o instanceof Error?o:String.fromCharCode(o)}function Sc(o){if(ie(o))return o;let a=(o=o||"").charCodeAt(0);return isNaN(a)&&(a=p),a}function Tc(){let o=W(arguments),a=be.apply(void 0,o);if(a)return a;let h=0;for(;(h=o.indexOf(!0))>-1;)o[h]="TRUE";let C=0;for(;(C=o.indexOf(!1))>-1;)o[C]="FALSE";return o.join("")}mi.INTL=(o,a,h,C)=>{if((o=He(o))instanceof Error)return o;if((a=He(a))instanceof Error)return a;let N=!1,U=[],Z=[1,2,3,4,5,6,0],re=new RegExp("^[0|1]{7}$");if(h===void 0)h=hi[1];else if(typeof h=="string"&&re.test(h)){N=!0,h=h.split("");for(let $e=0;$e<h.length;$e++)h[$e]==="1"&&U.push(Z[$e])}else h=hi[h];if(!(h instanceof Array))return p;C===void 0?C=[]:C instanceof Array||(C=[C]);for(let $e=0;$e<C.length;$e++){let Pe=He(C[$e]);if(Pe instanceof Error)return Pe;C[$e]=Pe}let fe=Math.round((a-o)/864e5)+1,je=fe,_e=o;for(let $e=0;$e<fe;$e++){let Pe=new Date().getTimezoneOffset()>0?_e.getUTCDay():_e.getDay(),Ke=N?U.includes(Pe):Pe===h[0]||Pe===h[1];for(let pt=0;pt<C.length;pt++){let yt=C[pt];if(yt.getDate()===_e.getDate()&&yt.getMonth()===_e.getMonth()&&yt.getFullYear()===_e.getFullYear()){Ke=!0;break}}Ke&&je--,_e.setDate(_e.getDate()+1)}return je},vi.INTL=(o,a,h,C)=>{if((o=He(o))instanceof Error)return o;if((a=q(a))instanceof Error)return a;if(a<0)return b;if(!((h=h===void 0?hi[1]:hi[h])instanceof Array))return p;C===void 0?C=[]:C instanceof Array||(C=[C]);for(let U=0;U<C.length;U++){let Z=He(C[U]);if(Z instanceof Error)return Z;C[U]=Z}let N=0;for(;N<a;){o.setDate(o.getDate()+1);let U=o.getDay();if(U!==h[0]&&U!==h[1]){for(let Z=0;Z<C.length;Z++){let re=C[Z];if(re.getDate()===o.getDate()&&re.getMonth()===o.getMonth()&&re.getFullYear()===o.getFullYear()){N--;break}}N++}}return o};let Bg=Tc;function Ac(o,a=2,h=!1){if(o=q(o),isNaN(o)||(a=q(a),isNaN(a)))return p;if(a<0){let C=Math.pow(10,-a);o=Math.round(o/C)*C}else o=o.toFixed(a);if(h)o=o.toString().replace(/,/g,"");else{let C=o.toString().split(".");C[0]=C[0].replace(/\B(?=(\d{3})+$)/g,","),o=C.join(".")}return o}function rn(o,a){return be(o,a)||(o=Ye(o),(a=q(a))instanceof Error?a:new Array(a+1).join(o))}let Ug=Mc,$g=Sc;function ba(o){return/^[01]{1,10}$/.test(o)}function Gt(o,a,h){if(ie(o=q(o),a=q(a)))return o;if((h=h===void 0?"i":h)!=="i"&&h!=="j")return p;if(o===0&&a===0)return 0;if(o===0)return a===1?h:a.toString()+h;if(a===0)return o.toString();{let C=a>0?"+":"";return o.toString()+C+(a===1?h:a.toString()+h)}}function ya(o,a){return a=a===void 0?0:a,ie(o=q(o),a=q(a))?p:g.erf(o)}function wa(o){return isNaN(o)?p:g.erfc(o)}function Ca(o){let a=Et(o),h=Dt(o);return ie(a,h)?p:Math.sqrt(Math.pow(a,2)+Math.pow(h,2))}function Dt(o){if(o===void 0||o===!0||o===!1)return p;if(o===0||o==="0")return 0;if(["i","j"].indexOf(o)>=0)return 1;let a=(o=(o+="").replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j")).indexOf("+"),h=o.indexOf("-");a===0&&(a=o.indexOf("+",1)),h===0&&(h=o.indexOf("-",1));let C=o.substring(o.length-1,o.length),N=C==="i"||C==="j";return a>=0||h>=0?N?a>=0?isNaN(o.substring(0,a))||isNaN(o.substring(a+1,o.length-1))?b:Number(o.substring(a+1,o.length-1)):isNaN(o.substring(0,h))||isNaN(o.substring(h+1,o.length-1))?b:-Number(o.substring(h+1,o.length-1)):b:N?isNaN(o.substring(0,o.length-1))?b:o.substring(0,o.length-1):isNaN(o)?b:0}function ja(o){let a=Et(o),h=Dt(o);return ie(a,h)?p:a===0&&h===0?v:a===0&&h>0?Math.PI/2:a===0&&h<0?-Math.PI/2:h===0&&a>0?0:h===0&&a<0?-Math.PI:a>0?Math.atan(h/a):a<0&&h>=0?Math.atan(h/a)+Math.PI:Math.atan(h/a)-Math.PI}function yi(o){let a=Et(o),h=Dt(o);if(ie(a,h))return p;let C=o.substring(o.length-1);return C=C==="i"||C==="j"?C:"i",Gt(Math.cos(a)*(Math.exp(h)+Math.exp(-h))/2,-Math.sin(a)*(Math.exp(h)-Math.exp(-h))/2,C)}function Nc(o){let a=Et(o),h=Dt(o);if(ie(a,h))return p;let C=o.substring(o.length-1);return C=C==="i"||C==="j"?C:"i",Gt(Math.cos(h)*(Math.exp(a)+Math.exp(-a))/2,Math.sin(h)*(Math.exp(a)-Math.exp(-a))/2,C)}function ur(o,a){let h=Et(o),C=Dt(o),N=Et(a),U=Dt(a);if(ie(h,C,N,U))return p;let Z=o.substring(o.length-1),re=a.substring(a.length-1),fe="i";if((Z==="j"||re==="j")&&(fe="j"),N===0&&U===0)return b;let je=N*N+U*U;return Gt((h*N+C*U)/je,(C*N-h*U)/je,fe)}function Et(o){if(o===void 0||o===!0||o===!1)return p;if(o===0||o==="0"||["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(o)>=0)return 0;let a=(o+="").indexOf("+"),h=o.indexOf("-");a===0&&(a=o.indexOf("+",1)),h===0&&(h=o.indexOf("-",1));let C=o.substring(o.length-1,o.length),N=C==="i"||C==="j";return a>=0||h>=0?N?a>=0?isNaN(o.substring(0,a))||isNaN(o.substring(a+1,o.length-1))?b:Number(o.substring(0,a)):isNaN(o.substring(0,h))||isNaN(o.substring(h+1,o.length-1))?b:Number(o.substring(0,h)):b:N?isNaN(o.substring(0,o.length-1))?b:0:isNaN(o)?b:o}function wi(o){let a=Et(o),h=Dt(o);if(ie(a,h))return p;let C=o.substring(o.length-1);return C=C==="i"||C==="j"?C:"i",Gt(Math.sin(a)*(Math.exp(h)+Math.exp(-h))/2,Math.cos(a)*(Math.exp(h)-Math.exp(-h))/2,C)}function _c(o){let a=Et(o),h=Dt(o);if(ie(a,h))return p;let C=o.substring(o.length-1);return C=C==="i"||C==="j"?C:"i",Gt(Math.cos(h)*(Math.exp(a)-Math.exp(-a))/2,Math.sin(h)*(Math.exp(a)+Math.exp(-a))/2,C)}ya.PRECISE=()=>{throw new Error("ERF.PRECISE is not implemented")},wa.PRECISE=()=>{throw new Error("ERFC.PRECISE is not implemented")};let zg=J.DIST,qg=J.INV,Wg=ee.DIST,Gg=Xe.MATH,Yg=Xe.PRECISE,Zg=k.DIST,Xg=k.DIST.RT,Qg=k.INV,Kg=k.INV.RT,Jg=k.TEST,em=me.P,tm=me.P,nm=me.S,rm=ee.INV,om=wa.PRECISE,im=ya.PRECISE,sm=le.DIST,am=ce.DIST,lm=ce.DIST.RT,um=ce.INV,cm=ce.INV.RT,dm=Ue.MATH,fm=Ue.PRECISE,pm=ce.TEST,hm=Ie.DIST,gm=Ie.INV,mm=Ne.PRECISE,vm=Ge.DIST,bm=ue.INV,ym=ue.DIST,wm=ue.INV,Cm=S.MULT,jm=S.SNGL,Dm=R.DIST,Em=mi.INTL,xm=Y.DIST,Im=Y.INV,Mm=Y.S.DIST,Sm=Y.S.INV,Tm=ne.EXC,Am=ne.INC,Nm=Q.EXC,_m=Q.INC,Rm=ve.DIST,Om=Ce.EXC,Lm=Ce.INC,Fm=De.AVG,km=De.EQ,Pm=xe.P,Vm=qe.P,Hm=qe.S,Bm=ct.DIST,Um=ct.DIST.RT,$m=ct.INV,zm=ct.TEST,qm=te.P,Wm=te.S,Gm=Fe.DIST,Ym=vi.INTL,Zm=dt.TEST;function Da(o){let a=[];return _(o,h=>{h&&a.push(h)}),a}function dn(o,a){let h={};for(let U=1;U<o[0].length;++U)h[U]=!0;let C=a[0].length;for(let U=1;U<a.length;++U)a[U].length>C&&(C=a[U].length);for(let U=1;U<o.length;++U)for(let Z=1;Z<o[U].length;++Z){let re=!1,fe=!1;for(let je=0;je<a.length;++je){let _e=a[je];if(_e.length<C)continue;let $e=_e[0];if(o[U][0]===$e){fe=!0;for(let Pe=1;Pe<_e.length;++Pe)if(!re)if(_e[Pe]===void 0||_e[Pe]==="*")re=!0;else{let Ke=yn(_e[Pe]+""),pt=[Xt(o[U][Z],At)].concat(Ke);re=Qt(pt)}}}fe&&(h[Z]=h[Z]&&re)}let N=[];for(let U=0;U<o[0].length;++U)h[U]&&N.push(U-1);return N}function Ea(o){return o&&o.getTime&&!isNaN(o.getTime())}function xa(o){return o instanceof Date?o:new Date(o)}function cr(o,a,h,C,N){if(C=C||0,N=N||0,ie(o=q(o),a=q(a),h=q(h),C=q(C),N=q(N)))return p;let U;if(o===0)U=C+h*a;else{let Z=Math.pow(1+o,a);U=N===1?C*Z+h*(1+o)*(Z-1)/o:C*Z+h*(Z-1)/o}return-U}function Rc(o,a,h,C,N,U){if(N=N||0,U=U||0,ie(o=q(o),a=q(a),h=q(h),C=q(C),N=q(N),U=q(U)))return p;let Z=bo(o,h,C,N,U);return(a===1?U===1?0:-C:U===1?cr(o,a-2,Z,C,1)-Z:cr(o,a-1,Z,C,0))*o}function Ia(){let o=Se(W(arguments));if(o instanceof Error)return o;let a=o[0],h=0;for(let C=1;C<o.length;C++)h+=o[C]/Math.pow(1+a,C);return h}function bo(o,a,h,C,N){if(C=C||0,N=N||0,ie(o=q(o),a=q(a),h=q(h),C=q(C),N=q(N)))return p;let U;if(o===0)U=(h+C)/a;else{let Z=Math.pow(1+o,a);U=N===1?(C*o/(Z-1)+h*o/(1-1/Z))/(1+o):C*o/(Z-1)+h*o/(1-1/Z)}return-U}let Xm={errors:F,symbols:kg};u.ABS=function(o){return(o=q(o))instanceof Error?o:Math.abs(o)},u.ACCRINT=function(o,a,h,C,N,U,Z){return o=xa(o),a=xa(a),h=xa(h),Ea(o)&&Ea(a)&&Ea(h)?C<=0||N<=0||[1,2,4].indexOf(U)===-1||[0,1,2,3,4].indexOf(Z)===-1||h<=o?b:(N=N||0)*C*va(o,h,Z=Z||0):p},u.ACCRINTM=function(){throw new Error("ACCRINTM is not implemented")},u.ACOS=function(o){if((o=q(o))instanceof Error)return o;let a=Math.acos(o);return isNaN(a)&&(a=b),a},u.ACOSH=function(o){if((o=q(o))instanceof Error)return o;let a=Math.log(o+Math.sqrt(o*o-1));return isNaN(a)&&(a=b),a},u.ACOT=function(o){return(o=q(o))instanceof Error?o:Math.atan(1/o)},u.ACOTH=function(o){if((o=q(o))instanceof Error)return o;let a=.5*Math.log((o+1)/(o-1));return isNaN(a)&&(a=b),a},u.AGGREGATE=function(o,a,h,C){if(ie(o=q(o),q(o)))return p;switch(o){case 1:return d(h);case 2:return H(h);case 3:return G(h);case 4:return ye(h);case 5:return X(h);case 6:return ga(h);case 7:return qe.S(h);case 8:return qe.P(h);case 9:return ar(h);case 10:return te.S(h);case 11:return te.P(h);case 12:return z(h);case 13:return S.SNGL(h);case 14:return lt(h,C);case 15:return ke(h,C);case 16:return ne.INC(h,C);case 17:return Ce.INC(h,C);case 18:return ne.EXC(h,C);case 19:return Ce.EXC(h,C)}},u.AMORDEGRC=function(){throw new Error("AMORDEGRC is not implemented")},u.AMORLINC=function(){throw new Error("AMORLINC is not implemented")},u.AND=function(){let o=W(arguments),a=p;for(let h=0;h<o.length;h++){if(o[h]instanceof Error)return o[h];o[h]!==void 0&&o[h]!==null&&typeof o[h]!="string"&&(a===p&&(a=!0),o[h]||(a=!1))}return a},u.ARABIC=function(o){if(o==null)return 0;if(o instanceof Error)return o;if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(o))return p;let a=0;return o.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,h=>{a+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[h]}),a},u.ASC=function(){throw new Error("ASC is not implemented")},u.ASIN=function(o){if((o=q(o))instanceof Error)return o;let a=Math.asin(o);return isNaN(a)&&(a=b),a},u.ASINH=function(o){return(o=q(o))instanceof Error?o:Math.log(o+Math.sqrt(o*o+1))},u.ATAN=function(o){return(o=q(o))instanceof Error?o:Math.atan(o)},u.ATAN2=function(o,a){return be(o=q(o),a=q(a))||Math.atan2(o,a)},u.ATANH=function(o){if((o=q(o))instanceof Error)return o;let a=Math.log((1+o)/(1-o))/2;return isNaN(a)&&(a=b),a},u.AVEDEV=function(){let o=W(arguments).filter(Ae);if(o.length===0)return b;let a=Se(o);return a instanceof Error?a:g.sum(g(a).subtract(g.mean(a)).abs()[0])/a.length},u.AVERAGE=d,u.AVERAGEA=B,u.AVERAGEIF=function(o,a,h){if(arguments.length<=1)return M;if(h=Se(W(h=h||o).filter(Ae)),o=W(o),h instanceof Error)return h;let C=0,N=0,U=a===void 0||a==="*",Z=U?null:yn(a+"");for(let re=0;re<o.length;re++){let fe=o[re];if(U)N+=h[re],C++;else{let je=[Xt(fe,At)].concat(Z);Qt(je)&&(N+=h[re],C++)}}return N/C},u.AVERAGEIFS=function(){let o=V(arguments),a=(o.length-1)/2,h=W(o[0]),C=0,N=0;for(let Z=0;Z<h.length;Z++){let re=!1;for(let fe=0;fe<a;fe++){let je=o[2*fe+1][Z],_e=o[2*fe+2],$e=!1;if(_e===void 0||_e==="*")$e=!0;else{let Pe=yn(_e+""),Ke=[Xt(je,At)].concat(Pe);$e=Qt(Ke)}if(!$e){re=!1;break}re=!0}re&&(N+=h[Z],C++)}let U=N/C;return isNaN(U)?0:U},u.BAHTTEXT=function(){throw new Error("BAHTTEXT is not implemented")},u.BASE=function(o,a,h){let C=be(o=q(o),a=q(a),h=q(h));if(C)return C;if(a===0)return b;let N=o.toString(a);return new Array(Math.max(h+1-N.length,0)).join("0")+N},u.BESSELI=function(o,a){return ie(o=q(o),a=q(a))?p:D.besseli(o,a)},u.BESSELJ=function(o,a){return ie(o=q(o),a=q(a))?p:D.besselj(o,a)},u.BESSELK=function(o,a){return ie(o=q(o),a=q(a))?p:D.besselk(o,a)},u.BESSELY=function(o,a){return ie(o=q(o),a=q(a))?p:D.bessely(o,a)},u.BETA=J,u.BETADIST=zg,u.BETAINV=qg,u.BIN2DEC=function(o){if(!ba(o))return b;let a=parseInt(o,2),h=o.toString();return h.length===10&&h.substring(0,1)==="1"?parseInt(h.substring(1),2)-512:a},u.BIN2HEX=function(o,a){if(!ba(o))return b;let h=o.toString();if(h.length===10&&h.substring(0,1)==="1")return(0xfffffffe00+parseInt(h.substring(1),2)).toString(16);let C=parseInt(o,2).toString(16);return a===void 0?C:isNaN(a)?p:a<0?b:(a=Math.floor(a))>=C.length?rn("0",a-C.length)+C:b},u.BIN2OCT=function(o,a){if(!ba(o))return b;let h=o.toString();if(h.length===10&&h.substring(0,1)==="1")return(1073741312+parseInt(h.substring(1),2)).toString(8);let C=parseInt(o,2).toString(8);return a===void 0?C:isNaN(a)?p:a<0?b:(a=Math.floor(a))>=C.length?rn("0",a-C.length)+C:b},u.BINOM=ee,u.BINOMDIST=Wg,u.BITAND=function(o,a){return ie(o=q(o),a=q(a))?p:o<0||a<0||Math.floor(o)!==o||Math.floor(a)!==a||o>0xffffffffffff||a>0xffffffffffff?b:o&a},u.BITLSHIFT=function(o,a){return ie(o=q(o),a=q(a))?p:o<0||Math.floor(o)!==o||o>0xffffffffffff||Math.abs(a)>53?b:a>=0?o<<a:o>>-a},u.BITOR=function(o,a){return ie(o=q(o),a=q(a))?p:o<0||a<0||Math.floor(o)!==o||Math.floor(a)!==a||o>0xffffffffffff||a>0xffffffffffff?b:o|a},u.BITRSHIFT=function(o,a){return ie(o=q(o),a=q(a))?p:o<0||Math.floor(o)!==o||o>0xffffffffffff||Math.abs(a)>53?b:a>=0?o>>a:o<<-a},u.BITXOR=function(o,a){return ie(o=q(o),a=q(a))?p:o<0||a<0||Math.floor(o)!==o||Math.floor(a)!==a||o>0xffffffffffff||a>0xffffffffffff?b:o^a},u.CEILING=Xe,u.CEILINGMATH=Gg,u.CEILINGPRECISE=Yg,u.CELL=function(){throw new Error("CELL is not implemented")},u.CHAR=Mc,u.CHIDIST=Zg,u.CHIDISTRT=Xg,u.CHIINV=Qg,u.CHIINVRT=Kg,u.CHISQ=k,u.CHITEST=Jg,u.CHOOSE=function(){if(arguments.length<2)return M;let o=arguments[0];return o<1||o>254||arguments.length<o+1?p:arguments[o]},u.CLEAN=function(o){return ie(o)?o:(o=o||"").replace(/[\0-\x1F]/g,"")},u.CODE=Sc,u.COLUMN=function(o,a){return arguments.length!==2?M:a<0?b:o instanceof Array&&typeof a=="number"?o.length!==0?g.col(o,a):void 0:p},u.COLUMNS=function(o){return arguments.length!==1?M:o instanceof Array?o.length===0?0:g.cols(o):p},u.COMBIN=Ct,u.COMBINA=function(o,a){return be(o=q(o),a=q(a))||(o<a?b:o===0&&a===0?1:Ct(o+a-1,o-1))},u.COMPLEX=Gt,u.CONCAT=Bg,u.CONCATENATE=Tc,u.CONFIDENCE=L,u.CONVERT=function(o,a,h){if((o=q(o))instanceof Error)return o;let C=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["\xE5ngstr\xF6m","\xC5",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic \xE5ngstr\xF6m","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,416818182544058e-5],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,758660370370369e-22],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","\xB0",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519538e-3],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["\u0153rsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","\u03A9",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdest\xE4rke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square \xE5ngstr\xF6m","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988110336e-6],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],N={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,1152921504606847e3,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},U={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]},Z,re=null,fe=null,je=a,_e=h,$e=1,Pe=1;for(let Ke=0;Ke<C.length;Ke++)Z=C[Ke][2]===null?[]:C[Ke][2],(C[Ke][1]===je||Z.indexOf(je)>=0)&&(re=C[Ke]),(C[Ke][1]===_e||Z.indexOf(_e)>=0)&&(fe=C[Ke]);if(re===null){let Ke=N[a.substring(0,2)],pt=U[a.substring(0,1)];a.substring(0,2)==="da"&&(pt=["dekao",10,"da"]),Ke?($e=Ke[2],je=a.substring(2)):pt&&($e=pt[1],je=a.substring(pt[2].length));for(let yt=0;yt<C.length;yt++)Z=C[yt][2]===null?[]:C[yt][2],(C[yt][1]===je||Z.indexOf(je)>=0)&&(re=C[yt])}if(fe===null){let Ke=N[h.substring(0,2)],pt=U[h.substring(0,1)];h.substring(0,2)==="da"&&(pt=["dekao",10,"da"]),Ke?(Pe=Ke[2],_e=h.substring(2)):pt&&(Pe=pt[1],_e=h.substring(pt[2].length));for(let yt=0;yt<C.length;yt++)Z=C[yt][2]===null?[]:C[yt][2],(C[yt][1]===_e||Z.indexOf(_e)>=0)&&(fe=C[yt])}return re===null||fe===null||re[3]!==fe[3]?M:o*re[6]*$e/(fe[6]*Pe)},u.CORREL=function(o,a){return ie(o=Se(W(o)),a=Se(W(a)))?p:g.corrcoeff(o,a)},u.COS=function(o){return(o=q(o))instanceof Error?o:Math.cos(o)},u.COSH=function(o){return(o=q(o))instanceof Error?o:(Math.exp(o)+Math.exp(-o))/2},u.COT=function(o){return(o=q(o))instanceof Error?o:o===0?v:1/Math.tan(o)},u.COTH=function(o){if((o=q(o))instanceof Error)return o;if(o===0)return v;let a=Math.exp(2*o);return(a+1)/(a-1)},u.COUNT=H,u.COUNTA=G,u.COUNTBLANK=oe,u.COUNTIF=function(o,a){if(o=W(o),a===void 0||a==="*")return o.length;let h=0,C=yn(a+"");for(let N=0;N<o.length;N++){let U=[Xt(o[N],At)].concat(C);Qt(U)&&h++}return h},u.COUNTIFS=function(){let o=V(arguments),a=new Array(W(o[0]).length);for(let C=0;C<a.length;C++)a[C]=!0;for(let C=0;C<o.length;C+=2){let N=W(o[C]),U=o[C+1];if(U!==void 0&&U!=="*"){let Z=yn(U+"");for(let re=0;re<N.length;re++){let fe=[Xt(N[re],At)].concat(Z);a[re]=a[re]&&Qt(fe)}}}let h=0;for(let C=0;C<a.length;C++)a[C]&&h++;return h},u.COUPDAYBS=function(){throw new Error("COUPDAYBS is not implemented")},u.COUPDAYS=function(){throw new Error("COUPDAYS is not implemented")},u.COUPDAYSNC=function(){throw new Error("COUPDAYSNC is not implemented")},u.COUPNCD=function(){throw new Error("COUPNCD is not implemented")},u.COUPNUM=function(){throw new Error("COUPNUM is not implemented")},u.COUPPCD=function(){throw new Error("COUPPCD is not implemented")},u.COVAR=em,u.COVARIANCE=me,u.COVARIANCEP=tm,u.COVARIANCES=nm,u.CRITBINOM=rm,u.CSC=function(o){return(o=q(o))instanceof Error?o:o===0?v:1/Math.sin(o)},u.CSCH=function(o){return(o=q(o))instanceof Error?o:o===0?v:2/(Math.exp(o)-Math.exp(-o))},u.CUMIPMT=function(o,a,h,C,N,U){if(ie(o=q(o),a=q(a),h=q(h)))return p;if(o<=0||a<=0||h<=0||C<1||N<1||C>N||U!==0&&U!==1)return b;let Z=bo(o,a,h,0,U),re=0;C===1&&(U===0&&(re=-h),C++);for(let fe=C;fe<=N;fe++)re+=U===1?cr(o,fe-2,Z,h,1)-Z:cr(o,fe-1,Z,h,0);return re*=o,re},u.CUMPRINC=function(o,a,h,C,N,U){if(ie(o=q(o),a=q(a),h=q(h)))return p;if(o<=0||a<=0||h<=0||C<1||N<1||C>N||U!==0&&U!==1)return b;let Z=bo(o,a,h,0,U),re=0;C===1&&(re=U===0?Z+h*o:Z,C++);for(let fe=C;fe<=N;fe++)re+=U>0?Z-(cr(o,fe-2,Z,h,1)-Z)*o:Z-cr(o,fe-1,Z,h,0)*o;return re},u.DATE=function(o,a,h){let C;return ie(o=q(o),a=q(a),h=q(h))?C=p:(C=new Date(o,a-1,h),C.getFullYear()<0&&(C=b)),C},u.DATEDIF=vo,u.DATEVALUE=function(o){if(typeof o!="string")return p;let a=Date.parse(o);return isNaN(a)?p:new Date(o)},u.DAVERAGE=function(o,a,h){if(isNaN(a)&&typeof a!="string")return p;let C=dn(o,h),N=[];if(typeof a=="string"){let Z=Me(o,a);N=ae(o[Z])}else N=ae(o[a]);let U=0;return _(C,Z=>{U+=N[Z]}),C.length===0?v:U/C.length},u.DAY=function(o){let a=He(o);return a instanceof Error?a:a.getDate()},u.DAYS=lr,u.DAYS360=Gn,u.DB=function(o,a,h,C,N){if(N=N===void 0?12:N,ie(o=q(o),a=q(a),h=q(h),C=q(C),N=q(N)))return p;if(o<0||a<0||h<0||C<0||[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(N)===-1||C>h)return b;if(a>=o)return 0;let U=(1-Math.pow(a/o,1/h)).toFixed(3),Z=o*U*N/12,re=Z,fe=0,je=C===h?h-1:C;for(let _e=2;_e<=je;_e++)fe=(o-re)*U,re+=fe;return C===1?Z:C===h?(o-re)*U:fe},u.DBCS=function(){throw new Error("DBCS is not implemented")},u.DCOUNT=function(o,a,h){if(isNaN(a)&&typeof a!="string")return p;let C=dn(o,h),N=[];if(typeof a=="string"){let Z=Me(o,a);N=ae(o[Z])}else N=ae(o[a]);let U=[];return _(C,Z=>{U.push(N[Z])}),H(U)},u.DCOUNTA=function(o,a,h){if(isNaN(a)&&typeof a!="string")return p;let C=dn(o,h),N=[];if(typeof a=="string"){let Z=Me(o,a);N=ae(o[Z])}else N=ae(o[a]);let U=[];return _(C,Z=>{U.push(N[Z])}),G(U)},u.DDB=function(o,a,h,C,N){if(N=N===void 0?2:N,ie(o=q(o),a=q(a),h=q(h),C=q(C),N=q(N)))return p;if(o<0||a<0||h<0||C<0||N<=0||C>h)return b;if(a>=o)return 0;let U=0,Z=0;for(let re=1;re<=C;re++)Z=Math.min(N/h*(o-U),o-a-U),U+=Z;return Z},u.DEC2BIN=function(o,a){if((o=q(o))instanceof Error)return o;if(!/^-?[0-9]{1,3}$/.test(o)||o<-512||o>511)return b;if(o<0)return"1"+rn("0",9-(512+o).toString(2).length)+(512+o).toString(2);let h=parseInt(o,10).toString(2);return a===void 0?h:isNaN(a)?p:a<0?b:(a=Math.floor(a))>=h.length?rn("0",a-h.length)+h:b},u.DEC2HEX=function(o,a){if((o=q(o))instanceof Error)return o;if(!/^-?[0-9]{1,12}$/.test(o)||o<-549755813888||o>549755813887)return b;if(o<0)return(1099511627776+o).toString(16);let h=parseInt(o,10).toString(16);return a===void 0?h:isNaN(a)?p:a<0?b:(a=Math.floor(a))>=h.length?rn("0",a-h.length)+h:b},u.DEC2OCT=function(o,a){if((o=q(o))instanceof Error)return o;if(!/^-?[0-9]{1,9}$/.test(o)||o<-536870912||o>536870911)return b;if(o<0)return(1073741824+o).toString(8);let h=parseInt(o,10).toString(8);return a===void 0?h:isNaN(a)?p:a<0?b:(a=Math.floor(a))>=h.length?rn("0",a-h.length)+h:b},u.DECIMAL=function(o,a){return arguments.length<1?p:be(o=q(o),a=q(a))||(a===0?b:parseInt(o,a))},u.DEGREES=function(o){return(o=q(o))instanceof Error?o:180*o/Math.PI},u.DELTA=function(o,a){return a=a===void 0?0:a,ie(o=q(o),a=q(a))?p:o===a?1:0},u.DEVSQ=function(){let o=Se(W(arguments));if(o instanceof Error)return o;let a=g.mean(o),h=0;for(let C=0;C<o.length;C++)h+=Math.pow(o[C]-a,2);return h},u.DGET=function(o,a,h){if(isNaN(a)&&typeof a!="string")return p;let C=dn(o,h),N=[];return N=ae(typeof a=="string"?o[Me(o,a)]:o[a]),C.length===0?p:C.length>1?b:N[C[0]]},u.DISC=function(o,a,h,C,N){if(ie(o=He(o),a=He(a),h=q(h),C=q(C),N=(N=q(N))||0))return p;if(h<=0||C<=0)return b;if(o>=a)return p;let U,Z;switch(N){case 0:U=360,Z=Gn(o,a,!1);break;case 1:case 3:U=365,Z=vo(o,a,"D");break;case 2:U=360,Z=vo(o,a,"D");break;case 4:U=360,Z=Gn(o,a,!0);break;default:return b}return(C-h)/C*U/Z},u.DMAX=function(o,a,h){if(isNaN(a)&&typeof a!="string")return p;let C=dn(o,h),N=[];if(typeof a=="string"){let Z=Me(o,a);N=ae(o[Z])}else N=ae(o[a]);let U=N[C[0]];return _(C,Z=>{U<N[Z]&&(U=N[Z])}),U},u.DMIN=function(o,a,h){if(isNaN(a)&&typeof a!="string")return p;let C=dn(o,h),N=[];if(typeof a=="string"){let Z=Me(o,a);N=ae(o[Z])}else N=ae(o[a]);let U=N[C[0]];return _(C,Z=>{U>N[Z]&&(U=N[Z])}),U},u.DOLLAR=function(o,a=2){if(o=q(o),isNaN(o))return p;let h={style:"currency",currency:"USD",minimumFractionDigits:a>=0?a:0,maximumFractionDigits:a>=0?a:0},C=(o=An(o,a)).toLocaleString("en-US",h);return o<0?"$("+C.slice(2)+")":C},u.DOLLARDE=function(o,a){if(ie(o=q(o),a=q(a)))return p;if(a<0)return b;if(a>=0&&a<1)return v;a=parseInt(a,10);let h=parseInt(o,10);h+=o%1*Math.pow(10,Math.ceil(Math.log(a)/Math.LN10))/a;let C=Math.pow(10,Math.ceil(Math.log(a)/Math.LN2)+1);return h=Math.round(h*C)/C,h},u.DOLLARFR=function(o,a){if(ie(o=q(o),a=q(a)))return p;if(a<0)return b;if(a>=0&&a<1)return v;a=parseInt(a,10);let h=parseInt(o,10);return h+=o%1*Math.pow(10,-Math.ceil(Math.log(a)/Math.LN10))*a,h},u.DPRODUCT=function(o,a,h){if(isNaN(a)&&typeof a!="string")return p;let C=dn(o,h),N=[];if(typeof a=="string"){let re=Me(o,a);N=ae(o[re])}else N=ae(o[a]);let U=[];_(C,re=>{U.push(N[re])}),U=Da(U);let Z=1;return _(U,re=>{Z*=re}),Z},u.DSTDEV=function(o,a,h){if(isNaN(a)&&typeof a!="string")return p;let C=dn(o,h),N=[];if(typeof a=="string"){let Z=Me(o,a);N=ae(o[Z])}else N=ae(o[a]);let U=[];return _(C,Z=>{U.push(N[Z])}),U=Da(U),qe.S(U)},u.DSTDEVP=function(o,a,h){if(isNaN(a)&&typeof a!="string")return p;let C=dn(o,h),N=[];if(typeof a=="string"){let Z=Me(o,a);N=ae(o[Z])}else N=ae(o[a]);let U=[];return _(C,Z=>{U.push(N[Z])}),U=Da(U),qe.P(U)},u.DSUM=function(o,a,h){if(isNaN(a)&&typeof a!="string")return p;let C=dn(o,h),N=[];if(typeof a=="string"){let Z=Me(o,a);N=ae(o[Z])}else N=ae(o[a]);let U=[];return _(C,Z=>{U.push(N[Z])}),ar(U)},u.DURATION=function(){throw new Error("DURATION is not implemented")},u.DVAR=function(o,a,h){if(isNaN(a)&&typeof a!="string")return p;let C=dn(o,h),N=[];if(typeof a=="string"){let Z=Me(o,a);N=ae(o[Z])}else N=ae(o[a]);let U=[];return _(C,Z=>{U.push(N[Z])}),te.S(U)},u.DVARP=function(o,a,h){if(isNaN(a)&&typeof a!="string")return p;let C=dn(o,h),N=[];if(typeof a=="string"){let Z=Me(o,a);N=ae(o[Z])}else N=ae(o[a]);let U=[];return _(C,Z=>{U.push(N[Z])}),te.P(U)},u.EDATE=function(o,a){return(o=He(o))instanceof Error?o:isNaN(a)?p:(a=parseInt(a,10),o.setMonth(o.getMonth()+a),o)},u.EFFECT=function(o,a){return ie(o=q(o),a=q(a))?p:o<=0||a<1?b:(a=parseInt(a,10),Math.pow(1+o/a,a)-1)},u.EOMONTH=function(o,a){return(o=He(o))instanceof Error?o:isNaN(a)?p:(a=parseInt(a,10),new Date(o.getFullYear(),o.getMonth()+a+1,0))},u.ERF=ya,u.ERFC=wa,u.ERFCPRECISE=om,u.ERFPRECISE=im,u.ERROR=fi,u.EVEN=function(o){return(o=q(o))instanceof Error?o:Xe(o,-2,-1)},u.EXACT=function(o,a){return arguments.length!==2?M:be(o,a)||(o=Ye(o))===Ye(a)},u.EXP=function(o){return arguments.length<1?M:arguments.length>1?A:(o=q(o))instanceof Error?o:o=Math.exp(o)},u.EXPON=le,u.EXPONDIST=sm,u.F=ce,u.FACT=Qe,u.FACTDOUBLE=function o(a){if((a=q(a))instanceof Error)return a;let h=Math.floor(a);return h<=0?1:h*o(h-2)},u.FALSE=function(){return!1},u.FDIST=am,u.FDISTRT=lm,u.FIND=function(o,a,h){if(arguments.length<2)return M;o=Ye(o),h=h===void 0?0:h;let C=(a=Ye(a)).indexOf(o,h-1);return C===-1?p:C+1},u.FINV=um,u.FINVRT=cm,u.FISHER=function(o){return(o=q(o))instanceof Error?o:Math.log((1+o)/(1-o))/2},u.FISHERINV=function(o){if((o=q(o))instanceof Error)return o;let a=Math.exp(2*o);return(a-1)/(a+1)},u.FIXED=Ac,u.FLOOR=Ue,u.FLOORMATH=dm,u.FLOORPRECISE=fm,u.FORECAST=Te,u.FREQUENCY=function(o,a){if(ie(o=Se(W(o)),a=Se(W(a))))return p;let h=o.length,C=a.length,N=[];for(let U=0;U<=C;U++){N[U]=0;for(let Z=0;Z<h;Z++)U===0?o[Z]<=a[0]&&(N[0]+=1):U<C?o[Z]>a[U-1]&&o[Z]<=a[U]&&(N[U]+=1):U===C&&o[Z]>a[C-1]&&(N[C]+=1)}return N},u.FTEST=pm,u.FV=cr,u.FVSCHEDULE=function(o,a){if(ie(o=q(o),a=Se(W(a))))return p;let h=a.length,C=o;for(let N=0;N<h;N++)C*=1+a[N];return C},u.GAMMA=Ie,u.GAMMADIST=hm,u.GAMMAINV=gm,u.GAMMALN=Ne,u.GAMMALNPRECISE=mm,u.GAUSS=function(o){return(o=q(o))instanceof Error?o:g.normal.cdf(o,0,1)-.5},u.GCD=function(){let o=Se(W(arguments));if(o instanceof Error)return o;let a=o.length,h=o[0],C=h<0?-h:h;for(let N=1;N<a;N++){let U=o[N],Z=U<0?-U:U;for(;C&&Z;)C>Z?C%=Z:Z%=C;C+=Z}return C},u.GEOMEAN=function(){let o=Se(W(arguments));return o instanceof Error?o:g.geomean(o)},u.GESTEP=function(o,a){return ie(a=a||0,o=q(o))?o:o>=a?1:0},u.GROWTH=function(o,a,h,C){if((o=Se(o))instanceof Error)return o;let N;if(a===void 0)for(a=[],N=1;N<=o.length;N++)a.push(N);if(h===void 0)for(h=[],N=1;N<=o.length;N++)h.push(N);if(ie(a=Se(a),h=Se(h)))return p;C===void 0&&(C=!0);let U=o.length,Z,re,fe=0,je=0,_e=0,$e=0;for(N=0;N<U;N++){let Ke=a[N],pt=Math.log(o[N]);fe+=Ke,je+=pt,_e+=Ke*pt,$e+=Ke*Ke}fe/=U,je/=U,_e/=U,$e/=U,C?(Z=(_e-fe*je)/($e-fe*fe),re=je-Z*fe):(Z=_e/$e,re=0);let Pe=[];for(N=0;N<h.length;N++)Pe.push(Math.exp(re+Z*h[N]));return Pe},u.HARMEAN=function(){let o=Se(W(arguments));if(o instanceof Error)return o;let a=o.length,h=0;for(let C=0;C<a;C++)h+=1/o[C];return a/h},u.HEX2BIN=function(o,a){if(!/^[0-9A-Fa-f]{1,10}$/.test(o))return b;let h=!(o.length!==10||o.substring(0,1).toLowerCase()!=="f"),C=h?parseInt(o,16)-1099511627776:parseInt(o,16);if(C<-512||C>511)return b;if(h)return"1"+rn("0",9-(512+C).toString(2).length)+(512+C).toString(2);let N=C.toString(2);return a===void 0?N:isNaN(a)?p:a<0?b:(a=Math.floor(a))>=N.length?rn("0",a-N.length)+N:b},u.HEX2DEC=function(o){if(!/^[0-9A-Fa-f]{1,10}$/.test(o))return b;let a=parseInt(o,16);return a>=549755813888?a-1099511627776:a},u.HEX2OCT=function(o,a){if(!/^[0-9A-Fa-f]{1,10}$/.test(o))return b;let h=parseInt(o,16);if(h>536870911&&h<0xffe0000000)return b;if(h>=0xffe0000000)return(h-0xffc0000000).toString(8);let C=h.toString(8);return a===void 0?C:isNaN(a)?p:a<0?b:(a=Math.floor(a))>=C.length?rn("0",a-C.length)+C:b},u.HLOOKUP=function(o,a,h,C){return m(o,we(a),h,C)},u.HOUR=function(o){return(o=He(o))instanceof Error?o:o.getHours()},u.HYPGEOM=Ge,u.HYPGEOMDIST=vm,u.IF=function(o,a,h){return o instanceof Error?o:((a=!(arguments.length>=2)||a)==null&&(a=0),(h=arguments.length===3&&h)==null&&(h=0),o?a:h)},u.IFERROR=function(o,a){return Ut(o)?a:o},u.IFNA=function(o,a){return o===M?a:o},u.IFS=function(){for(let o=0;o<arguments.length/2;o++)if(arguments[2*o])return arguments[2*o+1];return M},u.IMABS=Ca,u.IMAGINARY=Dt,u.IMARGUMENT=ja,u.IMCONJUGATE=function(o){let a=Et(o),h=Dt(o);if(ie(a,h))return p;let C=o.substring(o.length-1);return C=C==="i"||C==="j"?C:"i",h!==0?Gt(a,-h,C):o},u.IMCOS=yi,u.IMCOSH=Nc,u.IMCOT=function(o){return ie(Et(o),Dt(o))?p:ur(yi(o),wi(o))},u.IMCSC=function(o){return o===!0||o===!1?p:ie(Et(o),Dt(o))?b:ur("1",wi(o))},u.IMCSCH=function(o){return o===!0||o===!1?p:ie(Et(o),Dt(o))?b:ur("1",_c(o))},u.IMDIV=ur,u.IMEXP=function(o){let a=Et(o),h=Dt(o);if(ie(a,h))return p;let C=o.substring(o.length-1);C=C==="i"||C==="j"?C:"i";let N=Math.exp(a);return Gt(N*Math.cos(h),N*Math.sin(h),C)},u.IMLN=function(o){let a=Et(o),h=Dt(o);if(ie(a,h))return p;let C=o.substring(o.length-1);return C=C==="i"||C==="j"?C:"i",Gt(Math.log(Math.sqrt(a*a+h*h)),Math.atan(h/a),C)},u.IMLOG10=function(o){let a=Et(o),h=Dt(o);if(ie(a,h))return p;let C=o.substring(o.length-1);return C=C==="i"||C==="j"?C:"i",Gt(Math.log(Math.sqrt(a*a+h*h))/Math.log(10),Math.atan(h/a)/Math.log(10),C)},u.IMLOG2=function(o){let a=Et(o),h=Dt(o);if(ie(a,h))return p;let C=o.substring(o.length-1);return C=C==="i"||C==="j"?C:"i",Gt(Math.log(Math.sqrt(a*a+h*h))/Math.log(2),Math.atan(h/a)/Math.log(2),C)},u.IMPOWER=function(o,a){if(ie(a=q(a),Et(o),Dt(o)))return p;let h=o.substring(o.length-1);h=h==="i"||h==="j"?h:"i";let C=Math.pow(Ca(o),a),N=ja(o);return Gt(C*Math.cos(a*N),C*Math.sin(a*N),h)},u.IMPRODUCT=function(){let o=arguments[0];if(!arguments.length)return p;for(let a=1;a<arguments.length;a++){let h=Et(o),C=Dt(o),N=Et(arguments[a]),U=Dt(arguments[a]);if(ie(h,C,N,U))return p;o=Gt(h*N-C*U,h*U+C*N)}return o},u.IMREAL=Et,u.IMSEC=function(o){return o===!0||o===!1||ie(Et(o),Dt(o))?p:ur("1",yi(o))},u.IMSECH=function(o){return ie(Et(o),Dt(o))?p:ur("1",Nc(o))},u.IMSIN=wi,u.IMSINH=_c,u.IMSQRT=function(o){if(ie(Et(o),Dt(o)))return p;let a=o.substring(o.length-1);a=a==="i"||a==="j"?a:"i";let h=Math.sqrt(Ca(o)),C=ja(o);return Gt(h*Math.cos(C/2),h*Math.sin(C/2),a)},u.IMSUB=function(o,a){let h=Et(o),C=Dt(o),N=Et(a),U=Dt(a);if(ie(h,C,N,U))return p;let Z=o.substring(o.length-1),re=a.substring(a.length-1),fe="i";return(Z==="j"||re==="j")&&(fe="j"),Gt(h-N,C-U,fe)},u.IMSUM=function(){if(!arguments.length)return p;let o=W(arguments),a=o[0];for(let h=1;h<o.length;h++){let C=Et(a),N=Dt(a),U=Et(o[h]),Z=Dt(o[h]);if(ie(C,N,U,Z))return p;a=Gt(C+U,N+Z)}return a},u.IMTAN=function(o){return o===!0||o===!1||ie(Et(o),Dt(o))?p:ur(wi(o),yi(o))},u.INDEX=function(o,a,h){let C=be(o,a,h);if(C)return C;if(!Array.isArray(o))return p;let N=o.length>0&&!Array.isArray(o[0]);return N&&!h?(h=a,a=1):(h=h||1,a=a||1),h<0||a<0?p:N&&a===1&&h<=o.length?o[h-1]:a<=o.length&&h<=o[a-1].length?o[a-1][h-1]:w},u.INFO=function(){throw new Error("INFO is not implemented")},u.INT=function(o){return(o=q(o))instanceof Error?o:Math.floor(o)},u.INTERCEPT=function(o,a){return ie(o=Se(o),a=Se(a))?p:o.length!==a.length?M:Te(0,o,a)},u.INTRATE=function(){throw new Error("INTRATE is not implemented")},u.IPMT=Rc,u.IRR=function(o,a){if(a=a||0,ie(o=Se(W(o)),a=q(a)))return p;let h=(Pe,Ke,pt)=>{let yt=pt+1,Jt=Pe[0];for(let _t=1;_t<Pe.length;_t++)Jt+=Pe[_t]/Math.pow(yt,(Ke[_t]-Ke[0])/365);return Jt},C=(Pe,Ke,pt)=>{let yt=pt+1,Jt=0;for(let _t=1;_t<Pe.length;_t++){let Yn=(Ke[_t]-Ke[0])/365;Jt-=Yn*Pe[_t]/Math.pow(yt,Yn+1)}return Jt},N=[],U=!1,Z=!1;for(let Pe=0;Pe<o.length;Pe++)N[Pe]=Pe===0?0:N[Pe-1]+365,o[Pe]>0&&(U=!0),o[Pe]<0&&(Z=!0);if(!U||!Z)return b;let re,fe,je,_e=a=a===void 0?.1:a,$e=!0;do je=h(o,N,_e),re=_e-je/C(o,N,_e),fe=Math.abs(re-_e),_e=re,$e=fe>1e-10&&Math.abs(je)>1e-10;while($e);return _e},u.ISBLANK=function(o){return o===null},u.ISERR=pi,u.ISERROR=Ut,u.ISEVEN=function(o){return!(1&Math.floor(Math.abs(o)))},u.ISFORMULA=function(){throw new Error("ISFORMULA is not implemented")},u.ISLOGICAL=ha,u.ISNA=function(o){return o===M},u.ISNONTEXT=function(o){return typeof o!="string"},u.ISNUMBER=Ar,u.ISO=Fg,u.ISODD=function(o){return!!(1&Math.floor(Math.abs(o)))},u.ISOWEEKNUM=xc,u.ISPMT=function(o,a,h,C){return ie(o=q(o),a=q(a),h=q(h),C=q(C))?p:C*o*(a/h-1)},u.ISREF=function(){throw new Error("ISREF is not implemented")},u.ISTEXT=E,u.KURT=function(){let o=Se(W(arguments));if(o instanceof Error)return o;let a=g.mean(o),h=o.length,C=0;for(let N=0;N<h;N++)C+=Math.pow(o[N]-a,4);return C/=Math.pow(g.stdev(o,!0),4),h*(h+1)/((h-1)*(h-2)*(h-3))*C-3*(h-1)*(h-1)/((h-2)*(h-3))},u.LARGE=lt,u.LCM=function(){let o=Se(W(arguments));if(o instanceof Error)return o;for(var a,h,C,N,U=1;(C=o.pop())!==void 0;){if(C===0)return 0;for(;C>1;){if(C%2){for(a=3,h=Math.floor(Math.sqrt(C));a<=h&&C%a;a+=2);N=a<=h?a:C}else N=2;for(C/=N,U*=N,a=o.length;a;o[--a]%N==0&&(o[a]/=N)==1&&o.splice(a,1));}}return U},u.LEFT=function(o,a){return be(o,a)||(o=Ye(o),(a=q(a=a===void 0?1:a))instanceof Error||typeof o!="string"?p:o.substring(0,a))},u.LEN=function(o){return arguments.length===0?A:o instanceof Error?o:Array.isArray(o)?p:Ye(o).length},u.LINEST=pe,u.LN=function(o){return(o=q(o))instanceof Error?o:o===0?b:Math.log(o)},u.LOG=function(o,a){return be(o=q(o),a=q(a))||(o===0||a===0?b:Math.log(o)/Math.log(a))},u.LOG10=function(o){return(o=q(o))instanceof Error?o:o===0?b:Math.log(o)/Math.log(10)},u.LOGEST=function(o,a){if(ie(o=Se(W(o)),a=Se(W(a)))||o.length!==a.length)return p;for(let C=0;C<o.length;C++)o[C]=Math.log(o[C]);let h=pe(o,a);return h[0]=Math.round(1e6*Math.exp(h[0]))/1e6,h[1]=Math.round(1e6*Math.exp(h[1]))/1e6,h},u.LOGINV=bm,u.LOGNORM=ue,u.LOGNORMDIST=ym,u.LOGNORMINV=wm,u.LOOKUP=function(o,a,h){a=W(a),h=h?W(h):a;let C=typeof o=="number",N=M;for(let U=0;U<a.length;U++){if(a[U]===o)return h[U];if(C&&a[U]<=o||typeof a[U]=="string"&&a[U].localeCompare(o)<0)N=h[U];else if(C&&a[U]>o)return N}return N},u.LOWER=function(o){return arguments.length!==1?p:ie(o=Ye(o))?o:o.toLowerCase()},u.MATCH=function(o,a,h){if(!o||!a||(arguments.length===2&&(h=1),!((a=W(a))instanceof Array))||h!==-1&&h!==0&&h!==1)return M;let C,N;for(let U=0;U<a.length;U++)if(h===1){if(a[U]===o)return U+1;a[U]<o&&(N?a[U]>N&&(C=U+1,N=a[U]):(C=U+1,N=a[U]))}else if(h===0){if(typeof o=="string"&&typeof a[U]=="string"){let Z=o.toLowerCase().replace(/\?/g,".").replace(/\*/g,".*").replace(/~/g,"\\");if(new RegExp("^"+Z+"$").test(a[U].toLowerCase()))return U+1}else if(a[U]===o)return U+1}else if(h===-1){if(a[U]===o)return U+1;a[U]>o&&(N?a[U]<N&&(C=U+1,N=a[U]):(C=U+1,N=a[U]))}return C||M},u.MAX=ye,u.MAXA=function(){let o=W(arguments),a=be.apply(void 0,o);if(a)return a;let h=P(o);return h=h.map(C=>C??0),h.length===0?0:Math.max.apply(Math,h)},u.MDURATION=function(){throw new Error("MDURATION is not implemented")},u.MEDIAN=z,u.MID=function(o,a,h){if(a==null)return p;if(ie(a=q(a),h=q(h))||typeof o!="string")return h;let C=a-1,N=C+h;return o.substring(C,N)},u.MIN=X,u.MINA=function(){let o=W(arguments),a=be.apply(void 0,o);if(a)return a;let h=P(o);return h=h.map(C=>C??0),h.length===0?0:Math.min.apply(Math,h)},u.MINUTE=function(o){return(o=He(o))instanceof Error?o:o.getMinutes()},u.MIRR=function(o,a,h){if(ie(o=Se(W(o)),a=q(a),h=q(h)))return p;let C=o.length,N=[],U=[];for(let fe=0;fe<C;fe++)o[fe]<0?N.push(o[fe]):U.push(o[fe]);let Z=-Ia(h,U)*Math.pow(1+h,C-1),re=Ia(a,N)*(1+a);return Math.pow(Z/re,1/(C-1))-1},u.MMULT=function(o,a){return!Array.isArray(o)||!Array.isArray(a)||o.some(h=>!h.length)||a.some(h=>!h.length)||se(o).some(h=>typeof h!="number")||se(a).some(h=>typeof h!="number")||o[0].length!==a.length?p:Array(o.length).fill(0).map(()=>Array(a[0].length).fill(0)).map((h,C)=>h.map((N,U)=>o[C].reduce((Z,re,fe)=>Z+re*a[fe][U],0)))},u.MOD=function(o,a){let h=be(o=q(o),a=q(a));if(h)return h;if(a===0)return v;let C=Math.abs(o%a);return C=o<0?a-C:C,a>0?C:-C},u.MODE=S,u.MODEMULT=Cm,u.MODESNGL=jm,u.MONTH=function(o){return(o=He(o))instanceof Error?o:o.getMonth()+1},u.MROUND=function(o,a){return be(o=q(o),a=q(a))||(o*a==0?0:o*a<0?b:Math.round(o/a)*a)},u.MULTINOMIAL=function(){let o=Se(W(arguments));if(o instanceof Error)return o;let a=0,h=1;for(let C=0;C<o.length;C++)a+=o[C],h*=Qe(o[C]);return Qe(a)/h},u.MUNIT=function(o){return arguments.length>1?M:!(o=parseInt(o))||o<=0?p:Array(o).fill(0).map(()=>Array(o).fill(0)).map((a,h)=>(a[h]=1,a))},u.N=function(o){return Ar(o)?o:o instanceof Date?o.getTime():o===!0?1:o===!1?0:Ut(o)?o:0},u.NA=function(){return M},u.NEGBINOM=R,u.NEGBINOMDIST=Dm,u.NETWORKDAYS=mi,u.NETWORKDAYSINTL=Em,u.NOMINAL=function(o,a){return ie(o=q(o),a=q(a))?p:o<=0||a<1?b:(a=parseInt(a,10),(Math.pow(o+1,1/a)-1)*a)},u.NORM=Y,u.NORMDIST=xm,u.NORMINV=Im,u.NORMSDIST=Mm,u.NORMSINV=Sm,u.NOT=function(o){return typeof o=="string"?p:o instanceof Error?o:!o},u.NOW=function(){return new Date},u.NPER=function(o,a,h,C,N){if(N=N===void 0?0:N,C=C===void 0?0:C,ie(o=q(o),a=q(a),h=q(h),C=q(C),N=q(N)))return p;if(o===0)return-(h+C)/a;{let U=a*(1+o*N)-C*o,Z=h*o+a*(1+o*N);return Math.log(U/Z)/Math.log(1+o)}},u.NPV=Ia,u.NUMBERVALUE=function(o,a,h){return typeof(o=Ae(o)?o:"")=="number"?o:typeof o!="string"?M:(a=a===void 0?".":a,h=h===void 0?",":h,Number(o.replace(a,".").replace(h,"")))},u.OCT2BIN=function(o,a){if(!/^[0-7]{1,10}$/.test(o))return b;let h=!(o.length!==10||o.substring(0,1)!=="7"),C=h?parseInt(o,8)-1073741824:parseInt(o,8);if(C<-512||C>511)return b;if(h)return"1"+rn("0",9-(512+C).toString(2).length)+(512+C).toString(2);let N=C.toString(2);return a===void 0?N:isNaN(a)?p:a<0?b:(a=Math.floor(a))>=N.length?rn("0",a-N.length)+N:b},u.OCT2DEC=function(o){if(!/^[0-7]{1,10}$/.test(o))return b;let a=parseInt(o,8);return a>=536870912?a-1073741824:a},u.OCT2HEX=function(o,a){if(!/^[0-7]{1,10}$/.test(o))return b;let h=parseInt(o,8);if(h>=536870912)return"ff"+(h+3221225472).toString(16);let C=h.toString(16);return a===void 0?C:isNaN(a)?p:a<0?b:(a=Math.floor(a))>=C.length?rn("0",a-C.length)+C:b},u.ODD=function(o){if((o=q(o))instanceof Error)return o;let a=Math.ceil(Math.abs(o));return a=1&a?a:a+1,o>=0?a:-a},u.ODDFPRICE=function(){throw new Error("ODDFPRICE is not implemented")},u.ODDFYIELD=function(){throw new Error("ODDFYIELD is not implemented")},u.ODDLPRICE=function(){throw new Error("ODDLPRICE is not implemented")},u.ODDLYIELD=function(){throw new Error("ODDLYIELD is not implemented")},u.OR=function(){let o=W(arguments),a=p;for(let h=0;h<o.length;h++){if(o[h]instanceof Error)return o[h];o[h]!==void 0&&o[h]!==null&&typeof o[h]!="string"&&(a===p&&(a=!1),o[h]&&(a=!0))}return a},u.PDURATION=function(o,a,h){return ie(o=q(o),a=q(a),h=q(h))?p:o<=0?b:(Math.log(h)-Math.log(a))/Math.log(1+o)},u.PEARSON=de,u.PERCENTILE=ne,u.PERCENTILEEXC=Tm,u.PERCENTILEINC=Am,u.PERCENTRANK=Q,u.PERCENTRANKEXC=Nm,u.PERCENTRANKINC=_m,u.PERMUT=function(o,a){return ie(o=q(o),a=q(a))?p:Qe(o)/Qe(o-a)},u.PERMUTATIONA=function(o,a){return ie(o=q(o),a=q(a))?p:Math.pow(o,a)},u.PHI=function(o){return(o=q(o))instanceof Error?p:Math.exp(-.5*o*o)/2.5066282746310002},u.PI=function(){return Math.PI},u.PMT=bo,u.POISSON=ve,u.POISSONDIST=Rm,u.POWER=Ec,u.PPMT=function(o,a,h,C,N,U){return N=N||0,U=U||0,ie(o=q(o),h=q(h),C=q(C),N=q(N),U=q(U))?p:bo(o,h,C,N,U)-Rc(o,a,h,C,N,U)},u.PRICE=function(){throw new Error("PRICE is not implemented")},u.PRICEDISC=function(o,a,h,C,N){if(ie(o=He(o),a=He(a),h=q(h),C=q(C),N=(N=q(N))||0))return p;if(h<=0||C<=0)return b;if(o>=a)return p;let U,Z;switch(N){case 0:U=360,Z=Gn(o,a,!1);break;case 1:case 3:U=365,Z=vo(o,a,"D");break;case 2:U=360,Z=vo(o,a,"D");break;case 4:U=360,Z=Gn(o,a,!0);break;default:return b}return C-h*C*Z/U},u.PRICEMAT=function(){throw new Error("PRICEMAT is not implemented")},u.PROB=function(o,a,h,C){if(h===void 0)return 0;if(C=C===void 0?h:C,ie(o=Se(W(o)),a=Se(W(a)),h=q(h),C=q(C)))return p;if(h===C)return o.indexOf(h)>=0?a[o.indexOf(h)]:0;let N=o.sort((re,fe)=>re-fe),U=N.length,Z=0;for(let re=0;re<U;re++)N[re]>=h&&N[re]<=C&&(Z+=a[o.indexOf(N[re])]);return Z},u.PRODUCT=ga,u.PRONETIC=function(){throw new Error("PRONETIC is not implemented")},u.PROPER=function(o){return ie(o)?o:isNaN(o)&&typeof o=="number"?p:(o=Ye(o)).replace(/\w\S*/g,a=>a.charAt(0).toUpperCase()+a.substr(1).toLowerCase())},u.PV=function(o,a,h,C,N){return C=C||0,N=N||0,ie(o=q(o),a=q(a),h=q(h),C=q(C),N=q(N))?p:o===0?-h*a-C:((1-Math.pow(1+o,a))/o*h*(1+o*N)-C)/Math.pow(1+o,a)},u.QUARTILE=Ce,u.QUARTILEEXC=Om,u.QUARTILEINC=Lm,u.QUOTIENT=function(o,a){return be(o=q(o),a=q(a))||parseInt(o/a,10)},u.RADIANS=function(o){return(o=q(o))instanceof Error?o:o*Math.PI/180},u.RAND=function(){return Math.random()},u.RANDBETWEEN=function(o,a){return be(o=q(o),a=q(a))||o+Math.ceil((a-o+1)*Math.random())-1},u.RANK=De,u.RANKAVG=Fm,u.RANKEQ=km,u.RATE=function(o,a,h,C,N,U){if(U=U===void 0?.01:U,C=C===void 0?0:C,N=N===void 0?0:N,ie(o=q(o),a=q(a),h=q(h),C=q(C),N=q(N),U=q(U)))return p;let Z=1e-10,re=U;N=N?1:0;for(let fe=0;fe<20;fe++){if(re<=-1)return b;let je,_e,$e;if(Math.abs(re)<Z?je=h*(1+o*re)+a*(1+re*N)*o+C:(_e=Math.pow(1+re,o),je=h*_e+a*(1/re+N)*(_e-1)+C),Math.abs(je)<Z)return re;if(Math.abs(re)<Z)$e=h*o+a*N*o;else{_e=Math.pow(1+re,o);let Pe=o*Math.pow(1+re,o-1);$e=h*Pe+a*(1/re+N)*Pe+a*(-1/(re*re))*(_e-1)}re-=je/$e}return re},u.RECEIVED=function(){throw new Error("RECEIVED is not implemented")},u.REPLACE=function(o,a,h,C){return ie(a=q(a),h=q(h))||typeof o!="string"||typeof C!="string"?p:o.substr(0,a-1)+C+o.substr(a-1+h)},u.REPT=rn,u.RIGHT=function(o,a){return be(o,a)||(o=Ye(o),(a=q(a=a===void 0?1:a))instanceof Error?a:o.substring(o.length-a))},u.ROMAN=function(o){if((o=q(o))instanceof Error)return o;let a=String(o).split(""),h=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"],C="",N=3;for(;N--;)C=(h[+a.pop()+10*N]||"")+C;return new Array(+a.join("")+1).join("M")+C},u.ROUND=An,u.ROUNDDOWN=function(o,a){return be(o=q(o),a=q(a))||(o>0?1:-1)*Math.floor(Math.abs(o)*Math.pow(10,a))/Math.pow(10,a)},u.ROUNDUP=function(o,a){return be(o=q(o),a=q(a))||(o>0?1:-1)*Math.ceil(Math.abs(o)*Math.pow(10,a))/Math.pow(10,a)},u.ROW=function(o,a){return arguments.length!==2?M:a<0?b:o instanceof Array&&typeof a=="number"?o.length!==0?g.row(o,a):void 0:p},u.ROWS=function(o){return arguments.length!==1?M:o instanceof Array?o.length===0?0:g.rows(o):p},u.RRI=function(o,a,h){return ie(o=q(o),a=q(a),h=q(h))?p:o===0||a===0?b:Math.pow(h/a,1/o)-1},u.RSQ=function(o,a){return ie(o=Se(W(o)),a=Se(W(a)))?p:Math.pow(de(o,a),2)},u.SEARCH=function(o,a,h){let C;return typeof o!="string"||typeof a!="string"?p:(h=h===void 0?0:h,C=a.toLowerCase().indexOf(o.toLowerCase(),h-1)+1,C===0?p:C)},u.SEC=function(o){return(o=q(o))instanceof Error?o:1/Math.cos(o)},u.SECH=function(o){return(o=q(o))instanceof Error?o:2/(Math.exp(o)+Math.exp(-o))},u.SECOND=function(o){return(o=He(o))instanceof Error?o:o.getSeconds()},u.SERIESSUM=function(o,a,h,C){if(ie(o=q(o),a=q(a),h=q(h),C=Se(C)))return p;let N=C[0]*Math.pow(o,a);for(let U=1;U<C.length;U++)N+=C[U]*Math.pow(o,a+U*h);return N},u.SHEET=function(){throw new Error("SHEET is not implemented")},u.SHEETS=function(){throw new Error("SHEETS is not implemented")},u.SIGN=function(o){return(o=q(o))instanceof Error?o:o<0?-1:o===0?0:1},u.SIN=function(o){return(o=q(o))instanceof Error?o:Math.sin(o)},u.SINH=function(o){return(o=q(o))instanceof Error?o:(Math.exp(o)-Math.exp(-o))/2},u.SKEW=xe,u.SKEWP=Pm,u.SLN=function(o,a,h){return ie(o=q(o),a=q(a),h=q(h))?p:h===0?b:(o-a)/h},u.SLOPE=function(o,a){if(ie(o=Se(W(o)),a=Se(W(a))))return p;let h=g.mean(a),C=g.mean(o),N=a.length,U=0,Z=0;for(let re=0;re<N;re++)U+=(a[re]-h)*(o[re]-C),Z+=Math.pow(a[re]-h,2);return U/Z},u.SMALL=ke,u.SORT=function(o,a=1,h=1,C=!1){if(!o||!Array.isArray(o))return M;if(o.length===0)return 0;if(!(a=q(a))||a<1||(h=q(h))!==1&&h!==-1)return p;if(typeof(C=We(C))!="boolean")return j;let N=re=>re.sort((fe,je)=>(fe=Ye(fe[a-1]),je=Ye(je[a-1]),h===1?fe<je?-1*h:h:fe>je?h:-1*h)),U=K(o),Z=C?we(U):U;return a>=1&&a<=Z[0].length?C?we(N(Z)):N(Z):p},u.SQRT=function(o){return(o=q(o))instanceof Error?o:o<0?b:Math.sqrt(o)},u.SQRTPI=function(o){return(o=q(o))instanceof Error?o:Math.sqrt(o*Math.PI)},u.STANDARDIZE=function(o,a,h){return ie(o=q(o),a=q(a),h=q(h))?p:(o-a)/h},u.STDEV=qe,u.STDEVA=function(){let o=ge.apply(this,arguments);return Math.sqrt(o)},u.STDEVP=Vm,u.STDEVPA=function(){let o=Ee.apply(this,arguments),a=Math.sqrt(o);return isNaN(a)&&(a=b),a},u.STDEVS=Hm,u.STEYX=function(o,a){if(ie(o=Se(W(o)),a=Se(W(a))))return p;let h=g.mean(a),C=g.mean(o),N=a.length,U=0,Z=0,re=0;for(let fe=0;fe<N;fe++)U+=Math.pow(o[fe]-C,2),Z+=(a[fe]-h)*(o[fe]-C),re+=Math.pow(a[fe]-h,2);return Math.sqrt((U-Z*Z/re)/(N-2))},u.SUBSTITUTE=function(o,a,h,C){if(arguments.length<3)return M;if(o&&a){if(C===void 0)return o.split(a).join(h);{if(C=Math.floor(Number(C)),Number.isNaN(C)||C<=0)return p;let N=0,U=0;for(;N>-1&&o.indexOf(a,N)>-1;)if(N=o.indexOf(a,N+1),U++,N>-1&&U===C)return o.substring(0,N)+h+o.substring(N+a.length);return o}}return o},u.SUBTOTAL=function(o,a){if((o=q(o))instanceof Error)return o;switch(o){case 1:case 101:return d(a);case 2:case 102:return H(a);case 3:case 103:return G(a);case 4:case 104:return ye(a);case 5:case 105:return X(a);case 6:case 106:return ga(a);case 7:case 107:return qe.S(a);case 8:case 108:return qe.P(a);case 9:case 109:return ar(a);case 10:case 110:return te.S(a);case 11:case 111:return te.P(a)}},u.SUM=ar,u.SUMIF=function(o,a,h){if(o=W(o),h=h?W(h):o,o instanceof Error)return o;if(a==null||a instanceof Error)return 0;let C=0,N=a==="*",U=N?null:yn(a+"");for(let Z=0;Z<o.length;Z++){let re=o[Z],fe=h[Z];if(N)C+=re;else{let je=[Xt(re,At)].concat(U);C+=Qt(je)?fe:0}}return C},u.SUMIFS=function(){let o=V(arguments),a=Se(W(o.shift()));if(a instanceof Error)return a;let h=o,C=h.length/2;for(let U=0;U<C;U++)h[2*U]=W(h[2*U]);let N=0;for(let U=0;U<a.length;U++){let Z=!1;for(let re=0;re<C;re++){let fe=h[2*re][U],je=h[2*re+1],_e=!1;if(je===void 0||je==="*")_e=!0;else{let $e=yn(je+""),Pe=[Xt(fe,At)].concat($e);_e=Qt(Pe)}if(!_e){Z=!1;break}Z=!0}Z&&(N+=a[U])}return N},u.SUMPRODUCT=function(){if(!arguments||arguments.length===0)return p;let o=arguments.length+1,a,h,C,N,U=0;for(let Z=0;Z<arguments[0].length;Z++)if(arguments[0][Z]instanceof Array)for(let re=0;re<arguments[0][Z].length;re++){for(a=1,h=1;h<o;h++){let fe=arguments[h-1][Z][re];if(fe instanceof Error)return fe;if(N=q(fe),N instanceof Error)return N;a*=N}U+=a}else{for(a=1,h=1;h<o;h++){let re=arguments[h-1][Z];if(re instanceof Error)return re;if(C=q(re),C instanceof Error)return C;a*=C}U+=a}return U},u.SUMSQ=function(){let o=Se(W(arguments));if(o instanceof Error)return o;let a=0,h=o.length;for(let C=0;C<h;C++)a+=Ar(o[C])?o[C]*o[C]:0;return a},u.SUMX2MY2=function(o,a){if(ie(o=Se(W(o)),a=Se(W(a))))return p;let h=0;for(let C=0;C<o.length;C++)h+=o[C]*o[C]-a[C]*a[C];return h},u.SUMX2PY2=function(o,a){if(ie(o=Se(W(o)),a=Se(W(a))))return p;let h=0;o=Se(W(o)),a=Se(W(a));for(let C=0;C<o.length;C++)h+=o[C]*o[C]+a[C]*a[C];return h},u.SUMXMY2=function(o,a){if(ie(o=Se(W(o)),a=Se(W(a))))return p;let h=0;o=W(o),a=W(a);for(let C=0;C<o.length;C++)h+=Math.pow(o[C]-a[C],2);return h},u.SWITCH=function(){let o;if(arguments.length>0){let a=arguments[0],h=arguments.length-1,C=Math.floor(h/2),N=!1,U=h%2!=0,Z=h%2==0?null:arguments[arguments.length-1];if(C){for(let re=0;re<C;re++)if(a===arguments[2*re+1]){o=arguments[2*re+2],N=!0;break}}N||(o=U?Z:M)}else o=p;return o},u.SYD=function(o,a,h,C){return ie(o=q(o),a=q(a),h=q(h),C=q(C))?p:h===0||C<1||C>h?b:(o-a)*(h-(C=parseInt(C,10))+1)*2/(h*(h+1))},u.T=function(o){return o instanceof Error||typeof o=="string"?o:""},u.TAN=function(o){return(o=q(o))instanceof Error?o:Math.tan(o)},u.TANH=function(o){if((o=q(o))instanceof Error)return o;let a=Math.exp(2*o);return(a-1)/(a+1)},u.TBILLEQ=function(o,a,h){return ie(o=He(o),a=He(a),h=q(h))?p:h<=0||o>a||a-o>31536e6?b:365*h/(360-h*Gn(o,a,!1))},u.TBILLPRICE=function(o,a,h){return ie(o=He(o),a=He(a),h=q(h))?p:h<=0||o>a||a-o>31536e6?b:100*(1-h*Gn(o,a,!1)/360)},u.TBILLYIELD=function(o,a,h){return ie(o=He(o),a=He(a),h=q(h))?p:h<=0||o>a||a-o>31536e6?b:360*(100-h)/(h*Gn(o,a,!1))},u.TDIST=Bm,u.TDISTRT=Um,u.TEXT=function(o,a){if(o===void 0||o instanceof Error||a instanceof Error)return M;if(a==null)return"";if(typeof a=="number")return String(a);if(typeof a!="string")return p;let h=a.startsWith("$")?"$":"",C=a.endsWith("%");return C&&(o*=100),o=(o=Ac(o,(a=a.replace(/%/g,"").replace(/\$/g,"")).split(".")[1].match(/0/g).length,!a.includes(","))).startsWith("-")?"-"+h+(o=o.replace("-","")):h+o,C&&(o+="%"),o},u.TEXTJOIN=function(o,a,...h){if(typeof a!="boolean"&&(a=We(a)),arguments.length<3)return M;o=o??"";let C=W(h),N=a?C.filter(U=>U):C;if(Array.isArray(o)){o=W(o);let U=N.map(re=>[re]),Z=0;for(let re=0;re<U.length-1;re++)U[re].push(o[Z]),Z++,Z===o.length&&(Z=0);return N=W(U),N.join("")}return N.join(o)},u.TIME=function(o,a,h){return ie(o=q(o),a=q(a),h=q(h))?p:o<0||a<0||h<0?b:(3600*o+60*a+h)/86400},u.TIMEVALUE=function(o){return(o=He(o))instanceof Error?o:(3600*o.getHours()+60*o.getMinutes()+o.getSeconds())/86400},u.TINV=$m,u.TODAY=function(){return gi(new Date)},u.TRANSPOSE=function(o){return o?we(K(o)):M},u.TREND=function(o,a,h){if(ie(o=Se(W(o)),a=Se(W(a)),h=Se(W(h))))return p;let C=pe(o,a),N=C[0],U=C[1],Z=[];return h.forEach(re=>{Z.push(N*re+U)}),Z},u.TRIM=function(o){return(o=Ye(o))instanceof Error?o:o.replace(/\s+/g," ").trim()},u.TRIMMEAN=function(o,a){if(ie(o=Se(W(o)),a=q(a)))return p;let h=Ue(o.length*a,2)/2;return g.mean((N=(N=h)||1,(C=ae(o.sort((U,Z)=>U-Z),h))&&typeof C.slice=="function"?C.slice(0,C.length-N):C));var C,N},u.TRUE=function(){return!0},u.TRUNC=function(o,a){return be(o=q(o),a=q(a))||(o>0?1:-1)*Math.floor(Math.abs(o)*Math.pow(10,a))/Math.pow(10,a)},u.TTEST=zm,u.TYPE=function(o){return Ar(o)?1:E(o)?2:ha(o)?4:Ut(o)?16:Array.isArray(o)?64:void 0},u.UNICHAR=Ug,u.UNICODE=$g,u.UNIQUE=T,u.UPPER=function(o){return(o=Ye(o))instanceof Error?o:o.toUpperCase()},u.VALUE=function(o){let a=be(o);if(a)return a;if(typeof o=="number")return o;if(Ae(o)||(o=""),typeof o!="string")return p;let h=/(%)$/.test(o)||/^(%)/.test(o);if((o=(o=(o=o.replace(/^[^0-9-]{0,3}/,"")).replace(/[^0-9]{0,3}$/,"")).replace(/[ ,]/g,""))==="")return 0;let C=Number(o);return isNaN(C)?p:(C=C||0,h&&(C*=.01),C)},u.VAR=te,u.VARA=ge,u.VARP=qm,u.VARPA=Ee,u.VARS=Wm,u.VDB=function(){throw new Error("VDB is not implemented")},u.VLOOKUP=m,u.WEEKDAY=function(o,a){if((o=He(o))instanceof Error)return o;a===void 0&&(a=1);let h=o.getDay();return Hg[a][h]},u.WEEKNUM=function(o,a){if((o=He(o))instanceof Error)return o;if(a===void 0&&(a=1),a===21)return xc(o);let h=Vg[a],C=new Date(o.getFullYear(),0,1),N=C.getDay()<h?1:0;return C-=24*Math.abs(C.getDay()-h)*60*60*1e3,Math.floor((o-C)/864e5/7+1)+N},u.WEIBULL=Fe,u.WEIBULLDIST=Gm,u.WORKDAY=vi,u.WORKDAYINTL=Ym,u.XIRR=function(o,a,h){if(ie(o=Se(W(o)),a=St(W(a)),h=q(h)))return p;let C=(Pe,Ke,pt)=>{let yt=pt+1,Jt=Pe[0];for(let _t=1;_t<Pe.length;_t++)Jt+=Pe[_t]/Math.pow(yt,lr(Ke[_t],Ke[0])/365);return Jt},N=(Pe,Ke,pt)=>{let yt=pt+1,Jt=0;for(let _t=1;_t<Pe.length;_t++){let Yn=lr(Ke[_t],Ke[0])/365;Jt-=Yn*Pe[_t]/Math.pow(yt,Yn+1)}return Jt},U=!1,Z=!1;for(let Pe=0;Pe<o.length;Pe++)o[Pe]>0&&(U=!0),o[Pe]<0&&(Z=!0);if(!U||!Z)return b;let re,fe,je,_e=h=h||.1,$e=!0;do je=C(o,a,_e),re=_e-je/N(o,a,_e),fe=Math.abs(re-_e),_e=re,$e=fe>1e-10&&Math.abs(je)>1e-10;while($e);return _e},u.XNPV=function(o,a,h){if(ie(o=q(o),a=Se(W(a)),h=St(W(h))))return p;let C=0;for(let N=0;N<a.length;N++)C+=a[N]/Math.pow(1+o,lr(h[N],h[0])/365);return C},u.XOR=function(){let o=W(arguments),a=p;for(let h=0;h<o.length;h++){if(o[h]instanceof Error)return o[h];o[h]!==void 0&&o[h]!==null&&typeof o[h]!="string"&&(a===p&&(a=0),o[h]&&a++)}return a===p?a:!!(1&Math.floor(Math.abs(a)))},u.YEAR=function(o){return(o=He(o))instanceof Error?o:o.getFullYear()},u.YEARFRAC=va,u.YIELD=function(){throw new Error("YIELD is not implemented")},u.YIELDDISC=function(){throw new Error("YIELDDISC is not implemented")},u.YIELDMAT=function(){throw new Error("YIELDMAT is not implemented")},u.Z=dt,u.ZTEST=Zm,u.utils=Xm}},r={};function s(f){var u=r[f];if(u!==void 0)return u.exports;var c=r[f]={exports:{}};return n[f].call(c.exports,c,c.exports,s),c.exports}s.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}();var l=s(960);t=l}(),t)},44:function(module,__unused_webpack_exports,__webpack_require__){if(!formula)var formula=__webpack_require__(463);var factory;factory=function(){"use strict";var Version=(info={title:"Jspreadsheet",version:"4.15.0",type:"CE",host:"https://bossanova.uk/jspreadsheet",license:"MIT",print:function(){return[this.title+" "+this.type+" "+this.version,this.host,this.license].join(`\r
`)}},function(){return info}),info,isFormula=function(e){var t=(""+e)[0];return t=="="||t=="#"},getMask=function(e){if(e.format||e.mask||e.locale){var t={};return e.mask?t.mask=e.mask:e.format?t.mask=e.format:(t.locale=e.locale,t.options=e.options),e.decimal&&(t.options||(t.options={}),t.options={decimal:e.decimal}),t}return null},jexcel=function(el,options){var obj={options:{}};if(!(el instanceof Element||el instanceof HTMLDocument))return console.error("Jspreadsheet: el is not a valid DOM element"),!1;if(el.tagName=="TABLE"){if(!(options=jexcel.createFromTable(el,options)))return console.error("Jspreadsheet: el is not a valid DOM element"),!1;var div=document.createElement("div");el.parentNode.insertBefore(div,el),el.remove(),el=div}var defaults={url:null,method:"GET",requestVariables:null,data:null,sorting:null,copyCompatibility:!1,root:null,rows:[],columns:[],colHeaders:[],colWidths:[],colAlignments:[],nestedHeaders:null,defaultColWidth:50,defaultColAlign:"center",defaultRowHeight:null,minSpareRows:0,minSpareCols:0,minDimensions:[0,0],allowExport:!0,includeHeadersOnDownload:!1,includeHeadersOnCopy:!1,columnSorting:!0,columnDrag:!1,columnResize:!0,rowResize:!1,rowDrag:!0,editable:!0,allowInsertRow:!0,allowManualInsertRow:!0,allowInsertColumn:!0,allowManualInsertColumn:!0,allowDeleteRow:!0,allowDeletingAllRows:!1,allowDeleteColumn:!0,allowRenameColumn:!0,allowComments:!1,wordWrap:!1,imageOptions:null,csv:null,csvFileName:"jspreadsheet",csvHeaders:!0,csvDelimiter:",",parseTableFirstRowAsHeader:!1,parseTableAutoCellType:!1,selectionCopy:!0,mergeCells:{},toolbar:null,search:!1,pagination:!1,paginationOptions:null,fullscreen:!1,lazyLoading:!1,loadingSpin:!1,tableOverflow:!1,tableHeight:"300px",tableWidth:null,textOverflow:!1,meta:null,style:null,classes:null,parseFormulas:!0,autoIncrement:!0,autoCasting:!0,secureFormulas:!0,stripHTML:!0,stripHTMLOnCopy:!1,filters:!1,footers:null,onundo:null,onredo:null,onload:null,onchange:null,oncomments:null,onbeforechange:null,onafterchanges:null,onbeforeinsertrow:null,oninsertrow:null,onbeforeinsertcolumn:null,oninsertcolumn:null,onbeforedeleterow:null,ondeleterow:null,onbeforedeletecolumn:null,ondeletecolumn:null,onmoverow:null,onmovecolumn:null,onresizerow:null,onresizecolumn:null,onsort:null,onselection:null,oncopy:null,onpaste:null,onbeforepaste:null,onmerge:null,onfocus:null,onblur:null,onchangeheader:null,oncreateeditor:null,oneditionstart:null,oneditionend:null,onchangestyle:null,onchangemeta:null,onchangepage:null,onbeforesave:null,onsave:null,onevent:null,persistance:!1,updateTable:null,detachForUpdates:!1,freezeColumns:null,text:{noRecordsFound:"No records found",showingPage:"Showing page {0} of {1} entries",show:"Show ",search:"Search",entries:" entries",columnName:"Column name",insertANewColumnBefore:"Insert a new column before",insertANewColumnAfter:"Insert a new column after",deleteSelectedColumns:"Delete selected columns",renameThisColumn:"Rename this column",orderAscending:"Order ascending",orderDescending:"Order descending",insertANewRowBefore:"Insert a new row before",insertANewRowAfter:"Insert a new row after",deleteSelectedRows:"Delete selected rows",editComments:"Edit comments",addComments:"Add comments",comments:"Comments",clearComments:"Clear comments",copy:"Copy...",paste:"Paste...",saveAs:"Save as...",about:"About",areYouSureToDeleteTheSelectedRows:"Are you sure to delete the selected rows?",areYouSureToDeleteTheSelectedColumns:"Are you sure to delete the selected columns?",thisActionWillDestroyAnyExistingMergedCellsAreYouSure:"This action will destroy any existing merged cells. Are you sure?",thisActionWillClearYourSearchResultsAreYouSure:"This action will clear your search results. Are you sure?",thereIsAConflictWithAnotherMergedCell:"There is a conflict with another merged cell",invalidMergeProperties:"Invalid merged properties",cellAlreadyMerged:"Cell already merged",noCellsSelected:"No cells selected"},about:!0};for(var property in defaults)if(options&&options.hasOwnProperty(property))if(property==="text")for(var textKey in obj.options[property]=defaults[property],options[property])options[property].hasOwnProperty(textKey)&&(obj.options[property][textKey]=options[property][textKey]);else obj.options[property]=options[property];else obj.options[property]=defaults[property];obj.el=el,obj.corner=null,obj.contextMenu=null,obj.textarea=null,obj.ads=null,obj.content=null,obj.table=null,obj.thead=null,obj.tbody=null,obj.rows=[],obj.results=null,obj.searchInput=null,obj.toolbar=null,obj.pagination=null,obj.pageNumber=null,obj.headerContainer=null,obj.colgroupContainer=null,obj.headers=[],obj.records=[],obj.history=[],obj.formula=[],obj.colgroup=[],obj.selection=[],obj.highlighted=[],obj.selectedCell=null,obj.selectedContainer=null,obj.style=[],obj.data=null,obj.filter=null,obj.filters=[],obj.cursor=null,obj.historyIndex=-1,obj.ignoreEvents=!1,obj.ignoreHistory=!1,obj.edition=null,obj.hashString=null,obj.resizing=null,obj.dragging=null,obj.options.lazyLoading==1&&obj.options.tableOverflow==0&&obj.options.fullscreen==0&&(console.error("Jspreadsheet: The lazyloading only works when tableOverflow = yes or fullscreen = yes"),obj.options.lazyLoading=!1),obj.fullscreen=function(e){e==null&&(e=!obj.options.fullscreen),obj.options.fullscreen!=e&&(obj.options.fullscreen=e,e==1?el.classList.add("fullscreen"):el.classList.remove("fullscreen"))},obj.dispatch=function(e){if(!obj.ignoreEvents){if(typeof obj.options.onevent=="function")var t=obj.options.onevent.apply(this,arguments);typeof obj.options[e]=="function"&&(t=obj.options[e].apply(this,Array.prototype.slice.call(arguments,1)))}if(e=="onafterchanges"&&obj.options.persistance){var n=obj.options.persistance==1?obj.options.url:obj.options.persistance,r=obj.prepareJson(arguments[2]);obj.save(n,r)}return t},obj.prepareTable=function(){var e=obj.options.columns.length;if(obj.options.data&&obj.options.data[0]!==void 0){var t=Object.keys(obj.options.data[0]);t.length>e&&(e=t.length)}obj.options.minDimensions[0]>e&&(e=obj.options.minDimensions[0]);for(var n=[],r=0;r<e;r++)obj.options.colHeaders[r]||(obj.options.colHeaders[r]=""),obj.options.colWidths[r]||(obj.options.colWidths[r]=obj.options.defaultColWidth),obj.options.colAlignments[r]||(obj.options.colAlignments[r]=obj.options.defaultColAlign),obj.options.columns[r]?obj.options.columns[r].type||(obj.options.columns[r].type="text"):obj.options.columns[r]={type:"text"},obj.options.columns[r].name||(obj.options.columns[r].name=t&&t[r]?t[r]:r),obj.options.columns[r].source||(obj.options.columns[r].source=[]),obj.options.columns[r].options||(obj.options.columns[r].options=[]),obj.options.columns[r].editor||(obj.options.columns[r].editor=null),obj.options.columns[r].allowEmpty||(obj.options.columns[r].allowEmpty=!1),obj.options.columns[r].title||(obj.options.columns[r].title=obj.options.colHeaders[r]?obj.options.colHeaders[r]:""),obj.options.columns[r].width||(obj.options.columns[r].width=obj.options.colWidths[r]?obj.options.colWidths[r]:obj.options.defaultColWidth),obj.options.columns[r].align||(obj.options.columns[r].align=obj.options.colAlignments[r]?obj.options.colAlignments[r]:"center"),obj.options.columns[r].type=="autocomplete"||obj.options.columns[r].type=="dropdown"?obj.options.columns[r].url&&n.push({url:obj.options.columns[r].url,index:r,method:"GET",dataType:"json",success:function(s){for(var l=0;l<s.length;l++)obj.options.columns[this.index].source.push(s[l])}}):obj.options.columns[r].type=="calendar"&&(obj.options.columns[r].options.format||(obj.options.columns[r].options.format="DD/MM/YYYY"));n.length?jSuites.ajax(n,function(){obj.createTable()}):obj.createTable()},obj.createTable=function(){obj.table=document.createElement("table"),obj.thead=document.createElement("thead"),obj.tbody=document.createElement("tbody"),obj.headers=[],obj.colgroup=[],obj.content=document.createElement("div"),obj.content.classList.add("jexcel_content"),obj.content.onscroll=function(j){obj.scrollControls(j)},obj.content.onwheel=function(j){obj.wheelControls(j)},obj.toolbar=document.createElement("div"),obj.toolbar.classList.add("jexcel_toolbar");var e=document.createElement("div"),t=document.createTextNode(obj.options.text.search+": ");obj.searchInput=document.createElement("input"),obj.searchInput.classList.add("jexcel_search"),e.appendChild(t),e.appendChild(obj.searchInput),obj.searchInput.onfocus=function(){obj.resetSelection()};var n=document.createElement("div");if(obj.options.pagination>0&&obj.options.paginationOptions&&obj.options.paginationOptions.length>0){obj.paginationDropdown=document.createElement("select"),obj.paginationDropdown.classList.add("jexcel_pagination_dropdown"),obj.paginationDropdown.onchange=function(){obj.options.pagination=parseInt(this.value),obj.page(0)};for(var r=0;r<obj.options.paginationOptions.length;r++){var s=document.createElement("option");s.value=obj.options.paginationOptions[r],s.innerHTML=obj.options.paginationOptions[r],obj.paginationDropdown.appendChild(s)}obj.paginationDropdown.value=obj.options.pagination,n.appendChild(document.createTextNode(obj.options.text.show)),n.appendChild(obj.paginationDropdown),n.appendChild(document.createTextNode(obj.options.text.entries))}var l,f=document.createElement("div");if(f.classList.add("jexcel_filter"),f.appendChild(n),f.appendChild(e),obj.colgroupContainer=document.createElement("colgroup"),(l=document.createElement("col")).setAttribute("width","50"),obj.colgroupContainer.appendChild(l),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(var u=0;u<obj.options.nestedHeaders.length;u++)obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders[u]));else obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders));for(obj.headerContainer=document.createElement("tr"),(l=document.createElement("td")).classList.add("jexcel_selectall"),obj.headerContainer.appendChild(l),r=0;r<obj.options.columns.length;r++)obj.createCellHeader(r),obj.headerContainer.appendChild(obj.headers[r]),obj.colgroupContainer.appendChild(obj.colgroup[r]);if(obj.thead.appendChild(obj.headerContainer),obj.options.filters==1){obj.filter=document.createElement("tr");var c=document.createElement("td");for(obj.filter.appendChild(c),r=0;r<obj.options.columns.length;r++)(c=document.createElement("td")).innerHTML="&nbsp;",c.setAttribute("data-x",r),c.className="jexcel_column_filter",obj.options.columns[r].type=="hidden"&&(c.style.display="none"),obj.filter.appendChild(c);obj.thead.appendChild(obj.filter)}obj.table=document.createElement("table"),obj.table.classList.add("jexcel"),obj.table.setAttribute("cellpadding","0"),obj.table.setAttribute("cellspacing","0"),obj.table.setAttribute("unselectable","yes"),obj.table.appendChild(obj.colgroupContainer),obj.table.appendChild(obj.thead),obj.table.appendChild(obj.tbody),obj.options.textOverflow||obj.table.classList.add("jexcel_overflow"),obj.corner=document.createElement("div"),obj.corner.className="jexcel_corner",obj.corner.setAttribute("unselectable","on"),obj.corner.setAttribute("onselectstart","return false"),obj.options.selectionCopy==0&&(obj.corner.style.display="none"),obj.textarea=document.createElement("textarea"),obj.textarea.className="jexcel_textarea",obj.textarea.id="jexcel_textarea",obj.textarea.tabIndex="-1",obj.contextMenu=document.createElement("div"),obj.contextMenu.className="jexcel_contextmenu",jSuites.contextmenu(obj.contextMenu,{onclick:function(){obj.contextMenu.contextmenu.close(!1)}});var g=document.createElement("a");g.setAttribute("href","https://bossanova.uk/jspreadsheet/"),obj.ads=document.createElement("div"),obj.ads.className="jexcel_about";var D=document.createElement("span");D.innerHTML="Jspreadsheet CE",g.appendChild(D),obj.ads.appendChild(g),document.createElement("div").classList.add("jexcel_table"),obj.pagination=document.createElement("div"),obj.pagination.classList.add("jexcel_pagination");var I=document.createElement("div"),v=document.createElement("div");if(obj.pagination.appendChild(I),obj.pagination.appendChild(v),obj.options.pagination||(obj.pagination.style.display="none"),obj.options.search==1&&el.appendChild(f),obj.content.appendChild(obj.table),obj.content.appendChild(obj.corner),obj.content.appendChild(obj.textarea),el.appendChild(obj.toolbar),el.appendChild(obj.content),el.appendChild(obj.pagination),el.appendChild(obj.contextMenu),el.appendChild(obj.ads),el.classList.add("jexcel_container"),obj.options.toolbar&&obj.options.toolbar.length&&obj.createToolbar(),obj.options.fullscreen==1?el.classList.add("fullscreen"):obj.options.tableOverflow==1&&(obj.options.tableHeight&&(obj.content.style["overflow-y"]="auto",obj.content.style["box-shadow"]="rgb(221 221 221) 2px 2px 5px 0.1px",obj.content.style.maxHeight=obj.options.tableHeight),obj.options.tableWidth&&(obj.content.style["overflow-x"]="auto",obj.content.style.width=obj.options.tableWidth)),obj.options.tableOverflow!=1&&obj.options.toolbar&&el.classList.add("with-toolbar"),obj.options.columnDrag==1&&obj.thead.classList.add("draggable"),obj.options.columnResize==1&&obj.thead.classList.add("resizable"),obj.options.rowDrag==1&&obj.tbody.classList.add("draggable"),obj.options.rowResize==1&&obj.tbody.classList.add("resizable"),obj.setData(),obj.options.style&&obj.setStyle(obj.options.style,null,null,1,1),obj.options.classes){var p=Object.keys(obj.options.classes);for(r=0;r<p.length;r++){var w=jexcel.getIdFromColumnName(p[r],!0);obj.records[w[1]][w[0]].classList.add(obj.options.classes[p[r]])}}},obj.refresh=function(){obj.options.url?(obj.options.loadingSpin==1&&jSuites.loading.show(),jSuites.ajax({url:obj.options.url,method:obj.options.method,data:obj.options.requestVariables,dataType:"json",success:function(e){obj.options.data=e.data?e.data:e,obj.setData(),obj.options.loadingSpin==1&&jSuites.loading.hide()}})):obj.setData()},obj.setData=function(e){if(e&&(typeof e=="string"&&(e=JSON.parse(e)),obj.options.data=e),obj.options.data||(obj.options.data=[]),obj.options.data&&obj.options.data[0]&&!Array.isArray(obj.options.data[0])){e=[];for(var t=0;t<obj.options.data.length;t++){for(var n=[],r=0;r<obj.options.columns.length;r++)n[r]=obj.options.data[t][obj.options.columns[r].name];e.push(n)}obj.options.data=e}t=0,r=0;var s=obj.options.columns.length,l=obj.options.data.length,f=obj.options.minDimensions[0],u=obj.options.minDimensions[1],c=f>s?f:s,g=u>l?u:l;for(t=0;t<g;t++)for(r=0;r<c;r++)obj.options.data[t]==null&&(obj.options.data[t]=[]),obj.options.data[t][r]==null&&(obj.options.data[t][r]="");if(obj.rows=[],obj.results=null,obj.records=[],obj.history=[],obj.historyIndex=-1,obj.tbody.innerHTML="",obj.options.lazyLoading==1){var D=0,I=obj.options.data.length<100?obj.options.data.length:100;obj.options.pagination&&(obj.options.pagination=!1,console.error("Jspreadsheet: Pagination will be disable due the lazyLoading"))}else obj.options.pagination?(obj.pageNumber||(obj.pageNumber=0),obj.options.pagination,D=obj.options.pagination*obj.pageNumber,I=obj.options.pagination*obj.pageNumber+obj.options.pagination,obj.options.data.length<I&&(I=obj.options.data.length)):(D=0,I=obj.options.data.length);for(t=0;t<obj.options.data.length;t++){var v=obj.createRow(t,obj.options.data[t]);t>=D&&t<I&&obj.tbody.appendChild(v)}if(obj.options.lazyLoading==1||obj.options.pagination&&obj.updatePagination(),obj.options.mergeCells){var p=Object.keys(obj.options.mergeCells);for(r=0;r<p.length;r++){var w=obj.options.mergeCells[p[r]];obj.setMerge(p[r],w[0],w[1],1)}}obj.updateTable(),obj.dispatch("onload",el,obj)},obj.getData=function(e,t){for(var n=[],r=0,s=0,l=t==1||obj.options.copyCompatibility==0,f=obj.options.columns.length,u=obj.options.data.length,c=0;c<u;c++){r=0;for(var g=0;g<f;g++)e&&!obj.records[c][g].classList.contains("highlight")||(n[s]||(n[s]=[]),n[s][r]=l?obj.options.data[c][g]:obj.records[c][g].innerHTML,r++);r>0&&s++}return n},obj.getJsonRow=function(e){for(var t=obj.options.data[e],n=obj.options.columns.length,r={},s=0;s<n;s++)obj.options.columns[s].name||(obj.options.columns[s].name=s),r[obj.options.columns[s].name]=t[s];return r},obj.getJson=function(e){for(var t=[],n=obj.options.columns.length,r=obj.options.data.length,s=0;s<r;s++){for(var l=null,f=0;f<n;f++)e&&!obj.records[s][f].classList.contains("highlight")||(l==null&&(l={}),obj.options.columns[f].name||(obj.options.columns[f].name=f),l[obj.options.columns[f].name]=obj.options.data[s][f]);l!=null&&t.push(l)}return t},obj.prepareJson=function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n].x,s=e[n].y,l=obj.options.columns[r].name?obj.options.columns[r].name:r;t[s]||(t[s]={row:s,data:{}}),t[s].data[l]=e[n].newValue}return t.filter(function(f){return f!=null})},obj.save=function(e,t){var n=obj.dispatch("onbeforesave",el,obj,t);if(n)t=n;else if(n===!1)return!1;jSuites.ajax({url:e,method:"POST",dataType:"json",data:{data:JSON.stringify(t)},success:function(r){obj.dispatch("onsave",el,obj,t)}})},obj.getRowData=function(e){return obj.options.data[e]},obj.setRowData=function(e,t){for(var n=0;n<obj.headers.length;n++){var r=jexcel.getColumnNameFromId([n,e]);t[n]!=null&&obj.setValue(r,t[n])}},obj.getColumnData=function(e){for(var t=[],n=0;n<obj.options.data.length;n++)t.push(obj.options.data[n][e]);return t},obj.setColumnData=function(e,t){for(var n=0;n<obj.rows.length;n++){var r=jexcel.getColumnNameFromId([e,n]);t[n]!=null&&obj.setValue(r,t[n])}},obj.createRow=function(e,t){obj.records[e]||(obj.records[e]=[]),t||(t=obj.options.data[e]),obj.rows[e]=document.createElement("tr"),obj.rows[e].setAttribute("data-y",e);var n=null;obj.options.defaultRowHeight&&(obj.rows[e].style.height=obj.options.defaultRowHeight+"px"),obj.options.rows[e]&&(obj.options.rows[e].height&&(obj.rows[e].style.height=obj.options.rows[e].height),obj.options.rows[e].title&&(n=obj.options.rows[e].title)),n||(n=parseInt(e+1));var r=document.createElement("td");r.innerHTML=n,r.setAttribute("data-y",e),r.className="jexcel_row",obj.rows[e].appendChild(r);for(var s=0;s<obj.options.columns.length;s++)obj.records[e][s]=obj.createCell(s,e,t[s]),obj.rows[e].appendChild(obj.records[e][s]);return obj.rows[e]},obj.parseValue=function(e,t,n,r){(""+n).substr(0,1)=="="&&obj.options.parseFormulas==1&&(n=obj.executeFormula(n,e,t));var s=obj.options.columns[e];if(s&&!isFormula(n)){var l=null;if(l=getMask(s)){n&&n==Number(n)&&(n=Number(n));var f=jSuites.mask.render(n,l,!0);if(r&&l.mask){var u=l.mask.split(";");u[1]&&(u[1].match(new RegExp("\\[Red\\]","gi"))&&(n<0?r.classList.add("red"):r.classList.remove("red")),u[1].match(new RegExp("\\(","gi"))&&n<0&&(f="("+f+")"))}f&&(n=f)}}return n};var validDate=function(e){return(e=""+e).substr(4,1)=="-"&&e.substr(7,1)=="-"||(e=e.split("-"))[0].length==4&&e[0]==Number(e[0])&&e[1].length==2&&e[1]==Number(e[1])};obj.createCell=function(e,t,n){var r=document.createElement("td");if(r.setAttribute("data-x",e),r.setAttribute("data-y",t),(""+n).substr(0,1)=="="&&obj.options.secureFormulas==1){var s=secureFormula(n);s!=n&&(n=s)}if(obj.options.columns[e].editor)obj.options.stripHTML===!1||obj.options.columns[e].stripHTML===!1?r.innerHTML=n:r.textContent=n,typeof obj.options.columns[e].editor.createCell=="function"&&(r=obj.options.columns[e].editor.createCell(r));else if(obj.options.columns[e].type=="hidden")r.style.display="none",r.textContent=n;else if(obj.options.columns[e].type=="checkbox"||obj.options.columns[e].type=="radio"){var l=document.createElement("input");l.type=obj.options.columns[e].type,l.name="c"+e,l.checked=n==1||n==1||n=="true",l.onclick=function(){obj.setValue(r,this.checked)},obj.options.columns[e].readOnly!=1&&obj.options.editable!=0||l.setAttribute("disabled","disabled"),r.appendChild(l),obj.options.data[t][e]=l.checked}else if(obj.options.columns[e].type=="calendar"){var f=null;if(!validDate(n)){var u=jSuites.calendar.extractDateFromString(n,obj.options.columns[e].options.format);u&&(f=u)}r.textContent=jSuites.calendar.getDateString(f||n,obj.options.columns[e].options.format)}else if(obj.options.columns[e].type=="dropdown"||obj.options.columns[e].type=="autocomplete")r.classList.add("jexcel_dropdown"),r.textContent=obj.getDropDownValue(e,n);else if(obj.options.columns[e].type=="color")if(obj.options.columns[e].render=="square"){var c=document.createElement("div");c.className="color",c.style.backgroundColor=n,r.appendChild(c)}else r.style.color=n,r.textContent=n;else if(obj.options.columns[e].type=="image"){if(n&&n.substr(0,10)=="data:image"){var g=document.createElement("img");g.src=n,r.appendChild(g)}}else obj.options.columns[e].type=="html"||obj.options.stripHTML===!1||obj.options.columns[e].stripHTML===!1?r.innerHTML=stripScript(obj.parseValue(e,t,n,r)):r.textContent=obj.parseValue(e,t,n,r);obj.options.columns[e].readOnly==1&&(r.className="readonly");var D=obj.options.columns[e].align?obj.options.columns[e].align:"center";return r.style.textAlign=D,obj.options.columns[e].wordWrap!=0&&(obj.options.wordWrap==1||obj.options.columns[e].wordWrap==1||r.innerHTML.length>200)&&(r.style.whiteSpace="pre-wrap"),e>0&&this.options.textOverflow==1&&(n||r.innerHTML?obj.records[t][e-1].style.overflow="hidden":e==obj.options.columns.length-1&&(r.style.overflow="hidden")),r},obj.createCellHeader=function(e){var t=obj.options.columns[e].width?obj.options.columns[e].width:obj.options.defaultColWidth,n=obj.options.columns[e].align?obj.options.columns[e].align:obj.options.defaultColAlign;obj.headers[e]=document.createElement("td"),obj.options.stripHTML?obj.headers[e].textContent=obj.options.columns[e].title?obj.options.columns[e].title:jexcel.getColumnName(e):obj.headers[e].innerHTML=obj.options.columns[e].title?obj.options.columns[e].title:jexcel.getColumnName(e),obj.headers[e].setAttribute("data-x",e),obj.headers[e].style.textAlign=n,obj.options.columns[e].title&&obj.headers[e].setAttribute("title",obj.headers[e].innerText),obj.options.columns[e].id&&obj.headers[e].setAttribute("id",obj.options.columns[e].id),obj.colgroup[e]=document.createElement("col"),obj.colgroup[e].setAttribute("width",t),obj.options.columns[e].type=="hidden"&&(obj.headers[e].style.display="none",obj.colgroup[e].style.display="none")},obj.updateNestedHeader=function(e,t,n){obj.options.nestedHeaders[t][e].title&&(obj.options.nestedHeaders[t][e].title=n,obj.options.nestedHeaders[t].element.children[e+1].textContent=n)},obj.createNestedHeader=function(e){var t=document.createElement("tr");t.classList.add("jexcel_nested");var n=document.createElement("td");t.appendChild(n),e.element=t;for(var r=0,s=0;s<e.length;s++){e[s].colspan||(e[s].colspan=1),e[s].align||(e[s].align="center"),e[s].title||(e[s].title=""),e[s].id||(e[s].id="");for(var l=e[s].colspan,f=[],u=0;u<l;u++)obj.options.columns[r]&&obj.options.columns[r].type=="hidden"&&l++,f.push(r),r++;(n=document.createElement("td")).setAttribute("data-column",f.join(",")),n.setAttribute("colspan",e[s].colspan),n.setAttribute("align",e[s].align),n.setAttribute("id",e[s].id),n.textContent=e[s].title,t.appendChild(n)}return t},obj.createToolbar=function(e){e?obj.options.toolbar=e:e=obj.options.toolbar;for(var t=0;t<e.length;t++)if(e[t].type=="i")(l=document.createElement("i")).classList.add("jexcel_toolbar_item"),l.classList.add("material-icons"),l.setAttribute("data-k",e[t].k),l.setAttribute("data-v",e[t].v),l.setAttribute("id",e[t].id),e[t].tooltip&&l.setAttribute("title",e[t].tooltip),e[t].onclick&&(e[t].onclick,1)?l.onclick=function(f){var u=f;return function(){e[u].onclick(el,obj,this)}}(t):l.onclick=function(){var f=this.getAttribute("data-k"),u=this.getAttribute("data-v");obj.setStyle(obj.highlighted,f,u)},l.textContent=e[t].content,obj.toolbar.appendChild(l);else if(e[t].type=="select"){var n=!1;(l=document.createElement("select")).classList.add("jexcel_toolbar_item"),l.setAttribute("data-k",e[t].k),e[t].tooltip&&l.setAttribute("title",e[t].tooltip),e[t].onchange&&(e[t].onchange,1)?(l.onchange=e[t].onchange,n=!0):l.onchange=function(){var f=this.getAttribute("data-k");obj.setStyle(obj.highlighted,f,this.value)};for(var r=0;r<e[t].v.length;r++){var s=document.createElement("option");s.value=e[t].v[r],s.textContent=e[t].v[r],e[t].selectedValue&&s.value===e[t].selectedValue&&(s.selected=!0),l.appendChild(s)}n&&l.dispatchEvent(new Event("change")),obj.toolbar.appendChild(l)}else if(e[t].type=="color"){var l;(l=document.createElement("i")).classList.add("jexcel_toolbar_item"),l.classList.add("material-icons"),l.setAttribute("data-k",e[t].k),l.setAttribute("data-v",""),e[t].tooltip&&l.setAttribute("title",e[t].tooltip),obj.toolbar.appendChild(l),l.textContent=e[t].content,jSuites.color(l,{onchange:function(f,u){var c=f.getAttribute("data-k");obj.setStyle(obj.highlighted,c,u)}})}},obj.setMerge=function(e,t,n,r){var s=!1;if(!e){if(!obj.highlighted.length)return alert(obj.options.text.noCellsSelected),null;var l=parseInt(obj.highlighted[0].getAttribute("data-x")),f=parseInt(obj.highlighted[0].getAttribute("data-y")),u=parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute("data-x")),c=parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute("data-y"));e=jexcel.getColumnNameFromId([l,f]),t=u-l+1,n=c-f+1}var g=jexcel.getIdFromColumnName(e,!0);if(obj.options.mergeCells[e])obj.records[g[1]][g[0]].getAttribute("data-merged")&&(s=obj.options.text.cellAlreadyMerged);else if((!t||t<2)&&(!n||n<2))s=obj.options.text.invalidMergeProperties;else for(var D=g[1];D<g[1]+n;D++)for(var I=g[0];I<g[0]+t;I++)jexcel.getColumnNameFromId([I,D]),obj.records[D][I].getAttribute("data-merged")&&(s=obj.options.text.thereIsAConflictWithAnotherMergedCell);if(s)alert(s);else{t>1?obj.records[g[1]][g[0]].setAttribute("colspan",t):t=1,n>1?obj.records[g[1]][g[0]].setAttribute("rowspan",n):n=1,obj.options.mergeCells[e]=[t,n,[]],obj.records[g[1]][g[0]].setAttribute("data-merged","true"),obj.records[g[1]][g[0]].style.overflow="hidden";for(var v=[],p=g[1];p<g[1]+n;p++)for(var w=g[0];w<g[0]+t;w++)g[0]==w&&g[1]==p||(v.push(obj.options.data[p][w]),obj.updateCell(w,p,"",!0),obj.options.mergeCells[e][2].push(obj.records[p][w]),obj.records[p][w].style.display="none",obj.records[p][w]=obj.records[g[1]][g[0]]);obj.updateSelection(obj.records[g[1]][g[0]]),r||(obj.setHistory({action:"setMerge",column:e,colspan:t,rowspan:n,data:v}),obj.dispatch("onmerge",el,e,t,n))}},obj.getMerge=function(e){var t={};if(e)t=obj.options.mergeCells[e]?[obj.options.mergeCells[e][0],obj.options.mergeCells[e][1]]:null;else if(obj.options.mergeCells){obj.options.mergeCells;for(var n=Object.keys(obj.options.mergeCells),r=0;r<n.length;r++)t[n[r]]=[obj.options.mergeCells[n[r]][0],obj.options.mergeCells[n[r]][1]]}return t},obj.removeMerge=function(e,t,n){if(obj.options.mergeCells[e]){var r=jexcel.getIdFromColumnName(e,!0);obj.records[r[1]][r[0]].removeAttribute("colspan"),obj.records[r[1]][r[0]].removeAttribute("rowspan"),obj.records[r[1]][r[0]].removeAttribute("data-merged");for(var s=obj.options.mergeCells[e],l=0,f=0;f<s[1];f++)for(var u=0;u<s[0];u++)(f>0||u>0)&&(obj.records[r[1]+f][r[0]+u]=s[2][l],obj.records[r[1]+f][r[0]+u].style.display="",t&&t[l]&&obj.updateCell(r[0]+u,r[1]+f,t[l]),l++);obj.updateSelection(obj.records[r[1]][r[0]],obj.records[r[1]+f-1][r[0]+u-1]),n||delete obj.options.mergeCells[e]}},obj.destroyMerged=function(e){if(obj.options.mergeCells){obj.options.mergeCells;for(var t=Object.keys(obj.options.mergeCells),n=0;n<t.length;n++)obj.removeMerge(t[n],null,e)}},obj.isColMerged=function(e,t){var n=[];if(obj.options.mergeCells)for(var r=Object.keys(obj.options.mergeCells),s=0;s<r.length;s++){var l=jexcel.getIdFromColumnName(r[s],!0),f=obj.options.mergeCells[r[s]][0],u=l[0],c=l[0]+(f>1?f-1:0);t==null?u<=e&&c>=e&&n.push(r[s]):t?u<e&&c>=e&&n.push(r[s]):u<=e&&c>e&&n.push(r[s])}return n},obj.isRowMerged=function(e,t){var n=[];if(obj.options.mergeCells)for(var r=Object.keys(obj.options.mergeCells),s=0;s<r.length;s++){var l=jexcel.getIdFromColumnName(r[s],!0),f=obj.options.mergeCells[r[s]][1],u=l[1],c=l[1]+(f>1?f-1:0);t==null?u<=e&&c>=e&&n.push(r[s]):t?u<e&&c>=e&&n.push(r[s]):u<=e&&c>e&&n.push(r[s])}return n},obj.openFilter=function(e){if(obj.options.filters){e=parseInt(e),obj.resetSelection();var t=[];if(obj.options.columns[e].type=="checkbox")t.push({id:"true",name:"True"}),t.push({id:"false",name:"False"});else{for(var n=[],r=!1,s=0;s<obj.options.data.length;s++){var l=obj.options.data[s][e],f=obj.records[s][e].innerHTML;l&&f?n[l]=f:r=!0}var u=Object.keys(n);for(t=[],s=0;s<u.length;s++)t.push({id:u[s],name:n[u[s]]});r&&t.push({value:"",id:"",name:"(Blanks)"})}var c=document.createElement("div");obj.filter.children[e+1].innerHTML="",obj.filter.children[e+1].appendChild(c),obj.filter.children[e+1].style.paddingLeft="0px",obj.filter.children[e+1].style.paddingRight="0px",obj.filter.children[e+1].style.overflow="initial";var g={data:t,multiple:!0,autocomplete:!0,opened:!0,value:obj.filters[e]!==void 0?obj.filters[e]:null,width:"100%",position:obj.options.tableOverflow==1||obj.options.fullscreen==1,onclose:function(D){obj.resetFilters(),obj.filters[e]=D.dropdown.getValue(!0),obj.filter.children[e+1].innerHTML=D.dropdown.getText(),obj.filter.children[e+1].style.paddingLeft="",obj.filter.children[e+1].style.paddingRight="",obj.filter.children[e+1].style.overflow="",obj.closeFilter(e),obj.refreshSelection()}};jSuites.dropdown(c,g)}else console.log("Jspreadsheet: filters not enabled.")},obj.resetFilters=function(){if(obj.options.filters)for(var e=0;e<obj.filter.children.length;e++)obj.filter.children[e].innerHTML="&nbsp;",obj.filters[e]=null;obj.results=null,obj.updateResult()},obj.closeFilter=function(e){if(!e)for(var t=0;t<obj.filter.children.length;t++)obj.filters[t]&&(e=t);var n=function(l,f,u){for(var c=0;c<l.length;c++){var g=""+obj.options.data[u][f],D=""+obj.records[u][f].innerHTML;if(l[c]==g||l[c]==D)return!0}return!1},r=obj.filters[e];obj.results=[];for(var s=0;s<obj.options.data.length;s++)n(r,e,s)&&obj.results.push(s);obj.results.length||(obj.results=null),obj.updateResult()},obj.openEditor=function(e,t,n){var r=e.getAttribute("data-y"),s=e.getAttribute("data-x");obj.dispatch("oneditionstart",el,e,s,r),s>0&&(obj.records[r][s-1].style.overflow="hidden");var l=function(A){var O=e.getBoundingClientRect(),F=document.createElement(A);return F.style.width=O.width+"px",F.style.height=O.height-2+"px",F.style.minHeight=O.height-2+"px",e.classList.add("editor"),e.innerHTML="",e.appendChild(F),obj.dispatch("oncreateeditor",el,e,s,r,F),F};if(e.classList.contains("readonly")!=1){if(obj.edition=[obj.records[r][s],obj.records[r][s].innerHTML,s,r],obj.options.columns[s].editor)obj.options.columns[s].editor.openEditor(e,el,t,n);else if(obj.options.columns[s].type!="hidden")if(obj.options.columns[s].type=="checkbox"||obj.options.columns[s].type=="radio"){var f=!e.children[0].checked;obj.setValue(e,f),obj.edition=null}else if(obj.options.columns[s].type=="dropdown"||obj.options.columns[s].type=="autocomplete"){if(f=obj.options.data[r][s],obj.options.columns[s].multiple&&!Array.isArray(f)&&(f=f.split(";")),typeof obj.options.columns[s].filter=="function")var u=obj.options.columns[s].filter(el,e,s,r,obj.options.columns[s].source);else u=obj.options.columns[s].source;for(var c=[],g=0;g<u.length;g++)c.push(u[g]);var D=l("div"),I={data:c,multiple:!!obj.options.columns[s].multiple,autocomplete:!(!obj.options.columns[s].autocomplete&&obj.options.columns[s].type!="autocomplete"),opened:!0,value:f,width:"100%",height:D.style.minHeight,position:obj.options.tableOverflow==1||obj.options.fullscreen==1,onclose:function(){obj.closeEditor(e,!0)}};obj.options.columns[s].options&&obj.options.columns[s].options.type&&(I.type=obj.options.columns[s].options.type),jSuites.dropdown(D,I)}else if(obj.options.columns[s].type=="calendar"||obj.options.columns[s].type=="color")f=obj.options.data[r][s],(D=l("input")).value=f,obj.options.tableOverflow!=1&&obj.options.fullscreen!=1||(obj.options.columns[s].options.position=!0),obj.options.columns[s].options.value=obj.options.data[r][s],obj.options.columns[s].options.opened=!0,obj.options.columns[s].options.onclose=function(A,O){obj.closeEditor(e,!0)},obj.options.columns[s].type=="color"?jSuites.color(D,obj.options.columns[s].options):jSuites.calendar(D,obj.options.columns[s].options),D.focus();else if(obj.options.columns[s].type=="html"){f=obj.options.data[r][s],(D=l("div")).style.position="relative",(w=document.createElement("div")).classList.add("jexcel_richtext"),D.appendChild(w),jSuites.editor(w,{focus:!0,value:f});var v=e.getBoundingClientRect(),p=w.getBoundingClientRect();window.innerHeight<v.bottom+p.height?w.style.top=v.top-(p.height+2)+"px":w.style.top=v.top+"px"}else if(obj.options.columns[s].type=="image"){var w,j=e.children[0];(D=l("div")).style.position="relative",(w=document.createElement("div")).classList.add("jclose"),j&&j.src&&w.appendChild(j),D.appendChild(w),jSuites.image(w,obj.options.imageOptions),v=e.getBoundingClientRect(),p=w.getBoundingClientRect(),window.innerHeight<v.bottom+p.height?w.style.top=v.top-(p.height+2)+"px":w.style.top=v.top+"px"}else{f=t==1?"":obj.options.data[r][s],obj.options.columns[s].wordWrap==0||obj.options.wordWrap!=1&&obj.options.columns[s].wordWrap!=1?D=l("input"):D=l("textarea"),D.focus(),D.value=f,I=obj.options.columns[s];var b=null;if(!isFormula(f)&&(b=getMask(I))){if(!I.disabledMaskOnEdition)if(I.mask){var M=I.mask.split(";");D.setAttribute("data-mask",M[0])}else I.locale&&D.setAttribute("data-locale",I.locale);b.input=D,D.mask=b,jSuites.mask.render(f,b,!1)}D.onblur=function(){obj.closeEditor(e,!0)},D.scrollLeft=D.scrollWidth}}},obj.closeEditor=function(e,t){var n=parseInt(e.getAttribute("data-x")),r=parseInt(e.getAttribute("data-y"));if(t==1){if(obj.options.columns[n].editor)var s=obj.options.columns[n].editor.closeEditor(e,t);else if(!(obj.options.columns[n].type=="checkbox"||obj.options.columns[n].type=="radio"||obj.options.columns[n].type=="hidden"))if(obj.options.columns[n].type=="dropdown"||obj.options.columns[n].type=="autocomplete")s=e.children[0].dropdown.close(!0);else if(obj.options.columns[n].type=="calendar")s=e.children[0].calendar.close(!0);else if(obj.options.columns[n].type=="color")s=e.children[0].color.close(!0);else if(obj.options.columns[n].type=="html")s=e.children[0].children[0].editor.getData();else if(obj.options.columns[n].type=="image"){var l=e.children[0].children[0].children[0];s=l&&l.tagName=="IMG"?l.src:""}else if(obj.options.columns[n].type=="numeric")(""+(s=e.children[0].value)).substr(0,1)!="="&&s==""&&(s=obj.options.columns[n].allowEmpty?"":0),e.children[0].onblur=null;else{s=e.children[0].value,e.children[0].onblur=null;var f,u=obj.options.columns[n];if((f=getMask(u))&&s!==""&&!isFormula(s)&&typeof s!="number"){var c=jSuites.mask.extract(s,f,!0);c&&c.value!==""&&(s=c.value)}}obj.options.data[r][n]==s?e.innerHTML=obj.edition[1]:obj.setValue(e,s)}else obj.options.columns[n].editor?obj.options.columns[n].editor.closeEditor(e,t):obj.options.columns[n].type=="dropdown"||obj.options.columns[n].type=="autocomplete"?e.children[0].dropdown.close(!0):obj.options.columns[n].type=="calendar"?e.children[0].calendar.close(!0):obj.options.columns[n].type=="color"?e.children[0].color.close(!0):e.children[0].onblur=null,e.innerHTML=obj.edition&&obj.edition[1]?obj.edition[1]:"";obj.dispatch("oneditionend",el,e,n,r,s,t),e.classList.remove("editor"),obj.edition=null},obj.getCell=function(e){var t=(e=jexcel.getIdFromColumnName(e,!0))[0],n=e[1];return obj.records[n][t]},obj.getColumnOptions=function(e,t){var n=obj.options.columns[e];return n||(n={type:"text"}),n},obj.getCellFromCoords=function(e,t){return obj.records[t][e]},obj.getLabel=function(e){var t=(e=jexcel.getIdFromColumnName(e,!0))[0],n=e[1];return obj.records[n][t].innerHTML},obj.getLabelFromCoords=function(e,t){return obj.records[t][e].innerHTML},obj.getValue=function(e,t){if(typeof e=="object")var n=e.getAttribute("data-x"),r=e.getAttribute("data-y");else n=(e=jexcel.getIdFromColumnName(e,!0))[0],r=e[1];var s=null;return n!=null&&r!=null&&(obj.records[r]&&obj.records[r][n]&&(t||obj.options.copyCompatibility==1)?s=obj.records[r][n].innerHTML:obj.options.data[r]&&obj.options.data[r][n]!="undefined"&&(s=obj.options.data[r][n])),s},obj.getValueFromCoords=function(e,t,n){var r=null;return e!=null&&t!=null&&(obj.records[t]&&obj.records[t][e]&&n||obj.options.copyCompatibility==1?r=obj.records[t][e].innerHTML:obj.options.data[t]&&obj.options.data[t][e]!="undefined"&&(r=obj.options.data[t][e])),r},obj.setValue=function(e,t,n){var r=[];if(typeof e=="string"){var s=(c=jexcel.getIdFromColumnName(e,!0))[0],l=c[1];r.push(obj.updateCell(s,l,t,n)),obj.updateFormulaChain(s,l,r)}else if(s=null,l=null,e&&e.getAttribute&&(s=e.getAttribute("data-x"),l=e.getAttribute("data-y")),s!=null&&l!=null)r.push(obj.updateCell(s,l,t,n)),obj.updateFormulaChain(s,l,r);else{var f=Object.keys(e);if(f.length>0)for(var u=0;u<f.length;u++){var c;typeof e[u]=="string"?(s=(c=jexcel.getIdFromColumnName(e[u],!0))[0],l=c[1]):e[u].x!=null&&e[u].y!=null?(s=e[u].x,l=e[u].y,e[u].newValue!=null?t=e[u].newValue:e[u].value!=null&&(t=e[u].value)):(s=e[u].getAttribute("data-x"),l=e[u].getAttribute("data-y")),s!=null&&l!=null&&(r.push(obj.updateCell(s,l,t,n)),obj.updateFormulaChain(s,l,r))}}obj.setHistory({action:"setValue",records:r,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,r)},obj.setValueFromCoords=function(e,t,n,r){var s=[];s.push(obj.updateCell(e,t,n,r)),obj.updateFormulaChain(e,t,s),obj.setHistory({action:"setValue",records:s,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,s)},obj.setCheckRadioValue=function(){for(var e=[],t=Object.keys(obj.highlighted),n=0;n<t.length;n++){var r=obj.highlighted[n].getAttribute("data-x"),s=obj.highlighted[n].getAttribute("data-y");obj.options.columns[r].type!="checkbox"&&obj.options.columns[r].type!="radio"||e.push(obj.updateCell(r,s,!obj.options.data[s][r]))}e.length&&(obj.setHistory({action:"setValue",records:e,selection:obj.selectedCell}),obj.onafterchanges(el,e))};var stripScript=function(e){var t=new Option;t.innerHTML=e;var n=null;for(e=t.getElementsByTagName("script");n=e[0];)n.parentNode.removeChild(n);return t.innerHTML};obj.updateCell=function(e,t,n,r){if(obj.records[t][e].classList.contains("readonly")!=1||r){var s;(""+n).substr(0,1)=="="&&obj.options.secureFormulas==1&&(s=secureFormula(n))!=n&&(n=s),(s=obj.dispatch("onbeforechange",el,obj.records[t][e],e,t,n))!=null&&(n=s),obj.options.columns[e].editor&&typeof obj.options.columns[e].editor.updateCell=="function"&&(n=obj.options.columns[e].editor.updateCell(obj.records[t][e],n,r)),D={x:e,y:t,col:e,row:t,newValue:n,oldValue:obj.options.data[t][e]};let I=obj.options.columns[e].editor;if(I)obj.options.data[t][e]=n,typeof I.setValue=="function"&&I.setValue(obj.records[t][e],n);else if(obj.options.columns[e].type=="checkbox"||obj.options.columns[e].type=="radio"){if(obj.options.columns[e].type=="radio")for(var l=0;l<obj.options.data.length;l++)obj.options.data[l][e]=!1;obj.records[t][e].children[0].checked=n==1||n==1||n=="true"||n=="TRUE",obj.options.data[t][e]=obj.records[t][e].children[0].checked}else if(obj.options.columns[e].type=="dropdown"||obj.options.columns[e].type=="autocomplete")obj.options.data[t][e]=n,obj.records[t][e].textContent=obj.getDropDownValue(e,n);else if(obj.options.columns[e].type=="calendar"){var f=null;if(!validDate(n)){var u=jSuites.calendar.extractDateFromString(n,obj.options.columns[e].options.format);u&&(f=u)}obj.options.data[t][e]=n,obj.records[t][e].textContent=jSuites.calendar.getDateString(f||n,obj.options.columns[e].options.format)}else if(obj.options.columns[e].type=="color")if(obj.options.data[t][e]=n,obj.options.columns[e].render=="square"){var c=document.createElement("div");c.className="color",c.style.backgroundColor=n,obj.records[t][e].textContent="",obj.records[t][e].appendChild(c)}else obj.records[t][e].style.color=n,obj.records[t][e].textContent=n;else if(obj.options.columns[e].type=="image"){if(n=""+n,obj.options.data[t][e]=n,obj.records[t][e].innerHTML="",n&&n.substr(0,10)=="data:image"){var g=document.createElement("img");g.src=n,obj.records[t][e].appendChild(g)}}else obj.options.data[t][e]=n,obj.options.columns[e].type=="html"?obj.records[t][e].innerHTML=stripScript(obj.parseValue(e,t,n)):obj.options.stripHTML===!1||obj.options.columns[e].stripHTML===!1?obj.records[t][e].innerHTML=stripScript(obj.parseValue(e,t,n,obj.records[t][e])):obj.records[t][e].textContent=obj.parseValue(e,t,n,obj.records[t][e]),obj.options.columns[e].wordWrap!=0&&(obj.options.wordWrap==1||obj.options.columns[e].wordWrap==1||obj.records[t][e].innerHTML.length>200)?obj.records[t][e].style.whiteSpace="pre-wrap":obj.records[t][e].style.whiteSpace="";e>0&&(obj.records[t][e-1].style.overflow=n?"hidden":""),obj.dispatch("onchange",el,obj.records[t]&&obj.records[t][e]?obj.records[t][e]:null,e,t,n,D.oldValue)}else var D={x:e,y:t,col:e,row:t};return D},obj.copyData=function(e,t){var n=obj.getData(!0,!0),r=obj.selectedContainer,s=parseInt(e.getAttribute("data-x")),l=parseInt(e.getAttribute("data-y")),f=parseInt(t.getAttribute("data-x")),u=parseInt(t.getAttribute("data-y")),c=[],g=!1;if(r[0]==s){if(l<r[1])var D=l-r[1];else D=1;var I=0}else I=s<r[0]?s-r[0]:1,D=0;for(var v=0,p=0,w=l;w<=u;w++)if(!obj.rows[w]||obj.rows[w].style.display!="none"){n[p]==null&&(p=0),v=0,r[0]!=s&&(I=s<r[0]?s-r[0]:1);for(var j=s;j<=f;j++){if(obj.records[w][j]&&!obj.records[w][j].classList.contains("readonly")&&obj.records[w][j].style.display!="none"&&g==0){if(!obj.selection.length&&obj.options.data[w][j]!=""){g=!0;continue}(n[p]==null||n[p][v]==null)&&(v=0);var b=n[p][v];if(b&&!n[1]&&obj.options.autoIncrement==1){if(obj.options.columns[j].type=="text"||obj.options.columns[j].type=="number")if((""+b).substr(0,1)=="="){var M=b.match(/([A-Z]+[0-9]+)/g);if(M){for(var A=[],O=0;O<M.length;O++){var F=jexcel.getIdFromColumnName(M[O],1);F[0]+=I,F[1]+=D,F[1]<0&&(F[1]=0);var V=jexcel.getColumnNameFromId([F[0],F[1]]);V!=M[O]&&(A[M[O]]=V)}A&&(b=obj.updateFormula(b,A))}}else b==Number(b)&&(b=Number(b)+D);else if(obj.options.columns[j].type=="calendar"){var _=new Date(b);_.setDate(_.getDate()+D),b=_.getFullYear()+"-"+jexcel.doubleDigitFormat(parseInt(_.getMonth()+1))+"-"+jexcel.doubleDigitFormat(_.getDate())+" 00:00:00"}}c.push(obj.updateCell(j,w,b)),obj.updateFormulaChain(j,w,c)}v++,r[0]!=s&&I++}p++,D++}obj.setHistory({action:"setValue",records:c,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,c)},obj.refreshSelection=function(){obj.selectedCell&&obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])},obj.conditionalSelectionUpdate=function(e,t,n){if(e==1){if(obj.selectedCell&&(t>=obj.selectedCell[1]&&t<=obj.selectedCell[3]||n>=obj.selectedCell[1]&&n<=obj.selectedCell[3]))return void obj.resetSelection()}else if(obj.selectedCell&&(t>=obj.selectedCell[0]&&t<=obj.selectedCell[2]||n>=obj.selectedCell[0]&&n<=obj.selectedCell[2]))return void obj.resetSelection()},obj.resetSelection=function(e){if(obj.highlighted.length){g=1;for(var t=0;t<obj.highlighted.length;t++){obj.highlighted[t].classList.remove("highlight"),obj.highlighted[t].classList.remove("highlight-left"),obj.highlighted[t].classList.remove("highlight-right"),obj.highlighted[t].classList.remove("highlight-top"),obj.highlighted[t].classList.remove("highlight-bottom"),obj.highlighted[t].classList.remove("highlight-selected");var n=parseInt(obj.highlighted[t].getAttribute("data-x")),r=parseInt(obj.highlighted[t].getAttribute("data-y"));if(obj.highlighted[t].getAttribute("data-merged"))var s=parseInt(obj.highlighted[t].getAttribute("colspan")),l=parseInt(obj.highlighted[t].getAttribute("rowspan")),f=s>0?n+(s-1):n,u=l>0?r+(l-1):r;else f=n,u=r;for(var c=n;c<=f;c++)obj.headers[c]&&obj.headers[c].classList.remove("selected");for(c=r;c<=u;c++)obj.rows[c]&&obj.rows[c].classList.remove("selected")}}else var g=0;return obj.highlighted=[],obj.selectedCell=null,obj.corner.style.top="-2000px",obj.corner.style.left="-2000px",e==1&&g==1&&obj.dispatch("onblur",el),g},obj.updateSelection=function(e,t,n){var r=e.getAttribute("data-x"),s=e.getAttribute("data-y");if(t)var l=t.getAttribute("data-x"),f=t.getAttribute("data-y");else l=r,f=s;obj.updateSelectionFromCoords(r,s,l,f,n)},obj.updateSelectionFromCoords=function(e,t,n,r,s){var l=obj.resetSelection();if(t==null&&(t=0,r=obj.rows.length-1),n==null&&(n=e),r==null&&(r=t),e>=obj.headers.length&&(e=obj.headers.length-1),t>=obj.rows.length&&(t=obj.rows.length-1),n>=obj.headers.length&&(n=obj.headers.length-1),r>=obj.rows.length&&(r=obj.rows.length-1),obj.selectedCell=[e,t,n,r],e!=null){if(obj.records[t][e]&&obj.records[t][e].classList.add("highlight-selected"),parseInt(e)<parseInt(n))var f=parseInt(e),u=parseInt(n);else f=parseInt(n),u=parseInt(e);if(parseInt(t)<parseInt(r))var c=parseInt(t),g=parseInt(r);else c=parseInt(r),g=parseInt(t);for(var D=f;D<=u;D++)for(var I=c;I<=g;I++)if(obj.records[I][D]&&obj.records[I][D].getAttribute("data-merged")){var v=parseInt(obj.records[I][D].getAttribute("data-x")),p=parseInt(obj.records[I][D].getAttribute("data-y")),w=parseInt(obj.records[I][D].getAttribute("colspan")),j=parseInt(obj.records[I][D].getAttribute("rowspan"));w>1&&(v<f&&(f=v),v+w>u&&(u=v+w-1)),j&&(p<c&&(c=p),p+j>g&&(g=p+j-1))}var b=null,M=null,A=null,O=null;for(I=c;I<=g;I++)obj.rows[I].style.display!="none"&&(A==null&&(A=I),O=I);for(D=f;D<=u;D++){for(I=c;I<=g;I++)obj.rows[I].style.display!="none"&&obj.records[I][D].style.display!="none"&&(obj.records[I][D].classList.add("highlight"),obj.highlighted.push(obj.records[I][D]));obj.options.columns[D].type!="hidden"&&(b==null&&(b=D),M=D)}for(b||(b=0),M||(M=0),D=b;D<=M;D++)obj.options.columns[D].type!="hidden"&&obj.colgroup[D].style&&obj.colgroup[D].style.display!="none"&&(obj.records[A]&&obj.records[A][D]&&obj.records[A][D].classList.add("highlight-top"),obj.records[O]&&obj.records[O][D]&&obj.records[O][D].classList.add("highlight-bottom"),obj.headers[D].classList.add("selected"));for(I=A;I<=O;I++)obj.rows[I]&&obj.rows[I].style.display!="none"&&(obj.records[I][b].classList.add("highlight-left"),obj.records[I][M].classList.add("highlight-right"),obj.rows[I].classList.add("selected"));obj.selectedContainer=[b,A,M,O]}l==0&&(obj.dispatch("onfocus",el),obj.removeCopyingSelection()),obj.dispatch("onselection",el,b,A,M,O,s),obj.updateCornerPosition()},obj.removeCopySelection=function(){for(var e=0;e<obj.selection.length;e++)obj.selection[e].classList.remove("selection"),obj.selection[e].classList.remove("selection-left"),obj.selection[e].classList.remove("selection-right"),obj.selection[e].classList.remove("selection-top"),obj.selection[e].classList.remove("selection-bottom");obj.selection=[]},obj.updateCopySelection=function(e,t){obj.removeCopySelection();var n=obj.selectedContainer[0],r=obj.selectedContainer[1],s=obj.selectedContainer[2],l=obj.selectedContainer[3];if(e!=null&&t!=null){if(e-s>0)var f=parseInt(s)+1,u=parseInt(e);else f=parseInt(e),u=parseInt(n)-1;if(t-l>0)var c=parseInt(l)+1,g=parseInt(t);else c=parseInt(t),g=parseInt(r)-1;u-f<=g-c?(f=parseInt(n),u=parseInt(s)):(c=parseInt(r),g=parseInt(l));for(var D=c;D<=g;D++)for(var I=f;I<=u;I++)obj.records[D][I]&&obj.rows[D].style.display!="none"&&obj.records[D][I].style.display!="none"&&(obj.records[D][I].classList.add("selection"),obj.records[c][I].classList.add("selection-top"),obj.records[g][I].classList.add("selection-bottom"),obj.records[D][f].classList.add("selection-left"),obj.records[D][u].classList.add("selection-right"),obj.selection.push(obj.records[D][I]))}},obj.updateCornerPosition=function(){if(obj.highlighted.length){var e=obj.highlighted[obj.highlighted.length-1],t=e.getAttribute("data-x"),n=obj.content.getBoundingClientRect(),r=n.left,s=n.top,l=e.getBoundingClientRect(),f=l.left,u=l.top,c=l.width,g=l.height,D=f-r+obj.content.scrollLeft+c-4,I=u-s+obj.content.scrollTop+g-4;if(obj.corner.style.top=I+"px",obj.corner.style.left=D+"px",obj.options.freezeColumns){var v=obj.getFreezeWidth();t>obj.options.freezeColumns-1&&f-r+c<v?obj.corner.style.display="none":obj.options.selectionCopy==1&&(obj.corner.style.display="")}else obj.options.selectionCopy==1&&(obj.corner.style.display="")}else obj.corner.style.top="-2000px",obj.corner.style.left="-2000px"},obj.updateScroll=function(e){var t=obj.content.getBoundingClientRect(),n=t.left,r=t.top,s=t.width,l=t.height,f=obj.records[obj.selectedCell[3]][obj.selectedCell[2]].getBoundingClientRect(),u=f.left,c=f.top,g=f.width,D=f.height;if(e==0||e==1)var I=u-n+obj.content.scrollLeft,v=c-r+obj.content.scrollTop-2;else I=u-n+obj.content.scrollLeft+g,v=c-r+obj.content.scrollTop+D;v>obj.content.scrollTop+30&&v<obj.content.scrollTop+l||(v<obj.content.scrollTop+30?obj.content.scrollTop=v-D:obj.content.scrollTop=v-(l-2));var p=obj.getFreezeWidth();I>obj.content.scrollLeft+p&&I<obj.content.scrollLeft+s||(I<obj.content.scrollLeft+30?(obj.content.scrollLeft=I,obj.content.scrollLeft<50&&(obj.content.scrollLeft=0)):I<obj.content.scrollLeft+p?obj.content.scrollLeft=I-p-1:obj.content.scrollLeft=I-(s-20))},obj.getWidth=function(e){if(e===void 0)for(var t=[],n=0;n<obj.headers.length;n++)t.push(obj.options.columns[n].width);else typeof e=="object"&&(e=e.getAttribute("data-x")),t=obj.colgroup[e].getAttribute("width");return t},obj.setWidth=function(e,t,n){if(t){if(Array.isArray(e)){n||(n=[]);for(var r=0;r<e.length;r++){n[r]||(n[r]=obj.colgroup[e[r]].getAttribute("width"));var s=Array.isArray(t)&&t[r]?t[r]:t;obj.colgroup[e[r]].setAttribute("width",s),obj.options.columns[e[r]].width=s}}else n||(n=obj.colgroup[e].getAttribute("width")),obj.colgroup[e].setAttribute("width",t),obj.options.columns[e].width=t;obj.setHistory({action:"setWidth",column:e,oldValue:n,newValue:t}),obj.dispatch("onresizecolumn",el,e,t,n),obj.updateCornerPosition()}},obj.setHeight=function(e,t,n){t>0&&(typeof e=="object"&&(e=e.getAttribute("data-y")),n||(n=obj.rows[e].getAttribute("height"))||(n=obj.rows[e].getBoundingClientRect().height),t=parseInt(t),obj.rows[e].style.height=t+"px",obj.options.rows[e]||(obj.options.rows[e]={}),obj.options.rows[e].height=t,obj.setHistory({action:"setHeight",row:e,oldValue:n,newValue:t}),obj.dispatch("onresizerow",el,e,t,n),obj.updateCornerPosition())},obj.getHeight=function(e){if(e===void 0)for(var t=[],n=0;n<obj.rows.length;n++){var r=obj.rows[n].style.height;r&&(t[n]=r)}else typeof e=="object"&&(e=$(e).getAttribute("data-y")),t=obj.rows[e].style.height;return t},obj.setFooter=function(e){if(e&&(obj.options.footers=e),obj.options.footers){obj.tfoot||(obj.tfoot=document.createElement("tfoot"),obj.table.appendChild(obj.tfoot));for(var t=0;t<obj.options.footers.length;t++){if(obj.tfoot.children[t])var n=obj.tfoot.children[t];else{n=document.createElement("tr");var r=document.createElement("td");n.appendChild(r),obj.tfoot.appendChild(n)}for(var s=0;s<obj.headers.length;s++){if(obj.options.footers[t][s]||(obj.options.footers[t][s]=""),obj.tfoot.children[t].children[s+1])r=obj.tfoot.children[t].children[s+1];else{r=document.createElement("td"),n.appendChild(r);var l=obj.options.columns[s].align?obj.options.columns[s].align:"center";r.style.textAlign=l}r.textContent=obj.parseValue(+obj.records.length+s,t,obj.options.footers[t][s]),r.style.display=obj.colgroup[s].style.display}}}},obj.getHeader=function(e){return obj.headers[e].textContent},obj.setHeader=function(e,t){if(obj.headers[e]){var n=obj.headers[e].textContent;t||(t=prompt(obj.options.text.columnName,n)),t&&(obj.headers[e].textContent=t,obj.headers[e].setAttribute("title",t),obj.options.columns[e].title=t),obj.setHistory({action:"setHeader",column:e,oldValue:n,newValue:t}),obj.dispatch("onchangeheader",el,e,n,t)}},obj.getHeaders=function(e){for(var t=[],n=0;n<obj.headers.length;n++)t.push(obj.getHeader(n));return e?t:t.join(obj.options.csvDelimiter)},obj.getMeta=function(e,t){return e?t?obj.options.meta[e]&&obj.options.meta[e][t]?obj.options.meta[e][t]:null:obj.options.meta[e]?obj.options.meta[e]:null:obj.options.meta},obj.setMeta=function(e,t,n){if(obj.options.meta||(obj.options.meta={}),t&&n)obj.options.meta[e]||(obj.options.meta[e]={}),obj.options.meta[e][t]=n;else for(var r=Object.keys(e),s=0;s<r.length;s++){obj.options.meta[r[s]]||(obj.options.meta[r[s]]={});for(var l=Object.keys(e[r[s]]),f=0;f<l.length;f++)obj.options.meta[r[s]][l[f]]=e[r[s]][l[f]]}obj.dispatch("onchangemeta",el,e,t,n)},obj.updateMeta=function(e){if(obj.options.meta){for(var t={},n=Object.keys(obj.options.meta),r=0;r<n.length;r++)e[n[r]]?t[e[n[r]]]=obj.options.meta[n[r]]:t[n[r]]=obj.options.meta[n[r]];obj.options.meta=t}},obj.getStyle=function(e,t){if(e)return e=jexcel.getIdFromColumnName(e,!0),t?obj.records[e[1]][e[0]].style[t]:obj.records[e[1]][e[0]].getAttribute("style");for(var n={},r=obj.options.data[0].length,s=obj.options.data.length,l=0;l<s;l++)for(var f=0;f<r;f++){var u=t?obj.records[l][f].style[t]:obj.records[l][f].getAttribute("style");u&&(n[jexcel.getColumnNameFromId([f,l])]=u)}return n},obj.resetStyle=function(e,t){for(var n=Object.keys(e),r=0;r<n.length;r++){var s=jexcel.getIdFromColumnName(n[r],!0);obj.records[s[1]]&&obj.records[s[1]][s[0]]&&obj.records[s[1]][s[0]].setAttribute("style","")}obj.setStyle(e,null,null,null,t)},obj.setStyle=function(e,t,n,r,s){var l={},f={},u=function(b,M,A){var O=jexcel.getIdFromColumnName(b,!0);if(obj.records[O[1]]&&obj.records[O[1]][O[0]]&&(obj.records[O[1]][O[0]].classList.contains("readonly")==0||r)){var F=obj.records[O[1]][O[0]].style[M];F!=A||r?obj.records[O[1]][O[0]].style[M]=A:(A="",obj.records[O[1]][O[0]].style[M]=""),f[b]||(f[b]=[]),l[b]||(l[b]=[]),f[b].push([M+":"+F]),l[b].push([M+":"+A])}};if(t&&n)if(typeof e=="string")u(e,t,n);else for(var c=[],g=0;g<e.length;g++){var D=e[g].getAttribute("data-x"),I=e[g].getAttribute("data-y"),v=jexcel.getColumnNameFromId([D,I]);c[v]||(u(v,t,n),c[v]=!0)}else{var p=Object.keys(e);for(g=0;g<p.length;g++){var w=e[p[g]];typeof w=="string"&&(w=w.split(";"));for(var j=0;j<w.length;j++)typeof w[j]=="string"&&(w[j]=w[j].split(":")),w[j][0].trim()&&u(p[g],w[j][0].trim(),w[j][1])}}for(p=Object.keys(f),g=0;g<p.length;g++)f[p[g]]=f[p[g]].join(";");for(p=Object.keys(l),g=0;g<p.length;g++)l[p[g]]=l[p[g]].join(";");s||obj.setHistory({action:"setStyle",oldValue:f,newValue:l}),obj.dispatch("onchangestyle",el,e,t,n)},obj.getComments=function(e,t){if(e)return typeof e=="string"&&(e=jexcel.getIdFromColumnName(e,!0)),t?[obj.records[e[1]][e[0]].getAttribute("title"),obj.records[e[1]][e[0]].getAttribute("author")]:obj.records[e[1]][e[0]].getAttribute("title")||"";for(var n={},r=0;r<obj.options.data.length;r++)for(var s=0;s<obj.options.columns.length;s++){var l=obj.records[r][s].getAttribute("title");l&&(n[e=jexcel.getColumnNameFromId([s,r])]=l)}return n},obj.setComments=function(e,t,n){if(typeof e=="string")var r=jexcel.getIdFromColumnName(e,!0);else r=e;var s=obj.records[r[1]][r[0]].getAttribute("title"),l=[s,n=obj.records[r[1]][r[0]].getAttribute("data-author")];obj.records[r[1]][r[0]].setAttribute("title",t||""),obj.records[r[1]][r[0]].setAttribute("data-author",n||""),t?obj.records[r[1]][r[0]].classList.add("jexcel_comments"):obj.records[r[1]][r[0]].classList.remove("jexcel_comments"),obj.setHistory({action:"setComments",column:e,newValue:[t,n],oldValue:l}),obj.dispatch("oncomments",el,t,s,r,r[0],r[1])},obj.getConfig=function(){var e=obj.options;return e.style=obj.getStyle(),e.mergeCells=obj.getMerge(),e.comments=obj.getComments(),e},obj.orderBy=function(e,t){if(e>=0){if(Object.keys(obj.options.mergeCells).length>0){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}t=t==null?obj.headers[e].classList.contains("arrow-down")?1:0:t?1:0;var n=[];if(obj.options.columns[e].type=="number"||obj.options.columns[e].type=="numeric"||obj.options.columns[e].type=="percentage"||obj.options.columns[e].type=="autonumber"||obj.options.columns[e].type=="color")for(var r=0;r<obj.options.data.length;r++)n[r]=[r,Number(obj.options.data[r][e])];else if(obj.options.columns[e].type=="calendar"||obj.options.columns[e].type=="checkbox"||obj.options.columns[e].type=="radio")for(r=0;r<obj.options.data.length;r++)n[r]=[r,obj.options.data[r][e]];else for(r=0;r<obj.options.data.length;r++)n[r]=[r,obj.records[r][e].textContent.toLowerCase()];typeof obj.options.sorting!="function"&&(obj.options.sorting=function(l){return function(f,u){var c=f[1],g=u[1];return l?c===""&&g!==""?1:c!==""&&g===""||c>g?-1:c<g?1:0:c===""&&g!==""?1:c!==""&&g===""?-1:c>g?1:c<g?-1:0}}),n=n.sort(obj.options.sorting(t));var s=[];for(r=0;r<n.length;r++)s[r]=n[r][0];return obj.setHistory({action:"orderBy",rows:s,column:e,order:t}),obj.updateOrderArrow(e,t),obj.updateOrder(s),obj.dispatch("onsort",el,e,t),!0}},obj.updateOrderArrow=function(e,t){for(var n=0;n<obj.headers.length;n++)obj.headers[n].classList.remove("arrow-up"),obj.headers[n].classList.remove("arrow-down");t?obj.headers[e].classList.add("arrow-up"):obj.headers[e].classList.add("arrow-down")},obj.updateOrder=function(e){for(var t=[],n=0;n<e.length;n++)t[n]=obj.options.data[e[n]];for(obj.options.data=t,t=[],n=0;n<e.length;n++)t[n]=obj.records[e[n]];for(obj.records=t,t=[],n=0;n<e.length;n++)t[n]=obj.rows[e[n]];if(obj.rows=t,obj.updateTableReferences(),obj.results&&obj.results.length)obj.searchInput.value?obj.search(obj.searchInput.value):obj.closeFilter();else if(obj.results=null,obj.pageNumber=0,obj.options.pagination>0)obj.page(0);else if(obj.options.lazyLoading==1)obj.loadPage(0);else for(n=0;n<obj.rows.length;n++)obj.tbody.appendChild(obj.rows[n])},obj.moveRow=function(e,t,n){if(Object.keys(obj.options.mergeCells).length>0){if(e>t)var r=1;else r=0;if(obj.isRowMerged(e).length||obj.isRowMerged(t,r).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}}if(obj.options.search==1){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}n||(Array.prototype.indexOf.call(obj.tbody.children,obj.rows[t])>=0?e>t?obj.tbody.insertBefore(obj.rows[e],obj.rows[t]):obj.tbody.insertBefore(obj.rows[e],obj.rows[t].nextSibling):obj.tbody.removeChild(obj.rows[e])),obj.rows.splice(t,0,obj.rows.splice(e,1)[0]),obj.records.splice(t,0,obj.records.splice(e,1)[0]),obj.options.data.splice(t,0,obj.options.data.splice(e,1)[0]),obj.options.pagination>0&&obj.tbody.children.length!=obj.options.pagination&&obj.page(obj.pageNumber),obj.setHistory({action:"moveRow",oldValue:e,newValue:t}),obj.updateTableReferences(),obj.dispatch("onmoverow",el,e,t)},obj.insertRow=function(e,t,n){if(obj.options.allowInsertRow==1){var r=[];if(e>0)var s=e;else s=1,e&&(r=e);n=!!n;var l=obj.options.data.length-1;if((t==null||t>=parseInt(l)||t<0)&&(t=l),obj.dispatch("onbeforeinsertrow",el,t,s,n)===!1)return!1;if(Object.keys(obj.options.mergeCells).length>0&&obj.isRowMerged(t,n).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}if(obj.options.search==1){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}for(var f=n?t:t+1,u=obj.records.splice(f),c=obj.options.data.splice(f),g=obj.rows.splice(f),D=[],I=[],v=[],p=f;p<s+f;p++){obj.options.data[p]=[];for(var w=0;w<obj.options.columns.length;w++)obj.options.data[p][w]=r[w]?r[w]:"";var j=obj.createRow(p,obj.options.data[p]);g[0]?Array.prototype.indexOf.call(obj.tbody.children,g[0])>=0&&obj.tbody.insertBefore(j,g[0]):Array.prototype.indexOf.call(obj.tbody.children,obj.rows[t])>=0&&obj.tbody.appendChild(j),D.push(obj.records[p]),I.push(obj.options.data[p]),v.push(j)}Array.prototype.push.apply(obj.records,u),Array.prototype.push.apply(obj.options.data,c),Array.prototype.push.apply(obj.rows,g),obj.options.pagination>0&&obj.page(obj.pageNumber),obj.setHistory({action:"insertRow",rowNumber:t,numOfRows:s,insertBefore:n,rowRecords:D,rowData:I,rowNode:v}),obj.updateTableReferences(),obj.dispatch("oninsertrow",el,t,s,D,n)}},obj.deleteRow=function(e,t){if(obj.options.allowDeleteRow==1)if(obj.options.allowDeletingAllRows==1||obj.options.data.length>1){if(e==null){var n=obj.getSelectedRows();n[0]?(e=parseInt(n[0].getAttribute("data-y")),t=n.length):(e=obj.options.data.length-1,t=1)}var r=obj.options.data.length-1;if((e==null||e>r||e<0)&&(e=r),t||(t=1),e+t>=obj.options.data.length&&(t=obj.options.data.length-e),obj.dispatch("onbeforedeleterow",el,e,t)===!1)return!1;if(parseInt(e)>-1){var s=!1;if(Object.keys(obj.options.mergeCells).length>0)for(var l=e;l<e+t;l++)obj.isRowMerged(l,!1).length&&(s=!0);if(s){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}if(obj.options.search==1){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}for(obj.options.allowDeletingAllRows==0&&r+1===t&&(t--,console.error("Jspreadsheet: It is not possible to delete the last row")),l=e;l<e+t;l++)Array.prototype.indexOf.call(obj.tbody.children,obj.rows[l])>=0&&(obj.rows[l].className="",obj.rows[l].parentNode.removeChild(obj.rows[l]));var f=obj.records.splice(e,t),u=obj.options.data.splice(e,t),c=obj.rows.splice(e,t);obj.options.pagination>0&&obj.tbody.children.length!=obj.options.pagination&&obj.page(obj.pageNumber),obj.conditionalSelectionUpdate(1,e,e+t-1),obj.setHistory({action:"deleteRow",rowNumber:e,numOfRows:t,insertBefore:1,rowRecords:f,rowData:u,rowNode:c}),obj.updateTableReferences(),obj.dispatch("ondeleterow",el,e,t,f)}}else console.error("Jspreadsheet: It is not possible to delete the last row")},obj.moveColumn=function(e,t){if(Object.keys(obj.options.mergeCells).length>0){if(e>t)var n=1;else n=0;if(obj.isColMerged(e).length||obj.isColMerged(t,n).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}}if((e=parseInt(e))>(t=parseInt(t))){obj.headerContainer.insertBefore(obj.headers[e],obj.headers[t]),obj.colgroupContainer.insertBefore(obj.colgroup[e],obj.colgroup[t]);for(var r=0;r<obj.rows.length;r++)obj.rows[r].insertBefore(obj.records[r][e],obj.records[r][t])}else for(obj.headerContainer.insertBefore(obj.headers[e],obj.headers[t].nextSibling),obj.colgroupContainer.insertBefore(obj.colgroup[e],obj.colgroup[t].nextSibling),r=0;r<obj.rows.length;r++)obj.rows[r].insertBefore(obj.records[r][e],obj.records[r][t].nextSibling);for(obj.options.columns.splice(t,0,obj.options.columns.splice(e,1)[0]),obj.headers.splice(t,0,obj.headers.splice(e,1)[0]),obj.colgroup.splice(t,0,obj.colgroup.splice(e,1)[0]),r=0;r<obj.rows.length;r++)obj.options.data[r].splice(t,0,obj.options.data[r].splice(e,1)[0]),obj.records[r].splice(t,0,obj.records[r].splice(e,1)[0]);if(obj.options.footers)for(r=0;r<obj.options.footers.length;r++)obj.options.footers[r].splice(t,0,obj.options.footers[r].splice(e,1)[0]);obj.setHistory({action:"moveColumn",oldValue:e,newValue:t}),obj.updateTableReferences(),obj.dispatch("onmovecolumn",el,e,t)},obj.insertColumn=function(e,t,n,r){if(obj.options.allowInsertColumn==1){var s=[];if(e>0)var l=e;else l=1,e&&(s=e);n=!!n;var f=obj.options.columns.length-1;if((t==null||t>=parseInt(f)||t<0)&&(t=f),obj.dispatch("onbeforeinsertcolumn",el,t,l,n)===!1)return!1;if(Object.keys(obj.options.mergeCells).length>0&&obj.isColMerged(t,n).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}r||(r=[]);for(var u=0;u<l;u++)r[u]||(r[u]={type:"text",source:[],options:[],width:obj.options.defaultColWidth,align:obj.options.defaultColAlign});var c=n?t:t+1;obj.options.columns=jexcel.injectArray(obj.options.columns,c,r);for(var g=obj.headers.splice(c),D=obj.colgroup.splice(c),I=[],v=[],p=[],w=[],j=[],b=c;b<l+c;b++)obj.createCellHeader(b),obj.headerContainer.insertBefore(obj.headers[b],obj.headerContainer.children[b+1]),obj.colgroupContainer.insertBefore(obj.colgroup[b],obj.colgroupContainer.children[b+1]),I.push(obj.headers[b]),v.push(obj.colgroup[b]);if(obj.options.footers)for(var M=0;M<obj.options.footers.length;M++){for(j[M]=[],u=0;u<l;u++)j[M].push("");obj.options.footers[M].splice(c,0,j[M])}for(var A=0;A<obj.options.data.length;A++){var O=obj.options.data[A].splice(c),F=obj.records[A].splice(c);for(w[A]=[],p[A]=[],b=c;b<l+c;b++){var V=s[A]?s[A]:"";obj.options.data[A][b]=V;var _=obj.createCell(b,A,obj.options.data[A][b]);obj.records[A][b]=_,obj.rows[A]&&obj.rows[A].insertBefore(_,obj.rows[A].children[b+1]),w[A].push(V),p[A].push(_)}Array.prototype.push.apply(obj.options.data[A],O),Array.prototype.push.apply(obj.records[A],F)}if(Array.prototype.push.apply(obj.headers,g),Array.prototype.push.apply(obj.colgroup,D),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(M=0;M<obj.options.nestedHeaders.length;M++){var P=parseInt(obj.options.nestedHeaders[M][obj.options.nestedHeaders[M].length-1].colspan)+l;obj.options.nestedHeaders[M][obj.options.nestedHeaders[M].length-1].colspan=P,obj.thead.children[M].children[obj.thead.children[M].children.length-1].setAttribute("colspan",P);var K=obj.thead.children[M].children[obj.thead.children[M].children.length-1].getAttribute("data-column");for(K=K.split(","),b=c;b<l+c;b++)K.push(b);obj.thead.children[M].children[obj.thead.children[M].children.length-1].setAttribute("data-column",K)}else P=parseInt(obj.options.nestedHeaders[0].colspan)+l,obj.options.nestedHeaders[0].colspan=P,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",P);obj.setHistory({action:"insertColumn",columnNumber:t,numOfColumns:l,insertBefore:n,columns:r,headers:I,colgroup:v,records:p,footers:j,data:w}),obj.updateTableReferences(),obj.dispatch("oninsertcolumn",el,t,l,p,n)}},obj.deleteColumn=function(e,t){if(obj.options.allowDeleteColumn==1)if(obj.headers.length>1){if(e==null){var n=obj.getSelectedColumns(!0);n.length?(e=parseInt(n[0]),t=parseInt(n.length)):(e=obj.headers.length-1,t=1)}var r=obj.options.data[0].length-1;if((e==null||e>r||e<0)&&(e=r),t||(t=1),t>obj.options.data[0].length-e&&(t=obj.options.data[0].length-e),obj.dispatch("onbeforedeletecolumn",el,e,t)===!1)return!1;if(parseInt(e)>-1){var s=!1;if(Object.keys(obj.options.mergeCells).length>0)for(var l=e;l<e+t;l++)obj.isColMerged(l,!1).length&&(s=!0);if(s){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}var f=obj.options.columns.splice(e,t);for(l=e;l<e+t;l++)obj.colgroup[l].className="",obj.headers[l].className="",obj.colgroup[l].parentNode.removeChild(obj.colgroup[l]),obj.headers[l].parentNode.removeChild(obj.headers[l]);for(var u=obj.headers.splice(e,t),c=obj.colgroup.splice(e,t),g=[],D=[],I=[],v=0;v<obj.options.data.length;v++)for(l=e;l<e+t;l++)obj.records[v][l].className="",obj.records[v][l].parentNode.removeChild(obj.records[v][l]);for(v=0;v<obj.options.data.length;v++)D[v]=obj.options.data[v].splice(e,t),g[v]=obj.records[v].splice(e,t);if(obj.options.footers)for(v=0;v<obj.options.footers.length;v++)I[v]=obj.options.footers[v].splice(e,t);if(obj.conditionalSelectionUpdate(0,e,e+t-1),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(var p=0;p<obj.options.nestedHeaders.length;p++){var w=parseInt(obj.options.nestedHeaders[p][obj.options.nestedHeaders[p].length-1].colspan)-t;obj.options.nestedHeaders[p][obj.options.nestedHeaders[p].length-1].colspan=w,obj.thead.children[p].children[obj.thead.children[p].children.length-1].setAttribute("colspan",w)}else w=parseInt(obj.options.nestedHeaders[0].colspan)-t,obj.options.nestedHeaders[0].colspan=w,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",w);obj.setHistory({action:"deleteColumn",columnNumber:e,numOfColumns:t,insertBefore:1,columns:f,headers:u,colgroup:c,records:g,footers:I,data:D}),obj.updateTableReferences(),obj.dispatch("ondeletecolumn",el,e,t,g)}}else console.error("Jspreadsheet: It is not possible to delete the last column")},obj.getSelectedRows=function(e){for(var t=[],n=0;n<obj.rows.length;n++)obj.rows[n].classList.contains("selected")&&(e?t.push(n):t.push(obj.rows[n]));return t},obj.getSelectedColumns=function(){for(var e=[],t=0;t<obj.headers.length;t++)obj.headers[t].classList.contains("selected")&&e.push(t);return e},obj.getHighlighted=function(){return obj.highlighted},obj.updateTableReferences=function(){for(var e=0;e<obj.headers.length;e++)(l=obj.headers[e].getAttribute("data-x"))!=e&&(obj.headers[e].setAttribute("data-x",e),obj.headers[e].getAttribute("title")||(obj.headers[e].innerHTML=jexcel.getColumnName(e)));for(var t=0;t<obj.rows.length;t++)obj.rows[t]&&(f=obj.rows[t].getAttribute("data-y"))!=t&&(obj.rows[t].setAttribute("data-y",t),obj.rows[t].children[0].setAttribute("data-y",t),obj.rows[t].children[0].innerHTML=t+1);var n=[],r=[],s=function(p,w,j,b){if(p!=j&&obj.records[b][j].setAttribute("data-x",j),w!=b&&obj.records[b][j].setAttribute("data-y",b),p!=j||w!=b){var M=jexcel.getColumnNameFromId([p,w]),A=jexcel.getColumnNameFromId([j,b]);n[M]=A}};for(t=0;t<obj.records.length;t++)for(e=0;e<obj.records[0].length;e++)if(obj.records[t][e]){var l=obj.records[t][e].getAttribute("data-x"),f=obj.records[t][e].getAttribute("data-y");if(obj.records[t][e].getAttribute("data-merged")){var u=jexcel.getColumnNameFromId([l,f]),c=jexcel.getColumnNameFromId([e,t]);if(r[u]==null)if(u==c)r[u]=!1;else{var g=parseInt(e-l),D=parseInt(t-f);r[u]=[c,g,D]}}else s(l,f,e,t)}var I=Object.keys(r);if(I.length){for(e=0;e<I.length;e++)if(r[I[e]]){var v=jexcel.getIdFromColumnName(I[e],!0);for(s(l=v[0],f=v[1],l+r[I[e]][1],f+r[I[e]][2]),u=I[e],c=r[I[e]][0],t=0;t<obj.options.mergeCells[u][2].length;t++)l=parseInt(obj.options.mergeCells[u][2][t].getAttribute("data-x")),f=parseInt(obj.options.mergeCells[u][2][t].getAttribute("data-y")),obj.options.mergeCells[u][2][t].setAttribute("data-x",l+r[I[e]][1]),obj.options.mergeCells[u][2][t].setAttribute("data-y",f+r[I[e]][2]);obj.options.mergeCells[c]=obj.options.mergeCells[u],delete obj.options.mergeCells[u]}}obj.updateFormulas(n),obj.updateMeta(n),obj.refreshSelection(),obj.updateTable()},obj.updateTable=function(){if(obj.options.minSpareRows>0){for(var e=0,t=obj.rows.length-1;t>=0;t--){for(var n=!1,r=0;r<obj.headers.length;r++)obj.options.data[t][r]&&(n=!0);if(n)break;e++}obj.options.minSpareRows-e>0&&obj.insertRow(obj.options.minSpareRows-e)}if(obj.options.minSpareCols>0){var s=0;for(r=obj.headers.length-1;r>=0;r--){for(n=!1,t=0;t<obj.rows.length;t++)obj.options.data[t][r]&&(n=!0);if(n)break;s++}obj.options.minSpareCols-s>0&&obj.insertColumn(obj.options.minSpareCols-s)}if(typeof obj.options.updateTable=="function"){for(obj.options.detachForUpdates&&el.removeChild(obj.content),t=0;t<obj.rows.length;t++)for(r=0;r<obj.headers.length;r++)obj.options.updateTable(el,obj.records[t][r],r,t,obj.options.data[t][r],obj.records[t][r].textContent,jexcel.getColumnNameFromId([r,t]));obj.options.detachForUpdates&&el.insertBefore(obj.content,obj.pagination)}obj.options.footers&&obj.setFooter(),setTimeout(function(){obj.updateCornerPosition()},0)},obj.isReadOnly=function(e){if(e=obj.getCell(e))return!!e.classList.contains("readonly")},obj.setReadOnly=function(e,t){(e=obj.getCell(e))&&(t?e.classList.add("readonly"):e.classList.remove("readonly"))},obj.showRow=function(e){obj.rows[e].style.display=""},obj.hideRow=function(e){obj.rows[e].style.display="none"},obj.showColumn=function(e){obj.headers[e].style.display="",obj.colgroup[e].style.display="",obj.filter&&obj.filter.children.length>e+1&&(obj.filter.children[e+1].style.display="");for(var t=0;t<obj.options.data.length;t++)obj.records[t][e].style.display="";obj.options.footers&&obj.setFooter(),obj.resetSelection()},obj.hideColumn=function(e){obj.headers[e].style.display="none",obj.colgroup[e].style.display="none",obj.filter&&obj.filter.children.length>e+1&&(obj.filter.children[e+1].style.display="none");for(var t=0;t<obj.options.data.length;t++)obj.records[t][e].style.display="none";obj.options.footers&&obj.setFooter(),obj.resetSelection()},obj.showIndex=function(){obj.table.classList.remove("jexcel_hidden_index")},obj.hideIndex=function(){obj.table.classList.add("jexcel_hidden_index")};var chainLoopProtection=[];obj.updateFormulaChain=function(e,t,n){var r=jexcel.getColumnNameFromId([e,t]);if(obj.formula[r]&&obj.formula[r].length>0)if(chainLoopProtection[r])obj.records[t][e].innerHTML="#ERROR",obj.formula[r]="";else{chainLoopProtection[r]=!0;for(var s=0;s<obj.formula[r].length;s++){var l=jexcel.getIdFromColumnName(obj.formula[r][s],!0),f=""+obj.options.data[l[1]][l[0]];f.substr(0,1)=="="?n.push(obj.updateCell(l[0],l[1],f,!0)):Object.keys(obj.formula)[s]=null,obj.updateFormulaChain(l[0],l[1],n)}}chainLoopProtection=[]},obj.updateFormulas=function(e){for(var t=0;t<obj.options.data.length;t++)for(var n=0;n<obj.options.data[0].length;n++)if((u=""+obj.options.data[t][n]).substr(0,1)=="="){var r=obj.updateFormula(u,e);r!=u&&(obj.options.data[t][n]=r)}var s=[],l=Object.keys(obj.formula);for(t=0;t<l.length;t++){var f=l[t],u=obj.formula[f];for(e[f]&&(f=e[f]),s[f]=[],n=0;n<u.length;n++){var c=u[n];e[c]&&(c=e[c]),s[f].push(c)}}obj.formula=s},obj.updateFormula=function(e,t){for(var n=/[A-Z]/,r=/[0-9]/,s="",l=null,f=null,u="",c=0;c<e.length;c++)n.exec(e[c])?(l=1,f=0,u+=e[c]):r.exec(e[c])?(f=l?1:0,u+=e[c]):(l&&f&&(u=t[u]?t[u]:u),s+=u,s+=e[c],l=0,f=0,u="");return u&&(l&&f&&(u=t[u]?t[u]:u),s+=u),s};var secureFormula=function(e){for(var t="",n=0,r=0;r<e.length;r++)e[r]=='"'&&(n=n==0?1:0),t+=n==1?e[r]:e[r].toUpperCase();return t};obj.executeFormula=function(expression,x,y){var formulaResults=[],formulaLoopProtection=[],execute=function(expression,x,y){var parentId=jexcel.getColumnNameFromId([x,y]);if(formulaLoopProtection[parentId])return console.error("Reference loop detected"),"#ERROR";formulaLoopProtection[parentId]=!0;var tokensUpdate=function(e){for(var t=0;t<e.length;t++){var n=[],r=e[t].split(":"),s=jexcel.getIdFromColumnName(r[0],!0),l=jexcel.getIdFromColumnName(r[1],!0);if(s[0]<=l[0])var f=s[0],u=l[0];else f=l[0],u=s[0];if(s[1]<=l[1])var c=s[1],g=l[1];else c=l[1],g=s[1];for(var D=c;D<=g;D++)for(var I=f;I<=u;I++)n.push(jexcel.getColumnNameFromId([I,D]));expression=expression.replace(e[t],n.join(","))}};expression=expression.replace(/\$?([A-Z]+)\$?([0-9]+)/g,"$1$2");var tokens=expression.match(/([A-Z]+[0-9]+)\:([A-Z]+[0-9]+)/g);tokens&&tokens.length&&tokensUpdate(tokens);var tokens=expression.match(/([A-Z]+[0-9]+)/g);if(tokens&&tokens.indexOf(parentId)>-1)return console.error("Self Reference detected"),"#ERROR";var formulaExpressions={};if(tokens){for(var i=0;i<tokens.length;i++)if(obj.formula[tokens[i]]||(obj.formula[tokens[i]]=[]),obj.formula[tokens[i]].indexOf(parentId)<0&&obj.formula[tokens[i]].push(parentId),eval("typeof("+tokens[i]+') == "undefined"')){var position=jexcel.getIdFromColumnName(tokens[i],1);if(obj.options.data[position[1]]!==void 0&&obj.options.data[position[1]][position[0]]!==void 0)var value=obj.options.data[position[1]][position[0]];else var value="";if((""+value).substr(0,1)=="="&&(formulaResults[tokens[i]]!==void 0?value=formulaResults[tokens[i]]:(value=execute(value,position[0],position[1]),formulaResults[tokens[i]]=value)),(""+value).trim()=="")formulaExpressions[tokens[i]]=null;else if(value==Number(value)&&obj.options.autoCasting==1)formulaExpressions[tokens[i]]=Number(value);else{var number=obj.parseNumber(value,position[0]);obj.options.autoCasting==1&&number?formulaExpressions[tokens[i]]=number:formulaExpressions[tokens[i]]='"'+value+'"'}}}try{var res=jexcel.formula(expression.substr(1),formulaExpressions,x,y,obj)}catch(e){var res="#ERROR";console.log(e)}return res};return execute(expression,x,y)},obj.parseNumber=function(e,t){var n=t&&obj.options.columns[t].decimal?obj.options.columns[t].decimal:".",r=""+e;return(r=r.split(n))[0]=r[0].match(/[+-]?[0-9]/g),r[0]&&(r[0]=r[0].join("")),r[1]&&(r[1]=r[1].match(/[0-9]*/g).join("")),r[0]&&Number.isInteger(Number(r[0]))?r[1]?e=+(r[0]+"."+r[1]):e=+(r[0]+".00"):e=null,e},obj.row=function(e){},obj.col=function(e){},obj.up=function(e,t){if(e?obj.selectedCell[3]>0&&obj.up.visible(1,t?0:1):(obj.selectedCell[1]>0&&obj.up.visible(0,t?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.options.lazyLoading==1)if(obj.selectedCell[1]==0||obj.selectedCell[3]==0)obj.loadPage(0),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);else if(obj.loadValidation())obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);else{var n=parseInt(obj.tbody.firstChild.getAttribute("data-y"));obj.selectedCell[1]-n<30&&(obj.loadUp(),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]))}else if(obj.options.pagination>0){var r=obj.whichPage(obj.selectedCell[3]);r!=obj.pageNumber&&obj.page(r)}obj.updateScroll(1)},obj.up.visible=function(e,t){if(e==0)var n=parseInt(obj.selectedCell[0]),r=parseInt(obj.selectedCell[1]);else n=parseInt(obj.selectedCell[2]),r=parseInt(obj.selectedCell[3]);if(t==0){for(var s=0;s<r;s++)if(obj.records[s][n].style.display!="none"&&obj.rows[s].style.display!="none"){r=s;break}}else r=obj.up.get(n,r);e==0?(obj.selectedCell[0]=n,obj.selectedCell[1]=r):(obj.selectedCell[2]=n,obj.selectedCell[3]=r)},obj.up.get=function(e,t){e=parseInt(e);for(var n=(t=parseInt(t))-1;n>=0;n--)if(obj.records[n][e].style.display!="none"&&obj.rows[n].style.display!="none"){if(obj.records[n][e].getAttribute("data-merged")&&obj.records[n][e]==obj.records[t][e])continue;t=n;break}return t},obj.down=function(e,t){if(e?obj.selectedCell[3]<obj.records.length-1&&obj.down.visible(1,t?0:1):(obj.selectedCell[1]<obj.records.length-1&&obj.down.visible(0,t?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.options.lazyLoading==1)obj.selectedCell[1]==obj.records.length-1||obj.selectedCell[3]==obj.records.length-1?(obj.loadPage(-1),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])):obj.loadValidation()?obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]):parseInt(obj.tbody.lastChild.getAttribute("data-y"))-obj.selectedCell[3]<30&&(obj.loadDown(),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]));else if(obj.options.pagination>0){var n=obj.whichPage(obj.selectedCell[3]);n!=obj.pageNumber&&obj.page(n)}obj.updateScroll(3)},obj.down.visible=function(e,t){if(e==0)var n=parseInt(obj.selectedCell[0]),r=parseInt(obj.selectedCell[1]);else n=parseInt(obj.selectedCell[2]),r=parseInt(obj.selectedCell[3]);if(t==0){for(var s=obj.rows.length-1;s>r;s--)if(obj.records[s][n].style.display!="none"&&obj.rows[s].style.display!="none"){r=s;break}}else r=obj.down.get(n,r);e==0?(obj.selectedCell[0]=n,obj.selectedCell[1]=r):(obj.selectedCell[2]=n,obj.selectedCell[3]=r)},obj.down.get=function(e,t){e=parseInt(e);for(var n=(t=parseInt(t))+1;n<obj.rows.length;n++)if(obj.records[n][e].style.display!="none"&&obj.rows[n].style.display!="none"){if(obj.records[n][e].getAttribute("data-merged")&&obj.records[n][e]==obj.records[t][e])continue;t=n;break}return t},obj.right=function(e,t){e?obj.selectedCell[2]<obj.headers.length-1&&obj.right.visible(1,t?0:1):(obj.selectedCell[0]<obj.headers.length-1&&obj.right.visible(0,t?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(2)},obj.right.visible=function(e,t){if(e==0)var n=parseInt(obj.selectedCell[0]),r=parseInt(obj.selectedCell[1]);else n=parseInt(obj.selectedCell[2]),r=parseInt(obj.selectedCell[3]);if(t==0){for(var s=obj.headers.length-1;s>n;s--)if(obj.records[r][s].style.display!="none"){n=s;break}}else n=obj.right.get(n,r);e==0?(obj.selectedCell[0]=n,obj.selectedCell[1]=r):(obj.selectedCell[2]=n,obj.selectedCell[3]=r)},obj.right.get=function(e,t){e=parseInt(e),t=parseInt(t);for(var n=e+1;n<obj.headers.length;n++)if(obj.records[t][n].style.display!="none"){if(obj.records[t][n].getAttribute("data-merged")&&obj.records[t][n]==obj.records[t][e])continue;e=n;break}return e},obj.left=function(e,t){e?obj.selectedCell[2]>0&&obj.left.visible(1,t?0:1):(obj.selectedCell[0]>0&&obj.left.visible(0,t?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(0)},obj.left.visible=function(e,t){if(e==0)var n=parseInt(obj.selectedCell[0]),r=parseInt(obj.selectedCell[1]);else n=parseInt(obj.selectedCell[2]),r=parseInt(obj.selectedCell[3]);if(t==0){for(var s=0;s<n;s++)if(obj.records[r][s].style.display!="none"){n=s;break}}else n=obj.left.get(n,r);e==0?(obj.selectedCell[0]=n,obj.selectedCell[1]=r):(obj.selectedCell[2]=n,obj.selectedCell[3]=r)},obj.left.get=function(e,t){e=parseInt(e),t=parseInt(t);for(var n=e-1;n>=0;n--)if(obj.records[t][n].style.display!="none"){if(obj.records[t][n].getAttribute("data-merged")&&obj.records[t][n]==obj.records[t][e])continue;e=n;break}return e},obj.first=function(e,t){if(e?t?obj.selectedCell[3]=0:obj.left.visible(1,0):(t?obj.selectedCell[1]=0:obj.left.visible(0,0),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.options.lazyLoading!=1||obj.selectedCell[1]!=0&&obj.selectedCell[3]!=0){if(obj.options.pagination>0){var n=obj.whichPage(obj.selectedCell[3]);n!=obj.pageNumber&&obj.page(n)}}else obj.loadPage(0);obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(1)},obj.last=function(e,t){if(e?t?obj.selectedCell[3]=obj.records.length-1:obj.right.visible(1,0):(t?obj.selectedCell[1]=obj.records.length-1:obj.right.visible(0,0),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.options.lazyLoading!=1||obj.selectedCell[1]!=obj.records.length-1&&obj.selectedCell[3]!=obj.records.length-1){if(obj.options.pagination>0){var n=obj.whichPage(obj.selectedCell[3]);n!=obj.pageNumber&&obj.page(n)}}else obj.loadPage(-1);obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(3)},obj.selectAll=function(){obj.selectedCell||(obj.selectedCell=[]),obj.selectedCell[0]=0,obj.selectedCell[1]=0,obj.selectedCell[2]=obj.headers.length-1,obj.selectedCell[3]=obj.records.length-1,obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])},obj.loadPage=function(e){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)t=obj.rows;else var t=obj.results;var n=100;e!=null&&e!=-1||(e=Math.ceil(t.length/n)-1);var r=e*n,s=e*n+n;s>t.length&&(s=t.length),(r=s-100)<0&&(r=0);for(var l=r;l<s;l++)obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.appendChild(obj.rows[l]):obj.tbody.appendChild(obj.rows[t[l]]),obj.tbody.children.length>n&&obj.tbody.removeChild(obj.tbody.firstChild)},obj.loadUp=function(){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)e=obj.rows;else var e=obj.results;var t=0;if(e.length>100){var n=parseInt(obj.tbody.firstChild.getAttribute("data-y"));if(obj.options.search!=1&&obj.options.filters!=1||!obj.results||(n=e.indexOf(n)),n>0)for(var r=0;r<30;r++)(n-=1)>-1&&(obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.insertBefore(obj.rows[n],obj.tbody.firstChild):obj.tbody.insertBefore(obj.rows[e[n]],obj.tbody.firstChild),obj.tbody.children.length>100&&(obj.tbody.removeChild(obj.tbody.lastChild),t=1))}return t},obj.loadDown=function(){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)e=obj.rows;else var e=obj.results;var t=0;if(e.length>100){var n=parseInt(obj.tbody.lastChild.getAttribute("data-y"));if(obj.options.search!=1&&obj.options.filters!=1||!obj.results||(n=e.indexOf(n)),n<obj.rows.length-1)for(var r=0;r<=30;r++)n<e.length&&(obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.appendChild(obj.rows[n]):obj.tbody.appendChild(obj.rows[e[n]]),obj.tbody.children.length>100&&(obj.tbody.removeChild(obj.tbody.firstChild),t=1)),n+=1}return t},obj.loadValidation=function(){if(obj.selectedCell){var e=parseInt(obj.tbody.firstChild.getAttribute("data-y"))/100,t=parseInt(obj.selectedCell[3]/100),n=parseInt(obj.rows.length/100);if(e!=t&&t<=n&&!Array.prototype.indexOf.call(obj.tbody.children,obj.rows[obj.selectedCell[3]]))return obj.loadPage(t),!0}return!1},obj.resetSearch=function(){obj.searchInput.value="",obj.search(""),obj.results=null},obj.search=function(e){if(obj.options.filters&&obj.resetFilters(),obj.resetSelection(),obj.pageNumber=0,obj.results=[],e){var t=function(r){obj.results.indexOf(r)==-1&&obj.results.push(r)},n=e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");n=new RegExp(n,"i"),obj.options.data.forEach(function(r,s){if(function(g,D,I){for(var v=0;v<g.length;v++)if((""+g[v]).toLowerCase().search(D)>=0||(""+obj.records[I][v].innerHTML).toLowerCase().search(D)>=0)return!0;return!1}(r,n,s)){var l=obj.isRowMerged(s);if(l.length)for(var f=0;f<l.length;f++)for(var u=jexcel.getIdFromColumnName(l[f],!0),c=0;c<obj.options.mergeCells[l[f]][1];c++)t(u[1]+c);else t(s)}})}else obj.results=null;return obj.updateResult()},obj.updateResult=function(){var e,t=0;for(e=obj.options.lazyLoading==1?100:obj.options.pagination>0?obj.options.pagination:obj.results?obj.results.length:obj.rows.length;obj.tbody.firstChild;)obj.tbody.removeChild(obj.tbody.firstChild);for(var n=0;n<obj.rows.length;n++)!obj.results||obj.results.indexOf(n)>-1?(t<e&&(obj.tbody.appendChild(obj.rows[n]),t++),obj.rows[n].style.display=""):obj.rows[n].style.display="none";return obj.options.pagination>0&&obj.updatePagination(),obj.updateCornerPosition(),e},obj.whichPage=function(e){return obj.options.search!=1&&obj.options.filters!=1||!obj.results||(e=obj.results.indexOf(e)),Math.ceil((parseInt(e)+1)/parseInt(obj.options.pagination))-1},obj.page=function(e){var t=obj.pageNumber;if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)n=obj.rows;else var n=obj.results;var r=parseInt(obj.options.pagination);e!=null&&e!=-1||(e=Math.ceil(n.length/r)-1),obj.pageNumber=e;var s=e*r,l=e*r+r;for(l>n.length&&(l=n.length),s<0&&(s=0);obj.tbody.firstChild;)obj.tbody.removeChild(obj.tbody.firstChild);for(var f=s;f<l;f++)obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.appendChild(obj.rows[f]):obj.tbody.appendChild(obj.rows[n[f]]);obj.options.pagination>0&&obj.updatePagination(),obj.updateCornerPosition(),obj.dispatch("onchangepage",el,e,t)},obj.updatePagination=function(){if(obj.pagination.children[0].innerHTML="",obj.pagination.children[1].innerHTML="",obj.options.pagination){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)e=obj.rows.length;else var e=obj.results.length;if(e){var t=Math.ceil(e/obj.options.pagination);if(obj.pageNumber<6)var n=1,r=t<10?t:10;else t-obj.pageNumber<5?(r=t,(n=t-9)<1&&(n=1)):(n=obj.pageNumber-4,r=obj.pageNumber+5);n>1&&((l=document.createElement("div")).className="jexcel_page",l.innerHTML="<",l.title=1,obj.pagination.children[1].appendChild(l));for(var s=n;s<=r;s++){var l;(l=document.createElement("div")).className="jexcel_page",l.innerHTML=s,obj.pagination.children[1].appendChild(l),obj.pageNumber==s-1&&l.classList.add("jexcel_page_selected")}r<t&&((l=document.createElement("div")).className="jexcel_page",l.innerHTML=">",l.title=t,obj.pagination.children[1].appendChild(l)),obj.pagination.children[0].innerHTML=function(f){var u=Array.prototype.slice.call(arguments,1);return f.replace(/{(\d+)}/g,function(c,g){return u[g]!==void 0?u[g]:c})}(obj.options.text.showingPage,obj.pageNumber+1,t)}else obj.pagination.children[0].innerHTML=obj.options.text.noRecordsFound}},obj.download=function(e){if(obj.options.allowExport==0)console.error("Export not allowed");else{var t="";t+=obj.copy(!1,obj.options.csvDelimiter,!0,e,!0);var n=new Blob(["\uFEFF"+t],{type:"text/csv;charset=utf-8;"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(n,obj.options.csvFileName+".csv");else{var r=document.createElement("a"),s=URL.createObjectURL(n);r.href=s,r.setAttribute("download",obj.options.csvFileName+".csv"),document.body.appendChild(r),r.click(),r.parentNode.removeChild(r)}}},obj.setHistory=function(e){if(obj.ignoreHistory!=1){var t=++obj.historyIndex;obj.history=obj.history=obj.history.slice(0,t+1),obj.history[t]=e}},obj.copy=function(e,t,n,r,s){t||(t="	");for(var l=new RegExp(t,"ig"),f=[],u=[],c=[],g=[],D=[],I=obj.options.data[0].length,v=obj.options.data.length,p="",w=!1,j="",b="",M=0,A=0,O=0,F=0,V=!0,_=0;_<v;_++)for(var P=0;P<I;P++)e&&!obj.records[_][P].classList.contains("highlight")||(O<=P&&(O=P),F<=_&&(F=_));if(I===O+1&&v===F+1&&(V=!1),s&&obj.options.includeHeadersOnDownload==1||!s&&obj.options.includeHeadersOnCopy==1&&!V||r){if(obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)for(p=obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0]?obj.options.nestedHeaders:[obj.options.nestedHeaders],_=0;_<p.length;_++){var K=[];for(P=0;P<p[_].length;P++){var W=parseInt(p[_][P].colspan);K.push(p[_][P].title);for(var se=0;se<W-1;se++)K.push("")}b+=K.join(t)+`\r
`}w=!0}for(obj.style=[],_=0;_<v;_++){for(u=[],c=[],P=0;P<I;P++)if(!e||obj.records[_][P].classList.contains("highlight")){w==1&&f.push(obj.headers[P].textContent);var he=obj.options.data[_][P];if(he.match&&(he.match(l)||he.match(/,/g)||he.match(/\n/)||he.match(/\"/))&&(he='"'+(he=he.replace(new RegExp('"',"g"),'""'))+'"'),u.push(he),obj.options.columns[P].type=="checkbox"||obj.options.columns[P].type=="radio")var ae=he;else(ae=obj.options.stripHTMLOnCopy==1?obj.records[_][P].textContent:obj.records[_][P].innerHTML).match&&(ae.match(l)||ae.match(/,/g)||ae.match(/\n/)||ae.match(/\"/))&&(ae='"'+(ae=ae.replace(new RegExp('"',"g"),'""'))+'"');c.push(ae),p=(p=obj.records[_][P].getAttribute("style")).replace("display: none;",""),obj.style.push(p||"")}u.length&&(w&&(M=u.length,g.push(f.join(t))),g.push(u.join(t))),c.length&&(A++,w&&(D.push(f.join(t)),w=!1),D.push(c.join(t)))}I==M&&v==A&&(j=b);var we=j+g.join(`\r
`),Me=j+D.join(`\r
`);if(n||(obj.options.copyCompatibility==1?obj.textarea.value=Me:obj.textarea.value=we,obj.textarea.select(),document.execCommand("copy")),obj.options.copyCompatibility==1?obj.data=Me:obj.data=we,obj.hashString=obj.hash(obj.data),!n){if(obj.removeCopyingSelection(),obj.highlighted)for(P=0;P<obj.highlighted.length;P++)obj.highlighted[P].classList.add("copying"),obj.highlighted[P].classList.contains("highlight-left")&&obj.highlighted[P].classList.add("copying-left"),obj.highlighted[P].classList.contains("highlight-right")&&obj.highlighted[P].classList.add("copying-right"),obj.highlighted[P].classList.contains("highlight-top")&&obj.highlighted[P].classList.add("copying-top"),obj.highlighted[P].classList.contains("highlight-bottom")&&obj.highlighted[P].classList.add("copying-bottom");obj.dispatch("oncopy",el,obj.options.copyCompatibility==1?D:g,obj.hashString)}return obj.data},obj.paste=function(e,t,n){var r=parseInt(e),s=parseInt(t),l=parseInt(obj.selectedCell[2]),f=parseInt(obj.selectedCell[3]),u=l-r+1,c=f-s+1;l<r&&(e=l.toString(),u=r-l+1),f<s&&(t=f.toString(),c=s-f+1);var g=obj.dispatch("onbeforepaste",el,n,e,t);if(g===!1)return!1;g&&(n=g);var D=obj.hash(n),I=D==obj.hashString?obj.style:null;if(obj.options.copyCompatibility==1&&D==obj.hashString&&(n=obj.data),n=obj.parseCSV(n,"	"),u>1&Number.isInteger(u/n[0].length)){I=null,p=u/n[0].length;var v=n.map(function(W,se){var he=Array.apply(null,{length:p*W.length}).map(function(ae,we){return W[we%W.length]});return he});n=v}if(c>1&Number.isInteger(c/n.length)){I=null;var p=c/n.length;v=Array.apply(null,{length:p*n.length}).map(function(W,se){return n[se%n.length]}),n=v}if(e!=null&&t!=null&&n){for(var w=0,j=0,b=[],M={},A={},O=0,F=parseInt(e),V=parseInt(t),_=null;_=n[j];){for(w=0,F=parseInt(e);_[w]!=null;){var P=obj.updateCell(F,V,_[w]);if(b.push(P),obj.updateFormulaChain(F,V,b),I&&I[O]){var K=jexcel.getColumnNameFromId([F,V]);M[K]=I[O],A[K]=obj.getStyle(K),obj.records[V][F].setAttribute("style",I[O]),O++}if(_[++w]!=null){if(F>=obj.headers.length-1){if(obj.options.allowInsertColumn!=1)break;obj.insertColumn()}F=obj.right.get(F,V)}}if(j++,n[j]){if(V>=obj.rows.length-1){if(obj.options.allowInsertRow!=1)break;obj.insertRow()}V=obj.down.get(e,V)}}obj.updateSelectionFromCoords(e,t,F,V),obj.setHistory({action:"setValue",records:b,selection:obj.selectedCell,newStyle:M,oldStyle:A}),obj.updateTable(),obj.dispatch("onpaste",el,n),obj.onafterchanges(el,b)}obj.removeCopyingSelection()},obj.removeCopyingSelection=function(){for(var e=document.querySelectorAll(".jexcel .copying"),t=0;t<e.length;t++)e[t].classList.remove("copying"),e[t].classList.remove("copying-left"),e[t].classList.remove("copying-right"),e[t].classList.remove("copying-top"),e[t].classList.remove("copying-bottom")},obj.historyProcessRow=function(e,t){var n=t.insertBefore?+t.rowNumber:t.rowNumber+1;if(obj.options.search==1&&obj.results&&obj.results.length!=obj.rows.length&&obj.resetSearch(),e==1){for(var r=t.numOfRows,s=n;s<r+n;s++)obj.rows[s].parentNode.removeChild(obj.rows[s]);obj.records.splice(n,r),obj.options.data.splice(n,r),obj.rows.splice(n,r),obj.conditionalSelectionUpdate(1,n,r+n-1)}else{obj.records=jexcel.injectArray(obj.records,n,t.rowRecords),obj.options.data=jexcel.injectArray(obj.options.data,n,t.rowData),obj.rows=jexcel.injectArray(obj.rows,n,t.rowNode);var l=0;for(s=n;s<t.numOfRows+n;s++)obj.tbody.insertBefore(t.rowNode[l],obj.tbody.children[s]),l++}obj.options.pagination>0&&obj.page(obj.pageNumber),obj.updateTableReferences()},obj.historyProcessColumn=function(e,t){var n=t.insertBefore?t.columnNumber:t.columnNumber+1;if(e==1){var r=t.numOfColumns;obj.options.columns.splice(n,r);for(var s=n;s<r+n;s++)obj.headers[s].parentNode.removeChild(obj.headers[s]),obj.colgroup[s].parentNode.removeChild(obj.colgroup[s]);obj.headers.splice(n,r),obj.colgroup.splice(n,r);for(var l=0;l<t.data.length;l++){for(s=n;s<r+n;s++)obj.records[l][s].parentNode.removeChild(obj.records[l][s]);obj.records[l].splice(n,r),obj.options.data[l].splice(n,r)}if(obj.options.footers)for(l=0;l<obj.options.footers.length;l++)obj.options.footers[l].splice(n,r)}else{obj.options.columns=jexcel.injectArray(obj.options.columns,n,t.columns),obj.headers=jexcel.injectArray(obj.headers,n,t.headers),obj.colgroup=jexcel.injectArray(obj.colgroup,n,t.colgroup);var f=0;for(s=n;s<t.numOfColumns+n;s++)obj.headerContainer.insertBefore(t.headers[f],obj.headerContainer.children[s+1]),obj.colgroupContainer.insertBefore(t.colgroup[f],obj.colgroupContainer.children[s+1]),f++;for(l=0;l<t.data.length;l++)for(obj.options.data[l]=jexcel.injectArray(obj.options.data[l],n,t.data[l]),obj.records[l]=jexcel.injectArray(obj.records[l],n,t.records[l]),f=0,s=n;s<t.numOfColumns+n;s++)obj.rows[l].insertBefore(t.records[l][f],obj.rows[l].children[s+1]),f++;if(obj.options.footers)for(l=0;l<obj.options.footers.length;l++)obj.options.footers[l]=jexcel.injectArray(obj.options.footers[l],n,t.footers[l])}if(obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(l=0;l<obj.options.nestedHeaders.length;l++){if(e==1)var u=parseInt(obj.options.nestedHeaders[l][obj.options.nestedHeaders[l].length-1].colspan)-t.numOfColumns;else u=parseInt(obj.options.nestedHeaders[l][obj.options.nestedHeaders[l].length-1].colspan)+t.numOfColumns;obj.options.nestedHeaders[l][obj.options.nestedHeaders[l].length-1].colspan=u,obj.thead.children[l].children[obj.thead.children[l].children.length-1].setAttribute("colspan",u)}else u=e==1?parseInt(obj.options.nestedHeaders[0].colspan)-t.numOfColumns:parseInt(obj.options.nestedHeaders[0].colspan)+t.numOfColumns,obj.options.nestedHeaders[0].colspan=u,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",u);obj.updateTableReferences()},obj.undo=function(){var e=!!obj.ignoreEvents,t=!!obj.ignoreHistory;obj.ignoreEvents=!0,obj.ignoreHistory=!0;var n=[];if(obj.historyIndex>=0){var r=obj.history[obj.historyIndex--];if(r.action=="insertRow")obj.historyProcessRow(1,r);else if(r.action=="deleteRow")obj.historyProcessRow(0,r);else if(r.action=="insertColumn")obj.historyProcessColumn(1,r);else if(r.action=="deleteColumn")obj.historyProcessColumn(0,r);else if(r.action=="moveRow")obj.moveRow(r.newValue,r.oldValue);else if(r.action=="moveColumn")obj.moveColumn(r.newValue,r.oldValue);else if(r.action=="setMerge")obj.removeMerge(r.column,r.data);else if(r.action=="setStyle")obj.setStyle(r.oldValue,null,null,1);else if(r.action=="setWidth")obj.setWidth(r.column,r.oldValue);else if(r.action=="setHeight")obj.setHeight(r.row,r.oldValue);else if(r.action=="setHeader")obj.setHeader(r.column,r.oldValue);else if(r.action=="setComments")obj.setComments(r.column,r.oldValue[0],r.oldValue[1]);else if(r.action=="orderBy"){for(var s=[],l=0;l<r.rows.length;l++)s[r.rows[l]]=l;obj.updateOrderArrow(r.column,r.order?0:1),obj.updateOrder(s)}else if(r.action=="setValue"){for(var f=0;f<r.records.length;f++)n.push({x:r.records[f].x,y:r.records[f].y,newValue:r.records[f].oldValue}),r.oldStyle&&obj.resetStyle(r.oldStyle);obj.setValue(n),r.selection&&obj.updateSelectionFromCoords(r.selection[0],r.selection[1],r.selection[2],r.selection[3])}}obj.ignoreEvents=e,obj.ignoreHistory=t,obj.dispatch("onundo",el,r)},obj.redo=function(){var e=!!obj.ignoreEvents,t=!!obj.ignoreHistory;if(obj.ignoreEvents=!0,obj.ignoreHistory=!0,obj.historyIndex<obj.history.length-1){var n=obj.history[++obj.historyIndex];if(n.action=="insertRow")obj.historyProcessRow(0,n);else if(n.action=="deleteRow")obj.historyProcessRow(1,n);else if(n.action=="insertColumn")obj.historyProcessColumn(0,n);else if(n.action=="deleteColumn")obj.historyProcessColumn(1,n);else if(n.action=="moveRow")obj.moveRow(n.oldValue,n.newValue);else if(n.action=="moveColumn")obj.moveColumn(n.oldValue,n.newValue);else if(n.action=="setMerge")obj.setMerge(n.column,n.colspan,n.rowspan,1);else if(n.action=="setStyle")obj.setStyle(n.newValue,null,null,1);else if(n.action=="setWidth")obj.setWidth(n.column,n.newValue);else if(n.action=="setHeight")obj.setHeight(n.row,n.newValue);else if(n.action=="setHeader")obj.setHeader(n.column,n.newValue);else if(n.action=="setComments")obj.setComments(n.column,n.newValue[0],n.newValue[1]);else if(n.action=="orderBy")obj.updateOrderArrow(n.column,n.order),obj.updateOrder(n.rows);else if(n.action=="setValue"){obj.setValue(n.records);for(var r=0;r<n.records.length;r++)n.oldStyle&&obj.resetStyle(n.newStyle);n.selection&&obj.updateSelectionFromCoords(n.selection[0],n.selection[1],n.selection[2],n.selection[3])}}obj.ignoreEvents=e,obj.ignoreHistory=t,obj.dispatch("onredo",el,n)},obj.getDropDownValue=function(e,t){var n=[];if(obj.options.columns[e]&&obj.options.columns[e].source){for(var r=[],s=obj.options.columns[e].source,l=0;l<s.length;l++)typeof s[l]=="object"?r[s[l].id]=s[l].name:r[s[l]]=s[l];var f=Array.isArray(t)?t:(""+t).split(";");for(l=0;l<f.length;l++)typeof f[l]=="object"?n.push(r[f[l].id]):r[f[l]]&&n.push(r[f[l]])}else console.error("Invalid column");return n.length>0?n.join("; "):""},obj.parseCSV=function(e,t){(e=e.replace(/\r?\n$|\r$|\n$/g,"")).charCodeAt(e.length-1)==9&&(e+="\0"),t=t||",";for(var n=[],r=!1,s=0,l=0,f=0;f<e.length;f++){var u=e[f],c=e[f+1];n[s]=n[s]||[],n[s][l]=n[s][l]||"",u=='"'&&r&&c=='"'?(n[s][l]+=u,++f):u!='"'?u!=t||r?u!="\r"||c!=`
`||r?u==`
`&&!r||u=="\r"&&!r?(++s,l=0):n[s][l]+=u:(++s,l=0,++f):++l:r=!r}return n},obj.hash=function(e){var t,n=0;if(e.length===0)return n;for(t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return n},obj.onafterchanges=function(e,t){obj.dispatch("onafterchanges",e,t)},obj.destroy=function(){jexcel.destroy(el)},obj.init=function(){jexcel.current=obj,typeof jexcel.build=="function"&&(obj.options.root?jexcel.build(obj.options.root):(jexcel.build(document),jexcel.build=null)),el.setAttribute("tabindex",1),el.addEventListener("focus",function(e){jexcel.current&&!obj.selectedCell&&(obj.updateSelectionFromCoords(0,0,0,0),obj.left())}),obj.options.csv?(obj.options.loadingSpin==1&&jSuites.loading.show(),jSuites.ajax({url:obj.options.csv,method:obj.options.method,data:obj.options.requestVariables,dataType:"text",success:function(e){var t=obj.parseCSV(e,obj.options.csvDelimiter);if(obj.options.csvHeaders==1&&t.length>0)for(var n=t.shift(),r=0;r<n.length;r++)obj.options.columns[r]||(obj.options.columns[r]={type:"text",align:obj.options.defaultColAlign,width:obj.options.defaultColWidth}),obj.options.columns[r].title===void 0&&(obj.options.columns[r].title=n[r]);obj.options.data=t,obj.prepareTable(),obj.options.loadingSpin==1&&jSuites.loading.hide()}})):obj.options.url?(obj.options.loadingSpin==1&&jSuites.loading.show(),jSuites.ajax({url:obj.options.url,method:obj.options.method,data:obj.options.requestVariables,dataType:"json",success:function(e){obj.options.data=e.data?e.data:e,obj.prepareTable(),obj.options.loadingSpin==1&&jSuites.loading.hide()}})):obj.prepareTable()},options&&options.contextMenu!=null?obj.options.contextMenu=options.contextMenu:obj.options.contextMenu=function(e,t,n,r){var s=[];if(n==null)obj.options.allowInsertColumn==1&&s.push({title:obj.options.text.insertANewColumnBefore,onclick:function(){obj.insertColumn(1,parseInt(t),1)}}),obj.options.allowInsertColumn==1&&s.push({title:obj.options.text.insertANewColumnAfter,onclick:function(){obj.insertColumn(1,parseInt(t),0)}}),obj.options.allowDeleteColumn==1&&s.push({title:obj.options.text.deleteSelectedColumns,onclick:function(){obj.deleteColumn(obj.getSelectedColumns().length?void 0:parseInt(t))}}),obj.options.allowRenameColumn==1&&s.push({title:obj.options.text.renameThisColumn,onclick:function(){obj.setHeader(t)}}),obj.options.columnSorting==1&&(s.push({type:"line"}),s.push({title:obj.options.text.orderAscending,onclick:function(){obj.orderBy(t,0)}}),s.push({title:obj.options.text.orderDescending,onclick:function(){obj.orderBy(t,1)}}));else if(obj.options.allowInsertRow==1&&(s.push({title:obj.options.text.insertANewRowBefore,onclick:function(){obj.insertRow(1,parseInt(n),1)}}),s.push({title:obj.options.text.insertANewRowAfter,onclick:function(){obj.insertRow(1,parseInt(n))}})),obj.options.allowDeleteRow==1&&s.push({title:obj.options.text.deleteSelectedRows,onclick:function(){obj.deleteRow(obj.getSelectedRows().length?void 0:parseInt(n))}}),t&&obj.options.allowComments==1){s.push({type:"line"});var l=obj.records[n][t].getAttribute("title")||"";s.push({title:l?obj.options.text.editComments:obj.options.text.addComments,onclick:function(){var f=prompt(obj.options.text.comments,l);f&&obj.setComments([t,n],f)}}),l&&s.push({title:obj.options.text.clearComments,onclick:function(){obj.setComments([t,n],"")}})}return s.push({type:"line"}),s.push({title:obj.options.text.copy,shortcut:"Ctrl + C",onclick:function(){obj.copy(!0)}}),navigator&&navigator.clipboard&&s.push({title:obj.options.text.paste,shortcut:"Ctrl + V",onclick:function(){obj.selectedCell&&navigator.clipboard.readText().then(function(f){f&&jexcel.current.paste(obj.selectedCell[0],obj.selectedCell[1],f)})}}),obj.options.allowExport&&s.push({title:obj.options.text.saveAs,shortcut:"Ctrl + S",onclick:function(){obj.download()}}),obj.options.about&&s.push({title:obj.options.text.about,onclick:function(){obj.options.about===!0?alert(Version().print()):alert(obj.options.about)}}),s},obj.scrollControls=function(e){obj.wheelControls(),obj.options.freezeColumns>0&&obj.content.scrollLeft!=scrollLeft&&obj.updateFreezePosition(),obj.options.lazyLoading!=1&&obj.options.tableOverflow!=1||obj.edition&&e.target.className.substr(0,9)!="jdropdown"&&obj.closeEditor(obj.edition[0],!0)},obj.wheelControls=function(e){obj.options.lazyLoading==1&&jexcel.timeControlLoading==null&&(jexcel.timeControlLoading=setTimeout(function(){obj.content.scrollTop+obj.content.clientHeight>=obj.content.scrollHeight-10?obj.loadDown()&&(obj.content.scrollTop+obj.content.clientHeight>obj.content.scrollHeight-10&&(obj.content.scrollTop=obj.content.scrollTop-obj.content.clientHeight),obj.updateCornerPosition()):obj.content.scrollTop<=obj.content.clientHeight&&obj.loadUp()&&(obj.content.scrollTop<10&&(obj.content.scrollTop=obj.content.scrollTop+obj.content.clientHeight),obj.updateCornerPosition()),jexcel.timeControlLoading=null},100))},obj.getFreezeWidth=function(){var e=0;if(obj.options.freezeColumns>0)for(var t=0;t<obj.options.freezeColumns;t++)e+=parseInt(obj.options.columns[t].width);return e};var scrollLeft=0;return obj.updateFreezePosition=function(){var e=0;if((scrollLeft=obj.content.scrollLeft)>50)for(var t=0;t<obj.options.freezeColumns;t++){t>0&&obj.options.columns[t-1].type!=="hidden"&&(e+=parseInt(obj.options.columns[t-1].width)),obj.headers[t].classList.add("jexcel_freezed"),obj.headers[t].style.left=e+"px";for(var n=0;n<obj.rows.length;n++)if(obj.rows[n]&&obj.records[n][t]){var r=scrollLeft+(t>0?obj.records[n][t-1].style.width:0)-51+"px";obj.records[n][t].classList.add("jexcel_freezed"),obj.records[n][t].style.left=r}}else for(t=0;t<obj.options.freezeColumns;t++)for(obj.headers[t].classList.remove("jexcel_freezed"),obj.headers[t].style.left="",n=0;n<obj.rows.length;n++)obj.records[n][t]&&(obj.records[n][t].classList.remove("jexcel_freezed"),obj.records[n][t].style.left="");obj.updateCornerPosition()},el.addEventListener("DOMMouseScroll",obj.wheelControls),el.addEventListener("mousewheel",obj.wheelControls),el.jexcel=obj,el.jspreadsheet=obj,obj.init(),obj};jexcel.setDictionary=function(e){jSuites.setDictionary(e)},jexcel.setExtensions=function(e){for(var t=Object.keys(e),n=0;n<t.length;n++)typeof e[t[n]]=="function"&&(jexcel[t[n]]=e[t[n]],jexcel.license&&typeof e[t[n]].license=="function"&&e[t[n]].license(jexcel.license))},formula!==void 0&&(jexcel.formula=formula),jexcel.version=Version,jexcel.current=null,jexcel.timeControl=null,jexcel.timeControlLoading=null;let destroyEvents=function(e){e.removeEventListener("mouseup",jexcel.mouseUpControls),e.removeEventListener("mousedown",jexcel.mouseDownControls),e.removeEventListener("mousemove",jexcel.mouseMoveControls),e.removeEventListener("mouseover",jexcel.mouseOverControls),e.removeEventListener("dblclick",jexcel.doubleClickControls),e.removeEventListener("paste",jexcel.pasteControls),e.removeEventListener("contextmenu",jexcel.contextMenuControls),e.removeEventListener("touchstart",jexcel.touchStartControls),e.removeEventListener("touchend",jexcel.touchEndControls),e.removeEventListener("touchcancel",jexcel.touchEndControls),document.removeEventListener("keydown",jexcel.keyDownControls)};var component;return jexcel.destroy=function(e,t){if(e.jexcel){var n=e.jexcel.options.root?e.jexcel.options.root:document;e.removeEventListener("DOMMouseScroll",e.jexcel.scrollControls),e.removeEventListener("mousewheel",e.jexcel.scrollControls),e.jexcel=null,e.innerHTML="",t&&(destroyEvents(n),jexcel=null)}},jexcel.build=function(e){destroyEvents(e),e.addEventListener("mouseup",jexcel.mouseUpControls),e.addEventListener("mousedown",jexcel.mouseDownControls),e.addEventListener("mousemove",jexcel.mouseMoveControls),e.addEventListener("mouseover",jexcel.mouseOverControls),e.addEventListener("dblclick",jexcel.doubleClickControls),e.addEventListener("paste",jexcel.pasteControls),e.addEventListener("contextmenu",jexcel.contextMenuControls),e.addEventListener("touchstart",jexcel.touchStartControls),e.addEventListener("touchend",jexcel.touchEndControls),e.addEventListener("touchcancel",jexcel.touchEndControls),e.addEventListener("touchmove",jexcel.touchEndControls),document.addEventListener("keydown",jexcel.keyDownControls)},jexcel.keyDownControls=function(e){if(jexcel.current){if(jexcel.current.edition)if(e.which==27)jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!1),e.preventDefault();else if(e.which==13){if(jexcel.current.options.columns[jexcel.current.edition[2]].type=="calendar")jexcel.current.closeEditor(jexcel.current.edition[0],!0);else if(!(jexcel.current.options.columns[jexcel.current.edition[2]].type=="dropdown"||jexcel.current.options.columns[jexcel.current.edition[2]].type=="autocomplete"))if((jexcel.current.options.wordWrap==1||jexcel.current.options.columns[jexcel.current.edition[2]].wordWrap==1||jexcel.current.options.data[jexcel.current.edition[3]][jexcel.current.edition[2]].length>200)&&e.altKey){var t=jexcel.current.edition[0].children[0],n=jexcel.current.edition[0].children[0].value,r=t.selectionStart;n=n.slice(0,r)+`
`+n.slice(r),t.value=n,t.focus(),t.selectionStart=r+1,t.selectionEnd=r+1}else jexcel.current.edition[0].children[0].blur()}else e.which==9&&(["calendar","html"].includes(jexcel.current.options.columns[jexcel.current.edition[2]].type)?jexcel.current.closeEditor(jexcel.current.edition[0],!0):jexcel.current.edition[0].children[0].blur());if(!jexcel.current.edition&&jexcel.current.selectedCell)if(e.which==37)jexcel.current.left(e.shiftKey,e.ctrlKey),e.preventDefault();else if(e.which==39)jexcel.current.right(e.shiftKey,e.ctrlKey),e.preventDefault();else if(e.which==38)jexcel.current.up(e.shiftKey,e.ctrlKey),e.preventDefault();else if(e.which==40)jexcel.current.down(e.shiftKey,e.ctrlKey),e.preventDefault();else if(e.which==36)jexcel.current.first(e.shiftKey,e.ctrlKey),e.preventDefault();else if(e.which==35)jexcel.current.last(e.shiftKey,e.ctrlKey),e.preventDefault();else if(e.which==46||e.which==8)jexcel.current.options.editable==1&&(jexcel.current.selectedRow?jexcel.current.options.allowDeleteRow==1&&confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedRows)&&jexcel.current.deleteRow():jexcel.current.selectedHeader?jexcel.current.options.allowDeleteColumn==1&&confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedColumns)&&jexcel.current.deleteColumn():jexcel.current.setValue(jexcel.current.highlighted,""));else if(e.which==13)e.shiftKey?jexcel.current.up():(jexcel.current.options.allowInsertRow==1&&jexcel.current.options.allowManualInsertRow==1&&jexcel.current.selectedCell[1]==jexcel.current.options.data.length-1&&jexcel.current.insertRow(),jexcel.current.down()),e.preventDefault();else if(e.which==9)e.shiftKey?jexcel.current.left():(jexcel.current.options.allowInsertColumn==1&&jexcel.current.options.allowManualInsertColumn==1&&jexcel.current.selectedCell[0]==jexcel.current.options.data[0].length-1&&jexcel.current.insertColumn(),jexcel.current.right()),e.preventDefault();else if(!e.ctrlKey&&!e.metaKey||e.shiftKey){if(jexcel.current.selectedCell&&jexcel.current.options.editable==1){var s=jexcel.current.selectedCell[1],l=jexcel.current.selectedCell[0];jexcel.current.options.columns[l].type!="readonly"&&(e.keyCode==32?(e.preventDefault(),jexcel.current.options.columns[l].type=="checkbox"||jexcel.current.options.columns[l].type=="radio"?jexcel.current.setCheckRadioValue():jexcel.current.openEditor(jexcel.current.records[s][l],!0)):e.keyCode==113?jexcel.current.openEditor(jexcel.current.records[s][l],!1):(e.keyCode==8||e.keyCode>=48&&e.keyCode<=57||e.keyCode>=96&&e.keyCode<=111||e.keyCode>=187&&e.keyCode<=190||(String.fromCharCode(e.keyCode)==e.key||String.fromCharCode(e.keyCode).toLowerCase()==e.key.toLowerCase())&&jexcel.validLetter(String.fromCharCode(e.keyCode)))&&(jexcel.current.openEditor(jexcel.current.records[s][l],!0),jexcel.current.options.columns[l].type=="calendar"&&e.preventDefault()))}}else e.which==65?(jexcel.current.selectAll(),e.preventDefault()):e.which==83?(jexcel.current.download(),e.preventDefault()):e.which==89?(jexcel.current.redo(),e.preventDefault()):e.which==90?(jexcel.current.undo(),e.preventDefault()):e.which==67?(jexcel.current.copy(!0),e.preventDefault()):e.which==88?(jexcel.current.options.editable==1?jexcel.cutControls():jexcel.copyControls(),e.preventDefault()):e.which==86&&jexcel.pasteControls();else e.target.classList.contains("jexcel_search")&&(jexcel.timeControl&&clearTimeout(jexcel.timeControl),jexcel.timeControl=setTimeout(function(){jexcel.current.search(e.target.value)},200))}},jexcel.isMouseAction=!1,jexcel.mouseDownControls=function(e){if((e=e||window.event).buttons)var t=e.buttons;else t=e.button?e.button:e.which;var n=jexcel.getElement(e.target);if(n[0]?jexcel.current!=n[0].jexcel&&(jexcel.current&&(jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!0),jexcel.current.resetSelection()),jexcel.current=n[0].jexcel):jexcel.current&&(jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!0),jexcel.current.resetSelection(!0),jexcel.current=null),jexcel.current&&t==1){if(e.target.classList.contains("jexcel_selectall"))jexcel.current&&jexcel.current.selectAll();else if(e.target.classList.contains("jexcel_corner"))jexcel.current.options.editable==1&&(jexcel.current.selectedCorner=!0);else{if(n[1]==1){if(p=e.target.getAttribute("data-x")){var r=e.target.getBoundingClientRect();if(jexcel.current.options.columnResize==1&&r.width-e.offsetX<6){jexcel.current.resizing={mousePosition:e.pageX,column:p,width:r.width},jexcel.current.headers[p].classList.add("resizing");for(var s=0;s<jexcel.current.records.length;s++)jexcel.current.records[s][p]&&jexcel.current.records[s][p].classList.add("resizing")}else if(jexcel.current.options.columnDrag==1&&r.height-e.offsetY<6)if(jexcel.current.isColMerged(p).length)console.error("Jspreadsheet: This column is part of a merged cell.");else for(jexcel.current.resetSelection(),jexcel.current.dragging={element:e.target,column:p,destination:p},jexcel.current.headers[p].classList.add("dragging"),s=0;s<jexcel.current.records.length;s++)jexcel.current.records[s][p]&&jexcel.current.records[s][p].classList.add("dragging");else{if(jexcel.current.selectedHeader&&(e.shiftKey||e.ctrlKey))var l=jexcel.current.selectedHeader,f=p;else jexcel.current.selectedHeader==p&&jexcel.current.options.allowRenameColumn==1&&(jexcel.timeControl=setTimeout(function(){jexcel.current.setHeader(p)},800)),jexcel.current.selectedHeader=p,l=p,f=p;jexcel.current.updateSelectionFromCoords(l,0,f,jexcel.current.options.data.length-1)}}else if(e.target.parentNode.classList.contains("jexcel_nested")){if(e.target.getAttribute("data-column"))var u=e.target.getAttribute("data-column").split(","),c=parseInt(u[0]),g=parseInt(u[u.length-1]);else c=0,g=jexcel.current.options.columns.length-1;jexcel.current.updateSelectionFromCoords(c,0,g,jexcel.current.options.data.length-1)}}else jexcel.current.selectedHeader=!1;if(n[1]==2){var D=e.target.getAttribute("data-y");if(e.target.classList.contains("jexcel_row"))r=e.target.getBoundingClientRect(),jexcel.current.options.rowResize==1&&r.height-e.offsetY<6?(jexcel.current.resizing={element:e.target.parentNode,mousePosition:e.pageY,row:D,height:r.height},e.target.parentNode.classList.add("resizing")):jexcel.current.options.rowDrag==1&&r.width-e.offsetX<6?jexcel.current.isRowMerged(D).length?console.error("Jspreadsheet: This row is part of a merged cell"):jexcel.current.options.search==1&&jexcel.current.results?console.error("Jspreadsheet: Please clear your search before perform this action"):(jexcel.current.resetSelection(),jexcel.current.dragging={element:e.target.parentNode,row:D,destination:D},e.target.parentNode.classList.add("dragging")):(jexcel.current.selectedRow&&(e.shiftKey||e.ctrlKey)?(l=jexcel.current.selectedRow,f=D):(jexcel.current.selectedRow=D,l=D,f=D),jexcel.current.updateSelectionFromCoords(0,l,jexcel.current.options.data[0].length-1,f));else if(e.target.classList.contains("jclose")&&e.target.clientWidth-e.offsetX<50&&e.offsetY<50)jexcel.current.closeEditor(jexcel.current.edition[0],!0);else{var I=function(w){var j=w.getAttribute("data-x"),b=w.getAttribute("data-y");return j&&b?[j,b]:w.parentNode?I(w.parentNode):void 0},v=I(e.target);if(v){var p=v[0];D=v[1],jexcel.current.edition&&(jexcel.current.edition[2]==p&&jexcel.current.edition[3]==D||jexcel.current.closeEditor(jexcel.current.edition[0],!0)),jexcel.current.edition||(e.shiftKey?jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],p,D):jexcel.current.updateSelectionFromCoords(p,D)),jexcel.current.selectedHeader=null,jexcel.current.selectedRow=null}}}else jexcel.current.selectedRow=!1;e.target.classList.contains("jexcel_page")&&(e.target.textContent=="<"?jexcel.current.page(0):e.target.textContent==">"?jexcel.current.page(e.target.getAttribute("title")-1):jexcel.current.page(e.target.textContent-1))}jexcel.current.edition?jexcel.isMouseAction=!1:jexcel.isMouseAction=!0}else jexcel.isMouseAction=!1},jexcel.mouseUpControls=function(e){if(jexcel.current)if(jexcel.current.resizing){if(jexcel.current.resizing.column){var t=jexcel.current.colgroup[jexcel.current.resizing.column].getAttribute("width"),n=jexcel.current.getSelectedColumns();if(n.length>1){for(var r=[],s=0;s<n.length;s++)r.push(parseInt(jexcel.current.colgroup[n[s]].getAttribute("width")));r[n.indexOf(parseInt(jexcel.current.resizing.column))]=jexcel.current.resizing.width,jexcel.current.setWidth(n,t,r)}else jexcel.current.setWidth(jexcel.current.resizing.column,t,jexcel.current.resizing.width);jexcel.current.headers[jexcel.current.resizing.column].classList.remove("resizing");for(var l=0;l<jexcel.current.records.length;l++)jexcel.current.records[l][jexcel.current.resizing.column]&&jexcel.current.records[l][jexcel.current.resizing.column].classList.remove("resizing")}else{jexcel.current.rows[jexcel.current.resizing.row].children[0].classList.remove("resizing");var f=jexcel.current.rows[jexcel.current.resizing.row].getAttribute("height");jexcel.current.setHeight(jexcel.current.resizing.row,f,jexcel.current.resizing.height),jexcel.current.resizing.element.classList.remove("resizing")}jexcel.current.resizing=null}else if(jexcel.current.dragging){if(jexcel.current.dragging){if(jexcel.current.dragging.column){var u=e.target.getAttribute("data-x");for(jexcel.current.headers[jexcel.current.dragging.column].classList.remove("dragging"),l=0;l<jexcel.current.rows.length;l++)jexcel.current.records[l][jexcel.current.dragging.column]&&jexcel.current.records[l][jexcel.current.dragging.column].classList.remove("dragging");for(s=0;s<jexcel.current.headers.length;s++)jexcel.current.headers[s].classList.remove("dragging-left"),jexcel.current.headers[s].classList.remove("dragging-right");u&&jexcel.current.dragging.column!=jexcel.current.dragging.destination&&jexcel.current.moveColumn(jexcel.current.dragging.column,jexcel.current.dragging.destination)}else{if(jexcel.current.dragging.element.nextSibling){var c=parseInt(jexcel.current.dragging.element.nextSibling.getAttribute("data-y"));jexcel.current.dragging.row<c&&(c-=1)}else c=parseInt(jexcel.current.dragging.element.previousSibling.getAttribute("data-y"));jexcel.current.dragging.row!=jexcel.current.dragging.destination&&jexcel.current.moveRow(jexcel.current.dragging.row,c,!0),jexcel.current.dragging.element.classList.remove("dragging")}jexcel.current.dragging=null}}else jexcel.current.selectedCorner&&(jexcel.current.selectedCorner=!1,jexcel.current.selection.length>0&&(jexcel.current.copyData(jexcel.current.selection[0],jexcel.current.selection[jexcel.current.selection.length-1]),jexcel.current.removeCopySelection()));jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null),jexcel.isMouseAction=!1},jexcel.mouseMoveControls=function(e){if((e=e||window.event).buttons)var t=e.buttons;else t=e.button?e.button:e.which;if(t||(jexcel.isMouseAction=!1),jexcel.current)if(jexcel.isMouseAction==1){if(jexcel.current.resizing)if(jexcel.current.resizing.column){var n=e.pageX-jexcel.current.resizing.mousePosition;if(jexcel.current.resizing.width+n>0){var r=jexcel.current.resizing.width+n;jexcel.current.colgroup[jexcel.current.resizing.column].setAttribute("width",r),jexcel.current.updateCornerPosition()}}else{var s=e.pageY-jexcel.current.resizing.mousePosition;if(jexcel.current.resizing.height+s>0){var l=jexcel.current.resizing.height+s;jexcel.current.rows[jexcel.current.resizing.row].setAttribute("height",l),jexcel.current.updateCornerPosition()}}else if(jexcel.current.dragging)if(jexcel.current.dragging.column){var f=e.target.getAttribute("data-x");if(f)if(jexcel.current.isColMerged(f).length)console.error("Jspreadsheet: This column is part of a merged cell.");else{for(var u=0;u<jexcel.current.headers.length;u++)jexcel.current.headers[u].classList.remove("dragging-left"),jexcel.current.headers[u].classList.remove("dragging-right");jexcel.current.dragging.column==f?jexcel.current.dragging.destination=parseInt(f):e.target.clientWidth/2>e.offsetX?(jexcel.current.dragging.column<f?jexcel.current.dragging.destination=parseInt(f)-1:jexcel.current.dragging.destination=parseInt(f),jexcel.current.headers[f].classList.add("dragging-left")):(jexcel.current.dragging.column<f?jexcel.current.dragging.destination=parseInt(f):jexcel.current.dragging.destination=parseInt(f)+1,jexcel.current.headers[f].classList.add("dragging-right"))}}else{var c=e.target.getAttribute("data-y");if(c)if(jexcel.current.isRowMerged(c).length)console.error("Jspreadsheet: This row is part of a merged cell.");else{var g=e.target.clientHeight/2>e.offsetY?e.target.parentNode.nextSibling:e.target.parentNode;jexcel.current.dragging.element!=g&&(e.target.parentNode.parentNode.insertBefore(jexcel.current.dragging.element,g),jexcel.current.dragging.destination=Array.prototype.indexOf.call(jexcel.current.dragging.element.parentNode.children,jexcel.current.dragging.element))}}}else{var D=e.target.getAttribute("data-x"),I=e.target.getAttribute("data-y"),v=e.target.getBoundingClientRect();jexcel.current.cursor&&(jexcel.current.cursor.style.cursor="",jexcel.current.cursor=null),e.target.parentNode.parentNode&&e.target.parentNode.parentNode.className&&(e.target.parentNode.parentNode.classList.contains("resizable")&&(e.target&&D&&!I&&v.width-(e.clientX-v.left)<6?(jexcel.current.cursor=e.target,jexcel.current.cursor.style.cursor="col-resize"):e.target&&!D&&I&&v.height-(e.clientY-v.top)<6&&(jexcel.current.cursor=e.target,jexcel.current.cursor.style.cursor="row-resize")),e.target.parentNode.parentNode.classList.contains("draggable")&&(e.target&&!D&&I&&v.width-(e.clientX-v.left)<6||e.target&&D&&!I&&v.height-(e.clientY-v.top)<6)&&(jexcel.current.cursor=e.target,jexcel.current.cursor.style.cursor="move"))}},jexcel.mouseOverControls=function(e){if((e=e||window.event).buttons)var t=e.buttons;else t=e.button?e.button:e.which;if(t||(jexcel.isMouseAction=!1),jexcel.current&&jexcel.isMouseAction==1){var n=jexcel.getElement(e.target);if(n[0]){if(jexcel.current!=n[0].jexcel&&jexcel.current)return!1;var r=e.target.getAttribute("data-x"),s=e.target.getAttribute("data-y");if(!(jexcel.current.resizing||jexcel.current.dragging)){if(n[1]==1&&jexcel.current.selectedHeader){r=e.target.getAttribute("data-x");var l=jexcel.current.selectedHeader,f=r;jexcel.current.updateSelectionFromCoords(l,0,f,jexcel.current.options.data.length-1)}n[1]==2&&(e.target.classList.contains("jexcel_row")?jexcel.current.selectedRow&&(l=jexcel.current.selectedRow,f=s,jexcel.current.updateSelectionFromCoords(0,l,jexcel.current.options.data[0].length-1,f)):jexcel.current.edition||r&&s&&(jexcel.current.selectedCorner?jexcel.current.updateCopySelection(r,s):jexcel.current.selectedCell&&jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],r,s)))}}}jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null)},jexcel.doubleClickControls=function(e){if(jexcel.current)if(e.target.classList.contains("jexcel_corner")){if(jexcel.current.highlighted.length>0){var t=jexcel.current.highlighted[0].getAttribute("data-x"),n=parseInt(jexcel.current.highlighted[jexcel.current.highlighted.length-1].getAttribute("data-y"))+1,r=jexcel.current.highlighted[jexcel.current.highlighted.length-1].getAttribute("data-x"),s=jexcel.current.records.length-1;jexcel.current.copyData(jexcel.current.records[n][t],jexcel.current.records[s][r])}}else if(e.target.classList.contains("jexcel_column_filter")){var l=e.target.getAttribute("data-x");jexcel.current.openFilter(l)}else{var f=jexcel.getElement(e.target);if(f[1]==1&&jexcel.current.options.columnSorting==1&&(l=e.target.getAttribute("data-x"))&&jexcel.current.orderBy(l),f[1]==2&&jexcel.current.options.editable==1&&!jexcel.current.edition){var u=function(g){if(g.parentNode){var D=g.getAttribute("data-x"),I=g.getAttribute("data-y");return D&&I?g:u(g.parentNode)}},c=u(e.target);c&&c.classList.contains("highlight")&&jexcel.current.openEditor(c)}}},jexcel.copyControls=function(e){jexcel.current&&jexcel.copyControls.enabled&&(jexcel.current.edition||jexcel.current.copy(!0))},jexcel.cutControls=function(e){jexcel.current&&(jexcel.current.edition||(jexcel.current.copy(!0),jexcel.current.options.editable==1&&jexcel.current.setValue(jexcel.current.highlighted,"")))},jexcel.pasteControls=function(e){jexcel.current&&jexcel.current.selectedCell&&(jexcel.current.edition||jexcel.current.options.editable==1&&(e&&e.clipboardData?(jexcel.current.paste(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],e.clipboardData.getData("text")),e.preventDefault()):window.clipboardData&&jexcel.current.paste(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],window.clipboardData.getData("text"))))},jexcel.contextMenuControls=function(e){if("buttons"in(e=e||window.event)?e.buttons:e.which||e.button,jexcel.current){if(jexcel.current.edition)e.preventDefault();else if(jexcel.current.options.contextMenu&&(jexcel.current.contextMenu.contextmenu.close(),jexcel.current)){var t=e.target.getAttribute("data-x"),n=e.target.getAttribute("data-y");if(t||n){(t<parseInt(jexcel.current.selectedCell[0])||t>parseInt(jexcel.current.selectedCell[2])||n<parseInt(jexcel.current.selectedCell[1])||n>parseInt(jexcel.current.selectedCell[3]))&&jexcel.current.updateSelectionFromCoords(t,n,t,n);var r=jexcel.current.options.contextMenu(jexcel.current,t,n,e);jexcel.current.contextMenu.contextmenu.open(e,r),e.preventDefault()}}}},jexcel.touchStartControls=function(e){var t=jexcel.getElement(e.target);if(t[0]?jexcel.current!=t[0].jexcel&&(jexcel.current&&jexcel.current.resetSelection(),jexcel.current=t[0].jexcel):jexcel.current&&(jexcel.current.resetSelection(),jexcel.current=null),jexcel.current&&!jexcel.current.edition){var n=e.target.getAttribute("data-x"),r=e.target.getAttribute("data-y");n&&r&&(jexcel.current.updateSelectionFromCoords(n,r),jexcel.timeControl=setTimeout(function(){jexcel.current.options.columns[n].type=="color"?jexcel.tmpElement=null:jexcel.tmpElement=e.target,jexcel.current.openEditor(e.target,!1,e)},500))}},jexcel.touchEndControls=function(e){jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null,jexcel.tmpElement&&jexcel.tmpElement.children[0].tagName=="INPUT"&&jexcel.tmpElement.children[0].focus(),jexcel.tmpElement=null)},jexcel.tabs=function(e,t){var n=[];if(e.classList.contains("jexcel_tabs"))s=e.children[0],l=e.children[1];else{e.innerHTML="",e.classList.add("jexcel_tabs"),e.jexcel=[];var r=document.createElement("div"),s=e.appendChild(r),l=(r=document.createElement("div"),e.appendChild(r))}for(var f=[],u=[],c=0;c<t.length;c++){f[c]=document.createElement("div"),f[c].classList.add("jexcel_tab");var g=jexcel(f[c],t[c]);l.appendChild(f[c]),n[c]=e.jexcel.push(g),u[c]=document.createElement("div"),u[c].classList.add("jexcel_tab_link"),u[c].setAttribute("data-spreadsheet",e.jexcel.length-1),u[c].innerHTML=t[c].sheetName,u[c].onclick=function(){for(var I=0;I<s.children.length;I++)s.children[I].classList.remove("selected"),l.children[I].style.display="none";var v=this.getAttribute("data-spreadsheet");l.children[v].style.display="block",s.children[v].classList.add("selected")},s.appendChild(u[c])}for(var D=0;D<s.children.length;D++)s.children[D].classList.remove("selected"),l.children[D].style.display="none";return s.children[s.children.length-1].classList.add("selected"),l.children[s.children.length-1].style.display="block",n},jexcel.createTabs=jexcel.tabs,jexcel.fromSpreadsheet=function(e,t){var n,r=function(s){var l=[];return s.SheetNames.forEach(function(f){var u={rows:[],columns:[],data:[],style:{}};if(u.sheetName=f,(b=s.Sheets[f]["!cols"])&&b.length)for(var c=0;c<b.length;c++)u.columns[c]={},b[c]&&b[c].wpx&&(u.columns[c].width=b[c].wpx+"px");if((b=s.Sheets[f]["!rows"])&&b.length)for(c=0;c<b.length;c++)b[c]&&b[c].hpx&&(u.rows[c]={},u.rows[c].height=b[c].hpx+"px");if((b=s.Sheets[f]["!merges"])&&b.length>0)for(u.mergeCells=[],c=0;c<b.length;c++){var g=b[c].s.c,D=b[c].s.r,I=b[c].e.c,v=b[c].e.r,p=jexcel.getColumnNameFromId([g,D]);u.mergeCells[p]=[I-g+1,v-D+1]}var w=0,j=0,b=Object.keys(s.Sheets[f]);for(c=0;c<b.length;c++)if(b[c].substr(0,1)!="!"){var M=s.Sheets[f][b[c]],A=jexcel.getIdFromColumnName(b[c],!0);u.data[A[1]]||(u.data[A[1]]=[]),u.data[A[1]][A[0]]=M.f?"="+M.f:M.w,w<A[0]&&(w=A[0]),j<A[1]&&(j=A[1]),M.style&&Object.keys(M.style).length>0&&(u.style[b[c]]=M.style),M.s&&M.s.fgColor&&(u.style[b[c]]&&(u.style[b[c]]+=";"),u.style[b[c]]+="background-color:#"+M.s.fgColor.rgb)}for(var O=u.columns,F=0;F<=j;F++)for(c=0;c<=w;c++)u.data[F]||(u.data[F]=[]),u.data[F][c]||O<c&&(u.data[F][c]="");l.push(u)}),l};(n=new XMLHttpRequest).open("GET",e,!0),typeof Uint8Array<"u"?(n.responseType="arraybuffer",n.onload=function(s){var l=n.response,f=new Uint8Array(l),u=XLSX.read(f,{type:"array",cellFormula:!0,cellStyles:!0});t(r(u))}):(n.setRequestHeader("Accept-Charset","x-user-defined"),n.onreadystatechange=function(){if(n.readyState==4&&n.status==200){var s=convertResponseBodyToText(n.responseBody),l=XLSX.read(s,{type:"binary",cellFormula:!0,cellStyles:!0});t(r(l))}}),n.send()},jexcel.validLetter=function(e){return e.match(/([\u0041-\u005A\u0061-\u007A\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0\u08A2-\u08AC\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA793\uA7A0-\uA7AA\uA7F8-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC-\u0400-\u04FF']+)/g)?1:0},jexcel.injectArray=function(e,t,n){return e.slice(0,t).concat(n).concat(e.slice(t))},jexcel.getColumnName=function(e){return jexcel.helpers.getColumnName(e)},jexcel.getIdFromColumnName=function(e,t){var n=/^[a-zA-Z]+/.exec(e);if(n){for(var r=0,s=0;s<n[0].length;s++)r+=parseInt(n[0].charCodeAt(s)-64)*Math.pow(26,n[0].length-1-s);--r<0&&(r=0);var l=parseInt(/[0-9]+$/.exec(e));l>0&&l--,e=t==1?[r,l]:r+"-"+l}return e},jexcel.getColumnNameFromId=function(e){return Array.isArray(e)||(e=e.split("-")),jexcel.getColumnName(parseInt(e[0]))+(parseInt(e[1])+1)},jexcel.getElement=function(e){var t=0,n=0;return function r(s){s.className&&s.classList.contains("jexcel_container")&&(n=s),s.tagName=="THEAD"?t=1:s.tagName=="TBODY"&&(t=2),s.parentNode&&(n||r(s.parentNode))}(e),[n,t]},jexcel.doubleDigitFormat=function(e){return(e=""+e).length==1&&(e="0"+e),e},jexcel.createFromTable=function(e,t){if(e.tagName=="TABLE"){t||(t={}),t.columns=[],t.data=[];var n=e.querySelectorAll("colgroup > col");if(n.length)for(var r=0;r<n.length;r++){if(!(s=n[r].style.width))var s=n[r].getAttribute("width");s&&(t.columns[r]||(t.columns[r]={}),t.columns[r].width=s)}var l=function(we){var Me=we.getBoundingClientRect(),be=Me.width>50?Me.width:50;t.columns[r]||(t.columns[r]={}),we.getAttribute("data-celltype")?t.columns[r].type=we.getAttribute("data-celltype"):t.columns[r].type="text",t.columns[r].width=be+"px",t.columns[r].title=we.innerHTML,t.columns[r].align=we.style.textAlign||"center",(Me=we.getAttribute("name"))&&(t.columns[r].name=Me),(Me=we.getAttribute("id"))&&(t.columns[r].id=Me),(Me=we.getAttribute("data-mask"))&&(t.columns[r].mask=Me)},f=[],u=e.querySelectorAll(":scope > thead > tr");if(u.length){for(var c=0;c<u.length-1;c++){var g=[];for(r=0;r<u[c].children.length;r++){var D={title:u[c].children[r].textContent,colspan:u[c].children[r].getAttribute("colspan")||1};g.push(D)}f.push(g)}for(u=u[u.length-1].children,r=0;r<u.length;r++)l(u[r])}var I=0,v={},p={},w={},j={},b=e.querySelectorAll(":scope > tr, :scope > tbody > tr");for(c=0;c<b.length;c++)if(t.data[I]=[],t.parseTableFirstRowAsHeader!=1||u.length||c!=0){for(r=0;r<b[c].children.length;r++){if(M=b[c].children[r].getAttribute("data-formula"))M.substr(0,1)!="="&&(M="="+M);else var M=b[c].children[r].innerHTML;t.data[I].push(M);var A=jexcel.getColumnNameFromId([r,c]),O=b[c].children[r].getAttribute("class");O&&(j[A]=O);var F=parseInt(b[c].children[r].getAttribute("colspan"))||0,V=parseInt(b[c].children[r].getAttribute("rowspan"))||0;(F||V)&&(v[A]=[F||1,V||1]),b[c].children[r].style&&b[c].children[r].style.display=="none"&&(b[c].children[r].style.display="");var _=b[c].children[r].getAttribute("style");_&&(w[A]=_),b[c].children[r].classList.contains("styleBold")&&(w[A]?w[A]+="; font-weight:bold;":w[A]="font-weight:bold;")}b[c].style&&b[c].style.height&&(p[c]={height:b[c].style.height}),I++}else for(r=0;r<b[c].children.length;r++)l(b[c].children[r]);if(Object.keys(f).length>0&&(t.nestedHeaders=f),Object.keys(w).length>0&&(t.style=w),Object.keys(v).length>0&&(t.mergeCells=v),Object.keys(p).length>0&&(t.rows=p),Object.keys(j).length>0&&(t.classes=j),(b=e.querySelectorAll("tfoot tr")).length){var P=[];for(c=0;c<b.length;c++){var K=[];for(r=0;r<b[c].children.length;r++)K.push(b[c].children[r].textContent);P.push(K)}Object.keys(P).length>0&&(t.footers=P)}if(t.parseTableAutoCellType==1){var W=[];for(r=0;r<t.columns.length;r++){var se=!0,he=!0;for(W[r]=[],c=0;c<t.data.length;c++)M=t.data[c][r],W[r][M]||(W[r][M]=0),W[r][M]++,M.length>25&&(se=!1),M.length==10&&M.substr(4,1)=="-"&&M.substr(7,1)=="-"||(he=!1);var ae=Object.keys(W[r]).length;he?t.columns[r].type="calendar":se==1&&ae>1&&ae<=parseInt(.1*t.data.length)&&(t.columns[r].type="dropdown",t.columns[r].source=Object.keys(W[r]))}}return t}console.log("Element is not a table")},jexcel.helpers=(component={getCaretIndex:function(e){if(this.config.root)var t=this.config.root;else t=window;var n=0,r=t.getSelection();if(r&&r.rangeCount!==0){var s=r.getRangeAt(0),l=s.cloneRange();l.selectNodeContents(e),l.setEnd(s.endContainer,s.endOffset),n=l.toString().length}return n},invert:function(e){for(var t=[],n=Object.keys(e),r=0;r<n.length;r++)t[e[n[r]]]=n[r];return t},getColumnName:function(e){let t,n=e+1,r="";for(;n>0;)t=(n-1)%26,r=String.fromCharCode(65+t).toString()+r,n=parseInt((n-t)/26);return r},getColumnNameFromCoords:function(e,t){return component.getColumnName(parseInt(e))+(parseInt(t)+1)},getCoordsFromColumnName:function(e){var t=/^[a-zA-Z]+/.exec(e);if(t){for(var n=0,r=0;r<t[0].length;r++)n+=parseInt(t[0].charCodeAt(r)-64)*Math.pow(26,t[0].length-1-r);--n<0&&(n=0);var s=parseInt(/[0-9]+$/.exec(e))||null;return s>0&&s--,[n,s]}},createFromTable:function(){},injectArray:function(e,t,n){return e.slice(0,t).concat(n).concat(e.slice(t))},parseCSV:function(e,t){t=t||",";for(var n=0,r=0,s=[[]],l=0,f=null,u=!1,c=!1,g=0;g<e.length;g++)if(s[r]||(s[r]=[]),s[r][n]||(s[r][n]=""),e[g]!="\r")if(e[g]!=`
`&&e[g]!=t||u!=0&&c!=1&&f){if(e[g]=='"'&&(u=!u),f===null){if((f=u)==1)continue}else if(f===!0&&!c&&e[g]=='"'){e[g+1]=='"'?(u=!0,s[r][n]+=e[g],g++):c=!0;continue}s[r][n]+=e[g]}else{if(f=null,u=!1,c=!1,s[r][n][0]=='"'){var D=s[r][n].trim();D[D.length-1]=='"'&&(s[r][n]=D.substr(1,D.length-2))}e[g]==`
`?(n=0,r++):++n>l&&(l=n)}for(var I=0;I<s.length;I++)for(g=0;g<=l;g++)s[I][g]===void 0&&(s[I][g]="");return s}},component),typeof jQuery<"u"&&function(e){e.fn.jspreadsheet=e.fn.jexcel=function(t){var n=e(this).get(0);return n.jexcel?Array.isArray(n.jexcel)?n.jexcel[t][arguments[1]].apply(this,Array.prototype.slice.call(arguments,2)):n.jexcel[t].apply(this,Array.prototype.slice.call(arguments,1)):jexcel(e(this).get(0),arguments[0])}}(jQuery),jexcel},module.exports=factory()}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(t!==void 0)return t.exports;var n=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(n.exports,n,n.exports,__webpack_require__),n.exports}var __webpack_exports__=__webpack_require__(44);jspreadsheet=__webpack_exports__}(),jspreadsheet})});function Vc(e,t){return Object.is(e,t)}var Ft=null,Ci=!1,Ta=1,Nr=Symbol("SIGNAL");function wt(e){let t=Ft;return Ft=e,t}function Hc(){return Ft}var ji={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,kind:"unknown",producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function Bc(e){if(Ci)throw new Error("");if(Ft===null)return;Ft.consumerOnSignalRead(e);let t=Ft.nextProducerIndex++;if(Ei(Ft),t<Ft.producerNode.length&&Ft.producerNode[t]!==e&&yo(Ft)){let n=Ft.producerNode[t];Di(n,Ft.producerIndexOfThis[t])}Ft.producerNode[t]!==e&&(Ft.producerNode[t]=e,Ft.producerIndexOfThis[t]=yo(Ft)?qc(e,Ft,t):0),Ft.producerLastReadVersion[t]=e.version}function sv(){Ta++}function Uc(e){if(!(yo(e)&&!e.dirty)&&!(!e.dirty&&e.lastCleanEpoch===Ta)){if(!e.producerMustRecompute(e)&&!Na(e)){Sa(e);return}e.producerRecomputeValue(e),Sa(e)}}function $c(e){if(e.liveConsumerNode===void 0)return;let t=Ci;Ci=!0;try{for(let n of e.liveConsumerNode)n.dirty||lv(n)}finally{Ci=t}}function av(){return Ft?.consumerAllowSignalWrites!==!1}function lv(e){e.dirty=!0,$c(e),e.consumerMarkedDirty?.(e)}function Sa(e){e.dirty=!1,e.lastCleanEpoch=Ta}function Aa(e){return e&&(e.nextProducerIndex=0),wt(e)}function zc(e,t){if(wt(t),!(!e||e.producerNode===void 0||e.producerIndexOfThis===void 0||e.producerLastReadVersion===void 0)){if(yo(e))for(let n=e.nextProducerIndex;n<e.producerNode.length;n++)Di(e.producerNode[n],e.producerIndexOfThis[n]);for(;e.producerNode.length>e.nextProducerIndex;)e.producerNode.pop(),e.producerLastReadVersion.pop(),e.producerIndexOfThis.pop()}}function Na(e){Ei(e);for(let t=0;t<e.producerNode.length;t++){let n=e.producerNode[t],r=e.producerLastReadVersion[t];if(r!==n.version||(Uc(n),r!==n.version))return!0}return!1}function _a(e){if(Ei(e),yo(e))for(let t=0;t<e.producerNode.length;t++)Di(e.producerNode[t],e.producerIndexOfThis[t]);e.producerNode.length=e.producerLastReadVersion.length=e.producerIndexOfThis.length=0,e.liveConsumerNode&&(e.liveConsumerNode.length=e.liveConsumerIndexOfThis.length=0)}function qc(e,t,n){if(Wc(e),e.liveConsumerNode.length===0&&Gc(e))for(let r=0;r<e.producerNode.length;r++)e.producerIndexOfThis[r]=qc(e.producerNode[r],e,r);return e.liveConsumerIndexOfThis.push(n),e.liveConsumerNode.push(t)-1}function Di(e,t){if(Wc(e),e.liveConsumerNode.length===1&&Gc(e))for(let r=0;r<e.producerNode.length;r++)Di(e.producerNode[r],e.producerIndexOfThis[r]);let n=e.liveConsumerNode.length-1;if(e.liveConsumerNode[t]=e.liveConsumerNode[n],e.liveConsumerIndexOfThis[t]=e.liveConsumerIndexOfThis[n],e.liveConsumerNode.length--,e.liveConsumerIndexOfThis.length--,t<e.liveConsumerNode.length){let r=e.liveConsumerIndexOfThis[t],s=e.liveConsumerNode[t];Ei(s),s.producerIndexOfThis[r]=t}}function yo(e){return e.consumerIsAlwaysLive||(e?.liveConsumerNode?.length??0)>0}function Ei(e){e.producerNode??=[],e.producerIndexOfThis??=[],e.producerLastReadVersion??=[]}function Wc(e){e.liveConsumerNode??=[],e.liveConsumerIndexOfThis??=[]}function Gc(e){return e.producerNode!==void 0}function uv(){throw new Error}var Yc=uv;function cv(){Yc()}function Zc(e){Yc=e}var dv=null;function Xc(e,t){av()||cv(),e.equal(e.value,t)||(e.value=t,fv(e))}var Qc=Mt(Ve({},ji),{equal:Vc,value:void 0,kind:"signal"});function fv(e){e.version++,sv(),$c(e),dv?.()}function rt(e){return typeof e=="function"}function _r(e){let n=e(r=>{Error.call(r),r.stack=new Error().stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var xi=_r(e=>function(n){e(this),this.message=n?`${n.length} errors occurred during unsubscription:
${n.map((r,s)=>`${s+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=n});function wo(e,t){if(e){let n=e.indexOf(t);0<=n&&e.splice(n,1)}}var Rt=class e{constructor(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let t;if(!this.closed){this.closed=!0;let{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(let l of n)l.remove(this);else n.remove(this);let{initialTeardown:r}=this;if(rt(r))try{r()}catch(l){t=l instanceof xi?l.errors:[l]}let{_finalizers:s}=this;if(s){this._finalizers=null;for(let l of s)try{Kc(l)}catch(f){t=t??[],f instanceof xi?t=[...t,...f.errors]:t.push(f)}}if(t)throw new xi(t)}}add(t){var n;if(t&&t!==this)if(this.closed)Kc(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(t)}}_hasParent(t){let{_parentage:n}=this;return n===t||Array.isArray(n)&&n.includes(t)}_addParent(t){let{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(t),n):n?[n,t]:t}_removeParent(t){let{_parentage:n}=this;n===t?this._parentage=null:Array.isArray(n)&&wo(n,t)}remove(t){let{_finalizers:n}=this;n&&wo(n,t),t instanceof e&&t._removeParent(this)}};Rt.EMPTY=(()=>{let e=new Rt;return e.closed=!0,e})();var Ra=Rt.EMPTY;function Ii(e){return e instanceof Rt||e&&"closed"in e&&rt(e.remove)&&rt(e.add)&&rt(e.unsubscribe)}function Kc(e){rt(e)?e():e.unsubscribe()}var wn={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var Rr={setTimeout(e,t,...n){let{delegate:r}=Rr;return r?.setTimeout?r.setTimeout(e,t,...n):setTimeout(e,t,...n)},clearTimeout(e){let{delegate:t}=Rr;return(t?.clearTimeout||clearTimeout)(e)},delegate:void 0};function Mi(e){Rr.setTimeout(()=>{let{onUnhandledError:t}=wn;if(t)t(e);else throw e})}function Co(){}var Jc=Oa("C",void 0,void 0);function ed(e){return Oa("E",void 0,e)}function td(e){return Oa("N",e,void 0)}function Oa(e,t,n){return{kind:e,value:t,error:n}}var dr=null;function Or(e){if(wn.useDeprecatedSynchronousErrorHandling){let t=!dr;if(t&&(dr={errorThrown:!1,error:null}),e(),t){let{errorThrown:n,error:r}=dr;if(dr=null,n)throw r}}else e()}function nd(e){wn.useDeprecatedSynchronousErrorHandling&&dr&&(dr.errorThrown=!0,dr.error=e)}var fr=class extends Rt{constructor(t){super(),this.isStopped=!1,t?(this.destination=t,Ii(t)&&t.add(this)):this.destination=gv}static create(t,n,r){return new Lr(t,n,r)}next(t){this.isStopped?Fa(td(t),this):this._next(t)}error(t){this.isStopped?Fa(ed(t),this):(this.isStopped=!0,this._error(t))}complete(){this.isStopped?Fa(Jc,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(t){this.destination.next(t)}_error(t){try{this.destination.error(t)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},pv=Function.prototype.bind;function La(e,t){return pv.call(e,t)}var ka=class{constructor(t){this.partialObserver=t}next(t){let{partialObserver:n}=this;if(n.next)try{n.next(t)}catch(r){Si(r)}}error(t){let{partialObserver:n}=this;if(n.error)try{n.error(t)}catch(r){Si(r)}else Si(t)}complete(){let{partialObserver:t}=this;if(t.complete)try{t.complete()}catch(n){Si(n)}}},Lr=class extends fr{constructor(t,n,r){super();let s;if(rt(t)||!t)s={next:t??void 0,error:n??void 0,complete:r??void 0};else{let l;this&&wn.useDeprecatedNextContext?(l=Object.create(t),l.unsubscribe=()=>this.unsubscribe(),s={next:t.next&&La(t.next,l),error:t.error&&La(t.error,l),complete:t.complete&&La(t.complete,l)}):s=t}this.destination=new ka(s)}};function Si(e){wn.useDeprecatedSynchronousErrorHandling?nd(e):Mi(e)}function hv(e){throw e}function Fa(e,t){let{onStoppedNotification:n}=wn;n&&Rr.setTimeout(()=>n(e,t))}var gv={closed:!0,next:Co,error:hv,complete:Co};var Fr=typeof Symbol=="function"&&Symbol.observable||"@@observable";function on(e){return e}function Pa(...e){return Va(e)}function Va(e){return e.length===0?on:e.length===1?e[0]:function(n){return e.reduce((r,s)=>s(r),n)}}var xt=(()=>{class e{constructor(n){n&&(this._subscribe=n)}lift(n){let r=new e;return r.source=this,r.operator=n,r}subscribe(n,r,s){let l=vv(n)?n:new Lr(n,r,s);return Or(()=>{let{operator:f,source:u}=this;l.add(f?f.call(l,u):u?this._subscribe(l):this._trySubscribe(l))}),l}_trySubscribe(n){try{return this._subscribe(n)}catch(r){n.error(r)}}forEach(n,r){return r=rd(r),new r((s,l)=>{let f=new Lr({next:u=>{try{n(u)}catch(c){l(c),f.unsubscribe()}},error:l,complete:s});this.subscribe(f)})}_subscribe(n){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(n)}[Fr](){return this}pipe(...n){return Va(n)(this)}toPromise(n){return n=rd(n),new n((r,s)=>{let l;this.subscribe(f=>l=f,f=>s(f),()=>r(l))})}}return e.create=t=>new e(t),e})();function rd(e){var t;return(t=e??wn.Promise)!==null&&t!==void 0?t:Promise}function mv(e){return e&&rt(e.next)&&rt(e.error)&&rt(e.complete)}function vv(e){return e&&e instanceof fr||mv(e)&&Ii(e)}function Ha(e){return rt(e?.lift)}function ht(e){return t=>{if(Ha(t))return t.lift(function(n){try{return e(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function gt(e,t,n,r,s){return new Ba(e,t,n,r,s)}var Ba=class extends fr{constructor(t,n,r,s,l,f){super(t),this.onFinalize=l,this.shouldUnsubscribe=f,this._next=n?function(u){try{n(u)}catch(c){t.error(c)}}:super._next,this._error=s?function(u){try{s(u)}catch(c){t.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(u){t.error(u)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:n}=this;super.unsubscribe(),!n&&((t=this.onFinalize)===null||t===void 0||t.call(this))}}};function kr(){return ht((e,t)=>{let n=null;e._refCount++;let r=gt(t,void 0,void 0,void 0,()=>{if(!e||e._refCount<=0||0<--e._refCount){n=null;return}let s=e._connection,l=n;n=null,s&&(!l||s===l)&&s.unsubscribe(),t.unsubscribe()});e.subscribe(r),r.closed||(n=e.connect())})}var Pr=class extends xt{constructor(t,n){super(),this.source=t,this.subjectFactory=n,this._subject=null,this._refCount=0,this._connection=null,Ha(t)&&(this.lift=t.lift)}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){let t=this._subject;return(!t||t.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:t}=this;this._subject=this._connection=null,t?.unsubscribe()}connect(){let t=this._connection;if(!t){t=this._connection=new Rt;let n=this.getSubject();t.add(this.source.subscribe(gt(n,void 0,()=>{this._teardown(),n.complete()},r=>{this._teardown(),n.error(r)},()=>this._teardown()))),t.closed&&(this._connection=null,t=Rt.EMPTY)}return t}refCount(){return kr()(this)}};var od=_r(e=>function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Yt=(()=>{class e extends xt{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){let r=new Ti(this,this);return r.operator=n,r}_throwIfClosed(){if(this.closed)throw new od}next(n){Or(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(n)}})}error(n){Or(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;let{observers:r}=this;for(;r.length;)r.shift().error(n)}})}complete(){Or(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){let{hasError:r,isStopped:s,observers:l}=this;return r||s?Ra:(this.currentObservers=null,l.push(n),new Rt(()=>{this.currentObservers=null,wo(l,n)}))}_checkFinalizedStatuses(n){let{hasError:r,thrownError:s,isStopped:l}=this;r?n.error(s):l&&n.complete()}asObservable(){let n=new xt;return n.source=this,n}}return e.create=(t,n)=>new Ti(t,n),e})(),Ti=class extends Yt{constructor(t,n){super(),this.destination=t,this.source=n}next(t){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.next)===null||r===void 0||r.call(n,t)}error(t){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.error)===null||r===void 0||r.call(n,t)}complete(){var t,n;(n=(t=this.destination)===null||t===void 0?void 0:t.complete)===null||n===void 0||n.call(t)}_subscribe(t){var n,r;return(r=(n=this.source)===null||n===void 0?void 0:n.subscribe(t))!==null&&r!==void 0?r:Ra}};var $t=class extends Yt{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){let n=super._subscribe(t);return!n.closed&&t.next(this._value),n}getValue(){let{hasError:t,thrownError:n,_value:r}=this;if(t)throw n;return this._throwIfClosed(),r}next(t){super.next(this._value=t)}};var sn=new xt(e=>e.complete());function id(e){return e&&rt(e.schedule)}function sd(e){return e[e.length-1]}function ad(e){return rt(sd(e))?e.pop():void 0}function Zn(e){return id(sd(e))?e.pop():void 0}function ud(e,t,n,r){function s(l){return l instanceof n?l:new n(function(f){f(l)})}return new(n||(n=Promise))(function(l,f){function u(D){try{g(r.next(D))}catch(I){f(I)}}function c(D){try{g(r.throw(D))}catch(I){f(I)}}function g(D){D.done?l(D.value):s(D.value).then(u,c)}g((r=r.apply(e,t||[])).next())})}function ld(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function pr(e){return this instanceof pr?(this.v=e,this):new pr(e)}function cd(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(e,t||[]),s,l=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),u("next"),u("throw"),u("return",f),s[Symbol.asyncIterator]=function(){return this},s;function f(p){return function(w){return Promise.resolve(w).then(p,I)}}function u(p,w){r[p]&&(s[p]=function(j){return new Promise(function(b,M){l.push([p,j,b,M])>1||c(p,j)})},w&&(s[p]=w(s[p])))}function c(p,w){try{g(r[p](w))}catch(j){v(l[0][3],j)}}function g(p){p.value instanceof pr?Promise.resolve(p.value.v).then(D,I):v(l[0][2],p)}function D(p){c("next",p)}function I(p){c("throw",p)}function v(p,w){p(w),l.shift(),l.length&&c(l[0][0],l[0][1])}}function dd(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof ld=="function"?ld(e):e[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(l){n[l]=e[l]&&function(f){return new Promise(function(u,c){f=e[l](f),s(u,c,f.done,f.value)})}}function s(l,f,u,c){Promise.resolve(c).then(function(g){l({value:g,done:u})},f)}}var Ai=e=>e&&typeof e.length=="number"&&typeof e!="function";function Ni(e){return rt(e?.then)}function _i(e){return rt(e[Fr])}function Ri(e){return Symbol.asyncIterator&&rt(e?.[Symbol.asyncIterator])}function Oi(e){return new TypeError(`You provided ${e!==null&&typeof e=="object"?"an invalid object":`'${e}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function bv(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Li=bv();function Fi(e){return rt(e?.[Li])}function ki(e){return cd(this,arguments,function*(){let n=e.getReader();try{for(;;){let{value:r,done:s}=yield pr(n.read());if(s)return yield pr(void 0);yield yield pr(r)}}finally{n.releaseLock()}})}function Pi(e){return rt(e?.getReader)}function Vt(e){if(e instanceof xt)return e;if(e!=null){if(_i(e))return yv(e);if(Ai(e))return wv(e);if(Ni(e))return Cv(e);if(Ri(e))return fd(e);if(Fi(e))return jv(e);if(Pi(e))return Dv(e)}throw Oi(e)}function yv(e){return new xt(t=>{let n=e[Fr]();if(rt(n.subscribe))return n.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function wv(e){return new xt(t=>{for(let n=0;n<e.length&&!t.closed;n++)t.next(e[n]);t.complete()})}function Cv(e){return new xt(t=>{e.then(n=>{t.closed||(t.next(n),t.complete())},n=>t.error(n)).then(null,Mi)})}function jv(e){return new xt(t=>{for(let n of e)if(t.next(n),t.closed)return;t.complete()})}function fd(e){return new xt(t=>{Ev(e,t).catch(n=>t.error(n))})}function Dv(e){return fd(ki(e))}function Ev(e,t){var n,r,s,l;return ud(this,void 0,void 0,function*(){try{for(n=dd(e);r=yield n.next(),!r.done;){let f=r.value;if(t.next(f),t.closed)return}}catch(f){s={error:f}}finally{try{r&&!r.done&&(l=n.return)&&(yield l.call(n))}finally{if(s)throw s.error}}t.complete()})}function en(e,t,n,r=0,s=!1){let l=t.schedule(function(){n(),s?e.add(this.schedule(null,r)):this.unsubscribe()},r);if(e.add(l),!s)return l}function Vi(e,t=0){return ht((n,r)=>{n.subscribe(gt(r,s=>en(r,e,()=>r.next(s),t),()=>en(r,e,()=>r.complete(),t),s=>en(r,e,()=>r.error(s),t)))})}function Hi(e,t=0){return ht((n,r)=>{r.add(e.schedule(()=>n.subscribe(r),t))})}function pd(e,t){return Vt(e).pipe(Hi(t),Vi(t))}function hd(e,t){return Vt(e).pipe(Hi(t),Vi(t))}function gd(e,t){return new xt(n=>{let r=0;return t.schedule(function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())})})}function md(e,t){return new xt(n=>{let r;return en(n,t,()=>{r=e[Li](),en(n,t,()=>{let s,l;try{({value:s,done:l}=r.next())}catch(f){n.error(f);return}l?n.complete():n.next(s)},0,!0)}),()=>rt(r?.return)&&r.return()})}function Bi(e,t){if(!e)throw new Error("Iterable cannot be null");return new xt(n=>{en(n,t,()=>{let r=e[Symbol.asyncIterator]();en(n,t,()=>{r.next().then(s=>{s.done?n.complete():n.next(s.value)})},0,!0)})})}function vd(e,t){return Bi(ki(e),t)}function bd(e,t){if(e!=null){if(_i(e))return pd(e,t);if(Ai(e))return gd(e,t);if(Ni(e))return hd(e,t);if(Ri(e))return Bi(e,t);if(Fi(e))return md(e,t);if(Pi(e))return vd(e,t)}throw Oi(e)}function kt(e,t){return t?bd(e,t):Vt(e)}function it(...e){let t=Zn(e);return kt(e,t)}function Vr(e,t){let n=rt(e)?e:()=>e,r=s=>s.error(n());return new xt(t?s=>t.schedule(r,0,s):r)}function Ua(e){return!!e&&(e instanceof xt||rt(e.lift)&&rt(e.subscribe))}var Vn=_r(e=>function(){e(this),this.name="EmptyError",this.message="no elements in sequence"});function mt(e,t){return ht((n,r)=>{let s=0;n.subscribe(gt(r,l=>{r.next(e.call(t,l,s++))}))})}var{isArray:xv}=Array;function Iv(e,t){return xv(t)?e(...t):e(t)}function yd(e){return mt(t=>Iv(e,t))}var{isArray:Mv}=Array,{getPrototypeOf:Sv,prototype:Tv,keys:Av}=Object;function wd(e){if(e.length===1){let t=e[0];if(Mv(t))return{args:t,keys:null};if(Nv(t)){let n=Av(t);return{args:n.map(r=>t[r]),keys:n}}}return{args:e,keys:null}}function Nv(e){return e&&typeof e=="object"&&Sv(e)===Tv}function Cd(e,t){return e.reduce((n,r,s)=>(n[r]=t[s],n),{})}function Ui(...e){let t=Zn(e),n=ad(e),{args:r,keys:s}=wd(e);if(r.length===0)return kt([],t);let l=new xt(_v(r,t,s?f=>Cd(s,f):on));return n?l.pipe(yd(n)):l}function _v(e,t,n=on){return r=>{jd(t,()=>{let{length:s}=e,l=new Array(s),f=s,u=s;for(let c=0;c<s;c++)jd(t,()=>{let g=kt(e[c],t),D=!1;g.subscribe(gt(r,I=>{l[c]=I,D||(D=!0,u--),u||r.next(n(l.slice()))},()=>{--f||r.complete()}))},r)},r)}}function jd(e,t,n){e?en(n,e,t):t()}function Dd(e,t,n,r,s,l,f,u){let c=[],g=0,D=0,I=!1,v=()=>{I&&!c.length&&!g&&t.complete()},p=j=>g<r?w(j):c.push(j),w=j=>{l&&t.next(j),g++;let b=!1;Vt(n(j,D++)).subscribe(gt(t,M=>{s?.(M),l?p(M):t.next(M)},()=>{b=!0},void 0,()=>{if(b)try{for(g--;c.length&&g<r;){let M=c.shift();f?en(t,f,()=>w(M)):w(M)}v()}catch(M){t.error(M)}}))};return e.subscribe(gt(t,p,()=>{I=!0,v()})),()=>{u?.()}}function Pt(e,t,n=1/0){return rt(t)?Pt((r,s)=>mt((l,f)=>t(r,l,s,f))(Vt(e(r,s))),n):(typeof t=="number"&&(n=t),ht((r,s)=>Dd(r,s,e,n)))}function $a(e=1/0){return Pt(on,e)}function Ed(){return $a(1)}function Hr(...e){return Ed()(kt(e,Zn(e)))}function $i(e){return new xt(t=>{Vt(e()).subscribe(t)})}function Cn(e,t){return ht((n,r)=>{let s=0;n.subscribe(gt(r,l=>e.call(t,l,s++)&&r.next(l)))})}function Xn(e){return ht((t,n)=>{let r=null,s=!1,l;r=t.subscribe(gt(n,void 0,void 0,f=>{l=Vt(e(f,Xn(e)(t))),r?(r.unsubscribe(),r=null,l.subscribe(n)):s=!0})),s&&(r.unsubscribe(),r=null,l.subscribe(n))})}function xd(e,t,n,r,s){return(l,f)=>{let u=n,c=t,g=0;l.subscribe(gt(f,D=>{let I=g++;c=u?e(c,D,I):(u=!0,D),r&&f.next(c)},s&&(()=>{u&&f.next(c),f.complete()})))}}function Br(e,t){return rt(t)?Pt(e,t,1):Pt(e,1)}function Qn(e){return ht((t,n)=>{let r=!1;t.subscribe(gt(n,s=>{r=!0,n.next(s)},()=>{r||n.next(e),n.complete()}))})}function Hn(e){return e<=0?()=>sn:ht((t,n)=>{let r=0;t.subscribe(gt(n,s=>{++r<=e&&(n.next(s),e<=r&&n.complete())}))})}function zi(e=Rv){return ht((t,n)=>{let r=!1;t.subscribe(gt(n,s=>{r=!0,n.next(s)},()=>r?n.complete():n.error(e())))})}function Rv(){return new Vn}function jo(e){return ht((t,n)=>{try{t.subscribe(n)}finally{n.add(e)}})}function Bn(e,t){let n=arguments.length>=2;return r=>r.pipe(e?Cn((s,l)=>e(s,l,r)):on,Hn(1),n?Qn(t):zi(()=>new Vn))}function Ur(e){return e<=0?()=>sn:ht((t,n)=>{let r=[];t.subscribe(gt(n,s=>{r.push(s),e<r.length&&r.shift()},()=>{for(let s of r)n.next(s);n.complete()},void 0,()=>{r=null}))})}function za(e,t){let n=arguments.length>=2;return r=>r.pipe(e?Cn((s,l)=>e(s,l,r)):on,Ur(1),n?Qn(t):zi(()=>new Vn))}function qa(e,t){return ht(xd(e,t,arguments.length>=2,!0))}function Wa(...e){let t=Zn(e);return ht((n,r)=>{(t?Hr(e,n,t):Hr(e,n)).subscribe(r)})}function jn(e,t){return ht((n,r)=>{let s=null,l=0,f=!1,u=()=>f&&!s&&r.complete();n.subscribe(gt(r,c=>{s?.unsubscribe();let g=0,D=l++;Vt(e(c,D)).subscribe(s=gt(r,I=>r.next(t?t(c,I,D,g++):I),()=>{s=null,u()}))},()=>{f=!0,u()}))})}function Ga(e){return ht((t,n)=>{Vt(e).subscribe(gt(n,()=>n.complete(),Co)),!n.closed&&t.subscribe(n)})}function zt(e,t,n){let r=rt(e)||t||n?{next:e,error:t,complete:n}:e;return r?ht((s,l)=>{var f;(f=r.subscribe)===null||f===void 0||f.call(r);let u=!0;s.subscribe(gt(l,c=>{var g;(g=r.next)===null||g===void 0||g.call(r,c),l.next(c)},()=>{var c;u=!1,(c=r.complete)===null||c===void 0||c.call(r),l.complete()},c=>{var g;u=!1,(g=r.error)===null||g===void 0||g.call(r,c),l.error(c)},()=>{var c,g;u&&((c=r.unsubscribe)===null||c===void 0||c.call(r)),(g=r.finalize)===null||g===void 0||g.call(r)}))}):on}var Ze=class extends Error{code;constructor(t,n){super(Bl(t,n)),this.code=t}};function Bl(e,t){return`${`NG0${Math.abs(e)}`}${t?": "+t:""}`}var df=Symbol("InputSignalNode#UNSET"),Lv=Mt(Ve({},Qc),{transformFn:void 0,applyValueToInputSignal(e,t){Xc(e,t)}});function ff(e,t){let n=Object.create(Lv);n.value=e,n.transformFn=t?.transform;function r(){if(Bc(n),n.value===df)throw new Ze(-950,!1);return n.value}return r[Nr]=n,r}function Fo(e){return{toString:e}.toString()}var qi="__parameters__";function Fv(e){return function(...n){if(e){let r=e(...n);for(let s in r)this[s]=r[s]}}}function pf(e,t,n){return Fo(()=>{let r=Fv(t);function s(...l){if(this instanceof s)return r.apply(this,l),this;let f=new s(...l);return u.annotation=f,u;function u(c,g,D){let I=c.hasOwnProperty(qi)?c[qi]:Object.defineProperty(c,qi,{value:[]})[qi];for(;I.length<=D;)I.push(null);return(I[D]=I[D]||[]).push(f),c}}return n&&(s.prototype=Object.create(n.prototype)),s.prototype.ngMetadataName=e,s.annotationCls=s,s})}function It(e){for(let t in e)if(e[t]===It)return t;throw Error("Could not find renamed property on target object.")}function tn(e){if(typeof e=="string")return e;if(Array.isArray(e))return"["+e.map(tn).join(", ")+"]";if(e==null)return""+e;if(e.overriddenName)return`${e.overriddenName}`;if(e.name)return`${e.name}`;let t=e.toString();if(t==null)return""+t;let n=t.indexOf(`
`);return n===-1?t:t.substring(0,n)}function Id(e,t){return e==null||e===""?t===null?"":t:t==null||t===""?e:e+" "+t}var kv=It({__forward_ref__:It});function hf(e){return e.__forward_ref__=hf,e.toString=function(){return tn(this())},e}function pn(e){return gf(e)?e():e}function gf(e){return typeof e=="function"&&e.hasOwnProperty(kv)&&e.__forward_ref__===hf}function tt(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function ys(e){return{providers:e.providers||[],imports:e.imports||[]}}function ws(e){return Md(e,vf)||Md(e,bf)}function mf(e){return ws(e)!==null}function Md(e,t){return e.hasOwnProperty(t)?e[t]:null}function Pv(e){let t=e&&(e[vf]||e[bf]);return t||null}function Sd(e){return e&&(e.hasOwnProperty(Td)||e.hasOwnProperty(Vv))?e[Td]:null}var vf=It({\u0275prov:It}),Td=It({\u0275inj:It}),bf=It({ngInjectableDef:It}),Vv=It({ngInjectorDef:It}),ot=class{_desc;ngMetadataName="InjectionToken";\u0275prov;constructor(t,n){this._desc=t,this.\u0275prov=void 0,typeof n=="number"?this.__NG_ELEMENT_ID__=n:n!==void 0&&(this.\u0275prov=tt({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function yf(e){return e&&!!e.\u0275providers}var Hv=It({\u0275cmp:It}),Bv=It({\u0275dir:It}),Uv=It({\u0275pipe:It}),$v=It({\u0275mod:It}),Qi=It({\u0275fac:It}),Io=It({__NG_ELEMENT_ID__:It}),Ad=It({__NG_ENV_ID__:It});function wf(e){return typeof e=="string"?e:e==null?"":String(e)}function zv(e){return typeof e=="function"?e.name||e.toString():typeof e=="object"&&e!=null&&typeof e.type=="function"?e.type.name||e.type.toString():wf(e)}function qv(e,t){let n=t?`. Dependency path: ${t.join(" > ")} > ${e}`:"";throw new Ze(-200,e)}function Ul(e,t){throw new Ze(-201,!1)}var ut=function(e){return e[e.Default=0]="Default",e[e.Host=1]="Host",e[e.Self=2]="Self",e[e.SkipSelf=4]="SkipSelf",e[e.Optional=8]="Optional",e}(ut||{}),nl;function Cf(){return nl}function fn(e){let t=nl;return nl=e,t}function jf(e,t,n){let r=ws(e);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(n&ut.Optional)return null;if(t!==void 0)return t;Ul(e,"Injector")}var Wv={},Mo=Wv,rl="__NG_DI_FLAG__",Ki="ngTempTokenPath",Gv="ngTokenPath",Yv=/\n/gm,Zv="\u0275",Nd="__source",Wr;function Xv(){return Wr}function Kn(e){let t=Wr;return Wr=e,t}function Qv(e,t=ut.Default){if(Wr===void 0)throw new Ze(-203,!1);return Wr===null?jf(e,void 0,t):Wr.get(e,t&ut.Optional?null:void 0,t)}function ft(e,t=ut.Default){return(Cf()||Qv)(pn(e),t)}function Oe(e,t=ut.Default){return ft(e,Cs(t))}function Cs(e){return typeof e>"u"||typeof e=="number"?e:0|(e.optional&&8)|(e.host&&1)|(e.self&&2)|(e.skipSelf&&4)}function ol(e){let t=[];for(let n=0;n<e.length;n++){let r=pn(e[n]);if(Array.isArray(r)){if(r.length===0)throw new Ze(900,!1);let s,l=ut.Default;for(let f=0;f<r.length;f++){let u=r[f],c=Kv(u);typeof c=="number"?c===-1?s=u.token:l|=c:s=u}t.push(ft(s,l))}else t.push(ft(r))}return t}function Df(e,t){return e[rl]=t,e.prototype[rl]=t,e}function Kv(e){return e[rl]}function Jv(e,t,n,r){let s=e[Ki];throw t[Nd]&&s.unshift(t[Nd]),e.message=e0(`
`+e.message,s,n,r),e[Gv]=s,e[Ki]=null,e}function e0(e,t,n,r=null){e=e&&e.charAt(0)===`
`&&e.charAt(1)==Zv?e.slice(2):e;let s=tn(t);if(Array.isArray(t))s=t.map(tn).join(" -> ");else if(typeof t=="object"){let l=[];for(let f in t)if(t.hasOwnProperty(f)){let u=t[f];l.push(f+":"+(typeof u=="string"?JSON.stringify(u):tn(u)))}s=`{${l.join(", ")}}`}return`${n}${r?"("+r+")":""}[${s}]: ${e.replace(Yv,`
  `)}`}var Ef=Df(pf("Optional"),8);var t0=Df(pf("SkipSelf"),4);function Yr(e,t){let n=e.hasOwnProperty(Qi);return n?e[Qi]:null}function $l(e,t){e.forEach(n=>Array.isArray(n)?$l(n,t):t(n))}function xf(e,t,n){t>=e.length?e.push(n):e.splice(t,0,n)}function Ji(e,t){return t>=e.length-1?e.pop():e.splice(t,1)[0]}var So={},Nn=[],Zr=new ot(""),If=new ot("",-1),Mf=new ot(""),es=class{get(t,n=Mo){if(n===Mo){let r=new Error(`NullInjectorError: No provider for ${tn(t)}!`);throw r.name="NullInjectorError",r}return n}};function Sf(e,t){let n=e[$v]||null;if(!n&&t===!0)throw new Error(`Type ${tn(e)} does not have '\u0275mod' property.`);return n}function mr(e){return e[Hv]||null}function Tf(e){return e[Bv]||null}function Af(e){return e[Uv]||null}function Nf(e){let t=mr(e)||Tf(e)||Af(e);return t!==null&&t.standalone}function js(e){return{\u0275providers:e}}function n0(...e){return{\u0275providers:_f(!0,e),\u0275fromNgModule:!0}}function _f(e,...t){let n=[],r=new Set,s,l=f=>{n.push(f)};return $l(t,f=>{let u=f;il(u,l,[],r)&&(s||=[],s.push(u))}),s!==void 0&&Rf(s,l),n}function Rf(e,t){for(let n=0;n<e.length;n++){let{ngModule:r,providers:s}=e[n];zl(s,l=>{t(l,r)})}}function il(e,t,n,r){if(e=pn(e),!e)return!1;let s=null,l=Sd(e),f=!l&&mr(e);if(!l&&!f){let c=e.ngModule;if(l=Sd(c),l)s=c;else return!1}else{if(f&&!f.standalone)return!1;s=e}let u=r.has(s);if(f){if(u)return!1;if(r.add(s),f.dependencies){let c=typeof f.dependencies=="function"?f.dependencies():f.dependencies;for(let g of c)il(g,t,n,r)}}else if(l){if(l.imports!=null&&!u){r.add(s);let g;try{$l(l.imports,D=>{il(D,t,n,r)&&(g||=[],g.push(D))})}finally{}g!==void 0&&Rf(g,t)}if(!u){let g=Yr(s)||(()=>new s);t({provide:s,useFactory:g,deps:Nn},s),t({provide:Mf,useValue:s,multi:!0},s),t({provide:Zr,useValue:()=>ft(s),multi:!0},s)}let c=l.providers;if(c!=null&&!u){let g=e;zl(c,D=>{t(D,g)})}}else return!1;return s!==e&&e.providers!==void 0}function zl(e,t){for(let n of e)yf(n)&&(n=n.\u0275providers),Array.isArray(n)?zl(n,t):t(n)}var r0=It({provide:String,useValue:It});function Of(e){return e!==null&&typeof e=="object"&&r0 in e}function o0(e){return!!(e&&e.useExisting)}function i0(e){return!!(e&&e.useFactory)}function sl(e){return typeof e=="function"}var Ds=new ot(""),Wi={},s0={},Ya;function ql(){return Ya===void 0&&(Ya=new es),Ya}var mn=class{},To=class extends mn{parent;source;scopes;records=new Map;_ngOnDestroyHooks=new Set;_onDestroyHooks=[];get destroyed(){return this._destroyed}_destroyed=!1;injectorDefTypes;constructor(t,n,r,s){super(),this.parent=n,this.source=r,this.scopes=s,ll(t,f=>this.processProvider(f)),this.records.set(If,$r(void 0,this)),s.has("environment")&&this.records.set(mn,$r(void 0,this));let l=this.records.get(Ds);l!=null&&typeof l.value=="string"&&this.scopes.add(l.value),this.injectorDefTypes=new Set(this.get(Mf,Nn,ut.Self))}destroy(){Eo(this),this._destroyed=!0;let t=wt(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let n=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of n)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),wt(t)}}onDestroy(t){return Eo(this),this._onDestroyHooks.push(t),()=>this.removeOnDestroy(t)}runInContext(t){Eo(this);let n=Kn(this),r=fn(void 0),s;try{return t()}finally{Kn(n),fn(r)}}get(t,n=Mo,r=ut.Default){if(Eo(this),t.hasOwnProperty(Ad))return t[Ad](this);r=Cs(r);let s,l=Kn(this),f=fn(void 0);try{if(!(r&ut.SkipSelf)){let c=this.records.get(t);if(c===void 0){let g=f0(t)&&ws(t);g&&this.injectableDefInScope(g)?c=$r(al(t),Wi):c=null,this.records.set(t,c)}if(c!=null)return this.hydrate(t,c)}let u=r&ut.Self?ql():this.parent;return n=r&ut.Optional&&n===Mo?null:n,u.get(t,n)}catch(u){if(u.name==="NullInjectorError"){if((u[Ki]=u[Ki]||[]).unshift(tn(t)),l)throw u;return Jv(u,t,"R3InjectorError",this.source)}else throw u}finally{fn(f),Kn(l)}}resolveInjectorInitializers(){let t=wt(null),n=Kn(this),r=fn(void 0),s;try{let l=this.get(Zr,Nn,ut.Self);for(let f of l)f()}finally{Kn(n),fn(r),wt(t)}}toString(){let t=[],n=this.records;for(let r of n.keys())t.push(tn(r));return`R3Injector[${t.join(", ")}]`}processProvider(t){t=pn(t);let n=sl(t)?t:pn(t&&t.provide),r=l0(t);if(!sl(t)&&t.multi===!0){let s=this.records.get(n);s||(s=$r(void 0,Wi,!0),s.factory=()=>ol(s.multi),this.records.set(n,s)),n=t,s.multi.push(t)}this.records.set(n,r)}hydrate(t,n){let r=wt(null);try{return n.value===Wi&&(n.value=s0,n.value=n.factory()),typeof n.value=="object"&&n.value&&d0(n.value)&&this._ngOnDestroyHooks.add(n.value),n.value}finally{wt(r)}}injectableDefInScope(t){if(!t.providedIn)return!1;let n=pn(t.providedIn);return typeof n=="string"?n==="any"||this.scopes.has(n):this.injectorDefTypes.has(n)}removeOnDestroy(t){let n=this._onDestroyHooks.indexOf(t);n!==-1&&this._onDestroyHooks.splice(n,1)}};function al(e){let t=ws(e),n=t!==null?t.factory:Yr(e);if(n!==null)return n;if(e instanceof ot)throw new Ze(204,!1);if(e instanceof Function)return a0(e);throw new Ze(204,!1)}function a0(e){if(e.length>0)throw new Ze(204,!1);let n=Pv(e);return n!==null?()=>n.factory(e):()=>new e}function l0(e){if(Of(e))return $r(void 0,e.useValue);{let t=u0(e);return $r(t,Wi)}}function u0(e,t,n){let r;if(sl(e)){let s=pn(e);return Yr(s)||al(s)}else if(Of(e))r=()=>pn(e.useValue);else if(i0(e))r=()=>e.useFactory(...ol(e.deps||[]));else if(o0(e))r=()=>ft(pn(e.useExisting));else{let s=pn(e&&(e.useClass||e.provide));if(c0(e))r=()=>new s(...ol(e.deps));else return Yr(s)||al(s)}return r}function Eo(e){if(e.destroyed)throw new Ze(205,!1)}function $r(e,t,n=!1){return{factory:e,value:t,multi:n?[]:void 0}}function c0(e){return!!e.deps}function d0(e){return e!==null&&typeof e=="object"&&typeof e.ngOnDestroy=="function"}function f0(e){return typeof e=="function"||typeof e=="object"&&e instanceof ot}function ll(e,t){for(let n of e)Array.isArray(n)?ll(n,t):n&&yf(n)?ll(n.\u0275providers,t):t(n)}function xn(e,t){e instanceof To&&Eo(e);let n,r=Kn(e),s=fn(void 0);try{return t()}finally{Kn(r),fn(s)}}function p0(){return Cf()!==void 0||Xv()!=null}function h0(e){return typeof e=="function"}var $n=0,vt=1,et=2,Kt=3,En=4,In=5,ts=6,ns=7,Rn=8,Xr=9,er=10,nn=11,Ao=12,_d=13,to=14,On=15,Qr=16,zr=17,Kr=18,Es=19,Lf=20,Jn=21,Za=22,rs=23,ln=24,Un=25,Ff=1;var vr=7,os=8,is=9,gn=10;function hr(e){return Array.isArray(e)&&typeof e[Ff]=="object"}function zn(e){return Array.isArray(e)&&e[Ff]===!0}function kf(e){return(e.flags&4)!==0}function xs(e){return e.componentOffset>-1}function Wl(e){return(e.flags&1)===1}function ko(e){return!!e.template}function ul(e){return(e[et]&512)!==0}function Po(e){return(e[et]&256)===256}var cl=class{previousValue;currentValue;firstChange;constructor(t,n,r){this.previousValue=t,this.currentValue=n,this.firstChange=r}isFirstChange(){return this.firstChange}};function Pf(e,t,n,r){t!==null?t.applyValueToInputSignal(t,r):e[n]=r}var Gl=(()=>{let e=()=>Vf;return e.ngInherit=!0,e})();function Vf(e){return e.type.prototype.ngOnChanges&&(e.setInput=m0),g0}function g0(){let e=Bf(this),t=e?.current;if(t){let n=e.previous;if(n===So)e.previous=t;else for(let r in t)n[r]=t[r];e.current=null,this.ngOnChanges(t)}}function m0(e,t,n,r,s){let l=this.declaredInputs[r],f=Bf(e)||v0(e,{previous:So,current:null}),u=f.current||(f.current={}),c=f.previous,g=c[l];u[l]=new cl(g&&g.currentValue,n,c===So),Pf(e,t,s,n)}var Hf="__ngSimpleChanges__";function Bf(e){return e[Hf]||null}function v0(e,t){return e[Hf]=t}var Rd=null;var hn=function(e,t,n){Rd?.(e,t,n)},b0="svg",y0="math";function Ln(e){for(;Array.isArray(e);)e=e[$n];return e}function w0(e,t){return Ln(t[e])}function Mn(e,t){return Ln(t[e.index])}function Uf(e,t){return e.data[t]}function jr(e,t){let n=t[e];return hr(n)?n:n[$n]}function Yl(e){return(e[et]&128)===128}function C0(e){return zn(e[Kt])}function ss(e,t){return t==null?null:e[t]}function $f(e){e[zr]=0}function Zl(e){e[et]&1024||(e[et]|=1024,Yl(e)&&Ms(e))}function j0(e,t){for(;e>0;)t=t[to],e--;return t}function Is(e){return!!(e[et]&9216||e[ln]?.dirty)}function dl(e){e[er].changeDetectionScheduler?.notify(9),e[et]&64&&(e[et]|=1024),Is(e)&&Ms(e)}function Ms(e){e[er].changeDetectionScheduler?.notify(0);let t=br(e);for(;t!==null&&!(t[et]&8192||(t[et]|=8192,!Yl(t)));)t=br(t)}function zf(e,t){if(Po(e))throw new Ze(911,!1);e[Jn]===null&&(e[Jn]=[]),e[Jn].push(t)}function D0(e,t){if(e[Jn]===null)return;let n=e[Jn].indexOf(t);n!==-1&&e[Jn].splice(n,1)}function br(e){let t=e[Kt];return zn(t)?t[Kt]:t}function E0(e){return e[ns]??=[]}function x0(e){return e.cleanup??=[]}var bt={lFrame:Jf(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var fl=!1;function I0(){return bt.lFrame.elementDepthCount}function M0(){bt.lFrame.elementDepthCount++}function S0(){bt.lFrame.elementDepthCount--}function qf(){return bt.bindingsEnabled}function T0(){return bt.skipHydrationRootTNode!==null}function A0(e){return bt.skipHydrationRootTNode===e}function N0(){bt.skipHydrationRootTNode=null}function qt(){return bt.lFrame.lView}function Dr(){return bt.lFrame.tView}function Sn(){let e=Wf();for(;e!==null&&e.type===64;)e=e.parent;return e}function Wf(){return bt.lFrame.currentTNode}function _0(){let e=bt.lFrame,t=e.currentTNode;return e.isParent?t:t.parent}function Vo(e,t){let n=bt.lFrame;n.currentTNode=e,n.isParent=t}function Gf(){return bt.lFrame.isParent}function R0(){bt.lFrame.isParent=!1}function Yf(){return fl}function Od(e){let t=fl;return fl=e,t}function O0(e){return bt.lFrame.bindingIndex=e}function Zf(){return bt.lFrame.bindingIndex++}function L0(){return bt.lFrame.inI18n}function F0(e,t){let n=bt.lFrame;n.bindingIndex=n.bindingRootIndex=e,pl(t)}function k0(){return bt.lFrame.currentDirectiveIndex}function pl(e){bt.lFrame.currentDirectiveIndex=e}function Xf(e){bt.lFrame.currentQueryIndex=e}function P0(e){let t=e[vt];return t.type===2?t.declTNode:t.type===1?e[In]:null}function Qf(e,t,n){if(n&ut.SkipSelf){let s=t,l=e;for(;s=s.parent,s===null&&!(n&ut.Host);)if(s=P0(l),s===null||(l=l[to],s.type&10))break;if(s===null)return!1;t=s,e=l}let r=bt.lFrame=Kf();return r.currentTNode=t,r.lView=e,!0}function Xl(e){let t=Kf(),n=e[vt];bt.lFrame=t,t.currentTNode=n.firstChild,t.lView=e,t.tView=n,t.contextLView=e,t.bindingIndex=n.bindingStartIndex,t.inI18n=!1}function Kf(){let e=bt.lFrame,t=e===null?null:e.child;return t===null?Jf(e):t}function Jf(e){let t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:e,child:null,inI18n:!1};return e!==null&&(e.child=t),t}function ep(){let e=bt.lFrame;return bt.lFrame=e.parent,e.currentTNode=null,e.lView=null,e}var tp=ep;function Ql(){let e=ep();e.isParent=!0,e.tView=null,e.selectedIndex=-1,e.contextLView=null,e.elementDepthCount=0,e.currentDirectiveIndex=-1,e.currentNamespace=null,e.bindingRootIndex=-1,e.bindingIndex=-1,e.currentQueryIndex=0}function V0(e){return(bt.lFrame.contextLView=j0(e,bt.lFrame.contextLView))[Rn]}function Kl(){return bt.lFrame.selectedIndex}function yr(e){bt.lFrame.selectedIndex=e}function H0(){let e=bt.lFrame;return Uf(e.tView,e.selectedIndex)}function B0(){return bt.lFrame.currentNamespace}var np=!0;function Jl(){return np}function eu(e){np=e}function U0(e,t,n){let{ngOnChanges:r,ngOnInit:s,ngDoCheck:l}=t.type.prototype;if(r){let f=Vf(t);(n.preOrderHooks??=[]).push(e,f),(n.preOrderCheckHooks??=[]).push(e,f)}s&&(n.preOrderHooks??=[]).push(0-e,s),l&&((n.preOrderHooks??=[]).push(e,l),(n.preOrderCheckHooks??=[]).push(e,l))}function tu(e,t){for(let n=t.directiveStart,r=t.directiveEnd;n<r;n++){let l=e.data[n].type.prototype,{ngAfterContentInit:f,ngAfterContentChecked:u,ngAfterViewInit:c,ngAfterViewChecked:g,ngOnDestroy:D}=l;f&&(e.contentHooks??=[]).push(-n,f),u&&((e.contentHooks??=[]).push(n,u),(e.contentCheckHooks??=[]).push(n,u)),c&&(e.viewHooks??=[]).push(-n,c),g&&((e.viewHooks??=[]).push(n,g),(e.viewCheckHooks??=[]).push(n,g)),D!=null&&(e.destroyHooks??=[]).push(n,D)}}function Gi(e,t,n){rp(e,t,3,n)}function Yi(e,t,n,r){(e[et]&3)===n&&rp(e,t,n,r)}function Xa(e,t){let n=e[et];(n&3)===t&&(n&=16383,n+=1,e[et]=n)}function rp(e,t,n,r){let s=r!==void 0?e[zr]&65535:0,l=r??-1,f=t.length-1,u=0;for(let c=s;c<f;c++)if(typeof t[c+1]=="number"){if(u=t[c],r!=null&&u>=r)break}else t[c]<0&&(e[zr]+=65536),(u<l||l==-1)&&($0(e,n,t,c),e[zr]=(e[zr]&4294901760)+c+2),c++}function Ld(e,t){hn(4,e,t);let n=wt(null);try{t.call(e)}finally{wt(n),hn(5,e,t)}}function $0(e,t,n,r){let s=n[r]<0,l=n[r+1],f=s?-n[r]:n[r],u=e[f];s?e[et]>>14<e[zr]>>16&&(e[et]&3)===t&&(e[et]+=16384,Ld(u,l)):Ld(u,l)}var Gr=-1,No=class{factory;injectImpl;resolving=!1;canSeeViewProviders;multi;componentProviders;index;providerFactory;constructor(t,n,r){this.factory=t,this.canSeeViewProviders=n,this.injectImpl=r}};function z0(e){return e instanceof No}function q0(e){return(e.flags&8)!==0}function W0(e){return(e.flags&16)!==0}function G0(e,t,n){let r=0;for(;r<n.length;){let s=n[r];if(typeof s=="number"){if(s!==0)break;r++;let l=n[r++],f=n[r++],u=n[r++];e.setAttribute(t,f,u,l)}else{let l=s,f=n[++r];Z0(l)?e.setProperty(t,l,f):e.setAttribute(t,l,f),r++}}return r}function Y0(e){return e===3||e===4||e===6}function Z0(e){return e.charCodeAt(0)===64}function as(e,t){if(!(t===null||t.length===0))if(e===null||e.length===0)e=t.slice();else{let n=-1;for(let r=0;r<t.length;r++){let s=t[r];typeof s=="number"?n=s:n===0||(n===-1||n===2?Fd(e,n,s,null,t[++r]):Fd(e,n,s,null,null))}}return e}function Fd(e,t,n,r,s){let l=0,f=e.length;if(t===-1)f=-1;else for(;l<e.length;){let u=e[l++];if(typeof u=="number"){if(u===t){f=-1;break}else if(u>t){f=l-1;break}}}for(;l<e.length;){let u=e[l];if(typeof u=="number")break;if(u===n){if(r===null){s!==null&&(e[l+1]=s);return}else if(r===e[l+1]){e[l+2]=s;return}}l++,r!==null&&l++,s!==null&&l++}f!==-1&&(e.splice(f,0,t),l=f+1),e.splice(l++,0,n),r!==null&&e.splice(l++,0,r),s!==null&&e.splice(l++,0,s)}var Qa={},hl=class{injector;parentInjector;constructor(t,n){this.injector=t,this.parentInjector=n}get(t,n,r){r=Cs(r);let s=this.injector.get(t,Qa,r);return s!==Qa||n===Qa?s:this.parentInjector.get(t,n,r)}};function op(e){return e!==Gr}function ls(e){return e&32767}function X0(e){return e>>16}function us(e,t){let n=X0(e),r=t;for(;n>0;)r=r[to],n--;return r}var gl=!0;function kd(e){let t=gl;return gl=e,t}var Q0=256,ip=Q0-1,sp=5,K0=0,_n={};function J0(e,t,n){let r;typeof n=="string"?r=n.charCodeAt(0)||0:n.hasOwnProperty(Io)&&(r=n[Io]),r==null&&(r=n[Io]=K0++);let s=r&ip,l=1<<s;t.data[e+(s>>sp)]|=l}function ap(e,t){let n=lp(e,t);if(n!==-1)return n;let r=t[vt];r.firstCreatePass&&(e.injectorIndex=t.length,Ka(r.data,e),Ka(t,null),Ka(r.blueprint,null));let s=nu(e,t),l=e.injectorIndex;if(op(s)){let f=ls(s),u=us(s,t),c=u[vt].data;for(let g=0;g<8;g++)t[l+g]=u[f+g]|c[f+g]}return t[l+8]=s,l}function Ka(e,t){e.push(0,0,0,0,0,0,0,0,t)}function lp(e,t){return e.injectorIndex===-1||e.parent&&e.parent.injectorIndex===e.injectorIndex||t[e.injectorIndex+8]===null?-1:e.injectorIndex}function nu(e,t){if(e.parent&&e.parent.injectorIndex!==-1)return e.parent.injectorIndex;let n=0,r=null,s=t;for(;s!==null;){if(r=pp(s),r===null)return Gr;if(n++,s=s[to],r.injectorIndex!==-1)return r.injectorIndex|n<<16}return Gr}function eb(e,t,n){J0(e,t,n)}function up(e,t,n){if(n&ut.Optional||e!==void 0)return e;Ul(t,"NodeInjector")}function cp(e,t,n,r){if(n&ut.Optional&&r===void 0&&(r=null),!(n&(ut.Self|ut.Host))){let s=e[Xr],l=fn(void 0);try{return s?s.get(t,r,n&ut.Optional):jf(t,r,n&ut.Optional)}finally{fn(l)}}return up(r,t,n)}function dp(e,t,n,r=ut.Default,s){if(e!==null){if(t[et]&2048&&!(r&ut.Self)){let f=ib(e,t,n,r,_n);if(f!==_n)return f}let l=fp(e,t,n,r,_n);if(l!==_n)return l}return cp(t,n,r,s)}function fp(e,t,n,r,s){let l=rb(n);if(typeof l=="function"){if(!Qf(t,e,r))return r&ut.Host?up(s,n,r):cp(t,n,r,s);try{let f;if(f=l(r),f==null&&!(r&ut.Optional))Ul(n);else return f}finally{tp()}}else if(typeof l=="number"){let f=null,u=lp(e,t),c=Gr,g=r&ut.Host?t[On][In]:null;for((u===-1||r&ut.SkipSelf)&&(c=u===-1?nu(e,t):t[u+8],c===Gr||!Vd(r,!1)?u=-1:(f=t[vt],u=ls(c),t=us(c,t)));u!==-1;){let D=t[vt];if(Pd(l,u,D.data)){let I=tb(u,t,n,f,r,g);if(I!==_n)return I}c=t[u+8],c!==Gr&&Vd(r,t[vt].data[u+8]===g)&&Pd(l,u,t)?(f=D,u=ls(c),t=us(c,t)):u=-1}}return s}function tb(e,t,n,r,s,l){let f=t[vt],u=f.data[e+8],c=r==null?xs(u)&&gl:r!=f&&(u.type&3)!==0,g=s&ut.Host&&l===u,D=nb(u,f,n,c,g);return D!==null?_o(t,f,D,u):_n}function nb(e,t,n,r,s){let l=e.providerIndexes,f=t.data,u=l&1048575,c=e.directiveStart,g=e.directiveEnd,D=l>>20,I=r?u:u+D,v=s?u+D:g;for(let p=I;p<v;p++){let w=f[p];if(p<c&&n===w||p>=c&&w.type===n)return p}if(s){let p=f[c];if(p&&ko(p)&&p.type===n)return c}return null}function _o(e,t,n,r){let s=e[n],l=t.data;if(z0(s)){let f=s;f.resolving&&qv(zv(l[n]));let u=kd(f.canSeeViewProviders);f.resolving=!0;let c,g=f.injectImpl?fn(f.injectImpl):null,D=Qf(e,r,ut.Default);try{s=e[n]=f.factory(void 0,l,e,r),t.firstCreatePass&&n>=r.directiveStart&&U0(n,l[n],t)}finally{g!==null&&fn(g),kd(u),f.resolving=!1,tp()}}return s}function rb(e){if(typeof e=="string")return e.charCodeAt(0)||0;let t=e.hasOwnProperty(Io)?e[Io]:void 0;return typeof t=="number"?t>=0?t&ip:ob:t}function Pd(e,t,n){let r=1<<e;return!!(n[t+(e>>sp)]&r)}function Vd(e,t){return!(e&ut.Self)&&!(e&ut.Host&&t)}var gr=class{_tNode;_lView;constructor(t,n){this._tNode=t,this._lView=n}get(t,n,r){return dp(this._tNode,this._lView,t,Cs(r),n)}};function ob(){return new gr(Sn(),qt())}function ru(e){return Fo(()=>{let t=e.prototype.constructor,n=t[Qi]||ml(t),r=Object.prototype,s=Object.getPrototypeOf(e.prototype).constructor;for(;s&&s!==r;){let l=s[Qi]||ml(s);if(l&&l!==n)return l;s=Object.getPrototypeOf(s)}return l=>new l})}function ml(e){return gf(e)?()=>{let t=ml(pn(e));return t&&t()}:Yr(e)}function ib(e,t,n,r,s){let l=e,f=t;for(;l!==null&&f!==null&&f[et]&2048&&!(f[et]&512);){let u=fp(l,f,n,r|ut.Self,_n);if(u!==_n)return u;let c=l.parent;if(!c){let g=f[Lf];if(g){let D=g.get(n,_n,r);if(D!==_n)return D}c=pp(f),f=f[to]}l=c}return s}function pp(e){let t=e[vt],n=t.type;return n===2?t.declTNode:n===1?e[In]:null}function Hd(e,t=null,n=null,r){let s=hp(e,t,n,r);return s.resolveInjectorInitializers(),s}function hp(e,t=null,n=null,r,s=new Set){let l=[n||Nn,n0(e)];return r=r||(typeof e=="object"?void 0:tn(e)),new To(l,t||ql(),r||null,s)}var Fn=class e{static THROW_IF_NOT_FOUND=Mo;static NULL=new es;static create(t,n){if(Array.isArray(t))return Hd({name:""},n,t,"");{let r=t.name??"";return Hd({name:r},t.parent,t.providers,r)}}static \u0275prov=tt({token:e,providedIn:"any",factory:()=>ft(If)});static __NG_ELEMENT_ID__=-1};var sb=new ot("");sb.__NG_ELEMENT_ID__=e=>{let t=Sn();if(t===null)throw new Ze(204,!1);if(t.type&2)return t.value;if(e&ut.Optional)return null;throw new Ze(204,!1)};var gp=!1,mp=(()=>{class e{static __NG_ELEMENT_ID__=ab;static __NG_ENV_ID__=n=>n}return e})(),vl=class extends mp{_lView;constructor(t){super(),this._lView=t}onDestroy(t){return zf(this._lView,t),()=>D0(this._lView,t)}};function ab(){return new vl(qt())}var Ro=class{},Ss=new ot("",{providedIn:"root",factory:()=>!1});var vp=new ot(""),bp=new ot(""),no=(()=>{class e{taskId=0;pendingTasks=new Set;get _hasPendingTasks(){return this.hasPendingTasks.value}hasPendingTasks=new $t(!1);add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let n=this.taskId++;return this.pendingTasks.add(n),n}has(n){return this.pendingTasks.has(n)}remove(n){this.pendingTasks.delete(n),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static \u0275prov=tt({token:e,providedIn:"root",factory:()=>new e})}return e})();var bl=class extends Yt{__isAsync;destroyRef=void 0;pendingTasks=void 0;constructor(t=!1){super(),this.__isAsync=t,p0()&&(this.destroyRef=Oe(mp,{optional:!0})??void 0,this.pendingTasks=Oe(no,{optional:!0})??void 0)}emit(t){let n=wt(null);try{super.next(t)}finally{wt(n)}}subscribe(t,n,r){let s=t,l=n||(()=>null),f=r;if(t&&typeof t=="object"){let c=t;s=c.next?.bind(c),l=c.error?.bind(c),f=c.complete?.bind(c)}this.__isAsync&&(l=this.wrapInTimeout(l),s&&(s=this.wrapInTimeout(s)),f&&(f=this.wrapInTimeout(f)));let u=super.subscribe({next:s,error:l,complete:f});return t instanceof Rt&&t.add(u),u}wrapInTimeout(t){return n=>{let r=this.pendingTasks?.add();setTimeout(()=>{t(n),r!==void 0&&this.pendingTasks?.remove(r)})}}},an=bl;function cs(...e){}function yp(e){let t,n;function r(){e=cs;try{n!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(n),t!==void 0&&clearTimeout(t)}catch{}}return t=setTimeout(()=>{e(),r()}),typeof requestAnimationFrame=="function"&&(n=requestAnimationFrame(()=>{e(),r()})),()=>r()}function Bd(e){return queueMicrotask(()=>e()),()=>{e=cs}}var ou="isAngularZone",ds=ou+"_ID",lb=0,Ht=class e{hasPendingMacrotasks=!1;hasPendingMicrotasks=!1;isStable=!0;onUnstable=new an(!1);onMicrotaskEmpty=new an(!1);onStable=new an(!1);onError=new an(!1);constructor(t){let{enableLongStackTrace:n=!1,shouldCoalesceEventChangeDetection:r=!1,shouldCoalesceRunChangeDetection:s=!1,scheduleInRootZone:l=gp}=t;if(typeof Zone>"u")throw new Ze(908,!1);Zone.assertZonePatched();let f=this;f._nesting=0,f._outer=f._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(f._inner=f._inner.fork(new Zone.TaskTrackingZoneSpec)),n&&Zone.longStackTraceZoneSpec&&(f._inner=f._inner.fork(Zone.longStackTraceZoneSpec)),f.shouldCoalesceEventChangeDetection=!s&&r,f.shouldCoalesceRunChangeDetection=s,f.callbackScheduled=!1,f.scheduleInRootZone=l,db(f)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(ou)===!0}static assertInAngularZone(){if(!e.isInAngularZone())throw new Ze(909,!1)}static assertNotInAngularZone(){if(e.isInAngularZone())throw new Ze(909,!1)}run(t,n,r){return this._inner.run(t,n,r)}runTask(t,n,r,s){let l=this._inner,f=l.scheduleEventTask("NgZoneEvent: "+s,t,ub,cs,cs);try{return l.runTask(f,n,r)}finally{l.cancelTask(f)}}runGuarded(t,n,r){return this._inner.runGuarded(t,n,r)}runOutsideAngular(t){return this._outer.run(t)}},ub={};function iu(e){if(e._nesting==0&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular(()=>e.onStable.emit(null))}finally{e.isStable=!0}}}function cb(e){if(e.isCheckStableRunning||e.callbackScheduled)return;e.callbackScheduled=!0;function t(){yp(()=>{e.callbackScheduled=!1,yl(e),e.isCheckStableRunning=!0,iu(e),e.isCheckStableRunning=!1})}e.scheduleInRootZone?Zone.root.run(()=>{t()}):e._outer.run(()=>{t()}),yl(e)}function db(e){let t=()=>{cb(e)},n=lb++;e._inner=e._inner.fork({name:"angular",properties:{[ou]:!0,[ds]:n,[ds+n]:!0},onInvokeTask:(r,s,l,f,u,c)=>{if(fb(c))return r.invokeTask(l,f,u,c);try{return Ud(e),r.invokeTask(l,f,u,c)}finally{(e.shouldCoalesceEventChangeDetection&&f.type==="eventTask"||e.shouldCoalesceRunChangeDetection)&&t(),$d(e)}},onInvoke:(r,s,l,f,u,c,g)=>{try{return Ud(e),r.invoke(l,f,u,c,g)}finally{e.shouldCoalesceRunChangeDetection&&!e.callbackScheduled&&!pb(c)&&t(),$d(e)}},onHasTask:(r,s,l,f)=>{r.hasTask(l,f),s===l&&(f.change=="microTask"?(e._hasPendingMicrotasks=f.microTask,yl(e),iu(e)):f.change=="macroTask"&&(e.hasPendingMacrotasks=f.macroTask))},onHandleError:(r,s,l,f)=>(r.handleError(l,f),e.runOutsideAngular(()=>e.onError.emit(f)),!1)})}function yl(e){e._hasPendingMicrotasks||(e.shouldCoalesceEventChangeDetection||e.shouldCoalesceRunChangeDetection)&&e.callbackScheduled===!0?e.hasPendingMicrotasks=!0:e.hasPendingMicrotasks=!1}function Ud(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function $d(e){e._nesting--,iu(e)}var wl=class{hasPendingMicrotasks=!1;hasPendingMacrotasks=!1;isStable=!0;onUnstable=new an;onMicrotaskEmpty=new an;onStable=new an;onError=new an;run(t,n,r){return t.apply(n,r)}runGuarded(t,n,r){return t.apply(n,r)}runOutsideAngular(t){return t()}runTask(t,n,r,s){return t.apply(n,r)}};function fb(e){return wp(e,"__ignore_ng_zone__")}function pb(e){return wp(e,"__scheduler_tick__")}function wp(e,t){return!Array.isArray(e)||e.length!==1?!1:e[0]?.data?.[t]===!0}var tr=class{_console=console;handleError(t){this._console.error("ERROR",t)}},hb=new ot("",{providedIn:"root",factory:()=>{let e=Oe(Ht),t=Oe(tr);return n=>e.runOutsideAngular(()=>t.handleError(n))}});function zd(e,t){return ff(e,t)}function gb(e){return ff(df,e)}var Cp=(zd.required=gb,zd);function mb(){return Ts(Sn(),qt())}function Ts(e,t){return new As(Mn(e,t))}var As=(()=>{class e{nativeElement;constructor(n){this.nativeElement=n}static __NG_ELEMENT_ID__=mb}return e})();var qd=new Set;function su(e){qd.has(e)||(qd.add(e),performance?.mark?.("mark_feature_usage",{detail:{feature:e}}))}function jp(e){return(e.flags&128)===128}var Dp=function(e){return e[e.OnPush=0]="OnPush",e[e.Default=1]="Default",e}(Dp||{}),Ep=new Map,vb=0;function bb(){return vb++}function yb(e){Ep.set(e[Es],e)}function Cl(e){Ep.delete(e[Es])}var Wd="__ngContext__";function wr(e,t){hr(t)?(e[Wd]=t[Es],yb(t)):e[Wd]=t}function xp(e){return Mp(e[Ao])}function Ip(e){return Mp(e[En])}function Mp(e){for(;e!==null&&!zn(e);)e=e[En];return e}var jl;function Sp(e){jl=e}function wb(){if(jl!==void 0)return jl;if(typeof document<"u")return document;throw new Ze(210,!1)}var au=new ot("",{providedIn:"root",factory:()=>Cb}),Cb="ng",lu=new ot(""),ro=new ot("",{providedIn:"platform",factory:()=>"unknown"});var uu=new ot("",{providedIn:"root",factory:()=>wb().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var jb="h",Db="b";var Tp=!1,Eb=new ot("",{providedIn:"root",factory:()=>Tp});var Ap=function(e){return e[e.CHANGE_DETECTION=0]="CHANGE_DETECTION",e[e.AFTER_NEXT_RENDER=1]="AFTER_NEXT_RENDER",e}(Ap||{}),Ns=new ot("");var xb=(()=>{class e{impl=null;execute(){this.impl?.execute()}static \u0275prov=tt({token:e,providedIn:"root",factory:()=>new e})}return e})();var Ib=()=>null;function cu(e,t,n=!1){return Ib(e,t,n)}function Np(e,t){let n=e.contentQueries;if(n!==null){let r=wt(null);try{for(let s=0;s<n.length;s+=2){let l=n[s],f=n[s+1];if(f!==-1){let u=e.data[f];Xf(l),u.contentQueries(2,t[f],f)}}}finally{wt(r)}}}function Dl(e,t,n){Xf(0);let r=wt(null);try{t(e,n)}finally{wt(r)}}function _p(e,t,n){if(kf(t)){let r=wt(null);try{let s=t.directiveStart,l=t.directiveEnd;for(let f=s;f<l;f++){let u=e.data[f];if(u.contentQueries){let c=n[f];u.contentQueries(1,c,f)}}}finally{wt(r)}}}var kn=function(e){return e[e.Emulated=0]="Emulated",e[e.None=2]="None",e[e.ShadowDom=3]="ShadowDom",e}(kn||{});function Rp(e){return e instanceof Function?e():e}var nr=function(e){return e[e.None=0]="None",e[e.SignalBased=1]="SignalBased",e[e.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",e}(nr||{});function Mb(e,t,n){let r=e.length;for(;;){let s=e.indexOf(t,n);if(s===-1)return s;if(s===0||e.charCodeAt(s-1)<=32){let l=t.length;if(s+l===r||e.charCodeAt(s+l)<=32)return s}n=s+1}}var Op="ng-template";function Sb(e,t,n,r){let s=0;if(r){for(;s<t.length&&typeof t[s]=="string";s+=2)if(t[s]==="class"&&Mb(t[s+1].toLowerCase(),n,0)!==-1)return!0}else if(du(e))return!1;if(s=t.indexOf(1,s),s>-1){let l;for(;++s<t.length&&typeof(l=t[s])=="string";)if(l.toLowerCase()===n)return!0}return!1}function du(e){return e.type===4&&e.value!==Op}function Tb(e,t,n){let r=e.type===4&&!n?Op:e.value;return t===r}function Ab(e,t,n){let r=4,s=e.attrs,l=s!==null?Rb(s):0,f=!1;for(let u=0;u<t.length;u++){let c=t[u];if(typeof c=="number"){if(!f&&!Dn(r)&&!Dn(c))return!1;if(f&&Dn(c))continue;f=!1,r=c|r&1;continue}if(!f)if(r&4){if(r=2|r&1,c!==""&&!Tb(e,c,n)||c===""&&t.length===1){if(Dn(r))return!1;f=!0}}else if(r&8){if(s===null||!Sb(e,s,c,n)){if(Dn(r))return!1;f=!0}}else{let g=t[++u],D=Nb(c,s,du(e),n);if(D===-1){if(Dn(r))return!1;f=!0;continue}if(g!==""){let I;if(D>l?I="":I=s[D+1].toLowerCase(),r&2&&g!==I){if(Dn(r))return!1;f=!0}}}}return Dn(r)||f}function Dn(e){return(e&1)===0}function Nb(e,t,n,r){if(t===null)return-1;let s=0;if(r||!n){let l=!1;for(;s<t.length;){let f=t[s];if(f===e)return s;if(f===3||f===6)l=!0;else if(f===1||f===2){let u=t[++s];for(;typeof u=="string";)u=t[++s];continue}else{if(f===4)break;if(f===0){s+=4;continue}}s+=l?1:2}return-1}else return Ob(t,e)}function _b(e,t,n=!1){for(let r=0;r<t.length;r++)if(Ab(e,t[r],n))return!0;return!1}function Rb(e){for(let t=0;t<e.length;t++){let n=e[t];if(Y0(n))return t}return e.length}function Ob(e,t){let n=e.indexOf(4);if(n>-1)for(n++;n<e.length;){let r=e[n];if(typeof r=="number")return-1;if(r===t)return n;n++}return-1}function Gd(e,t){return e?":not("+t.trim()+")":t}function Lb(e){let t=e[0],n=1,r=2,s="",l=!1;for(;n<e.length;){let f=e[n];if(typeof f=="string")if(r&2){let u=e[++n];s+="["+f+(u.length>0?'="'+u+'"':"")+"]"}else r&8?s+="."+f:r&4&&(s+=" "+f);else s!==""&&!Dn(f)&&(t+=Gd(l,s),s=""),r=f,l=l||!Dn(r);n++}return s!==""&&(t+=Gd(l,s)),t}function Fb(e){return e.map(Lb).join(",")}function kb(e){let t=[],n=[],r=1,s=2;for(;r<e.length;){let l=e[r];if(typeof l=="string")s===2?l!==""&&t.push(l,e[++r]):s===8&&n.push(l);else{if(!Dn(s))break;s=l}r++}return{attrs:t,classes:n}}var _s={};function Rs(e=1){Lp(Dr(),qt(),Kl()+e,!1)}function Lp(e,t,n,r){if(!r)if((t[et]&3)===3){let l=e.preOrderCheckHooks;l!==null&&Gi(t,l,n)}else{let l=e.preOrderHooks;l!==null&&Yi(t,l,0,n)}yr(n)}function ir(e,t=ut.Default){let n=qt();if(n===null)return ft(e,t);let r=Sn();return dp(r,n,pn(e),t)}function Fp(e,t,n,r,s,l){let f=wt(null);try{let u=null;s&nr.SignalBased&&(u=t[r][Nr]),u!==null&&u.transformFn!==void 0&&(l=u.transformFn(l)),s&nr.HasDecoratorInputTransform&&(l=e.inputTransforms[r].call(t,l)),e.setInput!==null?e.setInput(t,u,l,n,r):Pf(t,u,r,l)}finally{wt(f)}}function Pb(e,t){return e.createText(t)}function Vb(e,t,n){e.setValue(t,n)}function kp(e,t,n){return e.createElement(t,n)}function fs(e,t,n,r,s){e.insertBefore(t,n,r,s)}function Pp(e,t,n){e.appendChild(t,n)}function Yd(e,t,n,r,s){r!==null?fs(e,t,n,r,s):Pp(e,t,n)}function Hb(e,t,n){e.removeChild(null,t,n)}function Bb(e,t,n){e.setAttribute(t,"style",n)}function Ub(e,t,n){n===""?e.removeAttribute(t,"class"):e.setAttribute(t,"class",n)}function Vp(e,t,n){let{mergedAttrs:r,classes:s,styles:l}=n;r!==null&&G0(e,t,r),s!==null&&Ub(e,t,s),l!==null&&Bb(e,t,l)}function Os(e,t,n,r,s,l,f,u,c,g,D){let I=t.blueprint.slice();return I[$n]=s,I[et]=r|4|128|8|64|1024,(g!==null||e&&e[et]&2048)&&(I[et]|=2048),$f(I),I[Kt]=I[to]=e,I[Rn]=n,I[er]=f||e&&e[er],I[nn]=u||e&&e[nn],I[Xr]=c||e&&e[Xr]||null,I[In]=l,I[Es]=bb(),I[ts]=D,I[Lf]=g,I[On]=t.type==2?e[On]:I,I}function Hp(e,t,n,r){if(n===0)return-1;let s=t.length;for(let l=0;l<n;l++)t.push(r),e.blueprint.push(r),e.data.push(null);return s}function Bp(e,t,n,r,s){let l=Kl(),f=r&2;try{yr(-1),f&&t.length>Un&&Lp(e,t,Un,!1),hn(f?2:0,s),n(r,s)}finally{yr(l),hn(f?3:1,s)}}function Up(e,t,n){qf()&&(Jb(e,t,n,Mn(n,t)),(n.flags&64)===64&&Gp(e,t,n))}function $p(e,t,n=Mn){let r=t.localNames;if(r!==null){let s=t.index+1;for(let l=0;l<r.length;l+=2){let f=r[l+1],u=f===-1?n(t,e):e[f];e[s++]=u}}}function zp(e){let t=e.tView;return t===null||t.incompleteFirstPass?e.tView=fu(1,null,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts,e.id):t}function fu(e,t,n,r,s,l,f,u,c,g,D){let I=Un+r,v=I+s,p=$b(I,v),w=typeof g=="function"?g():g;return p[vt]={type:e,blueprint:p,template:n,queries:null,viewQuery:u,declTNode:t,data:p.slice().fill(null,I),bindingStartIndex:I,expandoStartIndex:v,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof l=="function"?l():l,pipeRegistry:typeof f=="function"?f():f,firstChild:null,schemas:c,consts:w,incompleteFirstPass:!1,ssrId:D}}function $b(e,t){let n=[];for(let r=0;r<t;r++)n.push(r<e?null:_s);return n}function zb(e,t,n,r){let l=r.get(Eb,Tp)||n===kn.ShadowDom,f=e.selectRootElement(t,l);return qb(f),f}function qb(e){Wb(e)}var Wb=()=>null;function Zd(e,t,n,r,s){for(let l in t){if(!t.hasOwnProperty(l))continue;let f=t[l];if(f===void 0)continue;r??={};let u,c=nr.None;Array.isArray(f)?(u=f[0],c=f[1]):u=f;let g=l;if(s!==null){if(!s.hasOwnProperty(l))continue;g=s[l]}e===0?Xd(r,n,g,u,c):Xd(r,n,g,u)}return r}function Xd(e,t,n,r,s){let l;e.hasOwnProperty(n)?(l=e[n]).push(t,r):l=e[n]=[t,r],s!==void 0&&l.push(s)}function Gb(e,t,n){let r=t.directiveStart,s=t.directiveEnd,l=e.data,f=t.attrs,u=[],c=null,g=null;for(let D=r;D<s;D++){let I=l[D],v=n?n.get(I):null,p=v?v.inputs:null,w=v?v.outputs:null;c=Zd(0,I.inputs,D,c,p),g=Zd(1,I.outputs,D,g,w);let j=c!==null&&f!==null&&!du(t)?ly(c,D,f):null;u.push(j)}c!==null&&(c.hasOwnProperty("class")&&(t.flags|=8),c.hasOwnProperty("style")&&(t.flags|=16)),t.initialInputs=u,t.inputs=c,t.outputs=g}function Yb(e){return e==="class"?"className":e==="for"?"htmlFor":e==="formaction"?"formAction":e==="innerHtml"?"innerHTML":e==="readonly"?"readOnly":e==="tabindex"?"tabIndex":e}function Zb(e,t,n,r,s,l,f,u){let c=Mn(t,n),g=t.inputs,D;!u&&g!=null&&(D=g[r])?(pu(e,n,D,r,s),xs(t)&&Xb(n,t.index)):t.type&3?(r=Yb(r),s=f!=null?f(s,t.value||"",r):s,l.setProperty(c,r,s)):t.type&12}function Xb(e,t){let n=jr(t,e);n[et]&16||(n[et]|=64)}function qp(e,t,n,r){if(qf()){let s=r===null?null:{"":-1},l=ty(e,n),f,u;l===null?f=u=null:[f,u]=l,f!==null&&Wp(e,t,n,f,s,u),s&&ny(n,r,s)}n.mergedAttrs=as(n.mergedAttrs,n.attrs)}function Wp(e,t,n,r,s,l){for(let g=0;g<r.length;g++)eb(ap(n,t),e,r[g].type);oy(n,e.data.length,r.length);for(let g=0;g<r.length;g++){let D=r[g];D.providersResolver&&D.providersResolver(D)}let f=!1,u=!1,c=Hp(e,t,r.length,null);for(let g=0;g<r.length;g++){let D=r[g];n.mergedAttrs=as(n.mergedAttrs,D.hostAttrs),iy(e,n,t,c,D),ry(c,D,s),D.contentQueries!==null&&(n.flags|=4),(D.hostBindings!==null||D.hostAttrs!==null||D.hostVars!==0)&&(n.flags|=64);let I=D.type.prototype;!f&&(I.ngOnChanges||I.ngOnInit||I.ngDoCheck)&&((e.preOrderHooks??=[]).push(n.index),f=!0),!u&&(I.ngOnChanges||I.ngDoCheck)&&((e.preOrderCheckHooks??=[]).push(n.index),u=!0),c++}Gb(e,n,l)}function Qb(e,t,n,r,s){let l=s.hostBindings;if(l){let f=e.hostBindingOpCodes;f===null&&(f=e.hostBindingOpCodes=[]);let u=~t.index;Kb(f)!=u&&f.push(u),f.push(n,r,l)}}function Kb(e){let t=e.length;for(;t>0;){let n=e[--t];if(typeof n=="number"&&n<0)return n}return 0}function Jb(e,t,n,r){let s=n.directiveStart,l=n.directiveEnd;xs(n)&&sy(t,n,e.data[s+n.componentOffset]),e.firstCreatePass||ap(n,t),wr(r,t);let f=n.initialInputs;for(let u=s;u<l;u++){let c=e.data[u],g=_o(t,e,u,n);if(wr(g,t),f!==null&&ay(t,u-s,g,c,n,f),ko(c)){let D=jr(n.index,t);D[Rn]=_o(t,e,u,n)}}}function Gp(e,t,n){let r=n.directiveStart,s=n.directiveEnd,l=n.index,f=k0();try{yr(l);for(let u=r;u<s;u++){let c=e.data[u],g=t[u];pl(u),(c.hostBindings!==null||c.hostVars!==0||c.hostAttrs!==null)&&ey(c,g)}}finally{yr(-1),pl(f)}}function ey(e,t){e.hostBindings!==null&&e.hostBindings(1,t)}function ty(e,t){let n=e.directiveRegistry,r=null,s=null;if(n)for(let l=0;l<n.length;l++){let f=n[l];if(_b(t,f.selectors,!1))if(r||(r=[]),ko(f))if(f.findHostDirectiveDefs!==null){let u=[];s=s||new Map,f.findHostDirectiveDefs(f,u,s),r.unshift(...u,f);let c=u.length;El(e,t,c)}else r.unshift(f),El(e,t,0);else s=s||new Map,f.findHostDirectiveDefs?.(f,r,s),r.push(f)}return r===null?null:[r,s]}function El(e,t,n){t.componentOffset=n,(e.components??=[]).push(t.index)}function ny(e,t,n){if(t){let r=e.localNames=[];for(let s=0;s<t.length;s+=2){let l=n[t[s+1]];if(l==null)throw new Ze(-301,!1);r.push(t[s],l)}}}function ry(e,t,n){if(n){if(t.exportAs)for(let r=0;r<t.exportAs.length;r++)n[t.exportAs[r]]=e;ko(t)&&(n[""]=e)}}function oy(e,t,n){e.flags|=1,e.directiveStart=t,e.directiveEnd=t+n,e.providerIndexes=t}function iy(e,t,n,r,s){e.data[r]=s;let l=s.factory||(s.factory=Yr(s.type,!0)),f=new No(l,ko(s),ir);e.blueprint[r]=f,n[r]=f,Qb(e,t,r,Hp(e,n,s.hostVars,_s),s)}function Yp(e){let t=16;return e.signals?t=4096:e.onPush&&(t=64),t}function sy(e,t,n){let r=Mn(t,e),s=zp(n),l=e[er].rendererFactory,f=Ls(e,Os(e,s,null,Yp(n),r,t,null,l.createRenderer(r,n),null,null,null));e[t.index]=f}function ay(e,t,n,r,s,l){let f=l[t];if(f!==null)for(let u=0;u<f.length;){let c=f[u++],g=f[u++],D=f[u++],I=f[u++];Fp(r,n,c,g,D,I)}}function ly(e,t,n){let r=null,s=0;for(;s<n.length;){let l=n[s];if(l===0){s+=4;continue}else if(l===5){s+=2;continue}if(typeof l=="number")break;if(e.hasOwnProperty(l)){r===null&&(r=[]);let f=e[l];for(let u=0;u<f.length;u+=3)if(f[u]===t){r.push(l,f[u+1],f[u+2],n[s+1]);break}}s+=2}return r}function Zp(e,t,n,r){return[e,!0,0,t,null,r,null,n,null,null]}function Ls(e,t){return e[Ao]?e[_d][En]=t:e[Ao]=t,e[_d]=t,t}function Xp(e,t){let n=e[Xr],r=n?n.get(tr,null):null;r&&r.handleError(t)}function pu(e,t,n,r,s){for(let l=0;l<n.length;){let f=n[l++],u=n[l++],c=n[l++],g=t[f],D=e.data[f];Fp(D,g,r,u,c,s)}}function uy(e,t){let n=jr(t,e),r=n[vt];cy(r,n);let s=n[$n];s!==null&&n[ts]===null&&(n[ts]=cu(s,n[Xr])),hu(r,n,n[Rn])}function cy(e,t){for(let n=t.length;n<e.blueprint.length;n++)t.push(e.blueprint[n])}function hu(e,t,n){Xl(t);try{let r=e.viewQuery;r!==null&&Dl(1,r,n);let s=e.template;s!==null&&Bp(e,t,s,1,n),e.firstCreatePass&&(e.firstCreatePass=!1),t[Kr]?.finishViewCreation(e),e.staticContentQueries&&Np(e,t),e.staticViewQueries&&Dl(2,e.viewQuery,n);let l=e.components;l!==null&&dy(t,l)}catch(r){throw e.firstCreatePass&&(e.incompleteFirstPass=!0,e.firstCreatePass=!1),r}finally{t[et]&=-5,Ql()}}function dy(e,t){for(let n=0;n<t.length;n++)uy(e,t[n])}var Er=function(e){return e[e.Important=1]="Important",e[e.DashCase=2]="DashCase",e}(Er||{}),fy;function gu(e,t){return fy(e,t)}function qr(e,t,n,r,s){if(r!=null){let l,f=!1;zn(r)?l=r:hr(r)&&(f=!0,r=r[$n]);let u=Ln(r);e===0&&n!==null?s==null?Pp(t,n,u):fs(t,n,u,s||null,!0):e===1&&n!==null?fs(t,n,u,s||null,!0):e===2?Hb(t,u,f):e===3&&t.destroyNode(u),l!=null&&xy(t,e,l,n,s)}}function py(e,t){Qp(e,t),t[$n]=null,t[In]=null}function hy(e,t,n,r,s,l){r[$n]=s,r[In]=t,Fs(e,r,n,1,s,l)}function Qp(e,t){t[er].changeDetectionScheduler?.notify(10),Fs(e,t,t[nn],2,null,null)}function gy(e){let t=e[Ao];if(!t)return Ja(e[vt],e);for(;t;){let n=null;if(hr(t))n=t[Ao];else{let r=t[gn];r&&(n=r)}if(!n){for(;t&&!t[En]&&t!==e;)hr(t)&&Ja(t[vt],t),t=t[Kt];t===null&&(t=e),hr(t)&&Ja(t[vt],t),n=t&&t[En]}t=n}}function my(e,t,n,r){let s=gn+r,l=n.length;r>0&&(n[s-1][En]=t),r<l-gn?(t[En]=n[s],xf(n,gn+r,t)):(n.push(t),t[En]=null),t[Kt]=n;let f=t[Qr];f!==null&&n!==f&&Kp(f,t);let u=t[Kr];u!==null&&u.insertView(e),dl(t),t[et]|=128}function Kp(e,t){let n=e[is],r=t[Kt];if(hr(r))e[et]|=2;else{let s=r[Kt][On];t[On]!==s&&(e[et]|=2)}n===null?e[is]=[t]:n.push(t)}function mu(e,t){let n=e[is],r=n.indexOf(t);n.splice(r,1)}function xl(e,t){if(e.length<=gn)return;let n=gn+t,r=e[n];if(r){let s=r[Qr];s!==null&&s!==e&&mu(s,r),t>0&&(e[n-1][En]=r[En]);let l=Ji(e,gn+t);py(r[vt],r);let f=l[Kr];f!==null&&f.detachView(l[vt]),r[Kt]=null,r[En]=null,r[et]&=-129}return r}function Jp(e,t){if(Po(t))return;let n=t[nn];n.destroyNode&&Fs(e,t,n,3,null,null),gy(t)}function Ja(e,t){if(Po(t))return;let n=wt(null);try{t[et]&=-129,t[et]|=256,t[ln]&&_a(t[ln]),by(e,t),vy(e,t),t[vt].type===1&&t[nn].destroy();let r=t[Qr];if(r!==null&&zn(t[Kt])){r!==t[Kt]&&mu(r,t);let s=t[Kr];s!==null&&s.detachView(e)}Cl(t)}finally{wt(n)}}function vy(e,t){let n=e.cleanup,r=t[ns];if(n!==null)for(let f=0;f<n.length-1;f+=2)if(typeof n[f]=="string"){let u=n[f+3];u>=0?r[u]():r[-u].unsubscribe(),f+=2}else{let u=r[n[f+1]];n[f].call(u)}r!==null&&(t[ns]=null);let s=t[Jn];if(s!==null){t[Jn]=null;for(let f=0;f<s.length;f++){let u=s[f];u()}}let l=t[rs];if(l!==null){t[rs]=null;for(let f of l)f.destroy()}}function by(e,t){let n;if(e!=null&&(n=e.destroyHooks)!=null)for(let r=0;r<n.length;r+=2){let s=t[n[r]];if(!(s instanceof No)){let l=n[r+1];if(Array.isArray(l))for(let f=0;f<l.length;f+=2){let u=s[l[f]],c=l[f+1];hn(4,u,c);try{c.call(u)}finally{hn(5,u,c)}}else{hn(4,s,l);try{l.call(s)}finally{hn(5,s,l)}}}}}function yy(e,t,n){return wy(e,t.parent,n)}function wy(e,t,n){let r=t;for(;r!==null&&r.type&168;)t=r,r=t.parent;if(r===null)return n[$n];{let{componentOffset:s}=r;if(s>-1){let{encapsulation:l}=e.data[r.directiveStart+s];if(l===kn.None||l===kn.Emulated)return null}return Mn(r,n)}}function Cy(e,t,n){return Dy(e,t,n)}function jy(e,t,n){return e.type&40?Mn(e,n):null}var Dy=jy,Qd;function vu(e,t,n,r){let s=yy(e,r,t),l=t[nn],f=r.parent||t[In],u=Cy(f,r,t);if(s!=null)if(Array.isArray(n))for(let c=0;c<n.length;c++)Yd(l,s,n[c],u,!1);else Yd(l,s,n,u,!1);Qd!==void 0&&Qd(l,r,t,n,s)}function xo(e,t){if(t!==null){let n=t.type;if(n&3)return Mn(t,e);if(n&4)return Il(-1,e[t.index]);if(n&8){let r=t.child;if(r!==null)return xo(e,r);{let s=e[t.index];return zn(s)?Il(-1,s):Ln(s)}}else{if(n&128)return xo(e,t.next);if(n&32)return gu(t,e)()||Ln(e[t.index]);{let r=eh(e,t);if(r!==null){if(Array.isArray(r))return r[0];let s=br(e[On]);return xo(s,r)}else return xo(e,t.next)}}}return null}function eh(e,t){if(t!==null){let r=e[On][In],s=t.projection;return r.projection[s]}return null}function Il(e,t){let n=gn+e+1;if(n<t.length){let r=t[n],s=r[vt].firstChild;if(s!==null)return xo(r,s)}return t[vr]}function bu(e,t,n,r,s,l,f){for(;n!=null;){if(n.type===128){n=n.next;continue}let u=r[n.index],c=n.type;if(f&&t===0&&(u&&wr(Ln(u),r),n.flags|=2),(n.flags&32)!==32)if(c&8)bu(e,t,n.child,r,s,l,!1),qr(t,e,s,u,l);else if(c&32){let g=gu(n,r),D;for(;D=g();)qr(t,e,s,D,l);qr(t,e,s,u,l)}else c&16?Ey(e,t,r,n,s,l):qr(t,e,s,u,l);n=f?n.projectionNext:n.next}}function Fs(e,t,n,r,s,l){bu(n,r,e.firstChild,t,s,l,!1)}function Ey(e,t,n,r,s,l){let f=n[On],c=f[In].projection[r.projection];if(Array.isArray(c))for(let g=0;g<c.length;g++){let D=c[g];qr(t,e,s,D,l)}else{let g=c,D=f[Kt];jp(r)&&(g.flags|=128),bu(e,t,g,D,s,l,!0)}}function xy(e,t,n,r,s){let l=n[vr],f=Ln(n);l!==f&&qr(t,e,r,l,s);for(let u=gn;u<n.length;u++){let c=n[u];Fs(c[vt],c,e,t,r,l)}}function Iy(e,t,n,r){let s=wt(null);try{let l=t.tView,u=e[et]&4096?4096:16,c=Os(e,l,n,u,null,t,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null),g=e[t.index];c[Qr]=g;let D=e[Kr];return D!==null&&(c[Kr]=D.createEmbeddedView(l)),hu(l,c,n),c}finally{wt(s)}}function Kd(e,t){return!t||t.firstChild===null||jp(e)}function My(e,t,n,r=!0){let s=t[vt];if(my(s,t,e,n),r){let f=Il(n,e),u=t[nn],c=u.parentNode(e[vr]);c!==null&&hy(s,e[In],u,t,c,f)}let l=t[ts];l!==null&&l.firstChild!==null&&(l.firstChild=null)}function ps(e,t,n,r,s=!1){for(;n!==null;){if(n.type===128){n=s?n.projectionNext:n.next;continue}let l=t[n.index];l!==null&&r.push(Ln(l)),zn(l)&&Sy(l,r);let f=n.type;if(f&8)ps(e,t,n.child,r);else if(f&32){let u=gu(n,t),c;for(;c=u();)r.push(c)}else if(f&16){let u=eh(t,n);if(Array.isArray(u))r.push(...u);else{let c=br(t[On]);ps(c[vt],c,u,r,!0)}}n=s?n.projectionNext:n.next}return r}function Sy(e,t){for(let n=gn;n<e.length;n++){let r=e[n],s=r[vt].firstChild;s!==null&&ps(r[vt],r,s,t)}e[vr]!==e[$n]&&t.push(e[vr])}var th=[];function Ty(e){return e[ln]??Ay(e)}function Ay(e){let t=th.pop()??Object.create(_y);return t.lView=e,t}function Ny(e){e.lView[ln]!==e&&(e.lView=null,th.push(e))}var _y=Mt(Ve({},ji),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:e=>{Ms(e.lView)},consumerOnSignalRead(){this.lView[ln]=this}});function Ry(e){let t=e[ln]??Object.create(Oy);return t.lView=e,t}var Oy=Mt(Ve({},ji),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:e=>{let t=br(e.lView);for(;t&&!nh(t[vt]);)t=br(t);t&&Zl(t)},consumerOnSignalRead(){this.lView[ln]=this}});function nh(e){return e.type!==2}function rh(e){if(e[rs]===null)return;let t=!0;for(;t;){let n=!1;for(let r of e[rs])r.dirty&&(n=!0,r.zone===null||Zone.current===r.zone?r.run():r.zone.run(()=>r.run()));t=n&&!!(e[et]&8192)}}var Ly=100;function oh(e,t=!0,n=0){let s=e[er].rendererFactory,l=!1;l||s.begin?.();try{Fy(e,n)}catch(f){throw t&&Xp(e,f),f}finally{l||s.end?.()}}function Fy(e,t){let n=Yf();try{Od(!0),Ml(e,t);let r=0;for(;Is(e);){if(r===Ly)throw new Ze(103,!1);r++,Ml(e,1)}}finally{Od(n)}}function ky(e,t,n,r){if(Po(t))return;let s=t[et],l=!1,f=!1;Xl(t);let u=!0,c=null,g=null;l||(nh(e)?(g=Ty(t),c=Aa(g)):Hc()===null?(u=!1,g=Ry(t),c=Aa(g)):t[ln]&&(_a(t[ln]),t[ln]=null));try{$f(t),O0(e.bindingStartIndex),n!==null&&Bp(e,t,n,2,r);let D=(s&3)===3;if(!l)if(D){let p=e.preOrderCheckHooks;p!==null&&Gi(t,p,null)}else{let p=e.preOrderHooks;p!==null&&Yi(t,p,0,null),Xa(t,0)}if(f||Py(t),rh(t),ih(t,0),e.contentQueries!==null&&Np(e,t),!l)if(D){let p=e.contentCheckHooks;p!==null&&Gi(t,p)}else{let p=e.contentHooks;p!==null&&Yi(t,p,1),Xa(t,1)}Hy(e,t);let I=e.components;I!==null&&ah(t,I,0);let v=e.viewQuery;if(v!==null&&Dl(2,v,r),!l)if(D){let p=e.viewCheckHooks;p!==null&&Gi(t,p)}else{let p=e.viewHooks;p!==null&&Yi(t,p,2),Xa(t,2)}if(e.firstUpdatePass===!0&&(e.firstUpdatePass=!1),t[Za]){for(let p of t[Za])p();t[Za]=null}l||(t[et]&=-73)}catch(D){throw l||Ms(t),D}finally{g!==null&&(zc(g,c),u&&Ny(g)),Ql()}}function ih(e,t){for(let n=xp(e);n!==null;n=Ip(n))for(let r=gn;r<n.length;r++){let s=n[r];sh(s,t)}}function Py(e){for(let t=xp(e);t!==null;t=Ip(t)){if(!(t[et]&2))continue;let n=t[is];for(let r=0;r<n.length;r++){let s=n[r];Zl(s)}}}function Vy(e,t,n){let r=jr(t,e);sh(r,n)}function sh(e,t){Yl(e)&&Ml(e,t)}function Ml(e,t){let r=e[vt],s=e[et],l=e[ln],f=!!(t===0&&s&16);if(f||=!!(s&64&&t===0),f||=!!(s&1024),f||=!!(l?.dirty&&Na(l)),f||=!1,l&&(l.dirty=!1),e[et]&=-9217,f)ky(r,e,r.template,e[Rn]);else if(s&8192){rh(e),ih(e,1);let u=r.components;u!==null&&ah(e,u,1)}}function ah(e,t,n){for(let r=0;r<t.length;r++)Vy(e,t[r],n)}function Hy(e,t){let n=e.hostBindingOpCodes;if(n!==null)try{for(let r=0;r<n.length;r++){let s=n[r];if(s<0)yr(~s);else{let l=s,f=n[++r],u=n[++r];F0(f,l);let c=t[l];hn(24,c),u(2,c),hn(25,c)}}}finally{yr(-1)}}function yu(e,t){let n=Yf()?64:1088;for(e[er].changeDetectionScheduler?.notify(t);e;){e[et]|=n;let r=br(e);if(ul(e)&&!r)return e;e=r}return null}var Cr=class{_lView;_cdRefInjectingView;notifyErrorHandler;_appRef=null;_attachedToViewContainer=!1;get rootNodes(){let t=this._lView,n=t[vt];return ps(n,t,n.firstChild,[])}constructor(t,n,r=!0){this._lView=t,this._cdRefInjectingView=n,this.notifyErrorHandler=r}get context(){return this._lView[Rn]}get dirty(){return!!(this._lView[et]&9280)||!!this._lView[ln]?.dirty}set context(t){this._lView[Rn]=t}get destroyed(){return Po(this._lView)}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let t=this._lView[Kt];if(zn(t)){let n=t[os],r=n?n.indexOf(this):-1;r>-1&&(xl(t,r),Ji(n,r))}this._attachedToViewContainer=!1}Jp(this._lView[vt],this._lView)}onDestroy(t){zf(this._lView,t)}markForCheck(){yu(this._cdRefInjectingView||this._lView,4)}markForRefresh(){Zl(this._cdRefInjectingView||this._lView)}detach(){this._lView[et]&=-129}reattach(){dl(this._lView),this._lView[et]|=128}detectChanges(){this._lView[et]|=1024,oh(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Ze(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let t=ul(this._lView),n=this._lView[Qr];n!==null&&!t&&mu(n,this._lView),Qp(this._lView[vt],this._lView)}attachToAppRef(t){if(this._attachedToViewContainer)throw new Ze(902,!1);this._appRef=t;let n=ul(this._lView),r=this._lView[Qr];r!==null&&!n&&Kp(r,this._lView),dl(this._lView)}},ks=(()=>{class e{static __NG_ELEMENT_ID__=$y}return e})(),By=ks,Uy=class extends By{_declarationLView;_declarationTContainer;elementRef;constructor(t,n,r){super(),this._declarationLView=t,this._declarationTContainer=n,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(t,n){return this.createEmbeddedViewImpl(t,n)}createEmbeddedViewImpl(t,n,r){let s=Iy(this._declarationLView,this._declarationTContainer,t,{embeddedViewInjector:n,dehydratedView:r});return new Cr(s)}};function $y(){return zy(Sn(),qt())}function zy(e,t){return e.type&4?new Uy(t,e,Ts(e,t)):null}function Ps(e,t,n,r,s){let l=e.data[t];if(l===null)l=qy(e,t,n,r,s),L0()&&(l.flags|=32);else if(l.type&64){l.type=n,l.value=r,l.attrs=s;let f=_0();l.injectorIndex=f===null?-1:f.injectorIndex}return Vo(l,!0),l}function qy(e,t,n,r,s){let l=Wf(),f=Gf(),u=f?l:l&&l.parent,c=e.data[t]=Gy(e,u,n,t,r,s);return Wy(e,c,l,f),c}function Wy(e,t,n,r){e.firstChild===null&&(e.firstChild=t),n!==null&&(r?n.child==null&&t.parent!==null&&(n.child=t):n.next===null&&(n.next=t,t.prev=n))}function Gy(e,t,n,r,s,l){let f=t?t.injectorIndex:-1,u=0;return T0()&&(u|=128),{type:n,index:r,insertBeforeIndex:null,injectorIndex:f,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:u,providerIndexes:0,value:s,attrs:l,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}var nS=new RegExp(`^(\\d+)*(${Db}|${jb})*(.*)`);var Yy=()=>null;function Jd(e,t){return Yy(e,t)}var Sl=class{},hs=class{},Tl=class{resolveComponentFactory(t){throw Error(`No component factory found for ${tn(t)}.`)}},Jr=class{static NULL=new Tl},eo=class{};var Zy=(()=>{class e{static \u0275prov=tt({token:e,providedIn:"root",factory:()=>null})}return e})();function Al(e,t,n){let r=n?e.styles:null,s=n?e.classes:null,l=0;if(t!==null)for(let f=0;f<t.length;f++){let u=t[f];if(typeof u=="number")l=u;else if(l==1)s=Id(s,u);else if(l==2){let c=u,g=t[++f];r=Id(r,c+": "+g+";")}}n?e.styles=r:e.stylesWithoutHost=r,n?e.classes=s:e.classesWithoutHost=s}var gs=class extends Jr{ngModule;constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){let n=mr(t);return new Oo(n,this.ngModule)}};function ef(e,t){let n=[];for(let r in e){if(!e.hasOwnProperty(r))continue;let s=e[r];if(s===void 0)continue;let l=Array.isArray(s),f=l?s[0]:s,u=l?s[1]:nr.None;t?n.push({propName:f,templateName:r,isSignal:(u&nr.SignalBased)!==0}):n.push({propName:f,templateName:r})}return n}function Xy(e){let t=e.toLowerCase();return t==="svg"?b0:t==="math"?y0:null}function Qy(e){let{attrs:t,classes:n}=kb(e),r=t;return n.length&&r.push(1,...n),r}var Oo=class extends hs{componentDef;ngModule;selector;componentType;ngContentSelectors;isBoundToModule;get inputs(){let t=this.componentDef,n=t.inputTransforms,r=ef(t.inputs,!0);if(n!==null)for(let s of r)n.hasOwnProperty(s.propName)&&(s.transform=n[s.propName]);return r}get outputs(){return ef(this.componentDef.outputs,!1)}constructor(t,n){super(),this.componentDef=t,this.ngModule=n,this.componentType=t.type,this.selector=Fb(t.selectors),this.ngContentSelectors=t.ngContentSelectors?t.ngContentSelectors:[],this.isBoundToModule=!!n}create(t,n,r,s){let l=wt(null);try{s=s||this.ngModule;let f=s instanceof mn?s:s?.injector;f&&this.componentDef.getStandaloneInjector!==null&&(f=this.componentDef.getStandaloneInjector(f)||f);let u=f?new hl(t,f):t,c=u.get(eo,null);if(c===null)throw new Ze(407,!1);let g=u.get(Zy,null),D=u.get(Ro,null),I={rendererFactory:c,sanitizer:g,changeDetectionScheduler:D},v=c.createRenderer(null,this.componentDef),p=this.componentDef.selectors[0][0]||"div",w=r?zb(v,r,this.componentDef.encapsulation,u):kp(v,p,Xy(p)),j=512;this.componentDef.signals?j|=4096:this.componentDef.onPush||(j|=16);let b=null;w!==null&&(b=cu(w,u,!0));let M=fu(0,null,null,1,0,null,null,null,null,null,null),A=Os(null,M,null,j,null,null,I,v,u,null,b);A[Un]=w,Xl(A);let O,F=null;try{let _=this.componentDef,P,K=null;_.findHostDirectiveDefs?(P=[],K=new Map,_.findHostDirectiveDefs(_,P,K),P.push(_)):P=[_];let W=r?["ng-version","19.1.3"]:Qy(this.componentDef.selectors[0]),se=Ps(M,Un,2,"#host",W);for(let he of P)se.mergedAttrs=as(se.mergedAttrs,he.hostAttrs);se.mergedAttrs=as(se.mergedAttrs,W),Al(se,se.mergedAttrs,!0),w&&Vp(v,w,se),F=Ky(se,w,_,P,A,I),n!==void 0&&e1(se,this.ngContentSelectors,n),O=Jy(F,_,P,K,A,[t1]),hu(M,A,null)}catch(_){throw F!==null&&Cl(F),Cl(A),_}finally{Ql()}let V=Uf(M,Un);return new Nl(this.componentType,O,Ts(V,A),A,V)}finally{wt(l)}}},Nl=class extends Sl{location;_rootLView;_tNode;instance;hostView;changeDetectorRef;componentType;previousInputValues=null;constructor(t,n,r,s,l){super(),this.location=r,this._rootLView=s,this._tNode=l,this.instance=n,this.hostView=this.changeDetectorRef=new Cr(s,void 0,!1),this.componentType=t}setInput(t,n){let r=this._tNode.inputs,s;if(r!==null&&(s=r[t])){if(this.previousInputValues??=new Map,this.previousInputValues.has(t)&&Object.is(this.previousInputValues.get(t),n))return;let l=this._rootLView;pu(l[vt],l,s,t,n),this.previousInputValues.set(t,n);let f=jr(this._tNode.index,l);yu(f,1)}}get injector(){return new gr(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}};function Ky(e,t,n,r,s,l){let f=s[vt],u=null;t!==null&&(u=cu(t,s[Xr]));let c=l.rendererFactory.createRenderer(t,n),g=Os(s,zp(n),null,Yp(n),s[e.index],e,l,c,null,null,u);return f.firstCreatePass&&El(f,e,r.length-1),Ls(s,g),s[e.index]=g}function Jy(e,t,n,r,s,l){let f=Sn(),u=s[vt],c=Mn(f,s);Wp(u,s,f,n,null,r);for(let D=0;D<n.length;D++){let I=f.directiveStart+D,v=_o(s,u,I,f);wr(v,s)}Gp(u,s,f),c&&wr(c,s);let g=_o(s,u,f.directiveStart+f.componentOffset,f);if(e[Rn]=s[Rn]=g,l!==null)for(let D of l)D(g,t);return _p(u,f,s),g}function e1(e,t,n){let r=e.projection=[];for(let s=0;s<t.length;s++){let l=n[s];r.push(l!=null&&l.length?Array.from(l):null)}}function t1(){let e=Sn();tu(qt()[vt],e)}var oo=(()=>{class e{static __NG_ELEMENT_ID__=n1}return e})();function n1(){let e=Sn();return o1(e,qt())}var r1=oo,lh=class extends r1{_lContainer;_hostTNode;_hostLView;constructor(t,n,r){super(),this._lContainer=t,this._hostTNode=n,this._hostLView=r}get element(){return Ts(this._hostTNode,this._hostLView)}get injector(){return new gr(this._hostTNode,this._hostLView)}get parentInjector(){let t=nu(this._hostTNode,this._hostLView);if(op(t)){let n=us(t,this._hostLView),r=ls(t),s=n[vt].data[r+8];return new gr(s,n)}else return new gr(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){let n=tf(this._lContainer);return n!==null&&n[t]||null}get length(){return this._lContainer.length-gn}createEmbeddedView(t,n,r){let s,l;typeof r=="number"?s=r:r!=null&&(s=r.index,l=r.injector);let f=Jd(this._lContainer,t.ssrId),u=t.createEmbeddedViewImpl(n||{},l,f);return this.insertImpl(u,s,Kd(this._hostTNode,f)),u}createComponent(t,n,r,s,l){let f=t&&!h0(t),u;if(f)u=n;else{let w=n||{};u=w.index,r=w.injector,s=w.projectableNodes,l=w.environmentInjector||w.ngModuleRef}let c=f?t:new Oo(mr(t)),g=r||this.parentInjector;if(!l&&c.ngModule==null){let j=(f?g:this.parentInjector).get(mn,null);j&&(l=j)}let D=mr(c.componentType??{}),I=Jd(this._lContainer,D?.id??null),v=I?.firstChild??null,p=c.create(g,s,v,l);return this.insertImpl(p.hostView,u,Kd(this._hostTNode,I)),p}insert(t,n){return this.insertImpl(t,n,!0)}insertImpl(t,n,r){let s=t._lView;if(C0(s)){let u=this.indexOf(t);if(u!==-1)this.detach(u);else{let c=s[Kt],g=new lh(c,c[In],c[Kt]);g.detach(g.indexOf(t))}}let l=this._adjustIndex(n),f=this._lContainer;return My(f,s,l,r),t.attachToViewContainerRef(),xf(tl(f),l,t),t}move(t,n){return this.insert(t,n)}indexOf(t){let n=tf(this._lContainer);return n!==null?n.indexOf(t):-1}remove(t){let n=this._adjustIndex(t,-1),r=xl(this._lContainer,n);r&&(Ji(tl(this._lContainer),n),Jp(r[vt],r))}detach(t){let n=this._adjustIndex(t,-1),r=xl(this._lContainer,n);return r&&Ji(tl(this._lContainer),n)!=null?new Cr(r):null}_adjustIndex(t,n=0){return t??this.length+n}};function tf(e){return e[os]}function tl(e){return e[os]||(e[os]=[])}function o1(e,t){let n,r=t[e.index];return zn(r)?n=r:(n=Zp(r,t,null,e),t[e.index]=n,Ls(t,n)),s1(n,t,e,r),new lh(n,e,t)}function i1(e,t){let n=e[nn],r=n.createComment(""),s=Mn(t,e),l=n.parentNode(s);return fs(n,l,r,n.nextSibling(s),!1),r}var s1=u1,a1=()=>!1;function l1(e,t,n){return a1(e,t,n)}function u1(e,t,n,r){if(e[vr])return;let s;n.type&8?s=Ln(r):s=i1(t,n),e[vr]=s}var rr=class{},Lo=class{};var _l=class extends rr{ngModuleType;_parent;_bootstrapComponents=[];_r3Injector;instance;destroyCbs=[];componentFactoryResolver=new gs(this);constructor(t,n,r,s=!0){super(),this.ngModuleType=t,this._parent=n;let l=Sf(t);this._bootstrapComponents=Rp(l.bootstrap),this._r3Injector=hp(t,n,[{provide:rr,useValue:this},{provide:Jr,useValue:this.componentFactoryResolver},...r],tn(t),new Set(["environment"])),s&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){let t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}},Rl=class extends Lo{moduleType;constructor(t){super(),this.moduleType=t}create(t){return new _l(this.moduleType,t,[])}};var ms=class extends rr{injector;componentFactoryResolver=new gs(this);instance=null;constructor(t){super();let n=new To([...t.providers,{provide:rr,useValue:this},{provide:Jr,useValue:this.componentFactoryResolver}],t.parent||ql(),t.debugName,new Set(["environment"]));this.injector=n,t.runEnvironmentInitializers&&n.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(t){this.injector.onDestroy(t)}};function wu(e,t,n=null){return new ms({providers:e,parent:t,debugName:n,runEnvironmentInitializers:!0}).injector}var c1=(()=>{class e{_injector;cachedInjectors=new Map;constructor(n){this._injector=n}getOrCreateStandaloneInjector(n){if(!n.standalone)return null;if(!this.cachedInjectors.has(n)){let r=_f(!1,n.type),s=r.length>0?wu([r],this._injector,`Standalone[${n.type.name}]`):null;this.cachedInjectors.set(n,s)}return this.cachedInjectors.get(n)}ngOnDestroy(){try{for(let n of this.cachedInjectors.values())n!==null&&n.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=tt({token:e,providedIn:"environment",factory:()=>new e(ft(mn))})}return e})();function Vs(e){return Fo(()=>{let t=uh(e),n=Mt(Ve({},t),{decls:e.decls,vars:e.vars,template:e.template,consts:e.consts||null,ngContentSelectors:e.ngContentSelectors,onPush:e.changeDetection===Dp.OnPush,directiveDefs:null,pipeDefs:null,dependencies:t.standalone&&e.dependencies||null,getStandaloneInjector:t.standalone?s=>s.get(c1).getOrCreateStandaloneInjector(n):null,getExternalStyles:null,signals:e.signals??!1,data:e.data||{},encapsulation:e.encapsulation||kn.Emulated,styles:e.styles||Nn,_:null,schemas:e.schemas||null,tView:null,id:""});t.standalone&&su("NgStandalone"),ch(n);let r=e.dependencies;return n.directiveDefs=rf(r,!1),n.pipeDefs=rf(r,!0),n.id=p1(n),n})}function d1(e){return mr(e)||Tf(e)}function f1(e){return e!==null}function Hs(e){return Fo(()=>({type:e.type,bootstrap:e.bootstrap||Nn,declarations:e.declarations||Nn,imports:e.imports||Nn,exports:e.exports||Nn,transitiveCompileScopes:null,schemas:e.schemas||null,id:e.id||null}))}function nf(e,t){if(e==null)return So;let n={};for(let r in e)if(e.hasOwnProperty(r)){let s=e[r],l,f,u=nr.None;Array.isArray(s)?(u=s[0],l=s[1],f=s[2]??l):(l=s,f=s),t?(n[l]=u!==nr.None?[r,u]:r,t[l]=f):n[l]=r}return n}function Ho(e){return Fo(()=>{let t=uh(e);return ch(t),t})}function uh(e){let t={};return{type:e.type,providersResolver:null,factory:null,hostBindings:e.hostBindings||null,hostVars:e.hostVars||0,hostAttrs:e.hostAttrs||null,contentQueries:e.contentQueries||null,declaredInputs:t,inputTransforms:null,inputConfig:e.inputs||So,exportAs:e.exportAs||null,standalone:e.standalone??!0,signals:e.signals===!0,selectors:e.selectors||Nn,viewQuery:e.viewQuery||null,features:e.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:nf(e.inputs,t),outputs:nf(e.outputs),debugInfo:null}}function ch(e){e.features?.forEach(t=>t(e))}function rf(e,t){if(!e)return null;let n=t?Af:d1;return()=>(typeof e=="function"?e():e).map(r=>n(r)).filter(f1)}function p1(e){let t=0,n=typeof e.consts=="function"?"":e.consts,r=[e.selectors,e.ngContentSelectors,e.hostVars,e.hostAttrs,n,e.vars,e.decls,e.encapsulation,e.standalone,e.signals,e.exportAs,JSON.stringify(e.inputs),JSON.stringify(e.outputs),Object.getOwnPropertyNames(e.type.prototype),!!e.contentQueries,!!e.viewQuery];for(let l of r.join("|"))t=Math.imul(31,t)+l.charCodeAt(0)<<0;return t+=2147483648,"c"+t}function dh(e){return g1(e)?Array.isArray(e)||!(e instanceof Map)&&Symbol.iterator in e:!1}function h1(e,t){if(Array.isArray(e))for(let n=0;n<e.length;n++)t(e[n]);else{let n=e[Symbol.iterator](),r;for(;!(r=n.next()).done;)t(r.value)}}function g1(e){return e!==null&&(typeof e=="function"||typeof e=="object")}function fh(e,t,n){let r=e[t];return Object.is(r,n)?!1:(e[t]=n,!0)}function m1(e){return(e.flags&32)===32}function v1(e,t,n,r,s,l,f,u,c){let g=t.consts,D=Ps(t,e,4,f||null,u||null);qp(t,n,D,ss(g,c)),tu(t,D);let I=D.tView=fu(2,D,r,s,l,t.directiveRegistry,t.pipeRegistry,null,t.schemas,g,null);return t.queries!==null&&(t.queries.template(t,D),I.queries=t.queries.embeddedTView(D)),D}function b1(e,t,n,r,s,l,f,u,c,g){let D=n+Un,I=t.firstCreatePass?v1(D,t,e,r,s,l,f,u,c):t.data[D];Vo(I,!1);let v=y1(t,e,I,n);Jl()&&vu(t,e,v,I),wr(v,e);let p=Zp(v,e,v,I);return e[D]=p,Ls(e,p),l1(p,I,e),Wl(I)&&Up(t,e,I),c!=null&&$p(e,I,g),I}function Bs(e,t,n,r,s,l,f,u){let c=qt(),g=Dr(),D=ss(g.consts,l);return b1(c,g,e,t,n,r,s,D,f,u),Bs}var y1=w1;function w1(e,t,n,r){return eu(!0),t[nn].createComment("")}var Cu=(()=>{class e{log(n){console.log(n)}warn(n){console.warn(n)}static \u0275fac=function(r){return new(r||e)};static \u0275prov=tt({token:e,factory:e.\u0275fac,providedIn:"platform"})}return e})();var ph=new ot("");function Bo(e){return!!e&&typeof e.then=="function"}function hh(e){return!!e&&typeof e.subscribe=="function"}var gh=new ot("");var mh=(()=>{class e{resolve;reject;initialized=!1;done=!1;donePromise=new Promise((n,r)=>{this.resolve=n,this.reject=r});appInits=Oe(gh,{optional:!0})??[];injector=Oe(Fn);constructor(){}runInitializers(){if(this.initialized)return;let n=[];for(let s of this.appInits){let l=xn(this.injector,s);if(Bo(l))n.push(l);else if(hh(l)){let f=new Promise((u,c)=>{l.subscribe({complete:u,error:c})});n.push(f)}}let r=()=>{this.done=!0,this.resolve()};Promise.all(n).then(()=>{r()}).catch(s=>{this.reject(s)}),n.length===0&&r(),this.initialized=!0}static \u0275fac=function(r){return new(r||e)};static \u0275prov=tt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),C1=(()=>{class e{static \u0275prov=tt({token:e,providedIn:"root",factory:()=>new Ol})}return e})(),Ol=class{queuedEffectCount=0;queues=new Map;schedule(t){this.enqueue(t)}remove(t){let n=t.zone,r=this.queues.get(n);r.has(t)&&(r.delete(t),this.queuedEffectCount--)}enqueue(t){let n=t.zone;this.queues.has(n)||this.queues.set(n,new Set);let r=this.queues.get(n);r.has(t)||(this.queuedEffectCount++,r.add(t))}flush(){for(;this.queuedEffectCount>0;)for(let[t,n]of this.queues)t===null?this.flushQueue(n):t.run(()=>this.flushQueue(n))}flushQueue(t){for(let n of t)t.delete(n),this.queuedEffectCount--,n.run()}},ju=new ot("");function j1(){Zc(()=>{throw new Ze(600,!1)})}function D1(e){return e.isBoundToModule}var E1=10;function x1(e,t,n){try{let r=n();return Bo(r)?r.catch(s=>{throw t.runOutsideAngular(()=>e.handleError(s)),s}):r}catch(r){throw t.runOutsideAngular(()=>e.handleError(r)),r}}var or=(()=>{class e{_runningTick=!1;_destroyed=!1;_destroyListeners=[];_views=[];internalErrorHandler=Oe(hb);afterRenderManager=Oe(xb);zonelessEnabled=Oe(Ss);rootEffectScheduler=Oe(C1);dirtyFlags=0;deferredDirtyFlags=0;tracingSnapshot=null;externalTestViews=new Set;afterTick=new Yt;get allViews(){return[...this.externalTestViews.keys(),...this._views]}get destroyed(){return this._destroyed}componentTypes=[];components=[];isStable=Oe(no).hasPendingTasks.pipe(mt(n=>!n));constructor(){Oe(Ns,{optional:!0})}whenStable(){let n;return new Promise(r=>{n=this.isStable.subscribe({next:s=>{s&&r()}})}).finally(()=>{n.unsubscribe()})}_injector=Oe(mn);_rendererFactory=null;get injector(){return this._injector}bootstrap(n,r){let s=n instanceof hs;if(!this._injector.get(mh).done){let v=!s&&Nf(n),p=!1;throw new Ze(405,p)}let f;s?f=n:f=this._injector.get(Jr).resolveComponentFactory(n),this.componentTypes.push(f.componentType);let u=D1(f)?void 0:this._injector.get(rr),c=r||f.selector,g=f.create(Fn.NULL,[],c,u),D=g.location.nativeElement,I=g.injector.get(ph,null);return I?.registerApplication(D),g.onDestroy(()=>{this.detachView(g.hostView),Zi(this.components,g),I?.unregisterApplication(D)}),this._loadComponent(g),g}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick=()=>{if(this.tracingSnapshot!==null){let r=this.tracingSnapshot;this.tracingSnapshot=null,r.run(Ap.CHANGE_DETECTION,this._tick),r.dispose();return}if(this._runningTick)throw new Ze(101,!1);let n=wt(null);try{this._runningTick=!0,this.synchronize()}catch(r){this.internalErrorHandler(r)}finally{this._runningTick=!1,wt(n),this.afterTick.next()}};synchronize(){this._rendererFactory===null&&!this._injector.destroyed&&(this._rendererFactory=this._injector.get(eo,null,{optional:!0})),this.dirtyFlags|=this.deferredDirtyFlags,this.deferredDirtyFlags=0;let n=0;for(;this.dirtyFlags!==0&&n++<E1;)this.synchronizeOnce()}synchronizeOnce(){if(this.dirtyFlags|=this.deferredDirtyFlags,this.deferredDirtyFlags=0,this.dirtyFlags&16&&(this.dirtyFlags&=-17,this.rootEffectScheduler.flush()),this.dirtyFlags&7){let n=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8;for(let{_lView:r,notifyErrorHandler:s}of this.allViews)I1(r,s,n,this.zonelessEnabled);if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&23)return}else this._rendererFactory?.begin?.(),this._rendererFactory?.end?.();this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:n})=>Is(n))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(n){let r=n;this._views.push(r),r.attachToAppRef(this)}detachView(n){let r=n;Zi(this._views,r),r.detachFromAppRef()}_loadComponent(n){this.attachView(n.hostView),this.tick(),this.components.push(n),this._injector.get(ju,[]).forEach(s=>s(n))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(n=>n()),this._views.slice().forEach(n=>n.destroy())}finally{this._destroyed=!0,this._views=[],this._destroyListeners=[]}}onDestroy(n){return this._destroyListeners.push(n),()=>Zi(this._destroyListeners,n)}destroy(){if(this._destroyed)throw new Ze(406,!1);let n=this._injector;n.destroy&&!n.destroyed&&n.destroy()}get viewCount(){return this._views.length}static \u0275fac=function(r){return new(r||e)};static \u0275prov=tt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function Zi(e,t){let n=e.indexOf(t);n>-1&&e.splice(n,1)}function I1(e,t,n,r){if(!n&&!Is(e))return;oh(e,t,n&&!r?0:1)}function M1(e,t,n,r){return fh(e,Zf(),n)?t+wf(n)+r:_s}function Us(e,t,n){let r=qt(),s=Zf();if(fh(r,s,t)){let l=Dr(),f=H0();Zb(l,f,r,e,t,r[nn],n,!1)}return Us}function of(e,t,n,r,s){let l=t.inputs,f=s?"class":"style";pu(e,n,l[f],f,r)}function S1(e,t,n,r,s,l){let f=t.consts,u=ss(f,s),c=Ps(t,e,2,r,u);return qp(t,n,c,ss(f,l)),c.attrs!==null&&Al(c,c.attrs,!1),c.mergedAttrs!==null&&Al(c,c.mergedAttrs,!0),t.queries!==null&&t.queries.elementStart(t,c),c}function Ot(e,t,n,r){let s=qt(),l=Dr(),f=Un+e,u=s[nn],c=l.firstCreatePass?S1(f,l,s,t,n,r):l.data[f],g=T1(l,s,c,u,t,e);s[f]=g;let D=Wl(c);return Vo(c,!0),Vp(u,g,c),!m1(c)&&Jl()&&vu(l,s,g,c),I0()===0&&wr(g,s),M0(),D&&(Up(l,s,c),_p(l,c,s)),r!==null&&$p(s,c),Ot}function Lt(){let e=Sn();Gf()?R0():(e=e.parent,Vo(e,!1));let t=e;A0(t)&&N0(),S0();let n=Dr();return n.firstCreatePass&&(tu(n,e),kf(e)&&n.queries.elementEnd(e)),t.classesWithoutHost!=null&&q0(t)&&of(n,t,qt(),t.classesWithoutHost,!0),t.stylesWithoutHost!=null&&W0(t)&&of(n,t,qt(),t.stylesWithoutHost,!1),Lt}function Uo(e,t,n,r){return Ot(e,t,n,r),Lt(),Uo}var T1=(e,t,n,r,s,l)=>(eu(!0),kp(r,s,B0()));var vs="en-US";var A1=vs;function N1(e){typeof e=="string"&&(A1=e.toLowerCase().replace(/_/g,"-"))}var _1=(e,t,n)=>{};function $s(e,t,n,r){let s=qt(),l=Dr(),f=Sn();return O1(l,s,s[nn],f,e,t,r),$s}function R1(e,t,n,r){let s=e.cleanup;if(s!=null)for(let l=0;l<s.length-1;l+=2){let f=s[l];if(f===n&&s[l+1]===r){let u=t[ns],c=s[l+2];return u.length>c?u[c]:null}typeof f=="string"&&(l+=2)}return null}function O1(e,t,n,r,s,l,f){let u=Wl(r),g=e.firstCreatePass&&x0(e),D=t[Rn],I=E0(t),v=!0;if(r.type&3||f){let j=Mn(r,t),b=f?f(j):j,M=I.length,A=f?F=>f(Ln(F[r.index])):r.index,O=null;if(!f&&u&&(O=R1(e,t,s,r.index)),O!==null){let F=O.__ngLastListenerFn__||O;F.__ngNextListenerFn__=l,O.__ngLastListenerFn__=l,v=!1}else{l=af(r,t,D,l),_1(j,s,l);let F=n.listen(b,s,l);I.push(l,F),g&&g.push(s,A,M,M+1)}}else l=af(r,t,D,l);let p=r.outputs,w;if(v&&p!==null&&(w=p[s])){let j=w.length;if(j)for(let b=0;b<j;b+=2){let M=w[b],A=w[b+1],V=t[M][A].subscribe(l),_=I.length;I.push(l,V),g&&g.push(s,r.index,_,-(_+1))}}}function sf(e,t,n,r){let s=wt(null);try{return hn(6,t,n),n(r)!==!1}catch(l){return Xp(e,l),!1}finally{hn(7,t,n),wt(s)}}function af(e,t,n,r){return function s(l){if(l===Function)return r;let f=e.componentOffset>-1?jr(e.index,t):t;yu(f,5);let u=sf(t,n,r,l),c=s.__ngNextListenerFn__;for(;c;)u=sf(t,n,c,l)&&u,c=c.__ngNextListenerFn__;return u}}function vh(e=1){return V0(e)}function Zt(e,t=""){let n=qt(),r=Dr(),s=e+Un,l=r.firstCreatePass?Ps(r,s,1,t,null):r.data[s],f=L1(r,n,l,t,e);n[s]=f,Jl()&&vu(r,n,f,l),Vo(l,!1)}var L1=(e,t,n,r,s)=>(eu(!0),Pb(t[nn],r));function Du(e,t,n){let r=qt(),s=M1(r,e,t,n);return s!==_s&&F1(r,Kl(),s),Du}function F1(e,t,n){let r=w0(t,e);Vb(e[nn],r,n)}var Ll=class{ngModuleFactory;componentFactories;constructor(t,n){this.ngModuleFactory=t,this.componentFactories=n}},Eu=(()=>{class e{compileModuleSync(n){return new Rl(n)}compileModuleAsync(n){return Promise.resolve(this.compileModuleSync(n))}compileModuleAndAllComponentsSync(n){let r=this.compileModuleSync(n),s=Sf(n),l=Rp(s.declarations).reduce((f,u)=>{let c=mr(u);return c&&f.push(new Oo(c)),f},[]);return new Ll(r,l)}compileModuleAndAllComponentsAsync(n){return Promise.resolve(this.compileModuleAndAllComponentsSync(n))}clearCache(){}clearCacheFor(n){}getModuleId(n){}static \u0275fac=function(r){return new(r||e)};static \u0275prov=tt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var k1=(()=>{class e{zone=Oe(Ht);changeDetectionScheduler=Oe(Ro);applicationRef=Oe(or);_onMicrotaskEmptySubscription;initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static \u0275fac=function(r){return new(r||e)};static \u0275prov=tt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),P1=new ot("",{factory:()=>!1});function bh({ngZoneFactory:e,ignoreChangesOutsideZone:t,scheduleInRootZone:n}){return e??=()=>new Ht(Mt(Ve({},wh()),{scheduleInRootZone:n})),[{provide:Ht,useFactory:e},{provide:Zr,multi:!0,useFactory:()=>{let r=Oe(k1,{optional:!0});return()=>r.initialize()}},{provide:Zr,multi:!0,useFactory:()=>{let r=Oe(V1);return()=>{r.initialize()}}},t===!0?{provide:vp,useValue:!0}:[],{provide:bp,useValue:n??gp}]}function yh(e){let t=e?.ignoreChangesOutsideZone,n=e?.scheduleInRootZone,r=bh({ngZoneFactory:()=>{let s=wh(e);return s.scheduleInRootZone=n,s.shouldCoalesceEventChangeDetection&&su("NgZone_CoalesceEvent"),new Ht(s)},ignoreChangesOutsideZone:t,scheduleInRootZone:n});return js([{provide:P1,useValue:!0},{provide:Ss,useValue:!1},r])}function wh(e){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:e?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:e?.runCoalescing??!1}}var V1=(()=>{class e{subscription=new Rt;initialized=!1;zone=Oe(Ht);pendingTasks=Oe(no);initialize(){if(this.initialized)return;this.initialized=!0;let n=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(n=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{Ht.assertNotInAngularZone(),queueMicrotask(()=>{n!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(n),n=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{Ht.assertInAngularZone(),n??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static \u0275fac=function(r){return new(r||e)};static \u0275prov=tt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var H1=(()=>{class e{appRef=Oe(or);taskService=Oe(no);ngZone=Oe(Ht);zonelessEnabled=Oe(Ss);tracing=Oe(Ns,{optional:!0});disableScheduling=Oe(vp,{optional:!0})??!1;zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run;schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}];subscriptions=new Rt;angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(ds):null;scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(Oe(bp,{optional:!0})??!1);cancelScheduledCallback=null;useMicrotaskScheduler=!1;runningTick=!1;pendingRenderTaskId=null;constructor(){this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof wl||!this.zoneIsDefined)}notify(n){if(!this.zonelessEnabled&&n===5)return;let r=!1;switch(n){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 8:{this.appRef.deferredDirtyFlags|=8;break}case 6:{this.appRef.dirtyFlags|=2,r=!0;break}case 13:{this.appRef.dirtyFlags|=16,r=!0;break}case 14:{this.appRef.dirtyFlags|=2,r=!0;break}case 12:{r=!0;break}case 10:case 9:case 7:case 11:default:this.appRef.dirtyFlags|=8}if(this.appRef.tracingSnapshot=this.tracing?.snapshot(this.appRef.tracingSnapshot)??null,!this.shouldScheduleTick(r))return;let s=this.useMicrotaskScheduler?Bd:yp;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>s(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>s(()=>this.tick()))}shouldScheduleTick(n){return!(this.disableScheduling&&!n||this.appRef.destroyed||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(ds+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;if(this.appRef.dirtyFlags===0){this.cleanup();return}!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let n=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(r){throw this.taskService.remove(n),r}finally{this.cleanup()}this.useMicrotaskScheduler=!0,Bd(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(n)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let n=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(n)}}static \u0275fac=function(r){return new(r||e)};static \u0275prov=tt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function B1(){return typeof $localize<"u"&&$localize.locale||vs}var xu=new ot("",{providedIn:"root",factory:()=>Oe(xu,ut.Optional|ut.SkipSelf)||B1()});var Fl=new ot(""),U1=new ot("");function Do(e){return!e.moduleRef}function $1(e){let t=Do(e)?e.r3Injector:e.moduleRef.injector,n=t.get(Ht);return n.run(()=>{Do(e)?e.r3Injector.resolveInjectorInitializers():e.moduleRef.resolveInjectorInitializers();let r=t.get(tr,null),s;if(n.runOutsideAngular(()=>{s=n.onError.subscribe({next:l=>{r.handleError(l)}})}),Do(e)){let l=()=>t.destroy(),f=e.platformInjector.get(Fl);f.add(l),t.onDestroy(()=>{s.unsubscribe(),f.delete(l)})}else{let l=()=>e.moduleRef.destroy(),f=e.platformInjector.get(Fl);f.add(l),e.moduleRef.onDestroy(()=>{Zi(e.allPlatformModules,e.moduleRef),s.unsubscribe(),f.delete(l)})}return x1(r,n,()=>{let l=t.get(mh);return l.runInitializers(),l.donePromise.then(()=>{let f=t.get(xu,vs);if(N1(f||vs),!t.get(U1,!0))return Do(e)?t.get(or):(e.allPlatformModules.push(e.moduleRef),e.moduleRef);if(Do(e)){let c=t.get(or);return e.rootComponent!==void 0&&c.bootstrap(e.rootComponent),c}else return z1(e.moduleRef,e.allPlatformModules),e.moduleRef})})})}function z1(e,t){let n=e.injector.get(or);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(r=>n.bootstrap(r));else if(e.instance.ngDoBootstrap)e.instance.ngDoBootstrap(n);else throw new Ze(-403,!1);t.push(e)}var Xi=null;function q1(e=[],t){return Fn.create({name:t,providers:[{provide:Ds,useValue:"platform"},{provide:Fl,useValue:new Set([()=>Xi=null])},...e]})}function W1(e=[]){if(Xi)return Xi;let t=q1(e);return Xi=t,j1(),G1(t),t}function G1(e){let t=e.get(lu,null);xn(e,()=>{t?.forEach(n=>n())})}var $o=(()=>{class e{static __NG_ELEMENT_ID__=Y1}return e})();function Y1(e){return Z1(Sn(),qt(),(e&16)===16)}function Z1(e,t,n){if(xs(e)&&!n){let r=jr(e.index,t);return new Cr(r,r)}else if(e.type&175){let r=t[On];return new Cr(r,t)}return null}var kl=class{constructor(){}supports(t){return dh(t)}create(t){return new Pl(t)}},X1=(e,t)=>t,Pl=class{length=0;collection;_linkedRecords=null;_unlinkedRecords=null;_previousItHead=null;_itHead=null;_itTail=null;_additionsHead=null;_additionsTail=null;_movesHead=null;_movesTail=null;_removalsHead=null;_removalsTail=null;_identityChangesHead=null;_identityChangesTail=null;_trackByFn;constructor(t){this._trackByFn=t||X1}forEachItem(t){let n;for(n=this._itHead;n!==null;n=n._next)t(n)}forEachOperation(t){let n=this._itHead,r=this._removalsHead,s=0,l=null;for(;n||r;){let f=!r||n&&n.currentIndex<lf(r,s,l)?n:r,u=lf(f,s,l),c=f.currentIndex;if(f===r)s--,r=r._nextRemoved;else if(n=n._next,f.previousIndex==null)s++;else{l||(l=[]);let g=u-s,D=c-s;if(g!=D){for(let v=0;v<g;v++){let p=v<l.length?l[v]:l[v]=0,w=p+v;D<=w&&w<g&&(l[v]=p+1)}let I=f.previousIndex;l[I]=D-g}}u!==c&&t(f,u,c)}}forEachPreviousItem(t){let n;for(n=this._previousItHead;n!==null;n=n._nextPrevious)t(n)}forEachAddedItem(t){let n;for(n=this._additionsHead;n!==null;n=n._nextAdded)t(n)}forEachMovedItem(t){let n;for(n=this._movesHead;n!==null;n=n._nextMoved)t(n)}forEachRemovedItem(t){let n;for(n=this._removalsHead;n!==null;n=n._nextRemoved)t(n)}forEachIdentityChange(t){let n;for(n=this._identityChangesHead;n!==null;n=n._nextIdentityChange)t(n)}diff(t){if(t==null&&(t=[]),!dh(t))throw new Ze(900,!1);return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let n=this._itHead,r=!1,s,l,f;if(Array.isArray(t)){this.length=t.length;for(let u=0;u<this.length;u++)l=t[u],f=this._trackByFn(u,l),n===null||!Object.is(n.trackById,f)?(n=this._mismatch(n,l,f,u),r=!0):(r&&(n=this._verifyReinsertion(n,l,f,u)),Object.is(n.item,l)||this._addIdentityChange(n,l)),n=n._next}else s=0,h1(t,u=>{f=this._trackByFn(s,u),n===null||!Object.is(n.trackById,f)?(n=this._mismatch(n,u,f,s),r=!0):(r&&(n=this._verifyReinsertion(n,u,f,s)),Object.is(n.item,u)||this._addIdentityChange(n,u)),n=n._next,s++}),this.length=s;return this._truncate(n),this.collection=t,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let t;for(t=this._previousItHead=this._itHead;t!==null;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;t!==null;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;t!==null;t=t._nextMoved)t.previousIndex=t.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,n,r,s){let l;return t===null?l=this._itTail:(l=t._prev,this._remove(t)),t=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null),t!==null?(Object.is(t.item,n)||this._addIdentityChange(t,n),this._reinsertAfter(t,l,s)):(t=this._linkedRecords===null?null:this._linkedRecords.get(r,s),t!==null?(Object.is(t.item,n)||this._addIdentityChange(t,n),this._moveAfter(t,l,s)):t=this._addAfter(new Vl(n,r),l,s)),t}_verifyReinsertion(t,n,r,s){let l=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null);return l!==null?t=this._reinsertAfter(l,t._prev,s):t.currentIndex!=s&&(t.currentIndex=s,this._addToMoves(t,s)),t}_truncate(t){for(;t!==null;){let n=t._next;this._addToRemovals(this._unlink(t)),t=n}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,n,r){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(t);let s=t._prevRemoved,l=t._nextRemoved;return s===null?this._removalsHead=l:s._nextRemoved=l,l===null?this._removalsTail=s:l._prevRemoved=s,this._insertAfter(t,n,r),this._addToMoves(t,r),t}_moveAfter(t,n,r){return this._unlink(t),this._insertAfter(t,n,r),this._addToMoves(t,r),t}_addAfter(t,n,r){return this._insertAfter(t,n,r),this._additionsTail===null?this._additionsTail=this._additionsHead=t:this._additionsTail=this._additionsTail._nextAdded=t,t}_insertAfter(t,n,r){let s=n===null?this._itHead:n._next;return t._next=s,t._prev=n,s===null?this._itTail=t:s._prev=t,n===null?this._itHead=t:n._next=t,this._linkedRecords===null&&(this._linkedRecords=new bs),this._linkedRecords.put(t),t.currentIndex=r,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){this._linkedRecords!==null&&this._linkedRecords.remove(t);let n=t._prev,r=t._next;return n===null?this._itHead=r:n._next=r,r===null?this._itTail=n:r._prev=n,t}_addToMoves(t,n){return t.previousIndex===n||(this._movesTail===null?this._movesTail=this._movesHead=t:this._movesTail=this._movesTail._nextMoved=t),t}_addToRemovals(t){return this._unlinkedRecords===null&&(this._unlinkedRecords=new bs),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,n){return t.item=n,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=t:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=t,t}},Vl=class{item;trackById;currentIndex=null;previousIndex=null;_nextPrevious=null;_prev=null;_next=null;_prevDup=null;_nextDup=null;_prevRemoved=null;_nextRemoved=null;_nextAdded=null;_nextMoved=null;_nextIdentityChange=null;constructor(t,n){this.item=t,this.trackById=n}},Hl=class{_head=null;_tail=null;add(t){this._head===null?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,n){let r;for(r=this._head;r!==null;r=r._nextDup)if((n===null||n<=r.currentIndex)&&Object.is(r.trackById,t))return r;return null}remove(t){let n=t._prevDup,r=t._nextDup;return n===null?this._head=r:n._nextDup=r,r===null?this._tail=n:r._prevDup=n,this._head===null}},bs=class{map=new Map;put(t){let n=t.trackById,r=this.map.get(n);r||(r=new Hl,this.map.set(n,r)),r.add(t)}get(t,n){let r=t,s=this.map.get(r);return s?s.get(t,n):null}remove(t){let n=t.trackById;return this.map.get(n).remove(t)&&this.map.delete(n),t}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function lf(e,t,n){let r=e.previousIndex;if(r===null)return r;let s=0;return n&&r<n.length&&(s=n[r]),r+t+s}function uf(){return new Iu([new kl])}var Iu=(()=>{class e{factories;static \u0275prov=tt({token:e,providedIn:"root",factory:uf});constructor(n){this.factories=n}static create(n,r){if(r!=null){let s=r.factories.slice();n=n.concat(s)}return new e(n)}static extend(n){return{provide:e,useFactory:r=>e.create(n,r||uf()),deps:[[e,new t0,new Ef]]}}find(n){let r=this.factories.find(s=>s.supports(n));if(r!=null)return r;throw new Ze(901,!1)}}return e})();function Ch(e){try{let{rootComponent:t,appProviders:n,platformProviders:r}=e,s=W1(r),l=[bh({}),{provide:Ro,useExisting:H1},...n||[]],f=new ms({providers:l,parent:s,debugName:"",runEnvironmentInitializers:!1});return $1({r3Injector:f.injector,platformInjector:s,rootComponent:t})}catch(t){return Promise.reject(t)}}var cf=class{[Nr];constructor(t){this[Nr]=t}destroy(){this[Nr].destroy()}};var Sh=null;function io(){return Sh}function Th(e){Sh??=e}var qs=class{};var vn=new ot(""),Ah=(()=>{class e{historyGo(n){throw new Error("")}static \u0275fac=function(r){return new(r||e)};static \u0275prov=tt({token:e,factory:()=>Oe(tw),providedIn:"platform"})}return e})();var tw=(()=>{class e extends Ah{_location;_history;_doc=Oe(vn);constructor(){super(),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return io().getBaseHref(this._doc)}onPopState(n){let r=io().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",n,!1),()=>r.removeEventListener("popstate",n)}onHashChange(n){let r=io().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",n,!1),()=>r.removeEventListener("hashchange",n)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(n){this._location.pathname=n}pushState(n,r,s){this._history.pushState(n,r,s)}replaceState(n,r,s){this._history.replaceState(n,r,s)}forward(){this._history.forward()}back(){this._history.back()}historyGo(n=0){this._history.go(n)}getState(){return this._history.state}static \u0275fac=function(r){return new(r||e)};static \u0275prov=tt({token:e,factory:()=>new e,providedIn:"platform"})}return e})();function Nh(e,t){if(e.length==0)return t;if(t.length==0)return e;let n=0;return e.endsWith("/")&&n++,t.startsWith("/")&&n++,n==2?e+t.substring(1):n==1?e+t:e+"/"+t}function jh(e){let t=e.match(/#|\?|$/),n=t&&t.index||e.length,r=n-(e[n-1]==="/"?1:0);return e.slice(0,r)+e.slice(n)}function xr(e){return e&&e[0]!=="?"?"?"+e:e}var Gs=(()=>{class e{historyGo(n){throw new Error("")}static \u0275fac=function(r){return new(r||e)};static \u0275prov=tt({token:e,factory:()=>Oe(_h),providedIn:"root"})}return e})(),nw=new ot(""),_h=(()=>{class e extends Gs{_platformLocation;_baseHref;_removeListenerFns=[];constructor(n,r){super(),this._platformLocation=n,this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??Oe(vn).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}prepareExternalUrl(n){return Nh(this._baseHref,n)}path(n=!1){let r=this._platformLocation.pathname+xr(this._platformLocation.search),s=this._platformLocation.hash;return s&&n?`${r}${s}`:r}pushState(n,r,s,l){let f=this.prepareExternalUrl(s+xr(l));this._platformLocation.pushState(n,r,f)}replaceState(n,r,s,l){let f=this.prepareExternalUrl(s+xr(l));this._platformLocation.replaceState(n,r,f)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(n=0){this._platformLocation.historyGo?.(n)}static \u0275fac=function(r){return new(r||e)(ft(Ah),ft(nw,8))};static \u0275prov=tt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var zo=(()=>{class e{_subject=new Yt;_basePath;_locationStrategy;_urlChangeListeners=[];_urlChangeSubscription=null;constructor(n){this._locationStrategy=n;let r=this._locationStrategy.getBaseHref();this._basePath=iw(jh(Dh(r))),this._locationStrategy.onPopState(s=>{this._subject.next({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(n=!1){return this.normalize(this._locationStrategy.path(n))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(n,r=""){return this.path()==this.normalize(n+xr(r))}normalize(n){return e.stripTrailingSlash(ow(this._basePath,Dh(n)))}prepareExternalUrl(n){return n&&n[0]!=="/"&&(n="/"+n),this._locationStrategy.prepareExternalUrl(n)}go(n,r="",s=null){this._locationStrategy.pushState(s,"",n,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+xr(r)),s)}replaceState(n,r="",s=null){this._locationStrategy.replaceState(s,"",n,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+xr(r)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(n=0){this._locationStrategy.historyGo?.(n)}onUrlChange(n){return this._urlChangeListeners.push(n),this._urlChangeSubscription??=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}),()=>{let r=this._urlChangeListeners.indexOf(n);this._urlChangeListeners.splice(r,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(n="",r){this._urlChangeListeners.forEach(s=>s(n,r))}subscribe(n,r,s){return this._subject.subscribe({next:n,error:r??void 0,complete:s??void 0})}static normalizeQueryParams=xr;static joinWithSlash=Nh;static stripTrailingSlash=jh;static \u0275fac=function(r){return new(r||e)(ft(Gs))};static \u0275prov=tt({token:e,factory:()=>rw(),providedIn:"root"})}return e})();function rw(){return new zo(ft(Gs))}function ow(e,t){if(!e||!t.startsWith(e))return t;let n=t.substring(e.length);return n===""||["/",";","?","#"].includes(n[0])?n:t}function Dh(e){return e.replace(/\/index.html$/,"")}function iw(e){if(new RegExp("^(https?:)?//").test(e)){let[,n]=e.split(/\/\/[^\/]+/);return n}return e}function Rh(e,t){t=encodeURIComponent(t);for(let n of e.split(";")){let r=n.indexOf("="),[s,l]=r==-1?[n,""]:[n.slice(0,r),n.slice(r+1)];if(s.trim()===t)return decodeURIComponent(l)}return null}var Mu=class{$implicit;ngForOf;index;count;constructor(t,n,r,s){this.$implicit=t,this.ngForOf=n,this.index=r,this.count=s}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},Oh=(()=>{class e{_viewContainer;_template;_differs;set ngForOf(n){this._ngForOf=n,this._ngForOfDirty=!0}set ngForTrackBy(n){this._trackByFn=n}get ngForTrackBy(){return this._trackByFn}_ngForOf=null;_ngForOfDirty=!0;_differ=null;_trackByFn;constructor(n,r,s){this._viewContainer=n,this._template=r,this._differs=s}set ngForTemplate(n){n&&(this._template=n)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let n=this._ngForOf;!this._differ&&n&&(this._differ=this._differs.find(n).create(this.ngForTrackBy))}if(this._differ){let n=this._differ.diff(this._ngForOf);n&&this._applyChanges(n)}}_applyChanges(n){let r=this._viewContainer;n.forEachOperation((s,l,f)=>{if(s.previousIndex==null)r.createEmbeddedView(this._template,new Mu(s.item,this._ngForOf,-1,-1),f===null?void 0:f);else if(f==null)r.remove(l===null?void 0:l);else if(l!==null){let u=r.get(l);r.move(u,f),Eh(u,s)}});for(let s=0,l=r.length;s<l;s++){let u=r.get(s).context;u.index=s,u.count=l,u.ngForOf=this._ngForOf}n.forEachIdentityChange(s=>{let l=r.get(s.currentIndex);Eh(l,s)})}static ngTemplateContextGuard(n,r){return!0}static \u0275fac=function(r){return new(r||e)(ir(oo),ir(ks),ir(Iu))};static \u0275dir=Ho({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}})}return e})();function Eh(e,t){e.context.$implicit=t.item}var Lh=(()=>{class e{_viewContainer;_context=new Su;_thenTemplateRef=null;_elseTemplateRef=null;_thenViewRef=null;_elseViewRef=null;constructor(n,r){this._viewContainer=n,this._thenTemplateRef=r}set ngIf(n){this._context.$implicit=this._context.ngIf=n,this._updateView()}set ngIfThen(n){xh("ngIfThen",n),this._thenTemplateRef=n,this._thenViewRef=null,this._updateView()}set ngIfElse(n){xh("ngIfElse",n),this._elseTemplateRef=n,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngIfUseIfTypeGuard;static ngTemplateGuard_ngIf;static ngTemplateContextGuard(n,r){return!0}static \u0275fac=function(r){return new(r||e)(ir(oo),ir(ks))};static \u0275dir=Ho({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}})}return e})(),Su=class{$implicit=null;ngIf=null};function xh(e,t){if(!!!(!t||t.createEmbeddedView))throw new Error(`${e} must be a TemplateRef, but received '${tn(t)}'.`)}var Tu=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275mod=Hs({type:e});static \u0275inj=ys({})}return e})(),Fh="browser",sw="server";function Au(e){return e===sw}var Ws=class{};var _u=class extends qs{supportsDOMEvents=!0},Ru=class e extends _u{static makeCurrent(){Th(new e)}onAndCancel(t,n,r,s){return t.addEventListener(n,r,s),()=>{t.removeEventListener(n,r,s)}}dispatchEvent(t,n){t.dispatchEvent(n)}remove(t){t.remove()}createElement(t,n){return n=n||this.getDefaultDocument(),n.createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,n){return n==="window"?window:n==="document"?t:n==="body"?t.body:null}getBaseHref(t){let n=lw();return n==null?null:uw(n)}resetBaseElement(){qo=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return Rh(document.cookie,t)}},qo=null;function lw(){return qo=qo||document.querySelector("base"),qo?qo.getAttribute("href"):null}function uw(e){return new URL(e,document.baseURI).pathname}var cw=(()=>{class e{build(){return new XMLHttpRequest}static \u0275fac=function(r){return new(r||e)};static \u0275prov=tt({token:e,factory:e.\u0275fac})}return e})(),Ou=new ot(""),Uh=(()=>{class e{_zone;_plugins;_eventNameToPlugin=new Map;constructor(n,r){this._zone=r,n.forEach(s=>{s.manager=this}),this._plugins=n.slice().reverse()}addEventListener(n,r,s,l){return this._findPluginFor(r).addEventListener(n,r,s,l)}getZone(){return this._zone}_findPluginFor(n){let r=this._eventNameToPlugin.get(n);if(r)return r;if(r=this._plugins.find(l=>l.supports(n)),!r)throw new Ze(5101,!1);return this._eventNameToPlugin.set(n,r),r}static \u0275fac=function(r){return new(r||e)(ft(Ou),ft(Ht))};static \u0275prov=tt({token:e,factory:e.\u0275fac})}return e})(),Zs=class{_doc;constructor(t){this._doc=t}manager},Ys="ng-app-id";function kh(e){for(let t of e)t.remove()}function Ph(e,t){let n=t.createElement("style");return n.textContent=e,n}function dw(e,t,n,r){let s=e.head?.querySelectorAll(`style[${Ys}="${t}"],link[${Ys}="${t}"]`);if(s)for(let l of s)l.removeAttribute(Ys),l instanceof HTMLLinkElement?r.set(l.href.slice(l.href.lastIndexOf("/")+1),{usage:0,elements:[l]}):l.textContent&&n.set(l.textContent,{usage:0,elements:[l]})}function Lu(e,t){let n=t.createElement("link");return n.setAttribute("rel","stylesheet"),n.setAttribute("href",e),n}var $h=(()=>{class e{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;isServer;constructor(n,r,s,l={}){this.doc=n,this.appId=r,this.nonce=s,this.isServer=Au(l),dw(n,r,this.inline,this.external),this.hosts.add(n.head)}addStyles(n,r){for(let s of n)this.addUsage(s,this.inline,Ph);r?.forEach(s=>this.addUsage(s,this.external,Lu))}removeStyles(n,r){for(let s of n)this.removeUsage(s,this.inline);r?.forEach(s=>this.removeUsage(s,this.external))}addUsage(n,r,s){let l=r.get(n);l?l.usage++:r.set(n,{usage:1,elements:[...this.hosts].map(f=>this.addElement(f,s(n,this.doc)))})}removeUsage(n,r){let s=r.get(n);s&&(s.usage--,s.usage<=0&&(kh(s.elements),r.delete(n)))}ngOnDestroy(){for(let[,{elements:n}]of[...this.inline,...this.external])kh(n);this.hosts.clear()}addHost(n){this.hosts.add(n);for(let[r,{elements:s}]of this.inline)s.push(this.addElement(n,Ph(r,this.doc)));for(let[r,{elements:s}]of this.external)s.push(this.addElement(n,Lu(r,this.doc)))}removeHost(n){this.hosts.delete(n)}addElement(n,r){return this.nonce&&r.setAttribute("nonce",this.nonce),this.isServer&&r.setAttribute(Ys,this.appId),n.appendChild(r)}static \u0275fac=function(r){return new(r||e)(ft(vn),ft(au),ft(uu,8),ft(ro))};static \u0275prov=tt({token:e,factory:e.\u0275fac})}return e})(),Nu={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},ku=/%COMP%/g,zh="%COMP%",fw=`_nghost-${zh}`,pw=`_ngcontent-${zh}`,hw=!0,gw=new ot("",{providedIn:"root",factory:()=>hw});function mw(e){return pw.replace(ku,e)}function vw(e){return fw.replace(ku,e)}function qh(e,t){return t.map(n=>n.replace(ku,e))}var Vh=(()=>{class e{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;platformId;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;platformIsServer;constructor(n,r,s,l,f,u,c,g=null,D=null){this.eventManager=n,this.sharedStylesHost=r,this.appId=s,this.removeStylesOnCompDestroy=l,this.doc=f,this.platformId=u,this.ngZone=c,this.nonce=g,this.tracingService=D,this.platformIsServer=Au(u),this.defaultRenderer=new Wo(n,f,c,this.platformIsServer,this.tracingService)}createRenderer(n,r){if(!n||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===kn.ShadowDom&&(r=Mt(Ve({},r),{encapsulation:kn.Emulated}));let s=this.getOrCreateRenderer(n,r);return s instanceof Xs?s.applyToHost(n):s instanceof Go&&s.applyStyles(),s}getOrCreateRenderer(n,r){let s=this.rendererByCompId,l=s.get(r.id);if(!l){let f=this.doc,u=this.ngZone,c=this.eventManager,g=this.sharedStylesHost,D=this.removeStylesOnCompDestroy,I=this.platformIsServer;switch(r.encapsulation){case kn.Emulated:l=new Xs(c,g,r,this.appId,D,f,u,I,this.tracingService);break;case kn.ShadowDom:return new Fu(c,g,n,r,f,u,this.nonce,I,this.tracingService);default:l=new Go(c,g,r,D,f,u,I,this.tracingService);break}s.set(r.id,l)}return l}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(n){this.rendererByCompId.delete(n)}static \u0275fac=function(r){return new(r||e)(ft(Uh),ft($h),ft(au),ft(gw),ft(vn),ft(ro),ft(Ht),ft(uu),ft(Ns,8))};static \u0275prov=tt({token:e,factory:e.\u0275fac})}return e})(),Wo=class{eventManager;doc;ngZone;platformIsServer;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(t,n,r,s,l){this.eventManager=t,this.doc=n,this.ngZone=r,this.platformIsServer=s,this.tracingService=l}destroy(){}destroyNode=null;createElement(t,n){return n?this.doc.createElementNS(Nu[n]||n,t):this.doc.createElement(t)}createComment(t){return this.doc.createComment(t)}createText(t){return this.doc.createTextNode(t)}appendChild(t,n){(Hh(t)?t.content:t).appendChild(n)}insertBefore(t,n,r){t&&(Hh(t)?t.content:t).insertBefore(n,r)}removeChild(t,n){n.remove()}selectRootElement(t,n){let r=typeof t=="string"?this.doc.querySelector(t):t;if(!r)throw new Ze(-5104,!1);return n||(r.textContent=""),r}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,n,r,s){if(s){n=s+":"+n;let l=Nu[s];l?t.setAttributeNS(l,n,r):t.setAttribute(n,r)}else t.setAttribute(n,r)}removeAttribute(t,n,r){if(r){let s=Nu[r];s?t.removeAttributeNS(s,n):t.removeAttribute(`${r}:${n}`)}else t.removeAttribute(n)}addClass(t,n){t.classList.add(n)}removeClass(t,n){t.classList.remove(n)}setStyle(t,n,r,s){s&(Er.DashCase|Er.Important)?t.style.setProperty(n,r,s&Er.Important?"important":""):t.style[n]=r}removeStyle(t,n,r){r&Er.DashCase?t.style.removeProperty(n):t.style[n]=""}setProperty(t,n,r){t!=null&&(t[n]=r)}setValue(t,n){t.nodeValue=n}listen(t,n,r,s){if(typeof t=="string"&&(t=io().getGlobalEventTarget(this.doc,t),!t))throw new Error(`Unsupported event target ${t} for event ${n}`);let l=this.decoratePreventDefault(r);return this.tracingService!==null&&this.tracingService.wrapEventListener&&(l=this.tracingService.wrapEventListener(t,n,l)),this.eventManager.addEventListener(t,n,l,s)}decoratePreventDefault(t){return n=>{if(n==="__ngUnwrap__")return t;(this.platformIsServer?this.ngZone.runGuarded(()=>t(n)):t(n))===!1&&n.preventDefault()}}};function Hh(e){return e.tagName==="TEMPLATE"&&e.content!==void 0}var Fu=class extends Wo{sharedStylesHost;hostEl;shadowRoot;constructor(t,n,r,s,l,f,u,c,g){super(t,l,f,c,g),this.sharedStylesHost=n,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let D=qh(s.id,s.styles);for(let v of D){let p=document.createElement("style");u&&p.setAttribute("nonce",u),p.textContent=v,this.shadowRoot.appendChild(p)}let I=s.getExternalStyles?.();if(I)for(let v of I){let p=Lu(v,l);u&&p.setAttribute("nonce",u),this.shadowRoot.appendChild(p)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}appendChild(t,n){return super.appendChild(this.nodeOrShadowRoot(t),n)}insertBefore(t,n,r){return super.insertBefore(this.nodeOrShadowRoot(t),n,r)}removeChild(t,n){return super.removeChild(null,n)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Go=class extends Wo{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(t,n,r,s,l,f,u,c,g){super(t,l,f,u,c),this.sharedStylesHost=n,this.removeStylesOnCompDestroy=s,this.styles=g?qh(g,r.styles):r.styles,this.styleUrls=r.getExternalStyles?.(g)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},Xs=class extends Go{contentAttr;hostAttr;constructor(t,n,r,s,l,f,u,c,g){let D=s+"-"+r.id;super(t,n,r,l,f,u,c,g,D),this.contentAttr=mw(D),this.hostAttr=vw(D)}applyToHost(t){this.applyStyles(),this.setAttribute(t,this.hostAttr,"")}createElement(t,n){let r=super.createElement(t,n);return super.setAttribute(r,this.contentAttr,""),r}},bw=(()=>{class e extends Zs{constructor(n){super(n)}supports(n){return!0}addEventListener(n,r,s,l){return n.addEventListener(r,s,l),()=>this.removeEventListener(n,r,s,l)}removeEventListener(n,r,s,l){return n.removeEventListener(r,s,l)}static \u0275fac=function(r){return new(r||e)(ft(vn))};static \u0275prov=tt({token:e,factory:e.\u0275fac})}return e})(),Bh=["alt","control","meta","shift"],yw={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},ww={alt:e=>e.altKey,control:e=>e.ctrlKey,meta:e=>e.metaKey,shift:e=>e.shiftKey},Cw=(()=>{class e extends Zs{constructor(n){super(n)}supports(n){return e.parseEventName(n)!=null}addEventListener(n,r,s,l){let f=e.parseEventName(r),u=e.eventCallback(f.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>io().onAndCancel(n,f.domEventName,u,l))}static parseEventName(n){let r=n.toLowerCase().split("."),s=r.shift();if(r.length===0||!(s==="keydown"||s==="keyup"))return null;let l=e._normalizeKey(r.pop()),f="",u=r.indexOf("code");if(u>-1&&(r.splice(u,1),f="code."),Bh.forEach(g=>{let D=r.indexOf(g);D>-1&&(r.splice(D,1),f+=g+".")}),f+=l,r.length!=0||l.length===0)return null;let c={};return c.domEventName=s,c.fullKey=f,c}static matchEventFullKeyCode(n,r){let s=yw[n.key]||n.key,l="";return r.indexOf("code.")>-1&&(s=n.code,l="code."),s==null||!s?!1:(s=s.toLowerCase(),s===" "?s="space":s==="."&&(s="dot"),Bh.forEach(f=>{if(f!==s){let u=ww[f];u(n)&&(l+=f+".")}}),l+=s,l===r)}static eventCallback(n,r,s){return l=>{e.matchEventFullKeyCode(l,n)&&s.runGuarded(()=>r(l))}}static _normalizeKey(n){return n==="esc"?"escape":n}static \u0275fac=function(r){return new(r||e)(ft(vn))};static \u0275prov=tt({token:e,factory:e.\u0275fac})}return e})();function Wh(e,t){return Ch(Ve({rootComponent:e},jw(t)))}function jw(e){return{appProviders:[...Mw,...e?.providers??[]],platformProviders:Iw}}function Dw(){Ru.makeCurrent()}function Ew(){return new tr}function xw(){return Sp(document),document}var Iw=[{provide:ro,useValue:Fh},{provide:lu,useValue:Dw,multi:!0},{provide:vn,useFactory:xw,deps:[]}];var Mw=[{provide:Ds,useValue:"root"},{provide:tr,useFactory:Ew,deps:[]},{provide:Ou,useClass:bw,multi:!0,deps:[vn,Ht,ro]},{provide:Ou,useClass:Cw,multi:!0,deps:[vn]},Vh,$h,Uh,{provide:eo,useExisting:Vh},{provide:Ws,useClass:cw,deps:[]},[]];var Gh=(()=>{class e{_doc;constructor(n){this._doc=n}getTitle(){return this._doc.title}setTitle(n){this._doc.title=n||""}static \u0275fac=function(r){return new(r||e)(ft(vn))};static \u0275prov=tt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var at="primary",ui=Symbol("RouteTitle"),Uu=class{params;constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){let n=this.params[t];return Array.isArray(n)?n[0]:n}return null}getAll(t){if(this.has(t)){let n=this.params[t];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}};function fo(e){return new Uu(e)}function Tw(e,t,n){let r=n.path.split("/");if(r.length>e.length||n.pathMatch==="full"&&(t.hasChildren()||r.length<e.length))return null;let s={};for(let l=0;l<r.length;l++){let f=r[l],u=e[l];if(f[0]===":")s[f.substring(1)]=u;else if(f!==u.path)return null}return{consumed:e.slice(0,r.length),posParams:s}}function Aw(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(!Pn(e[n],t[n]))return!1;return!0}function Pn(e,t){let n=e?$u(e):void 0,r=t?$u(t):void 0;if(!n||!r||n.length!=r.length)return!1;let s;for(let l=0;l<n.length;l++)if(s=n[l],!tg(e[s],t[s]))return!1;return!0}function $u(e){return[...Object.keys(e),...Object.getOwnPropertySymbols(e)]}function tg(e,t){if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;let n=[...e].sort(),r=[...t].sort();return n.every((s,l)=>r[l]===s)}else return e===t}function ng(e){return e.length>0?e[e.length-1]:null}function sr(e){return Ua(e)?e:Bo(e)?kt(Promise.resolve(e)):it(e)}var Nw={exact:og,subset:ig},rg={exact:_w,subset:Rw,ignored:()=>!0};function Yh(e,t,n){return Nw[n.paths](e.root,t.root,n.matrixParams)&&rg[n.queryParams](e.queryParams,t.queryParams)&&!(n.fragment==="exact"&&e.fragment!==t.fragment)}function _w(e,t){return Pn(e,t)}function og(e,t,n){if(!Mr(e.segments,t.segments)||!Js(e.segments,t.segments,n)||e.numberOfChildren!==t.numberOfChildren)return!1;for(let r in t.children)if(!e.children[r]||!og(e.children[r],t.children[r],n))return!1;return!0}function Rw(e,t){return Object.keys(t).length<=Object.keys(e).length&&Object.keys(t).every(n=>tg(e[n],t[n]))}function ig(e,t,n){return sg(e,t,t.segments,n)}function sg(e,t,n,r){if(e.segments.length>n.length){let s=e.segments.slice(0,n.length);return!(!Mr(s,n)||t.hasChildren()||!Js(s,n,r))}else if(e.segments.length===n.length){if(!Mr(e.segments,n)||!Js(e.segments,n,r))return!1;for(let s in t.children)if(!e.children[s]||!ig(e.children[s],t.children[s],r))return!1;return!0}else{let s=n.slice(0,e.segments.length),l=n.slice(e.segments.length);return!Mr(e.segments,s)||!Js(e.segments,s,r)||!e.children[at]?!1:sg(e.children[at],t,l,r)}}function Js(e,t,n){return t.every((r,s)=>rg[n](e[s].parameters,r.parameters))}var Wn=class{root;queryParams;fragment;_queryParamMap;constructor(t=new jt([],{}),n={},r=null){this.root=t,this.queryParams=n,this.fragment=r}get queryParamMap(){return this._queryParamMap??=fo(this.queryParams),this._queryParamMap}toString(){return Fw.serialize(this)}},jt=class{segments;children;parent=null;constructor(t,n){this.segments=t,this.children=n,Object.values(n).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return ea(this)}},Ir=class{path;parameters;_parameterMap;constructor(t,n){this.path=t,this.parameters=n}get parameterMap(){return this._parameterMap??=fo(this.parameters),this._parameterMap}toString(){return lg(this)}};function Ow(e,t){return Mr(e,t)&&e.every((n,r)=>Pn(n.parameters,t[r].parameters))}function Mr(e,t){return e.length!==t.length?!1:e.every((n,r)=>n.path===t[r].path)}function Lw(e,t){let n=[];return Object.entries(e.children).forEach(([r,s])=>{r===at&&(n=n.concat(t(s,r)))}),Object.entries(e.children).forEach(([r,s])=>{r!==at&&(n=n.concat(t(s,r)))}),n}var gc=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275prov=tt({token:e,factory:()=>new Jo,providedIn:"root"})}return e})(),Jo=class{parse(t){let n=new qu(t);return new Wn(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(t){let n=`/${Yo(t.root,!0)}`,r=Vw(t.queryParams),s=typeof t.fragment=="string"?`#${kw(t.fragment)}`:"";return`${n}${r}${s}`}},Fw=new Jo;function ea(e){return e.segments.map(t=>lg(t)).join("/")}function Yo(e,t){if(!e.hasChildren())return ea(e);if(t){let n=e.children[at]?Yo(e.children[at],!1):"",r=[];return Object.entries(e.children).forEach(([s,l])=>{s!==at&&r.push(`${s}:${Yo(l,!1)}`)}),r.length>0?`${n}(${r.join("//")})`:n}else{let n=Lw(e,(r,s)=>s===at?[Yo(e.children[at],!1)]:[`${s}:${Yo(r,!1)}`]);return Object.keys(e.children).length===1&&e.children[at]!=null?`${ea(e)}/${n[0]}`:`${ea(e)}/(${n.join("//")})`}}function ag(e){return encodeURIComponent(e).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Qs(e){return ag(e).replace(/%3B/gi,";")}function kw(e){return encodeURI(e)}function zu(e){return ag(e).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function ta(e){return decodeURIComponent(e)}function Zh(e){return ta(e.replace(/\+/g,"%20"))}function lg(e){return`${zu(e.path)}${Pw(e.parameters)}`}function Pw(e){return Object.entries(e).map(([t,n])=>`;${zu(t)}=${zu(n)}`).join("")}function Vw(e){let t=Object.entries(e).map(([n,r])=>Array.isArray(r)?r.map(s=>`${Qs(n)}=${Qs(s)}`).join("&"):`${Qs(n)}=${Qs(r)}`).filter(n=>n);return t.length?`?${t.join("&")}`:""}var Hw=/^[^\/()?;#]+/;function Pu(e){let t=e.match(Hw);return t?t[0]:""}var Bw=/^[^\/()?;=#]+/;function Uw(e){let t=e.match(Bw);return t?t[0]:""}var $w=/^[^=?&#]+/;function zw(e){let t=e.match($w);return t?t[0]:""}var qw=/^[^&#]+/;function Ww(e){let t=e.match(qw);return t?t[0]:""}var qu=class{url;remaining;constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new jt([],{}):new jt([],this.parseChildren())}parseQueryParams(){let t={};if(this.consumeOptional("?"))do this.parseQueryParam(t);while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(t.length>0||Object.keys(n).length>0)&&(r[at]=new jt(t,n)),r}parseSegment(){let t=Pu(this.remaining);if(t===""&&this.peekStartsWith(";"))throw new Ze(4009,!1);return this.capture(t),new Ir(ta(t),this.parseMatrixParams())}parseMatrixParams(){let t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){let n=Uw(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){let s=Pu(this.remaining);s&&(r=s,this.capture(r))}t[ta(n)]=ta(r)}parseQueryParam(t){let n=zw(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){let f=Ww(this.remaining);f&&(r=f,this.capture(r))}let s=Zh(n),l=Zh(r);if(t.hasOwnProperty(s)){let f=t[s];Array.isArray(f)||(f=[f],t[s]=f),f.push(l)}else t[s]=l}parseParens(t){let n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=Pu(this.remaining),s=this.remaining[r.length];if(s!=="/"&&s!==")"&&s!==";")throw new Ze(4010,!1);let l;r.indexOf(":")>-1?(l=r.slice(0,r.indexOf(":")),this.capture(l),this.capture(":")):t&&(l=at);let f=this.parseChildren();n[l]=Object.keys(f).length===1?f[at]:new jt([],f),this.consumeOptional("//")}return n}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return this.peekStartsWith(t)?(this.remaining=this.remaining.substring(t.length),!0):!1}capture(t){if(!this.consumeOptional(t))throw new Ze(4011,!1)}};function ug(e){return e.segments.length>0?new jt([],{[at]:e}):e}function cg(e){let t={};for(let[r,s]of Object.entries(e.children)){let l=cg(s);if(r===at&&l.segments.length===0&&l.hasChildren())for(let[f,u]of Object.entries(l.children))t[f]=u;else(l.segments.length>0||l.hasChildren())&&(t[r]=l)}let n=new jt(e.segments,t);return Gw(n)}function Gw(e){if(e.numberOfChildren===1&&e.children[at]){let t=e.children[at];return new jt(e.segments.concat(t.segments),t.children)}return e}function ei(e){return e instanceof Wn}function Yw(e,t,n=null,r=null){let s=dg(e);return fg(s,t,n,r)}function dg(e){let t;function n(l){let f={};for(let c of l.children){let g=n(c);f[c.outlet]=g}let u=new jt(l.url,f);return l===e&&(t=u),u}let r=n(e.root),s=ug(r);return t??s}function fg(e,t,n,r){let s=e;for(;s.parent;)s=s.parent;if(t.length===0)return Vu(s,s,s,n,r);let l=Zw(t);if(l.toRoot())return Vu(s,s,new jt([],{}),n,r);let f=Xw(l,s,e),u=f.processChildren?Xo(f.segmentGroup,f.index,l.commands):hg(f.segmentGroup,f.index,l.commands);return Vu(s,f.segmentGroup,u,n,r)}function na(e){return typeof e=="object"&&e!=null&&!e.outlets&&!e.segmentPath}function ti(e){return typeof e=="object"&&e!=null&&e.outlets}function Vu(e,t,n,r,s){let l={};r&&Object.entries(r).forEach(([c,g])=>{l[c]=Array.isArray(g)?g.map(D=>`${D}`):`${g}`});let f;e===t?f=n:f=pg(e,t,n);let u=ug(cg(f));return new Wn(u,l,s)}function pg(e,t,n){let r={};return Object.entries(e.children).forEach(([s,l])=>{l===t?r[s]=n:r[s]=pg(l,t,n)}),new jt(e.segments,r)}var ra=class{isAbsolute;numberOfDoubleDots;commands;constructor(t,n,r){if(this.isAbsolute=t,this.numberOfDoubleDots=n,this.commands=r,t&&r.length>0&&na(r[0]))throw new Ze(4003,!1);let s=r.find(ti);if(s&&s!==ng(r))throw new Ze(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function Zw(e){if(typeof e[0]=="string"&&e.length===1&&e[0]==="/")return new ra(!0,0,e);let t=0,n=!1,r=e.reduce((s,l,f)=>{if(typeof l=="object"&&l!=null){if(l.outlets){let u={};return Object.entries(l.outlets).forEach(([c,g])=>{u[c]=typeof g=="string"?g.split("/"):g}),[...s,{outlets:u}]}if(l.segmentPath)return[...s,l.segmentPath]}return typeof l!="string"?[...s,l]:f===0?(l.split("/").forEach((u,c)=>{c==0&&u==="."||(c==0&&u===""?n=!0:u===".."?t++:u!=""&&s.push(u))}),s):[...s,l]},[]);return new ra(n,t,r)}var lo=class{segmentGroup;processChildren;index;constructor(t,n,r){this.segmentGroup=t,this.processChildren=n,this.index=r}};function Xw(e,t,n){if(e.isAbsolute)return new lo(t,!0,0);if(!n)return new lo(t,!1,NaN);if(n.parent===null)return new lo(n,!0,0);let r=na(e.commands[0])?0:1,s=n.segments.length-1+r;return Qw(n,s,e.numberOfDoubleDots)}function Qw(e,t,n){let r=e,s=t,l=n;for(;l>s;){if(l-=s,r=r.parent,!r)throw new Ze(4005,!1);s=r.segments.length}return new lo(r,!1,s-l)}function Kw(e){return ti(e[0])?e[0].outlets:{[at]:e}}function hg(e,t,n){if(e??=new jt([],{}),e.segments.length===0&&e.hasChildren())return Xo(e,t,n);let r=Jw(e,t,n),s=n.slice(r.commandIndex);if(r.match&&r.pathIndex<e.segments.length){let l=new jt(e.segments.slice(0,r.pathIndex),{});return l.children[at]=new jt(e.segments.slice(r.pathIndex),e.children),Xo(l,0,s)}else return r.match&&s.length===0?new jt(e.segments,{}):r.match&&!e.hasChildren()?Wu(e,t,n):r.match?Xo(e,0,s):Wu(e,t,n)}function Xo(e,t,n){if(n.length===0)return new jt(e.segments,{});{let r=Kw(n),s={};if(Object.keys(r).some(l=>l!==at)&&e.children[at]&&e.numberOfChildren===1&&e.children[at].segments.length===0){let l=Xo(e.children[at],t,n);return new jt(e.segments,l.children)}return Object.entries(r).forEach(([l,f])=>{typeof f=="string"&&(f=[f]),f!==null&&(s[l]=hg(e.children[l],t,f))}),Object.entries(e.children).forEach(([l,f])=>{r[l]===void 0&&(s[l]=f)}),new jt(e.segments,s)}}function Jw(e,t,n){let r=0,s=t,l={match:!1,pathIndex:0,commandIndex:0};for(;s<e.segments.length;){if(r>=n.length)return l;let f=e.segments[s],u=n[r];if(ti(u))break;let c=`${u}`,g=r<n.length-1?n[r+1]:null;if(s>0&&c===void 0)break;if(c&&g&&typeof g=="object"&&g.outlets===void 0){if(!Qh(c,g,f))return l;r+=2}else{if(!Qh(c,{},f))return l;r++}s++}return{match:!0,pathIndex:s,commandIndex:r}}function Wu(e,t,n){let r=e.segments.slice(0,t),s=0;for(;s<n.length;){let l=n[s];if(ti(l)){let c=eC(l.outlets);return new jt(r,c)}if(s===0&&na(n[0])){let c=e.segments[t];r.push(new Ir(c.path,Xh(n[0]))),s++;continue}let f=ti(l)?l.outlets[at]:`${l}`,u=s<n.length-1?n[s+1]:null;f&&u&&na(u)?(r.push(new Ir(f,Xh(u))),s+=2):(r.push(new Ir(f,{})),s++)}return new jt(r,{})}function eC(e){let t={};return Object.entries(e).forEach(([n,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(t[n]=Wu(new jt([],{}),0,r))}),t}function Xh(e){let t={};return Object.entries(e).forEach(([n,r])=>t[n]=`${r}`),t}function Qh(e,t,n){return e==n.path&&Pn(t,n.parameters)}var Qo="imperative",Wt=function(e){return e[e.NavigationStart=0]="NavigationStart",e[e.NavigationEnd=1]="NavigationEnd",e[e.NavigationCancel=2]="NavigationCancel",e[e.NavigationError=3]="NavigationError",e[e.RoutesRecognized=4]="RoutesRecognized",e[e.ResolveStart=5]="ResolveStart",e[e.ResolveEnd=6]="ResolveEnd",e[e.GuardsCheckStart=7]="GuardsCheckStart",e[e.GuardsCheckEnd=8]="GuardsCheckEnd",e[e.RouteConfigLoadStart=9]="RouteConfigLoadStart",e[e.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",e[e.ChildActivationStart=11]="ChildActivationStart",e[e.ChildActivationEnd=12]="ChildActivationEnd",e[e.ActivationStart=13]="ActivationStart",e[e.ActivationEnd=14]="ActivationEnd",e[e.Scroll=15]="Scroll",e[e.NavigationSkipped=16]="NavigationSkipped",e}(Wt||{}),bn=class{id;url;constructor(t,n){this.id=t,this.url=n}},ni=class extends bn{type=Wt.NavigationStart;navigationTrigger;restoredState;constructor(t,n,r="imperative",s=null){super(t,n),this.navigationTrigger=r,this.restoredState=s}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Sr=class extends bn{urlAfterRedirects;type=Wt.NavigationEnd;constructor(t,n,r){super(t,n),this.urlAfterRedirects=r}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},cn=function(e){return e[e.Redirect=0]="Redirect",e[e.SupersededByNewNavigation=1]="SupersededByNewNavigation",e[e.NoDataFromResolver=2]="NoDataFromResolver",e[e.GuardRejected=3]="GuardRejected",e}(cn||{}),Gu=function(e){return e[e.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",e[e.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",e}(Gu||{}),qn=class extends bn{reason;code;type=Wt.NavigationCancel;constructor(t,n,r,s){super(t,n),this.reason=r,this.code=s}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Tr=class extends bn{reason;code;type=Wt.NavigationSkipped;constructor(t,n,r,s){super(t,n),this.reason=r,this.code=s}},ri=class extends bn{error;target;type=Wt.NavigationError;constructor(t,n,r,s){super(t,n),this.error=r,this.target=s}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},oa=class extends bn{urlAfterRedirects;state;type=Wt.RoutesRecognized;constructor(t,n,r,s){super(t,n),this.urlAfterRedirects=r,this.state=s}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Yu=class extends bn{urlAfterRedirects;state;type=Wt.GuardsCheckStart;constructor(t,n,r,s){super(t,n),this.urlAfterRedirects=r,this.state=s}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Zu=class extends bn{urlAfterRedirects;state;shouldActivate;type=Wt.GuardsCheckEnd;constructor(t,n,r,s,l){super(t,n),this.urlAfterRedirects=r,this.state=s,this.shouldActivate=l}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Xu=class extends bn{urlAfterRedirects;state;type=Wt.ResolveStart;constructor(t,n,r,s){super(t,n),this.urlAfterRedirects=r,this.state=s}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Qu=class extends bn{urlAfterRedirects;state;type=Wt.ResolveEnd;constructor(t,n,r,s){super(t,n),this.urlAfterRedirects=r,this.state=s}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Ku=class{route;type=Wt.RouteConfigLoadStart;constructor(t){this.route=t}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Ju=class{route;type=Wt.RouteConfigLoadEnd;constructor(t){this.route=t}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},ec=class{snapshot;type=Wt.ChildActivationStart;constructor(t){this.snapshot=t}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},tc=class{snapshot;type=Wt.ChildActivationEnd;constructor(t){this.snapshot=t}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},nc=class{snapshot;type=Wt.ActivationStart;constructor(t){this.snapshot=t}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},rc=class{snapshot;type=Wt.ActivationEnd;constructor(t){this.snapshot=t}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var oi=class{},po=class{url;navigationBehaviorOptions;constructor(t,n){this.url=t,this.navigationBehaviorOptions=n}};function tC(e,t){return e.providers&&!e._injector&&(e._injector=wu(e.providers,t,`Route: ${e.path}`)),e._injector??t}function Tn(e){return e.outlet||at}function nC(e,t){let n=e.filter(r=>Tn(r)===t);return n.push(...e.filter(r=>Tn(r)!==t)),n}function ci(e){if(!e)return null;if(e.routeConfig?._injector)return e.routeConfig._injector;for(let t=e.parent;t;t=t.parent){let n=t.routeConfig;if(n?._loadedInjector)return n._loadedInjector;if(n?._injector)return n._injector}return null}var oc=class{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return ci(this.route?.snapshot)??this.rootInjector}constructor(t){this.rootInjector=t,this.children=new da(this.rootInjector)}},da=(()=>{class e{rootInjector;contexts=new Map;constructor(n){this.rootInjector=n}onChildOutletCreated(n,r){let s=this.getOrCreateContext(n);s.outlet=r,this.contexts.set(n,s)}onChildOutletDestroyed(n){let r=this.getContext(n);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){let n=this.contexts;return this.contexts=new Map,n}onOutletReAttached(n){this.contexts=n}getOrCreateContext(n){let r=this.getContext(n);return r||(r=new oc(this.rootInjector),this.contexts.set(n,r)),r}getContext(n){return this.contexts.get(n)||null}static \u0275fac=function(r){return new(r||e)(ft(mn))};static \u0275prov=tt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),ia=class{_root;constructor(t){this._root=t}get root(){return this._root.value}parent(t){let n=this.pathFromRoot(t);return n.length>1?n[n.length-2]:null}children(t){let n=ic(t,this._root);return n?n.children.map(r=>r.value):[]}firstChild(t){let n=ic(t,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(t){let n=sc(t,this._root);return n.length<2?[]:n[n.length-2].children.map(s=>s.value).filter(s=>s!==t)}pathFromRoot(t){return sc(t,this._root).map(n=>n.value)}};function ic(e,t){if(e===t.value)return t;for(let n of t.children){let r=ic(e,n);if(r)return r}return null}function sc(e,t){if(e===t.value)return[t];for(let n of t.children){let r=sc(e,n);if(r.length)return r.unshift(t),r}return[]}var un=class{value;children;constructor(t,n){this.value=t,this.children=n}toString(){return`TreeNode(${this.value})`}};function ao(e){let t={};return e&&e.children.forEach(n=>t[n.value.outlet]=n),t}var sa=class extends ia{snapshot;constructor(t,n){super(t),this.snapshot=n,mc(this,t)}toString(){return this.snapshot.toString()}};function gg(e){let t=rC(e),n=new $t([new Ir("",{})]),r=new $t({}),s=new $t({}),l=new $t({}),f=new $t(""),u=new ho(n,r,l,f,s,at,e,t.root);return u.snapshot=t.root,new sa(new un(u,[]),t)}function rC(e){let t={},n={},r={},s="",l=new uo([],t,r,s,n,at,e,null,{});return new la("",new un(l,[]))}var ho=class{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(t,n,r,s,l,f,u,c){this.urlSubject=t,this.paramsSubject=n,this.queryParamsSubject=r,this.fragmentSubject=s,this.dataSubject=l,this.outlet=f,this.component=u,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(mt(g=>g[ui]))??it(void 0),this.url=t,this.params=n,this.queryParams=r,this.fragment=s,this.data=l}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(mt(t=>fo(t))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(mt(t=>fo(t))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function aa(e,t,n="emptyOnly"){let r,{routeConfig:s}=e;return t!==null&&(n==="always"||s?.path===""||!t.component&&!t.routeConfig?.loadComponent)?r={params:Ve(Ve({},t.params),e.params),data:Ve(Ve({},t.data),e.data),resolve:Ve(Ve(Ve(Ve({},e.data),t.data),s?.data),e._resolvedData)}:r={params:Ve({},e.params),data:Ve({},e.data),resolve:Ve(Ve({},e.data),e._resolvedData??{})},s&&vg(s)&&(r.resolve[ui]=s.title),r}var uo=class{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;get title(){return this.data?.[ui]}constructor(t,n,r,s,l,f,u,c,g){this.url=t,this.params=n,this.queryParams=r,this.fragment=s,this.data=l,this.outlet=f,this.component=u,this.routeConfig=c,this._resolve=g}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=fo(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=fo(this.queryParams),this._queryParamMap}toString(){let t=this.url.map(r=>r.toString()).join("/"),n=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${t}', path:'${n}')`}},la=class extends ia{url;constructor(t,n){super(n),this.url=t,mc(this,n)}toString(){return mg(this._root)}};function mc(e,t){t.value._routerState=e,t.children.forEach(n=>mc(e,n))}function mg(e){let t=e.children.length>0?` { ${e.children.map(mg).join(", ")} } `:"";return`${e.value}${t}`}function Hu(e){if(e.snapshot){let t=e.snapshot,n=e._futureSnapshot;e.snapshot=n,Pn(t.queryParams,n.queryParams)||e.queryParamsSubject.next(n.queryParams),t.fragment!==n.fragment&&e.fragmentSubject.next(n.fragment),Pn(t.params,n.params)||e.paramsSubject.next(n.params),Aw(t.url,n.url)||e.urlSubject.next(n.url),Pn(t.data,n.data)||e.dataSubject.next(n.data)}else e.snapshot=e._futureSnapshot,e.dataSubject.next(e._futureSnapshot.data)}function ac(e,t){let n=Pn(e.params,t.params)&&Ow(e.url,t.url),r=!e.parent!=!t.parent;return n&&!r&&(!e.parent||ac(e.parent,t.parent))}function vg(e){return typeof e.title=="string"||e.title===null}var oC=new ot(""),iC=(()=>{class e{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=at;activateEvents=new an;deactivateEvents=new an;attachEvents=new an;detachEvents=new an;routerOutletData=Cp(void 0);parentContexts=Oe(da);location=Oe(oo);changeDetector=Oe($o);inputBinder=Oe(vc,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(n){if(n.name){let{firstChange:r,previousValue:s}=n.name;if(r)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(n){return this.parentContexts.getContext(n)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let n=this.parentContexts.getContext(this.name);n?.route&&(n.attachRef?this.attach(n.attachRef,n.route):this.activateWith(n.route,n.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Ze(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Ze(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Ze(4012,!1);this.location.detach();let n=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(n.instance),n}attach(n,r){this.activated=n,this._activatedRoute=r,this.location.insert(n.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(n.instance)}deactivate(){if(this.activated){let n=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(n)}}activateWith(n,r){if(this.isActivated)throw new Ze(4013,!1);this._activatedRoute=n;let s=this.location,f=n.snapshot.component,u=this.parentContexts.getOrCreateContext(this.name).children,c=new lc(n,u,s.injector,this.routerOutletData);this.activated=s.createComponent(f,{index:s.length,injector:c,environmentInjector:r}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(r){return new(r||e)};static \u0275dir=Ho({type:e,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[Gl]})}return e})(),lc=class e{route;childContexts;parent;outletData;__ngOutletInjector(t){return new e(this.route,this.childContexts,t,this.outletData)}constructor(t,n,r,s){this.route=t,this.childContexts=n,this.parent=r,this.outletData=s}get(t,n){return t===ho?this.route:t===da?this.childContexts:t===oC?this.outletData:this.parent.get(t,n)}},vc=new ot("");function sC(e,t,n){let r=ii(e,t._root,n?n._root:void 0);return new sa(r,t)}function ii(e,t,n){if(n&&e.shouldReuseRoute(t.value,n.value.snapshot)){let r=n.value;r._futureSnapshot=t.value;let s=aC(e,t,n);return new un(r,s)}else{if(e.shouldAttach(t.value)){let l=e.retrieve(t.value);if(l!==null){let f=l.route;return f.value._futureSnapshot=t.value,f.children=t.children.map(u=>ii(e,u)),f}}let r=lC(t.value),s=t.children.map(l=>ii(e,l));return new un(r,s)}}function aC(e,t,n){return t.children.map(r=>{for(let s of n.children)if(e.shouldReuseRoute(r.value,s.value.snapshot))return ii(e,r,s);return ii(e,r)})}function lC(e){return new ho(new $t(e.url),new $t(e.params),new $t(e.queryParams),new $t(e.fragment),new $t(e.data),e.outlet,e.component,e)}var si=class{redirectTo;navigationBehaviorOptions;constructor(t,n){this.redirectTo=t,this.navigationBehaviorOptions=n}},bg="ngNavigationCancelingError";function ua(e,t){let{redirectTo:n,navigationBehaviorOptions:r}=ei(t)?{redirectTo:t,navigationBehaviorOptions:void 0}:t,s=yg(!1,cn.Redirect);return s.url=n,s.navigationBehaviorOptions=r,s}function yg(e,t){let n=new Error(`NavigationCancelingError: ${e||""}`);return n[bg]=!0,n.cancellationCode=t,n}function uC(e){return wg(e)&&ei(e.url)}function wg(e){return!!e&&e[bg]}var cC=(e,t,n,r)=>mt(s=>(new uc(t,s.targetRouterState,s.currentRouterState,n,r).activate(e),s)),uc=class{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(t,n,r,s,l){this.routeReuseStrategy=t,this.futureState=n,this.currState=r,this.forwardEvent=s,this.inputBindingEnabled=l}activate(t){let n=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,r,t),Hu(this.futureState.root),this.activateChildRoutes(n,r,t)}deactivateChildRoutes(t,n,r){let s=ao(n);t.children.forEach(l=>{let f=l.value.outlet;this.deactivateRoutes(l,s[f],r),delete s[f]}),Object.values(s).forEach(l=>{this.deactivateRouteAndItsChildren(l,r)})}deactivateRoutes(t,n,r){let s=t.value,l=n?n.value:null;if(s===l)if(s.component){let f=r.getContext(s.outlet);f&&this.deactivateChildRoutes(t,n,f.children)}else this.deactivateChildRoutes(t,n,r);else l&&this.deactivateRouteAndItsChildren(n,r)}deactivateRouteAndItsChildren(t,n){t.value.component&&this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,n):this.deactivateRouteAndOutlet(t,n)}detachAndStoreRouteSubtree(t,n){let r=n.getContext(t.value.outlet),s=r&&t.value.component?r.children:n,l=ao(t);for(let f of Object.values(l))this.deactivateRouteAndItsChildren(f,s);if(r&&r.outlet){let f=r.outlet.detach(),u=r.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:f,route:t,contexts:u})}}deactivateRouteAndOutlet(t,n){let r=n.getContext(t.value.outlet),s=r&&t.value.component?r.children:n,l=ao(t);for(let f of Object.values(l))this.deactivateRouteAndItsChildren(f,s);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(t,n,r){let s=ao(n);t.children.forEach(l=>{this.activateRoutes(l,s[l.value.outlet],r),this.forwardEvent(new rc(l.value.snapshot))}),t.children.length&&this.forwardEvent(new tc(t.value.snapshot))}activateRoutes(t,n,r){let s=t.value,l=n?n.value:null;if(Hu(s),s===l)if(s.component){let f=r.getOrCreateContext(s.outlet);this.activateChildRoutes(t,n,f.children)}else this.activateChildRoutes(t,n,r);else if(s.component){let f=r.getOrCreateContext(s.outlet);if(this.routeReuseStrategy.shouldAttach(s.snapshot)){let u=this.routeReuseStrategy.retrieve(s.snapshot);this.routeReuseStrategy.store(s.snapshot,null),f.children.onOutletReAttached(u.contexts),f.attachRef=u.componentRef,f.route=u.route.value,f.outlet&&f.outlet.attach(u.componentRef,u.route.value),Hu(u.route.value),this.activateChildRoutes(t,null,f.children)}else f.attachRef=null,f.route=s,f.outlet&&f.outlet.activateWith(s,f.injector),this.activateChildRoutes(t,null,f.children)}else this.activateChildRoutes(t,null,r)}},ca=class{path;route;constructor(t){this.path=t,this.route=this.path[this.path.length-1]}},co=class{component;route;constructor(t,n){this.component=t,this.route=n}};function dC(e,t,n){let r=e._root,s=t?t._root:null;return Zo(r,s,n,[r.value])}function fC(e){let t=e.routeConfig?e.routeConfig.canActivateChild:null;return!t||t.length===0?null:{node:e,guards:t}}function mo(e,t){let n=Symbol(),r=t.get(e,n);return r===n?typeof e=="function"&&!mf(e)?e:t.get(e):r}function Zo(e,t,n,r,s={canDeactivateChecks:[],canActivateChecks:[]}){let l=ao(t);return e.children.forEach(f=>{pC(f,l[f.value.outlet],n,r.concat([f.value]),s),delete l[f.value.outlet]}),Object.entries(l).forEach(([f,u])=>Ko(u,n.getContext(f),s)),s}function pC(e,t,n,r,s={canDeactivateChecks:[],canActivateChecks:[]}){let l=e.value,f=t?t.value:null,u=n?n.getContext(e.value.outlet):null;if(f&&l.routeConfig===f.routeConfig){let c=hC(f,l,l.routeConfig.runGuardsAndResolvers);c?s.canActivateChecks.push(new ca(r)):(l.data=f.data,l._resolvedData=f._resolvedData),l.component?Zo(e,t,u?u.children:null,r,s):Zo(e,t,n,r,s),c&&u&&u.outlet&&u.outlet.isActivated&&s.canDeactivateChecks.push(new co(u.outlet.component,f))}else f&&Ko(t,u,s),s.canActivateChecks.push(new ca(r)),l.component?Zo(e,null,u?u.children:null,r,s):Zo(e,null,n,r,s);return s}function hC(e,t,n){if(typeof n=="function")return n(e,t);switch(n){case"pathParamsChange":return!Mr(e.url,t.url);case"pathParamsOrQueryParamsChange":return!Mr(e.url,t.url)||!Pn(e.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!ac(e,t)||!Pn(e.queryParams,t.queryParams);case"paramsChange":default:return!ac(e,t)}}function Ko(e,t,n){let r=ao(e),s=e.value;Object.entries(r).forEach(([l,f])=>{s.component?t?Ko(f,t.children.getContext(l),n):Ko(f,null,n):Ko(f,t,n)}),s.component?t&&t.outlet&&t.outlet.isActivated?n.canDeactivateChecks.push(new co(t.outlet.component,s)):n.canDeactivateChecks.push(new co(null,s)):n.canDeactivateChecks.push(new co(null,s))}function di(e){return typeof e=="function"}function gC(e){return typeof e=="boolean"}function mC(e){return e&&di(e.canLoad)}function vC(e){return e&&di(e.canActivate)}function bC(e){return e&&di(e.canActivateChild)}function yC(e){return e&&di(e.canDeactivate)}function wC(e){return e&&di(e.canMatch)}function Cg(e){return e instanceof Vn||e?.name==="EmptyError"}var Ks=Symbol("INITIAL_VALUE");function go(){return jn(e=>Ui(e.map(t=>t.pipe(Hn(1),Wa(Ks)))).pipe(mt(t=>{for(let n of t)if(n!==!0){if(n===Ks)return Ks;if(n===!1||CC(n))return n}return!0}),Cn(t=>t!==Ks),Hn(1)))}function CC(e){return ei(e)||e instanceof si}function jC(e,t){return Pt(n=>{let{targetSnapshot:r,currentSnapshot:s,guards:{canActivateChecks:l,canDeactivateChecks:f}}=n;return f.length===0&&l.length===0?it(Mt(Ve({},n),{guardsResult:!0})):DC(f,r,s,e).pipe(Pt(u=>u&&gC(u)?EC(r,l,e,t):it(u)),mt(u=>Mt(Ve({},n),{guardsResult:u})))})}function DC(e,t,n,r){return kt(e).pipe(Pt(s=>TC(s.component,s.route,n,t,r)),Bn(s=>s!==!0,!0))}function EC(e,t,n,r){return kt(t).pipe(Br(s=>Hr(IC(s.route.parent,r),xC(s.route,r),SC(e,s.path,n),MC(e,s.route,n))),Bn(s=>s!==!0,!0))}function xC(e,t){return e!==null&&t&&t(new nc(e)),it(!0)}function IC(e,t){return e!==null&&t&&t(new ec(e)),it(!0)}function MC(e,t,n){let r=t.routeConfig?t.routeConfig.canActivate:null;if(!r||r.length===0)return it(!0);let s=r.map(l=>$i(()=>{let f=ci(t)??n,u=mo(l,f),c=vC(u)?u.canActivate(t,e):xn(f,()=>u(t,e));return sr(c).pipe(Bn())}));return it(s).pipe(go())}function SC(e,t,n){let r=t[t.length-1],l=t.slice(0,t.length-1).reverse().map(f=>fC(f)).filter(f=>f!==null).map(f=>$i(()=>{let u=f.guards.map(c=>{let g=ci(f.node)??n,D=mo(c,g),I=bC(D)?D.canActivateChild(r,e):xn(g,()=>D(r,e));return sr(I).pipe(Bn())});return it(u).pipe(go())}));return it(l).pipe(go())}function TC(e,t,n,r,s){let l=t&&t.routeConfig?t.routeConfig.canDeactivate:null;if(!l||l.length===0)return it(!0);let f=l.map(u=>{let c=ci(t)??s,g=mo(u,c),D=yC(g)?g.canDeactivate(e,t,n,r):xn(c,()=>g(e,t,n,r));return sr(D).pipe(Bn())});return it(f).pipe(go())}function AC(e,t,n,r){let s=t.canLoad;if(s===void 0||s.length===0)return it(!0);let l=s.map(f=>{let u=mo(f,e),c=mC(u)?u.canLoad(t,n):xn(e,()=>u(t,n));return sr(c)});return it(l).pipe(go(),jg(r))}function jg(e){return Pa(zt(t=>{if(typeof t!="boolean")throw ua(e,t)}),mt(t=>t===!0))}function NC(e,t,n,r){let s=t.canMatch;if(!s||s.length===0)return it(!0);let l=s.map(f=>{let u=mo(f,e),c=wC(u)?u.canMatch(t,n):xn(e,()=>u(t,n));return sr(c)});return it(l).pipe(go(),jg(r))}var ai=class{segmentGroup;constructor(t){this.segmentGroup=t||null}},li=class extends Error{urlTree;constructor(t){super(),this.urlTree=t}};function so(e){return Vr(new ai(e))}function _C(e){return Vr(new Ze(4e3,!1))}function RC(e){return Vr(yg(!1,cn.GuardRejected))}var cc=class{urlSerializer;urlTree;constructor(t,n){this.urlSerializer=t,this.urlTree=n}lineralizeSegments(t,n){let r=[],s=n.root;for(;;){if(r=r.concat(s.segments),s.numberOfChildren===0)return it(r);if(s.numberOfChildren>1||!s.children[at])return _C(`${t.redirectTo}`);s=s.children[at]}}applyRedirectCommands(t,n,r,s,l){if(typeof n!="string"){let u=n,{queryParams:c,fragment:g,routeConfig:D,url:I,outlet:v,params:p,data:w,title:j}=s,b=xn(l,()=>u({params:p,data:w,queryParams:c,fragment:g,routeConfig:D,url:I,outlet:v,title:j}));if(b instanceof Wn)throw new li(b);n=b}let f=this.applyRedirectCreateUrlTree(n,this.urlSerializer.parse(n),t,r);if(n[0]==="/")throw new li(f);return f}applyRedirectCreateUrlTree(t,n,r,s){let l=this.createSegmentGroup(t,n.root,r,s);return new Wn(l,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(t,n){let r={};return Object.entries(t).forEach(([s,l])=>{if(typeof l=="string"&&l[0]===":"){let u=l.substring(1);r[s]=n[u]}else r[s]=l}),r}createSegmentGroup(t,n,r,s){let l=this.createSegments(t,n.segments,r,s),f={};return Object.entries(n.children).forEach(([u,c])=>{f[u]=this.createSegmentGroup(t,c,r,s)}),new jt(l,f)}createSegments(t,n,r,s){return n.map(l=>l.path[0]===":"?this.findPosParam(t,l,s):this.findOrReturn(l,r))}findPosParam(t,n,r){let s=r[n.path.substring(1)];if(!s)throw new Ze(4001,!1);return s}findOrReturn(t,n){let r=0;for(let s of n){if(s.path===t.path)return n.splice(r),s;r++}return t}},dc={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function OC(e,t,n,r,s){let l=Dg(e,t,n);return l.matched?(r=tC(t,r),NC(r,t,n,s).pipe(mt(f=>f===!0?l:Ve({},dc)))):it(l)}function Dg(e,t,n){if(t.path==="**")return LC(n);if(t.path==="")return t.pathMatch==="full"&&(e.hasChildren()||n.length>0)?Ve({},dc):{matched:!0,consumedSegments:[],remainingSegments:n,parameters:{},positionalParamSegments:{}};let s=(t.matcher||Tw)(n,e,t);if(!s)return Ve({},dc);let l={};Object.entries(s.posParams??{}).forEach(([u,c])=>{l[u]=c.path});let f=s.consumed.length>0?Ve(Ve({},l),s.consumed[s.consumed.length-1].parameters):l;return{matched:!0,consumedSegments:s.consumed,remainingSegments:n.slice(s.consumed.length),parameters:f,positionalParamSegments:s.posParams??{}}}function LC(e){return{matched:!0,parameters:e.length>0?ng(e).parameters:{},consumedSegments:e,remainingSegments:[],positionalParamSegments:{}}}function Kh(e,t,n,r){return n.length>0&&PC(e,n,r)?{segmentGroup:new jt(t,kC(r,new jt(n,e.children))),slicedSegments:[]}:n.length===0&&VC(e,n,r)?{segmentGroup:new jt(e.segments,FC(e,n,r,e.children)),slicedSegments:n}:{segmentGroup:new jt(e.segments,e.children),slicedSegments:n}}function FC(e,t,n,r){let s={};for(let l of n)if(fa(e,t,l)&&!r[Tn(l)]){let f=new jt([],{});s[Tn(l)]=f}return Ve(Ve({},r),s)}function kC(e,t){let n={};n[at]=t;for(let r of e)if(r.path===""&&Tn(r)!==at){let s=new jt([],{});n[Tn(r)]=s}return n}function PC(e,t,n){return n.some(r=>fa(e,t,r)&&Tn(r)!==at)}function VC(e,t,n){return n.some(r=>fa(e,t,r))}function fa(e,t,n){return(e.hasChildren()||t.length>0)&&n.pathMatch==="full"?!1:n.path===""}function HC(e,t,n){return t.length===0&&!e.children[n]}var fc=class{};function BC(e,t,n,r,s,l,f="emptyOnly"){return new pc(e,t,n,r,s,f,l).recognize()}var UC=31,pc=class{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(t,n,r,s,l,f,u){this.injector=t,this.configLoader=n,this.rootComponentType=r,this.config=s,this.urlTree=l,this.paramsInheritanceStrategy=f,this.urlSerializer=u,this.applyRedirects=new cc(this.urlSerializer,this.urlTree)}noMatchError(t){return new Ze(4002,`'${t.segmentGroup}'`)}recognize(){let t=Kh(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(t).pipe(mt(({children:n,rootSnapshot:r})=>{let s=new un(r,n),l=new la("",s),f=Yw(r,[],this.urlTree.queryParams,this.urlTree.fragment);return f.queryParams=this.urlTree.queryParams,l.url=this.urlSerializer.serialize(f),{state:l,tree:f}}))}match(t){let n=new uo([],Object.freeze({}),Object.freeze(Ve({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),at,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,t,at,n).pipe(mt(r=>({children:r,rootSnapshot:n})),Xn(r=>{if(r instanceof li)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof ai?this.noMatchError(r):r}))}processSegmentGroup(t,n,r,s,l){return r.segments.length===0&&r.hasChildren()?this.processChildren(t,n,r,l):this.processSegment(t,n,r,r.segments,s,!0,l).pipe(mt(f=>f instanceof un?[f]:[]))}processChildren(t,n,r,s){let l=[];for(let f of Object.keys(r.children))f==="primary"?l.unshift(f):l.push(f);return kt(l).pipe(Br(f=>{let u=r.children[f],c=nC(n,f);return this.processSegmentGroup(t,c,u,f,s)}),qa((f,u)=>(f.push(...u),f)),Qn(null),za(),Pt(f=>{if(f===null)return so(r);let u=Eg(f);return $C(u),it(u)}))}processSegment(t,n,r,s,l,f,u){return kt(n).pipe(Br(c=>this.processSegmentAgainstRoute(c._injector??t,n,c,r,s,l,f,u).pipe(Xn(g=>{if(g instanceof ai)return it(null);throw g}))),Bn(c=>!!c),Xn(c=>{if(Cg(c))return HC(r,s,l)?it(new fc):so(r);throw c}))}processSegmentAgainstRoute(t,n,r,s,l,f,u,c){return Tn(r)!==f&&(f===at||!fa(s,l,r))?so(s):r.redirectTo===void 0?this.matchSegmentAgainstRoute(t,s,r,l,f,c):this.allowRedirects&&u?this.expandSegmentAgainstRouteUsingRedirect(t,s,n,r,l,f,c):so(s)}expandSegmentAgainstRouteUsingRedirect(t,n,r,s,l,f,u){let{matched:c,parameters:g,consumedSegments:D,positionalParamSegments:I,remainingSegments:v}=Dg(n,s,l);if(!c)return so(n);typeof s.redirectTo=="string"&&s.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>UC&&(this.allowRedirects=!1));let p=new uo(l,g,Object.freeze(Ve({},this.urlTree.queryParams)),this.urlTree.fragment,Jh(s),Tn(s),s.component??s._loadedComponent??null,s,eg(s)),w=aa(p,u,this.paramsInheritanceStrategy);p.params=Object.freeze(w.params),p.data=Object.freeze(w.data);let j=this.applyRedirects.applyRedirectCommands(D,s.redirectTo,I,p,t);return this.applyRedirects.lineralizeSegments(s,j).pipe(Pt(b=>this.processSegment(t,r,n,b.concat(v),f,!1,u)))}matchSegmentAgainstRoute(t,n,r,s,l,f){let u=OC(n,r,s,t,this.urlSerializer);return r.path==="**"&&(n.children={}),u.pipe(jn(c=>c.matched?(t=r._injector??t,this.getChildConfig(t,r,s).pipe(jn(({routes:g})=>{let D=r._loadedInjector??t,{parameters:I,consumedSegments:v,remainingSegments:p}=c,w=new uo(v,I,Object.freeze(Ve({},this.urlTree.queryParams)),this.urlTree.fragment,Jh(r),Tn(r),r.component??r._loadedComponent??null,r,eg(r)),j=aa(w,f,this.paramsInheritanceStrategy);w.params=Object.freeze(j.params),w.data=Object.freeze(j.data);let{segmentGroup:b,slicedSegments:M}=Kh(n,v,p,g);if(M.length===0&&b.hasChildren())return this.processChildren(D,g,b,w).pipe(mt(O=>new un(w,O)));if(g.length===0&&M.length===0)return it(new un(w,[]));let A=Tn(r)===l;return this.processSegment(D,g,b,M,A?at:l,!0,w).pipe(mt(O=>new un(w,O instanceof un?[O]:[])))}))):so(n)))}getChildConfig(t,n,r){return n.children?it({routes:n.children,injector:t}):n.loadChildren?n._loadedRoutes!==void 0?it({routes:n._loadedRoutes,injector:n._loadedInjector}):AC(t,n,r,this.urlSerializer).pipe(Pt(s=>s?this.configLoader.loadChildren(t,n).pipe(zt(l=>{n._loadedRoutes=l.routes,n._loadedInjector=l.injector})):RC(n))):it({routes:[],injector:t})}};function $C(e){e.sort((t,n)=>t.value.outlet===at?-1:n.value.outlet===at?1:t.value.outlet.localeCompare(n.value.outlet))}function zC(e){let t=e.value.routeConfig;return t&&t.path===""}function Eg(e){let t=[],n=new Set;for(let r of e){if(!zC(r)){t.push(r);continue}let s=t.find(l=>r.value.routeConfig===l.value.routeConfig);s!==void 0?(s.children.push(...r.children),n.add(s)):t.push(r)}for(let r of n){let s=Eg(r.children);t.push(new un(r.value,s))}return t.filter(r=>!n.has(r))}function Jh(e){return e.data||{}}function eg(e){return e.resolve||{}}function qC(e,t,n,r,s,l){return Pt(f=>BC(e,t,n,r,f.extractedUrl,s,l).pipe(mt(({state:u,tree:c})=>Mt(Ve({},f),{targetSnapshot:u,urlAfterRedirects:c}))))}function WC(e,t){return Pt(n=>{let{targetSnapshot:r,guards:{canActivateChecks:s}}=n;if(!s.length)return it(n);let l=new Set(s.map(c=>c.route)),f=new Set;for(let c of l)if(!f.has(c))for(let g of xg(c))f.add(g);let u=0;return kt(f).pipe(Br(c=>l.has(c)?GC(c,r,e,t):(c.data=aa(c,c.parent,e).resolve,it(void 0))),zt(()=>u++),Ur(1),Pt(c=>u===f.size?it(n):sn))})}function xg(e){let t=e.children.map(n=>xg(n)).flat();return[e,...t]}function GC(e,t,n,r){let s=e.routeConfig,l=e._resolve;return s?.title!==void 0&&!vg(s)&&(l[ui]=s.title),YC(l,e,t,r).pipe(mt(f=>(e._resolvedData=f,e.data=aa(e,e.parent,n).resolve,null)))}function YC(e,t,n,r){let s=$u(e);if(s.length===0)return it({});let l={};return kt(s).pipe(Pt(f=>ZC(e[f],t,n,r).pipe(Bn(),zt(u=>{if(u instanceof si)throw ua(new Jo,u);l[f]=u}))),Ur(1),mt(()=>l),Xn(f=>Cg(f)?sn:Vr(f)))}function ZC(e,t,n,r){let s=ci(t)??r,l=mo(e,s),f=l.resolve?l.resolve(t,n):xn(s,()=>l(t,n));return sr(f)}function Bu(e){return jn(t=>{let n=e(t);return n?kt(n).pipe(mt(()=>t)):it(t)})}var Ig=(()=>{class e{buildTitle(n){let r,s=n.root;for(;s!==void 0;)r=this.getResolvedTitleForRoute(s)??r,s=s.children.find(l=>l.outlet===at);return r}getResolvedTitleForRoute(n){return n.data[ui]}static \u0275fac=function(r){return new(r||e)};static \u0275prov=tt({token:e,factory:()=>Oe(XC),providedIn:"root"})}return e})(),XC=(()=>{class e extends Ig{title;constructor(n){super(),this.title=n}updateTitle(n){let r=this.buildTitle(n);r!==void 0&&this.title.setTitle(r)}static \u0275fac=function(r){return new(r||e)(ft(Gh))};static \u0275prov=tt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),bc=new ot("",{providedIn:"root",factory:()=>({})}),QC=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275cmp=Vs({type:e,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(r,s){r&1&&Uo(0,"router-outlet")},dependencies:[iC],encapsulation:2})}return e})();function yc(e){let t=e.children&&e.children.map(yc),n=t?Mt(Ve({},e),{children:t}):Ve({},e);return!n.component&&!n.loadComponent&&(t||n.loadChildren)&&n.outlet&&n.outlet!==at&&(n.component=QC),n}var wc=new ot(""),KC=(()=>{class e{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=Oe(Eu);loadComponent(n){if(this.componentLoaders.get(n))return this.componentLoaders.get(n);if(n._loadedComponent)return it(n._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(n);let r=sr(n.loadComponent()).pipe(mt(Mg),zt(l=>{this.onLoadEndListener&&this.onLoadEndListener(n),n._loadedComponent=l}),jo(()=>{this.componentLoaders.delete(n)})),s=new Pr(r,()=>new Yt).pipe(kr());return this.componentLoaders.set(n,s),s}loadChildren(n,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return it({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);let l=JC(r,this.compiler,n,this.onLoadEndListener).pipe(jo(()=>{this.childrenLoaders.delete(r)})),f=new Pr(l,()=>new Yt).pipe(kr());return this.childrenLoaders.set(r,f),f}static \u0275fac=function(r){return new(r||e)};static \u0275prov=tt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function JC(e,t,n,r){return sr(e.loadChildren()).pipe(mt(Mg),Pt(s=>s instanceof Lo||Array.isArray(s)?it(s):kt(t.compileModuleAsync(s))),mt(s=>{r&&r(e);let l,f,u=!1;return Array.isArray(s)?(f=s,u=!0):(l=s.create(n).injector,f=l.get(wc,[],{optional:!0,self:!0}).flat()),{routes:f.map(yc),injector:l}}))}function ej(e){return e&&typeof e=="object"&&"default"in e}function Mg(e){return ej(e)?e.default:e}var Cc=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275prov=tt({token:e,factory:()=>Oe(tj),providedIn:"root"})}return e})(),tj=(()=>{class e{shouldProcessUrl(n){return!0}extract(n){return n}merge(n,r){return n}static \u0275fac=function(r){return new(r||e)};static \u0275prov=tt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),nj=new ot("");var rj=new ot(""),oj=(()=>{class e{currentNavigation=null;currentTransition=null;lastSuccessfulNavigation=null;events=new Yt;transitionAbortSubject=new Yt;configLoader=Oe(KC);environmentInjector=Oe(mn);urlSerializer=Oe(gc);rootContexts=Oe(da);location=Oe(zo);inputBindingEnabled=Oe(vc,{optional:!0})!==null;titleStrategy=Oe(Ig);options=Oe(bc,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=Oe(Cc);createViewTransition=Oe(nj,{optional:!0});navigationErrorHandler=Oe(rj,{optional:!0});navigationId=0;get hasRequestedNavigation(){return this.navigationId!==0}transitions;afterPreactivation=()=>it(void 0);rootComponentType=null;constructor(){let n=s=>this.events.next(new Ku(s)),r=s=>this.events.next(new Ju(s));this.configLoader.onLoadEndListener=r,this.configLoader.onLoadStartListener=n}complete(){this.transitions?.complete()}handleNavigationRequest(n){let r=++this.navigationId;this.transitions?.next(Mt(Ve(Ve({},this.transitions.value),n),{id:r}))}setupNavigations(n,r,s){return this.transitions=new $t({id:0,currentUrlTree:r,currentRawUrl:r,extractedUrl:this.urlHandlingStrategy.extract(r),urlAfterRedirects:this.urlHandlingStrategy.extract(r),rawUrl:r,extras:{},resolve:()=>{},reject:()=>{},promise:Promise.resolve(!0),source:Qo,restoredState:null,currentSnapshot:s.snapshot,targetSnapshot:null,currentRouterState:s,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Cn(l=>l.id!==0),mt(l=>Mt(Ve({},l),{extractedUrl:this.urlHandlingStrategy.extract(l.rawUrl)})),jn(l=>{let f=!1,u=!1;return it(l).pipe(jn(c=>{if(this.navigationId>l.id)return this.cancelNavigationTransition(l,"",cn.SupersededByNewNavigation),sn;this.currentTransition=l,this.currentNavigation={id:c.id,initialUrl:c.rawUrl,extractedUrl:c.extractedUrl,targetBrowserUrl:typeof c.extras.browserUrl=="string"?this.urlSerializer.parse(c.extras.browserUrl):c.extras.browserUrl,trigger:c.source,extras:c.extras,previousNavigation:this.lastSuccessfulNavigation?Mt(Ve({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let g=!n.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),D=c.extras.onSameUrlNavigation??n.onSameUrlNavigation;if(!g&&D!=="reload"){let I="";return this.events.next(new Tr(c.id,this.urlSerializer.serialize(c.rawUrl),I,Gu.IgnoredSameUrlNavigation)),c.resolve(!1),sn}if(this.urlHandlingStrategy.shouldProcessUrl(c.rawUrl))return it(c).pipe(jn(I=>{let v=this.transitions?.getValue();return this.events.next(new ni(I.id,this.urlSerializer.serialize(I.extractedUrl),I.source,I.restoredState)),v!==this.transitions?.getValue()?sn:Promise.resolve(I)}),qC(this.environmentInjector,this.configLoader,this.rootComponentType,n.config,this.urlSerializer,this.paramsInheritanceStrategy),zt(I=>{l.targetSnapshot=I.targetSnapshot,l.urlAfterRedirects=I.urlAfterRedirects,this.currentNavigation=Mt(Ve({},this.currentNavigation),{finalUrl:I.urlAfterRedirects});let v=new oa(I.id,this.urlSerializer.serialize(I.extractedUrl),this.urlSerializer.serialize(I.urlAfterRedirects),I.targetSnapshot);this.events.next(v)}));if(g&&this.urlHandlingStrategy.shouldProcessUrl(c.currentRawUrl)){let{id:I,extractedUrl:v,source:p,restoredState:w,extras:j}=c,b=new ni(I,this.urlSerializer.serialize(v),p,w);this.events.next(b);let M=gg(this.rootComponentType).snapshot;return this.currentTransition=l=Mt(Ve({},c),{targetSnapshot:M,urlAfterRedirects:v,extras:Mt(Ve({},j),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=v,it(l)}else{let I="";return this.events.next(new Tr(c.id,this.urlSerializer.serialize(c.extractedUrl),I,Gu.IgnoredByUrlHandlingStrategy)),c.resolve(!1),sn}}),zt(c=>{let g=new Yu(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(g)}),mt(c=>(this.currentTransition=l=Mt(Ve({},c),{guards:dC(c.targetSnapshot,c.currentSnapshot,this.rootContexts)}),l)),jC(this.environmentInjector,c=>this.events.next(c)),zt(c=>{if(l.guardsResult=c.guardsResult,c.guardsResult&&typeof c.guardsResult!="boolean")throw ua(this.urlSerializer,c.guardsResult);let g=new Zu(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot,!!c.guardsResult);this.events.next(g)}),Cn(c=>c.guardsResult?!0:(this.cancelNavigationTransition(c,"",cn.GuardRejected),!1)),Bu(c=>{if(c.guards.canActivateChecks.length)return it(c).pipe(zt(g=>{let D=new Xu(g.id,this.urlSerializer.serialize(g.extractedUrl),this.urlSerializer.serialize(g.urlAfterRedirects),g.targetSnapshot);this.events.next(D)}),jn(g=>{let D=!1;return it(g).pipe(WC(this.paramsInheritanceStrategy,this.environmentInjector),zt({next:()=>D=!0,complete:()=>{D||this.cancelNavigationTransition(g,"",cn.NoDataFromResolver)}}))}),zt(g=>{let D=new Qu(g.id,this.urlSerializer.serialize(g.extractedUrl),this.urlSerializer.serialize(g.urlAfterRedirects),g.targetSnapshot);this.events.next(D)}))}),Bu(c=>{let g=D=>{let I=[];D.routeConfig?.loadComponent&&!D.routeConfig._loadedComponent&&I.push(this.configLoader.loadComponent(D.routeConfig).pipe(zt(v=>{D.component=v}),mt(()=>{})));for(let v of D.children)I.push(...g(v));return I};return Ui(g(c.targetSnapshot.root)).pipe(Qn(null),Hn(1))}),Bu(()=>this.afterPreactivation()),jn(()=>{let{currentSnapshot:c,targetSnapshot:g}=l,D=this.createViewTransition?.(this.environmentInjector,c.root,g.root);return D?kt(D).pipe(mt(()=>l)):it(l)}),mt(c=>{let g=sC(n.routeReuseStrategy,c.targetSnapshot,c.currentRouterState);return this.currentTransition=l=Mt(Ve({},c),{targetRouterState:g}),this.currentNavigation.targetRouterState=g,l}),zt(()=>{this.events.next(new oi)}),cC(this.rootContexts,n.routeReuseStrategy,c=>this.events.next(c),this.inputBindingEnabled),Hn(1),zt({next:c=>{f=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Sr(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects))),this.titleStrategy?.updateTitle(c.targetRouterState.snapshot),c.resolve(!0)},complete:()=>{f=!0}}),Ga(this.transitionAbortSubject.pipe(zt(c=>{throw c}))),jo(()=>{!f&&!u&&this.cancelNavigationTransition(l,"",cn.SupersededByNewNavigation),this.currentTransition?.id===l.id&&(this.currentNavigation=null,this.currentTransition=null)}),Xn(c=>{if(u=!0,wg(c))this.events.next(new qn(l.id,this.urlSerializer.serialize(l.extractedUrl),c.message,c.cancellationCode)),uC(c)?this.events.next(new po(c.url,c.navigationBehaviorOptions)):l.resolve(!1);else{let g=new ri(l.id,this.urlSerializer.serialize(l.extractedUrl),c,l.targetSnapshot??void 0);try{let D=xn(this.environmentInjector,()=>this.navigationErrorHandler?.(g));if(D instanceof si){let{message:I,cancellationCode:v}=ua(this.urlSerializer,D);this.events.next(new qn(l.id,this.urlSerializer.serialize(l.extractedUrl),I,v)),this.events.next(new po(D.redirectTo,D.navigationBehaviorOptions))}else throw this.events.next(g),c}catch(D){this.options.resolveNavigationPromiseOnError?l.resolve(!1):l.reject(D)}}return sn}))}))}cancelNavigationTransition(n,r,s){let l=new qn(n.id,this.urlSerializer.serialize(n.extractedUrl),r,s);this.events.next(l),n.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let n=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),r=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return n.toString()!==r?.toString()&&!this.currentNavigation?.extras.skipLocationChange}static \u0275fac=function(r){return new(r||e)};static \u0275prov=tt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function ij(e){return e!==Qo}var sj=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275prov=tt({token:e,factory:()=>Oe(aj),providedIn:"root"})}return e})(),hc=class{shouldDetach(t){return!1}store(t,n){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,n){return t.routeConfig===n.routeConfig}},aj=(()=>{class e extends hc{static \u0275fac=(()=>{let n;return function(s){return(n||(n=ru(e)))(s||e)}})();static \u0275prov=tt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),Sg=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275prov=tt({token:e,factory:()=>Oe(lj),providedIn:"root"})}return e})(),lj=(()=>{class e extends Sg{location=Oe(zo);urlSerializer=Oe(gc);options=Oe(bc,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";urlHandlingStrategy=Oe(Cc);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new Wn;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}currentPageId=0;lastSuccessfulId=-1;restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}routerState=gg(null);getRouterState(){return this.routerState}stateMemento=this.createStateMemento();createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(n){return this.location.subscribe(r=>{r.type==="popstate"&&n(r.url,r.state)})}handleRouterEvent(n,r){if(n instanceof ni)this.stateMemento=this.createStateMemento();else if(n instanceof Tr)this.rawUrlTree=r.initialUrl;else if(n instanceof oa){if(this.urlUpdateStrategy==="eager"&&!r.extras.skipLocationChange){let s=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl);this.setBrowserUrl(r.targetBrowserUrl??s,r)}}else n instanceof oi?(this.currentUrlTree=r.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl),this.routerState=r.targetRouterState,this.urlUpdateStrategy==="deferred"&&!r.extras.skipLocationChange&&this.setBrowserUrl(r.targetBrowserUrl??this.rawUrlTree,r)):n instanceof qn&&(n.code===cn.GuardRejected||n.code===cn.NoDataFromResolver)?this.restoreHistory(r):n instanceof ri?this.restoreHistory(r,!0):n instanceof Sr&&(this.lastSuccessfulId=n.id,this.currentPageId=this.browserPageId)}setBrowserUrl(n,r){let s=n instanceof Wn?this.urlSerializer.serialize(n):n;if(this.location.isCurrentPathEqualTo(s)||r.extras.replaceUrl){let l=this.browserPageId,f=Ve(Ve({},r.extras.state),this.generateNgRouterState(r.id,l));this.location.replaceState(s,"",f)}else{let l=Ve(Ve({},r.extras.state),this.generateNgRouterState(r.id,this.browserPageId+1));this.location.go(s,"",l)}}restoreHistory(n,r=!1){if(this.canceledNavigationResolution==="computed"){let s=this.browserPageId,l=this.currentPageId-s;l!==0?this.location.historyGo(l):this.currentUrlTree===n.finalUrl&&l===0&&(this.resetState(n),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(r&&this.resetState(n),this.resetUrlToCurrentUrlTree())}resetState(n){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(n,r){return this.canceledNavigationResolution==="computed"?{navigationId:n,\u0275routerPageId:r}:{navigationId:n}}static \u0275fac=(()=>{let n;return function(s){return(n||(n=ru(e)))(s||e)}})();static \u0275prov=tt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function uj(e,t){e.events.pipe(Cn(n=>n instanceof Sr||n instanceof qn||n instanceof ri||n instanceof Tr),mt(n=>n instanceof Sr||n instanceof Tr?0:(n instanceof qn?n.code===cn.Redirect||n.code===cn.SupersededByNewNavigation:!1)?2:1),Cn(n=>n!==2),Hn(1)).subscribe(()=>{t()})}var cj={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},dj={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Tg=(()=>{class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=Oe(Cu);stateManager=Oe(Sg);options=Oe(bc,{optional:!0})||{};pendingTasks=Oe(no);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=Oe(oj);urlSerializer=Oe(gc);location=Oe(zo);urlHandlingStrategy=Oe(Cc);_events=new Yt;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=Oe(sj);onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=Oe(wc,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!Oe(vc,{optional:!0});constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:n=>{this.console.warn(n)}}),this.subscribeToNavigationEvents()}eventsSubscription=new Rt;subscribeToNavigationEvents(){let n=this.navigationTransitions.events.subscribe(r=>{try{let s=this.navigationTransitions.currentTransition,l=this.navigationTransitions.currentNavigation;if(s!==null&&l!==null){if(this.stateManager.handleRouterEvent(r,l),r instanceof qn&&r.code!==cn.Redirect&&r.code!==cn.SupersededByNewNavigation)this.navigated=!0;else if(r instanceof Sr)this.navigated=!0;else if(r instanceof po){let f=r.navigationBehaviorOptions,u=this.urlHandlingStrategy.merge(r.url,s.currentRawUrl),c=Ve({browserUrl:s.extras.browserUrl,info:s.extras.info,skipLocationChange:s.extras.skipLocationChange,replaceUrl:s.extras.replaceUrl||this.urlUpdateStrategy==="eager"||ij(s.source)},f);this.scheduleNavigation(u,Qo,null,c,{resolve:s.resolve,reject:s.reject,promise:s.promise})}}pj(r)&&this._events.next(r)}catch(s){this.navigationTransitions.transitionAbortSubject.next(s)}});this.eventsSubscription.add(n)}resetRootComponentType(n){this.routerState.root.component=n,this.navigationTransitions.rootComponentType=n}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Qo,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((n,r)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(n,"popstate",r)},0)})}navigateToSyncWithBrowser(n,r,s){let l={replaceUrl:!0},f=s?.navigationId?s:null;if(s){let c=Ve({},s);delete c.navigationId,delete c.\u0275routerPageId,Object.keys(c).length!==0&&(l.state=c)}let u=this.parseUrl(n);this.scheduleNavigation(u,r,f,l)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(n){this.config=n.map(yc),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(n,r={}){let{relativeTo:s,queryParams:l,fragment:f,queryParamsHandling:u,preserveFragment:c}=r,g=c?this.currentUrlTree.fragment:f,D=null;switch(u??this.options.defaultQueryParamsHandling){case"merge":D=Ve(Ve({},this.currentUrlTree.queryParams),l);break;case"preserve":D=this.currentUrlTree.queryParams;break;default:D=l||null}D!==null&&(D=this.removeEmptyProps(D));let I;try{let v=s?s.snapshot:this.routerState.snapshot.root;I=dg(v)}catch{(typeof n[0]!="string"||n[0][0]!=="/")&&(n=[]),I=this.currentUrlTree.root}return fg(I,n,D,g??null)}navigateByUrl(n,r={skipLocationChange:!1}){let s=ei(n)?n:this.parseUrl(n),l=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(l,Qo,null,r)}navigate(n,r={skipLocationChange:!1}){return fj(n),this.navigateByUrl(this.createUrlTree(n,r),r)}serializeUrl(n){return this.urlSerializer.serialize(n)}parseUrl(n){try{return this.urlSerializer.parse(n)}catch{return this.urlSerializer.parse("/")}}isActive(n,r){let s;if(r===!0?s=Ve({},cj):r===!1?s=Ve({},dj):s=r,ei(n))return Yh(this.currentUrlTree,n,s);let l=this.parseUrl(n);return Yh(this.currentUrlTree,l,s)}removeEmptyProps(n){return Object.entries(n).reduce((r,[s,l])=>(l!=null&&(r[s]=l),r),{})}scheduleNavigation(n,r,s,l,f){if(this.disposed)return Promise.resolve(!1);let u,c,g;f?(u=f.resolve,c=f.reject,g=f.promise):g=new Promise((I,v)=>{u=I,c=v});let D=this.pendingTasks.add();return uj(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(D))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:n,extras:l,resolve:u,reject:c,promise:g,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),g.catch(I=>Promise.reject(I))}static \u0275fac=function(r){return new(r||e)};static \u0275prov=tt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function fj(e){for(let t=0;t<e.length;t++)if(e[t]==null)throw new Ze(4008,!1)}function pj(e){return!(e instanceof oi)&&!(e instanceof po)}var hj=new ot("");function Ag(e,...t){return js([{provide:wc,multi:!0,useValue:e},[],{provide:ho,useFactory:gj,deps:[Tg]},{provide:ju,multi:!0,useFactory:mj},t.map(n=>n.\u0275providers)])}function gj(e){return e.routerState.root}function mj(){let e=Oe(Fn);return t=>{let n=e.get(or);if(t!==n.components[0])return;let r=e.get(Tg),s=e.get(vj);e.get(bj)===1&&r.initialNavigation(),e.get(yj,null,ut.Optional)?.setUpPreloading(),e.get(hj,null,ut.Optional)?.init(),r.resetRootComponentType(n.componentTypes[0]),s.closed||(s.next(),s.complete(),s.unsubscribe())}}var vj=new ot("",{factory:()=>new Yt}),bj=new ot("",{providedIn:"root",factory:()=>1});var yj=new ot("");var Ng=[];var _g={providers:[yh({eventCoalescing:!0}),Ag(Ng)]};var Lg=iv(Og());function wj(e,t){if(e&1&&(Ot(0,"li",16),Zt(1),Lt()),e&2){let n=t.$implicit;Rs(),Du(" ",n.error," ")}}function Cj(e,t){if(e&1&&(Ot(0,"div",12)(1,"button",13),Zt(2," Error List "),Lt(),Ot(3,"ul",14),Bs(4,wj,2,1,"li",15),Lt()()),e&2){let n=vh();Rs(4),Us("ngForOf",n.errorList)}}var pa=class e{title="myapp";jspreadsheetList;errorList=[];ngAfterViewInit(){let t=document.querySelector("div#spreadsheet");t&&(this.jspreadsheetList=(0,Lg.default)(t,{data:[],columns:[{type:"text",title:"Nama Pengirim",width:200,wordWrap:!0},{type:"text",title:"Telepon Pengirim",width:200,wordWrap:!0},{type:"text",title:"Nama Barang",width:200,wordWrap:!0},{type:"text",title:"Berat Barang",width:200,wordWrap:!0},{type:"text",title:"Nilai Barang",width:200,wordWrap:!0}],minDimensions:[5,5],paginationOptions:[],contextMenu:void 0,allowInsertRow:!1,allowInsertColumn:!1,allowManualInsertRow:!1,allowManualInsertColumn:!1}))}validateForm(){if(this.jspreadsheetList){let t=this.jspreadsheetList.getData();this.errorList=[],t.forEach((n,r)=>{let s=r;n.forEach((l,f)=>{let u=document.querySelector(`#spreadsheet td[data-x="${f}"][data-y="${r}"]`);u&&u.classList.contains("invalid-cell")&&u.classList.remove("invalid-cell")}),n.some(l=>l)&&(n.some(l=>!l)?(this.errorList.push({y:s,x:-1,error:"Data tidak lengkap"}),document.querySelectorAll(`#spreadsheet td[data-y="${r}"]:not(.jexcel_row)`).forEach(f=>{f&&!f.classList.contains("invalid-cell")&&f.classList.add("invalid-cell")})):n.forEach((l,f)=>{let u=f;u==0&&l.length>50&&(this.errorList.push({y:s,x:u,error:"Nama Pengirim max 50 karakter"}),this.setErrorOnSpreadSheet(u,s)),u==1&&(/^\d+$/.test(l)||(this.errorList.push({y:s,x:u,error:"Telepon Pengirim hanya boleh angka"}),this.setErrorOnSpreadSheet(u,s)),l.length<10&&(this.errorList.push({y:s,x:u,error:"Telepon Pengirim min 10 karakter"}),this.setErrorOnSpreadSheet(u,s)),l.length>15&&(this.errorList.push({y:s,x:u,error:"Telepon Pengirim max 15 karakter"}),this.setErrorOnSpreadSheet(u,s))),u==2&&l.length>50&&(this.errorList.push({y:s,x:u,error:"Nama Barang max 50 karaker"}),this.setErrorOnSpreadSheet(u,s)),u==3&&(/^[1-9][0-9]*$/.test(l)||(this.errorList.push({y:s,x:u,error:'Berat Barang hanya boleh angka (tidak diawali dengan "0")'}),this.setErrorOnSpreadSheet(u,s)),parseFloat(l)>5e4&&(this.errorList.push({y:s,x:u,error:"Berat Barang max 50.000 gram"}),this.setErrorOnSpreadSheet(u,s))),u==4&&(/^[1-9][0-9]*$/.test(l)||(this.errorList.push({y:s,x:u,error:'Nilai Barang hanya boleh angka (tidak diawali dengan "0")'}),this.setErrorOnSpreadSheet(u,s)),parseFloat(l)>5e6&&(this.errorList.push({y:s,x:u,error:"Nilai Barang max 5.000.000"}),this.setErrorOnSpreadSheet(u,s)))}))})}}setErrorOnSpreadSheet(t,n){let r=document.querySelector(`#spreadsheet td[data-x="${t}"][data-y="${n}"]`);r&&!r.classList.contains("invalid-cell")&&r.classList.add("invalid-cell")}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=Vs({type:e,selectors:[["app-root"]],decls:36,vars:1,consts:[[1,"container"],[1,"p-5"],[1,"position-relative"],[1,"position-absolute","top-0","end-0"],["class","dropdown",4,"ngIf"],["id","spreadsheet"],[1,"px-5","row"],[1,"col-12","pb-5"],["href","https://docs.google.com/spreadsheets/d/1rptEJqCz0CXQnc_jpnKMhColkIykXJjKYAaziWFzrR8/edit?usp=sharing","target","_blank"],[1,"col"],[1,"col-auto"],["type","button",1,"btn","btn-info","text-light",3,"click"],[1,"dropdown"],["type","button","data-bs-toggle","dropdown","aria-expanded","false",1,"btn","btn-secondary","dropdown-toggle"],[1,"dropdown-menu"],["class","dropdown-item",4,"ngFor","ngForOf"],[1,"dropdown-item"]],template:function(n,r){n&1&&(Ot(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),Bs(4,Cj,5,1,"div",4),Lt()(),Uo(5,"div",5),Lt(),Ot(6,"div",6)(7,"div",7)(8,"a",8),Zt(9,"Sampe Data"),Lt(),Ot(10,"span"),Zt(11," to test form"),Lt()(),Ot(12,"div",9),Zt(13," Daftar Validasi "),Ot(14,"ul")(15,"li"),Zt(16,"Nama Pengirim max 50 karakter"),Lt(),Ot(17,"li"),Zt(18,"Telepon Pengirim hanya boleh angka"),Lt(),Ot(19,"li"),Zt(20,"Telepon Pengirim min 10 karakter"),Lt(),Ot(21,"li"),Zt(22,"Telepon Pengirim max 15 karakter"),Lt(),Ot(23,"li"),Zt(24,"Nama Barang max 50 karaker"),Lt(),Ot(25,"li"),Zt(26,'Berat Barang hanya boleh angka (tidak diawali dengan "0")'),Lt(),Ot(27,"li"),Zt(28,"Berat Barang max 50.000 gram"),Lt(),Ot(29,"li"),Zt(30,'Nilai Barang hanya boleh angka (tidak diawali dengan "0")'),Lt(),Ot(31,"li"),Zt(32,"Nilai Barang max 5.000.000"),Lt()()(),Ot(33,"div",10)(34,"button",11),$s("click",function(){return r.validateForm()}),Zt(35,"Validate"),Lt()()()()),n&2&&(Rs(4),Us("ngIf",r.errorList.length>0))},dependencies:[Tu,Oh,Lh],encapsulation:2})};Wh(pa,_g).catch(e=>console.error(e));
