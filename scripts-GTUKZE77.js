if(!jSuites&&typeof require=="function")var jSuites=require("jsuites");(function(o,r){typeof exports=="object"&&typeof module<"u"?module.exports=r():typeof define=="function"&&define.amd?define(r):o.jspreadsheet=r()})(this,function(){var jspreadsheet;return function(){var __webpack_modules__={463:function(o){var r;o.exports=(function(){var a={765:function(O,b){var s;s=function(g){g.version="1.0.2";var S=Math;function T(U,B){for(var Z=0,ne=0;Z<U.length;++Z)ne=B*ne+U[Z];return ne}function d(U,B,Z,ne,ee){if(B===0)return Z;if(B===1)return ne;for(var J=2/U,de=ne,L=1;L<B;++L)de=ne*L*J+ee*Z,Z=ne,ne=de;return de}function l(U,B,Z,ne,ee){return function(J,de){if(ne){if(J===0)return ne==1?-1/0:1/0;if(J<0)return NaN}return de===0?U(J):de===1?B(J):de<0?NaN:d(J,de|=0,U(J),B(J),ee)}}var p,j,f,h,w,A,D,E,C,M,k,F,P,q=function(){var U=.636619772,B=[57568490574,-13362590354,6516196407e-1,-1121442418e-2,77392.33017,-184.9052456].reverse(),Z=[57568490411,1029532985,9494680718e-3,59272.64853,267.8532712,1].reverse(),ne=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),ee=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934935152e-16].reverse();function J(ue){var ae=0,ce=0,je=0,pe=ue*ue;if(ue<8)ae=(ce=T(B,pe))/(je=T(Z,pe));else{var Ce=ue-.785398164;ce=T(ne,pe=64/pe),je=T(ee,pe),ae=S.sqrt(U/ue)*(S.cos(Ce)*ce-S.sin(Ce)*je*8/ue)}return ae}var de=[72362614232,-7895059235,2423968531e-1,-2972611439e-3,15704.4826,-30.16036606].reverse(),L=[144725228442,2300535178,1858330474e-2,99447.43394,376.9991397,1].reverse(),X=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),oe=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function He(ue){var ae=0,ce=0,je=0,pe=ue*ue,Ce=S.abs(ue)-2.356194491;return Math.abs(ue)<8?ae=(ce=ue*T(de,pe))/(je=T(L,pe)):(ce=T(X,pe=64/pe),je=T(oe,pe),ae=S.sqrt(U/S.abs(ue))*(S.cos(Ce)*ce-S.sin(Ce)*je*8/S.abs(ue)),ue<0&&(ae=-ae)),ae}return function ue(ae,ce){if(ce=Math.round(ce),!isFinite(ae))return isNaN(ae)?ae:0;if(ce<0)return(ce%2?-1:1)*ue(ae,-ce);if(ae<0)return(ce%2?-1:1)*ue(-ae,ce);if(ce===0)return J(ae);if(ce===1)return He(ae);if(ae===0)return 0;var je=0;if(ae>ce)je=d(ae,ce,J(ae),He(ae),-1);else{for(var pe=!1,Ce=0,Te=0,be=1,me=0,Fe=2/ae,xe=2*S.floor((ce+S.floor(S.sqrt(40*ce)))/2);xe>0;xe--)me=xe*Fe*be-Ce,Ce=be,be=me,S.abs(be)>1e10&&(be*=1e-10,Ce*=1e-10,je*=1e-10,Te*=1e-10),pe&&(Te+=be),pe=!pe,xe==ce&&(je=Ce);je/=Te=2*Te-be}return je}}(),_=(p=.636619772,j=[-2957821389,7062834065,-5123598036e-1,1087988129e-2,-86327.92757,228.4622733].reverse(),f=[40076544269,7452499648e-1,7189466438e-3,47447.2647,226.1030244,1].reverse(),h=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),w=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934945152e-16].reverse(),A=[-4900604943e3,127527439e4,-51534381390,7349264551e-1,-4237922726e-3,8511.937935].reverse(),D=[249958057e5,424441966400,3733650367,2245904002e-2,102042.605,354.9632885,1].reverse(),E=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),C=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse(),l(function(U){var B=0,Z=0,ne=0,ee=U*U,J=U-.785398164;return U<8?B=(Z=T(j,ee))/(ne=T(f,ee))+p*q(U,0)*S.log(U):(Z=T(h,ee=64/ee),ne=T(w,ee),B=S.sqrt(p/U)*(S.sin(J)*Z+S.cos(J)*ne*8/U)),B},function(U){var B=0,Z=0,ne=0,ee=U*U,J=U-2.356194491;return U<8?B=(Z=U*T(A,ee))/(ne=T(D,ee))+p*(q(U,1)*S.log(U)-1/U):(Z=T(E,ee=64/ee),ne=T(C,ee),B=S.sqrt(p/U)*(S.sin(J)*Z+S.cos(J)*ne*8/U)),B},0,1,-1)),z=(M=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),k=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),F=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),P=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse(),function U(B,Z){if((Z=Math.round(Z))===0)return function(oe){return oe<=3.75?T(M,oe*oe/14.0625):S.exp(S.abs(oe))/S.sqrt(S.abs(oe))*T(k,3.75/S.abs(oe))}(B);if(Z===1)return function(oe){return oe<3.75?oe*T(F,oe*oe/14.0625):(oe<0?-1:1)*S.exp(S.abs(oe))/S.sqrt(S.abs(oe))*T(P,3.75/S.abs(oe))}(B);if(Z<0)return NaN;if(S.abs(B)===0)return 0;if(B==1/0)return 1/0;var ne,ee=0,J=2/S.abs(B),de=0,L=1,X=0;for(ne=2*S.round((Z+S.round(S.sqrt(40*Z)))/2);ne>0;ne--)X=ne*J*L+de,de=L,L=X,S.abs(L)>1e10&&(L*=1e-10,de*=1e-10,ee*=1e-10),ne==Z&&(ee=de);return ee*=U(B,0)/L,B<0&&Z%2?-ee:ee}),W=function(){var U=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),B=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse(),Z=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),ne=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();return l(function(ee){return ee<=2?-S.log(ee/2)*z(ee,0)+T(U,ee*ee/4):S.exp(-ee)/S.sqrt(ee)*T(B,2/ee)},function(ee){return ee<=2?S.log(ee/2)*z(ee,1)+1/ee*T(Z,ee*ee/4):S.exp(-ee)/S.sqrt(ee)*T(ne,2/ee)},0,2,1)}();g.besselj=q,g.bessely=_,g.besseli=z,g.besselk=W},s(typeof DO_NOT_EXPORT_BESSEL>"u"?b:{})},162:function(O){var b;O.exports=(b=function(s,g){var S=Array.prototype.concat,T=Array.prototype.slice,d=Object.prototype.toString;function l(C,M){var k=C>M?C:M;return s.pow(10,17-~~(s.log(k>0?k:-k)*s.LOG10E))}var p=Array.isArray||function(C){return d.call(C)==="[object Array]"};function j(C){return d.call(C)==="[object Function]"}function f(C){return typeof C=="number"&&C-C==0}function h(){return new h._init(arguments)}function w(){return 0}function A(){return 1}function D(C,M){return C===M?1:0}h.fn=h.prototype,h._init=function(C){if(p(C[0]))if(p(C[0][0])){j(C[1])&&(C[0]=h.map(C[0],C[1]));for(var M=0;M<C[0].length;M++)this[M]=C[0][M];this.length=C[0].length}else this[0]=j(C[1])?h.map(C[0],C[1]):C[0],this.length=1;else if(f(C[0]))this[0]=h.seq.apply(null,C),this.length=1;else{if(C[0]instanceof h)return h(C[0].toArray());this[0]=[],this.length=1}return this},h._init.prototype=h.prototype,h._init.constructor=h,h.utils={calcRdx:l,isArray:p,isFunction:j,isNumber:f,toVector:function(C){return S.apply([],C)}},h._random_fn=s.random,h.setRandom=function(C){if(typeof C!="function")throw new TypeError("fn is not a function");h._random_fn=C},h.extend=function(C){var M,k;if(arguments.length===1){for(k in C)h[k]=C[k];return this}for(M=1;M<arguments.length;M++)for(k in arguments[M])C[k]=arguments[M][k];return C},h.rows=function(C){return C.length||1},h.cols=function(C){return C[0].length||1},h.dimensions=function(C){return{rows:h.rows(C),cols:h.cols(C)}},h.row=function(C,M){return p(M)?M.map(function(k){return h.row(C,k)}):C[M]},h.rowa=function(C,M){return h.row(C,M)},h.col=function(C,M){if(p(M)){var k=h.arange(C.length).map(function(){return new Array(M.length)});return M.forEach(function(q,_){h.arange(C.length).forEach(function(z){k[z][_]=C[z][q]})}),k}for(var F=new Array(C.length),P=0;P<C.length;P++)F[P]=[C[P][M]];return F},h.cola=function(C,M){return h.col(C,M).map(function(k){return k[0]})},h.diag=function(C){for(var M=h.rows(C),k=new Array(M),F=0;F<M;F++)k[F]=[C[F][F]];return k},h.antidiag=function(C){for(var M=h.rows(C)-1,k=new Array(M),F=0;M>=0;M--,F++)k[F]=[C[F][M]];return k},h.transpose=function(C){var M,k,F,P,q,_=[];for(p(C[0])||(C=[C]),k=C.length,F=C[0].length,q=0;q<F;q++){for(M=new Array(k),P=0;P<k;P++)M[P]=C[P][q];_.push(M)}return _.length===1?_[0]:_},h.map=function(C,M,k){var F,P,q,_,z;for(p(C[0])||(C=[C]),P=C.length,q=C[0].length,_=k?C:new Array(P),F=0;F<P;F++)for(_[F]||(_[F]=new Array(q)),z=0;z<q;z++)_[F][z]=M(C[F][z],F,z);return _.length===1?_[0]:_},h.cumreduce=function(C,M,k){var F,P,q,_,z;for(p(C[0])||(C=[C]),P=C.length,q=C[0].length,_=k?C:new Array(P),F=0;F<P;F++)for(_[F]||(_[F]=new Array(q)),q>0&&(_[F][0]=C[F][0]),z=1;z<q;z++)_[F][z]=M(_[F][z-1],C[F][z]);return _.length===1?_[0]:_},h.alter=function(C,M){return h.map(C,M,!0)},h.create=function(C,M,k){var F,P,q=new Array(C);for(j(M)&&(k=M,M=C),F=0;F<C;F++)for(q[F]=new Array(M),P=0;P<M;P++)q[F][P]=k(F,P);return q},h.zeros=function(C,M){return f(M)||(M=C),h.create(C,M,w)},h.ones=function(C,M){return f(M)||(M=C),h.create(C,M,A)},h.rand=function(C,M){return f(M)||(M=C),h.create(C,M,h._random_fn)},h.identity=function(C,M){return f(M)||(M=C),h.create(C,M,D)},h.symmetric=function(C){var M,k,F=C.length;if(C.length!==C[0].length)return!1;for(M=0;M<F;M++)for(k=0;k<F;k++)if(C[k][M]!==C[M][k])return!1;return!0},h.clear=function(C){return h.alter(C,w)},h.seq=function(C,M,k,F){j(F)||(F=!1);var P,q=[],_=l(C,M),z=(M*_-C*_)/((k-1)*_),W=C;for(P=0;W<=M&&P<k;W=(C*_+z*_*++P)/_)q.push(F?F(W,P):W);return q},h.arange=function(C,M,k){var F,P=[];if(k=k||1,M===g&&(M=C,C=0),C===M||k===0)return[];if(C<M&&k<0)return[];if(C>M&&k>0)return[];if(k>0)for(F=C;F<M;F+=k)P.push(F);else for(F=C;F>M;F+=k)P.push(F);return P},h.slice=function(){function C(M,k,F,P){var q,_=[],z=M.length;if(k===g&&F===g&&P===g)return h.copy(M);if(P=P||1,(k=(k=k||0)>=0?k:z+k)===(F=(F=F||M.length)>=0?F:z+F)||P===0)return[];if(k<F&&P<0)return[];if(k>F&&P>0)return[];if(P>0)for(q=k;q<F;q+=P)_.push(M[q]);else for(q=k;q>F;q+=P)_.push(M[q]);return _}return function(M,k){var F,P;return f((k=k||{}).row)?f(k.col)?M[k.row][k.col]:C(h.rowa(M,k.row),(F=k.col||{}).start,F.end,F.step):f(k.col)?C(h.cola(M,k.col),(P=k.row||{}).start,P.end,P.step):(P=k.row||{},F=k.col||{},C(M,P.start,P.end,P.step).map(function(q){return C(q,F.start,F.end,F.step)}))}}(),h.sliceAssign=function(C,M,k){var F,P;if(f(M.row)){if(f(M.col))return C[M.row][M.col]=k;M.col=M.col||{},M.col.start=M.col.start||0,M.col.end=M.col.end||C[0].length,M.col.step=M.col.step||1,F=h.arange(M.col.start,s.min(C.length,M.col.end),M.col.step);var q=M.row;return F.forEach(function(z,W){C[q][z]=k[W]}),C}if(f(M.col)){M.row=M.row||{},M.row.start=M.row.start||0,M.row.end=M.row.end||C.length,M.row.step=M.row.step||1,P=h.arange(M.row.start,s.min(C[0].length,M.row.end),M.row.step);var _=M.col;return P.forEach(function(z,W){C[z][_]=k[W]}),C}return k[0].length===g&&(k=[k]),M.row.start=M.row.start||0,M.row.end=M.row.end||C.length,M.row.step=M.row.step||1,M.col.start=M.col.start||0,M.col.end=M.col.end||C[0].length,M.col.step=M.col.step||1,P=h.arange(M.row.start,s.min(C.length,M.row.end),M.row.step),F=h.arange(M.col.start,s.min(C[0].length,M.col.end),M.col.step),P.forEach(function(z,W){F.forEach(function(U,B){C[z][U]=k[W][B]})}),C},h.diagonal=function(C){var M=h.zeros(C.length,C.length);return C.forEach(function(k,F){M[F][F]=k}),M},h.copy=function(C){return C.map(function(M){return f(M)?M:M.map(function(k){return k})})};var E=h.prototype;return E.length=0,E.push=Array.prototype.push,E.sort=Array.prototype.sort,E.splice=Array.prototype.splice,E.slice=Array.prototype.slice,E.toArray=function(){return this.length>1?T.call(this):T.call(this)[0]},E.map=function(C,M){return h(h.map(this,C,M))},E.cumreduce=function(C,M){return h(h.cumreduce(this,C,M))},E.alter=function(C){return h.alter(this,C),this},function(C){for(var M=0;M<C.length;M++)(function(k){E[k]=function(F){var P,q=this;return F?(setTimeout(function(){F.call(q,E[k].call(q))}),this):(P=h[k](this),p(P)?h(P):P)}})(C[M])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(C){for(var M=0;M<C.length;M++)(function(k){E[k]=function(F,P){var q=this;return P?(setTimeout(function(){P.call(q,E[k].call(q,F))}),this):h(h[k](this,F))}})(C[M])}("row col".split(" ")),function(C){for(var M=0;M<C.length;M++)(function(k){E[k]=function(){return h(h[k].apply(null,arguments))}})(C[M])}("create zeros ones rand identity".split(" ")),h}(Math),function(s,g){var S=s.utils.isFunction;function T(p,j){return p-j}function d(p,j,f){return g.max(j,g.min(p,f))}s.sum=function(p){for(var j=0,f=p.length;--f>=0;)j+=p[f];return j},s.sumsqrd=function(p){for(var j=0,f=p.length;--f>=0;)j+=p[f]*p[f];return j},s.sumsqerr=function(p){for(var j,f=s.mean(p),h=0,w=p.length;--w>=0;)h+=(j=p[w]-f)*j;return h},s.sumrow=function(p){for(var j=0,f=p.length;--f>=0;)j+=p[f];return j},s.product=function(p){for(var j=1,f=p.length;--f>=0;)j*=p[f];return j},s.min=function(p){for(var j=p[0],f=0;++f<p.length;)p[f]<j&&(j=p[f]);return j},s.max=function(p){for(var j=p[0],f=0;++f<p.length;)p[f]>j&&(j=p[f]);return j},s.unique=function(p){for(var j={},f=[],h=0;h<p.length;h++)j[p[h]]||(j[p[h]]=!0,f.push(p[h]));return f},s.mean=function(p){return s.sum(p)/p.length},s.meansqerr=function(p){return s.sumsqerr(p)/p.length},s.geomean=function(p){var j=p.map(g.log),f=s.mean(j);return g.exp(f)},s.median=function(p){var j=p.length,f=p.slice().sort(T);return 1&j?f[j/2|0]:(f[j/2-1]+f[j/2])/2},s.cumsum=function(p){return s.cumreduce(p,function(j,f){return j+f})},s.cumprod=function(p){return s.cumreduce(p,function(j,f){return j*f})},s.diff=function(p){var j,f=[],h=p.length;for(j=1;j<h;j++)f.push(p[j]-p[j-1]);return f},s.rank=function(p){var j,f=[],h={};for(j=0;j<p.length;j++)h[E=p[j]]?h[E]++:(h[E]=1,f.push(E));var w=f.sort(T),A={},D=1;for(j=0;j<w.length;j++){var E,C=h[E=w[j]],M=(D+(D+C-1))/2;A[E]=M,D+=C}return p.map(function(k){return A[k]})},s.mode=function(p){var j,f=p.length,h=p.slice().sort(T),w=1,A=0,D=0,E=[];for(j=0;j<f;j++)h[j]===h[j+1]?w++:(w>A?(E=[h[j]],A=w,D=0):w===A&&(E.push(h[j]),D++),w=1);return D===0?E[0]:E},s.range=function(p){return s.max(p)-s.min(p)},s.variance=function(p,j){return s.sumsqerr(p)/(p.length-(j?1:0))},s.pooledvariance=function(p){return p.reduce(function(j,f){return j+s.sumsqerr(f)},0)/(p.reduce(function(j,f){return j+f.length},0)-p.length)},s.deviation=function(p){for(var j=s.mean(p),f=p.length,h=new Array(f),w=0;w<f;w++)h[w]=p[w]-j;return h},s.stdev=function(p,j){return g.sqrt(s.variance(p,j))},s.pooledstdev=function(p){return g.sqrt(s.pooledvariance(p))},s.meandev=function(p){for(var j=s.mean(p),f=[],h=p.length-1;h>=0;h--)f.push(g.abs(p[h]-j));return s.mean(f)},s.meddev=function(p){for(var j=s.median(p),f=[],h=p.length-1;h>=0;h--)f.push(g.abs(p[h]-j));return s.median(f)},s.coeffvar=function(p){return s.stdev(p)/s.mean(p)},s.quartiles=function(p){var j=p.length,f=p.slice().sort(T);return[f[g.round(j/4)-1],f[g.round(j/2)-1],f[g.round(3*j/4)-1]]},s.quantiles=function(p,j,f,h){var w,A,D,E,C,M=p.slice().sort(T),k=[j.length],F=p.length;for(f===void 0&&(f=.375),h===void 0&&(h=.375),w=0;w<j.length;w++)D=F*(A=j[w])+(f+A*(1-f-h)),E=g.floor(d(D,1,F-1)),C=d(D-E,0,1),k[w]=(1-C)*M[E-1]+C*M[E];return k},s.percentile=function(p,j,f){var h=p.slice().sort(T),w=j*(h.length+(f?1:-1))+(f?0:1),A=parseInt(w),D=w-A;return A+1<h.length?h[A-1]+D*(h[A]-h[A-1]):h[A-1]},s.percentileOfScore=function(p,j,f){var h,w,A=0,D=p.length,E=!1;for(f==="strict"&&(E=!0),w=0;w<D;w++)h=p[w],(E&&h<j||!E&&h<=j)&&A++;return A/D},s.histogram=function(p,j){j=j||4;var f,h=s.min(p),w=(s.max(p)-h)/j,A=p.length,D=[];for(f=0;f<j;f++)D[f]=0;for(f=0;f<A;f++)D[g.min(g.floor((p[f]-h)/w),j-1)]+=1;return D},s.covariance=function(p,j){var f,h=s.mean(p),w=s.mean(j),A=p.length,D=new Array(A);for(f=0;f<A;f++)D[f]=(p[f]-h)*(j[f]-w);return s.sum(D)/(A-1)},s.corrcoeff=function(p,j){return s.covariance(p,j)/s.stdev(p,1)/s.stdev(j,1)},s.spearmancoeff=function(p,j){return p=s.rank(p),j=s.rank(j),s.corrcoeff(p,j)},s.stanMoment=function(p,j){for(var f=s.mean(p),h=s.stdev(p),w=p.length,A=0,D=0;D<w;D++)A+=g.pow((p[D]-f)/h,j);return A/p.length},s.skewness=function(p){return s.stanMoment(p,3)},s.kurtosis=function(p){return s.stanMoment(p,4)-3};var l=s.prototype;(function(p){for(var j=0;j<p.length;j++)(function(f){l[f]=function(h,w){var A=[],D=0,E=this;if(S(h)&&(w=h,h=!1),w)return setTimeout(function(){w.call(E,l[f].call(E,h))}),this;if(this.length>1){for(E=h===!0?this:this.transpose();D<E.length;D++)A[D]=s[f](E[D]);return A}return s[f](this[0],h)}})(p[j])})("cumsum cumprod".split(" ")),function(p){for(var j=0;j<p.length;j++)(function(f){l[f]=function(h,w){var A=[],D=0,E=this;if(S(h)&&(w=h,h=!1),w)return setTimeout(function(){w.call(E,l[f].call(E,h))}),this;if(this.length>1){for(f!=="sumrow"&&(E=h===!0?this:this.transpose());D<E.length;D++)A[D]=s[f](E[D]);return h===!0?s[f](s.utils.toVector(A)):A}return s[f](this[0],h)}})(p[j])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(p){for(var j=0;j<p.length;j++)(function(f){l[f]=function(){var h,w=[],A=0,D=this,E=Array.prototype.slice.call(arguments);if(S(E[E.length-1])){h=E[E.length-1];var C=E.slice(0,E.length-1);return setTimeout(function(){h.call(D,l[f].apply(D,C))}),this}h=void 0;var M=function(k){return s[f].apply(D,[k].concat(E))};if(this.length>1){for(D=D.transpose();A<D.length;A++)w[A]=M(D[A]);return w}return M(this[0])}})(p[j])}("quantiles percentileOfScore".split(" "))}(b,Math),function(s,g){s.gammaln=function(S){var T,d,l,p=0,j=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],f=1.000000000190015;for(l=(d=T=S)+5.5,l-=(T+.5)*g.log(l);p<6;p++)f+=j[p]/++d;return g.log(2.5066282746310007*f/T)-l},s.loggam=function(S){var T,d,l,p,j,f,h,w=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(T=S,h=0,S==1||S==2)return 0;for(S<=7&&(T=S+(h=g.floor(7-S))),d=1/(T*T),l=2*g.PI,j=w[9],f=8;f>=0;f--)j*=d,j+=w[f];if(p=j/T+.5*g.log(l)+(T-.5)*g.log(T)-T,S<=7)for(f=1;f<=h;f++)p-=g.log(T-1),T-=1;return p},s.gammafn=function(S){var T,d,l,p,j=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],f=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],h=!1,w=0,A=0,D=0,E=S;if(S>171.6243769536076)return 1/0;if(E<=0){if(!(p=E%1+36e-17))return 1/0;h=(1&E?-1:1)*g.PI/g.sin(g.PI*p),E=1-E}for(l=E,d=E<1?E++:(E-=w=(0|E)-1)-1,T=0;T<8;++T)D=(D+j[T])*d,A=A*d+f[T];if(p=D/A+1,l<E)p/=l;else if(l>E)for(T=0;T<w;++T)p*=E,E++;return h&&(p=h/p),p},s.gammap=function(S,T){return s.lowRegGamma(S,T)*s.gammafn(S)},s.lowRegGamma=function(S,T){var d,l=s.gammaln(S),p=S,j=1/S,f=j,h=T+1-S,w=1/1e-30,A=1/h,D=A,E=1,C=-~(8.5*g.log(S>=1?S:1/S)+.4*S+17);if(T<0||S<=0)return NaN;if(T<S+1){for(;E<=C;E++)j+=f*=T/++p;return j*g.exp(-T+S*g.log(T)-l)}for(;E<=C;E++)D*=(A=1/(A=(d=-E*(E-S))*A+(h+=2)))*(w=h+d/w);return 1-D*g.exp(-T+S*g.log(T)-l)},s.factorialln=function(S){return S<0?NaN:s.gammaln(S+1)},s.factorial=function(S){return S<0?NaN:s.gammafn(S+1)},s.combination=function(S,T){return S>170||T>170?g.exp(s.combinationln(S,T)):s.factorial(S)/s.factorial(T)/s.factorial(S-T)},s.combinationln=function(S,T){return s.factorialln(S)-s.factorialln(T)-s.factorialln(S-T)},s.permutation=function(S,T){return s.factorial(S)/s.factorial(S-T)},s.betafn=function(S,T){if(!(S<=0||T<=0))return S+T>170?g.exp(s.betaln(S,T)):s.gammafn(S)*s.gammafn(T)/s.gammafn(S+T)},s.betaln=function(S,T){return s.gammaln(S)+s.gammaln(T)-s.gammaln(S+T)},s.betacf=function(S,T,d){var l,p,j,f,h=1e-30,w=1,A=T+d,D=T+1,E=T-1,C=1,M=1-A*S/D;for(g.abs(M)<h&&(M=h),f=M=1/M;w<=100&&(M=1+(p=w*(d-w)*S/((E+(l=2*w))*(T+l)))*M,g.abs(M)<h&&(M=h),C=1+p/C,g.abs(C)<h&&(C=h),f*=(M=1/M)*C,M=1+(p=-(T+w)*(A+w)*S/((T+l)*(D+l)))*M,g.abs(M)<h&&(M=h),C=1+p/C,g.abs(C)<h&&(C=h),f*=j=(M=1/M)*C,!(g.abs(j-1)<3e-7));w++);return f},s.gammapinv=function(S,T){var d,l,p,j,f,h,w=0,A=T-1,D=s.gammaln(T);if(S>=1)return g.max(100,T+100*g.sqrt(T));if(S<=0)return 0;for(T>1?(f=g.log(A),h=g.exp(A*(f-1)-D),j=S<.5?S:1-S,d=(2.30753+.27061*(l=g.sqrt(-2*g.log(j))))/(1+l*(.99229+.04481*l))-l,S<.5&&(d=-d),d=g.max(.001,T*g.pow(1-1/(9*T)-d/(3*g.sqrt(T)),3))):d=S<(l=1-T*(.253+.12*T))?g.pow(S/l,1/T):1-g.log(1-(S-l)/(1-l));w<12;w++){if(d<=0)return 0;if((d-=l=(p=(s.lowRegGamma(T,d)-S)/(l=T>1?h*g.exp(-(d-A)+A*(g.log(d)-f)):g.exp(-d+A*g.log(d)-D)))/(1-.5*g.min(1,p*((T-1)/d-1))))<=0&&(d=.5*(d+l)),g.abs(l)<1e-8*d)break}return d},s.erf=function(S){var T,d,l,p,j=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],f=j.length-1,h=!1,w=0,A=0;for(S<0&&(S=-S,h=!0),d=4*(T=2/(2+S))-2;f>0;f--)l=w,w=d*w-A+j[f],A=l;return p=T*g.exp(-S*S+.5*(j[0]+d*w)-A),h?p-1:1-p},s.erfc=function(S){return 1-s.erf(S)},s.erfcinv=function(S){var T,d,l,p,j=0;if(S>=2)return-100;if(S<=0)return 100;for(p=S<1?S:2-S,T=-.70711*((2.30753+.27061*(l=g.sqrt(-2*g.log(p/2))))/(1+l*(.99229+.04481*l))-l);j<2;j++)T+=(d=s.erfc(T)-p)/(1.1283791670955126*g.exp(-T*T)-T*d);return S<1?T:-T},s.ibetainv=function(S,T,d){var l,p,j,f,h,w,A,D,E,C,M=T-1,k=d-1,F=0;if(S<=0)return 0;if(S>=1)return 1;for(T>=1&&d>=1?(j=S<.5?S:1-S,w=(2.30753+.27061*(f=g.sqrt(-2*g.log(j))))/(1+f*(.99229+.04481*f))-f,S<.5&&(w=-w),A=(w*w-3)/6,D=2/(1/(2*T-1)+1/(2*d-1)),E=w*g.sqrt(A+D)/D-(1/(2*d-1)-1/(2*T-1))*(A+.8333333333333334-2/(3*D)),w=T/(T+d*g.exp(2*E))):(l=g.log(T/(T+d)),p=g.log(d/(T+d)),w=S<(f=g.exp(T*l)/T)/(E=f+(h=g.exp(d*p)/d))?g.pow(T*E*S,1/T):1-g.pow(d*E*(1-S),1/d)),C=-s.gammaln(T)-s.gammaln(d)+s.gammaln(T+d);F<10;F++){if(w===0||w===1)return w;if((w-=f=(h=(s.ibeta(w,T,d)-S)/(f=g.exp(M*g.log(w)+k*g.log(1-w)+C)))/(1-.5*g.min(1,h*(M/w-k/(1-w)))))<=0&&(w=.5*(w+f)),w>=1&&(w=.5*(w+f+1)),g.abs(f)<1e-8*w&&F>0)break}return w},s.ibeta=function(S,T,d){var l=S===0||S===1?0:g.exp(s.gammaln(T+d)-s.gammaln(T)-s.gammaln(d)+T*g.log(S)+d*g.log(1-S));return!(S<0||S>1)&&(S<(T+1)/(T+d+2)?l*s.betacf(S,T,d)/T:1-l*s.betacf(1-S,d,T)/d)},s.randn=function(S,T){var d,l,p,j,f;if(T||(T=S),S)return s.create(S,T,function(){return s.randn()});do d=s._random_fn(),l=1.7156*(s._random_fn()-.5),f=(p=d-.449871)*p+(j=g.abs(l)+.386595)*(.196*j-.25472*p);while(f>.27597&&(f>.27846||l*l>-4*g.log(d)*d*d));return l/d},s.randg=function(S,T,d){var l,p,j,f,h,w,A=S;if(d||(d=T),S||(S=1),T)return(w=s.zeros(T,d)).alter(function(){return s.randg(S)}),w;S<1&&(S+=1),l=S-.3333333333333333,p=1/g.sqrt(9*l);do{do f=1+p*(h=s.randn());while(f<=0);f*=f*f,j=s._random_fn()}while(j>1-.331*g.pow(h,4)&&g.log(j)>.5*h*h+l*(1-f+g.log(f)));if(S==A)return l*f;do j=s._random_fn();while(j===0);return g.pow(j,1/A)*l*f},function(S){for(var T=0;T<S.length;T++)(function(d){s.fn[d]=function(){return s(s.map(this,function(l){return s[d](l)}))}})(S[T])}("gammaln gammafn factorial factorialln".split(" ")),function(S){for(var T=0;T<S.length;T++)(function(d){s.fn[d]=function(){return s(s[d].apply(null,arguments))}})(S[T])}("randn".split(" "))}(b,Math),function(s,g){function S(d,l,p,j){for(var f,h=0,w=1,A=1,D=1,E=0,C=0;g.abs((A-C)/A)>j;)C=A,w=D+(f=-(l+E)*(l+p+E)*d/(l+2*E)/(l+2*E+1))*w,A=(h=A+f*h)+(f=(E+=1)*(p-E)*d/(l+2*E-1)/(l+2*E))*A,h/=D=w+f*D,w/=D,A/=D,D=1;return A/l}function T(d,l,p){var j=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],f=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],h=.5*d;if(h>=8)return 1;var w,A=2*s.normal.cdf(h,0,1,1,0)-1;A=A>=g.exp(-50/p)?g.pow(A,p):0;for(var D=h,E=(8-h)/(w=d>3?2:3),C=D+E,M=0,k=p-1,F=1;F<=w;F++){for(var P=0,q=.5*(C+D),_=.5*(C-D),z=1;z<=12;z++){var W,U=q+_*(6<z?j[(W=12-z+1)-1]:-j[(W=z)-1]),B=U*U;if(B>60)break;var Z=2*s.normal.cdf(U,0,1,1,0)*.5-2*s.normal.cdf(U,d,1,1,0)*.5;Z>=g.exp(-30/k)&&(P+=Z=f[W-1]*g.exp(-.5*B)*g.pow(Z,k))}M+=P*=2*_*p/g.sqrt(2*g.PI),D=C,C+=E}return(A+=M)<=g.exp(-30/l)?0:(A=g.pow(A,l))>=1?1:A}(function(d){for(var l=0;l<d.length;l++)(function(p){s[p]=function j(f,h,w){return this instanceof j?(this._a=f,this._b=h,this._c=w,this):new j(f,h,w)},s.fn[p]=function(j,f,h){var w=s[p](j,f,h);return w.data=this,w},s[p].prototype.sample=function(j){var f=this._a,h=this._b,w=this._c;return j?s.alter(j,function(){return s[p].sample(f,h,w)}):s[p].sample(f,h,w)},function(j){for(var f=0;f<j.length;f++)(function(h){s[p].prototype[h]=function(w){var A=this._a,D=this._b,E=this._c;return w||w===0||(w=this.data),typeof w!="number"?s.fn.map.call(w,function(C){return s[p][h](C,A,D,E)}):s[p][h](w,A,D,E)}})(j[f])}("pdf cdf inv".split(" ")),function(j){for(var f=0;f<j.length;f++)(function(h){s[p].prototype[h]=function(){return s[p][h](this._a,this._b,this._c)}})(j[f])}("mean median mode variance".split(" "))})(d[l])})("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),s.extend(s.beta,{pdf:function(d,l,p){return d>1||d<0?0:l==1&&p==1?1:l<512&&p<512?g.pow(d,l-1)*g.pow(1-d,p-1)/s.betafn(l,p):g.exp((l-1)*g.log(d)+(p-1)*g.log(1-d)-s.betaln(l,p))},cdf:function(d,l,p){return d>1||d<0?1*(d>1):s.ibeta(d,l,p)},inv:function(d,l,p){return s.ibetainv(d,l,p)},mean:function(d,l){return d/(d+l)},median:function(d,l){return s.ibetainv(.5,d,l)},mode:function(d,l){return(d-1)/(d+l-2)},sample:function(d,l){var p=s.randg(d);return p/(p+s.randg(l))},variance:function(d,l){return d*l/(g.pow(d+l,2)*(d+l+1))}}),s.extend(s.centralF,{pdf:function(d,l,p){var j;return d<0?0:l<=2?d===0&&l<2?1/0:d===0&&l===2?1:1/s.betafn(l/2,p/2)*g.pow(l/p,l/2)*g.pow(d,l/2-1)*g.pow(1+l/p*d,-(l+p)/2):(j=l*d/(p+d*l),l*(p/(p+d*l))/2*s.binomial.pdf((l-2)/2,(l+p-2)/2,j))},cdf:function(d,l,p){return d<0?0:s.ibeta(l*d/(l*d+p),l/2,p/2)},inv:function(d,l,p){return p/(l*(1/s.ibetainv(d,l/2,p/2)-1))},mean:function(d,l){return l>2?l/(l-2):void 0},mode:function(d,l){return d>2?l*(d-2)/(d*(l+2)):void 0},sample:function(d,l){return 2*s.randg(d/2)/d/(2*s.randg(l/2)/l)},variance:function(d,l){if(!(l<=4))return 2*l*l*(d+l-2)/(d*(l-2)*(l-2)*(l-4))}}),s.extend(s.cauchy,{pdf:function(d,l,p){return p<0?0:p/(g.pow(d-l,2)+g.pow(p,2))/g.PI},cdf:function(d,l,p){return g.atan((d-l)/p)/g.PI+.5},inv:function(d,l,p){return l+p*g.tan(g.PI*(d-.5))},median:function(d){return d},mode:function(d){return d},sample:function(d,l){return s.randn()*g.sqrt(1/(2*s.randg(.5)))*l+d}}),s.extend(s.chisquare,{pdf:function(d,l){return d<0?0:d===0&&l===2?.5:g.exp((l/2-1)*g.log(d)-d/2-l/2*g.log(2)-s.gammaln(l/2))},cdf:function(d,l){return d<0?0:s.lowRegGamma(l/2,d/2)},inv:function(d,l){return 2*s.gammapinv(d,.5*l)},mean:function(d){return d},median:function(d){return d*g.pow(1-2/(9*d),3)},mode:function(d){return d-2>0?d-2:0},sample:function(d){return 2*s.randg(d/2)},variance:function(d){return 2*d}}),s.extend(s.exponential,{pdf:function(d,l){return d<0?0:l*g.exp(-l*d)},cdf:function(d,l){return d<0?0:1-g.exp(-l*d)},inv:function(d,l){return-g.log(1-d)/l},mean:function(d){return 1/d},median:function(d){return 1/d*g.log(2)},mode:function(){return 0},sample:function(d){return-1/d*g.log(s._random_fn())},variance:function(d){return g.pow(d,-2)}}),s.extend(s.gamma,{pdf:function(d,l,p){return d<0?0:d===0&&l===1?1/p:g.exp((l-1)*g.log(d)-d/p-s.gammaln(l)-l*g.log(p))},cdf:function(d,l,p){return d<0?0:s.lowRegGamma(l,d/p)},inv:function(d,l,p){return s.gammapinv(d,l)*p},mean:function(d,l){return d*l},mode:function(d,l){if(d>1)return(d-1)*l},sample:function(d,l){return s.randg(d)*l},variance:function(d,l){return d*l*l}}),s.extend(s.invgamma,{pdf:function(d,l,p){return d<=0?0:g.exp(-(l+1)*g.log(d)-p/d-s.gammaln(l)+l*g.log(p))},cdf:function(d,l,p){return d<=0?0:1-s.lowRegGamma(l,p/d)},inv:function(d,l,p){return p/s.gammapinv(1-d,l)},mean:function(d,l){return d>1?l/(d-1):void 0},mode:function(d,l){return l/(d+1)},sample:function(d,l){return l/s.randg(d)},variance:function(d,l){if(!(d<=2))return l*l/((d-1)*(d-1)*(d-2))}}),s.extend(s.kumaraswamy,{pdf:function(d,l,p){return d===0&&l===1?p:d===1&&p===1?l:g.exp(g.log(l)+g.log(p)+(l-1)*g.log(d)+(p-1)*g.log(1-g.pow(d,l)))},cdf:function(d,l,p){return d<0?0:d>1?1:1-g.pow(1-g.pow(d,l),p)},inv:function(d,l,p){return g.pow(1-g.pow(1-d,1/p),1/l)},mean:function(d,l){return l*s.gammafn(1+1/d)*s.gammafn(l)/s.gammafn(1+1/d+l)},median:function(d,l){return g.pow(1-g.pow(2,-1/l),1/d)},mode:function(d,l){if(d>=1&&l>=1&&d!==1&&l!==1)return g.pow((d-1)/(d*l-1),1/d)},variance:function(){throw new Error("variance not yet implemented")}}),s.extend(s.lognormal,{pdf:function(d,l,p){return d<=0?0:g.exp(-g.log(d)-.5*g.log(2*g.PI)-g.log(p)-g.pow(g.log(d)-l,2)/(2*p*p))},cdf:function(d,l,p){return d<0?0:.5+.5*s.erf((g.log(d)-l)/g.sqrt(2*p*p))},inv:function(d,l,p){return g.exp(-1.4142135623730951*p*s.erfcinv(2*d)+l)},mean:function(d,l){return g.exp(d+l*l/2)},median:function(d){return g.exp(d)},mode:function(d,l){return g.exp(d-l*l)},sample:function(d,l){return g.exp(s.randn()*l+d)},variance:function(d,l){return(g.exp(l*l)-1)*g.exp(2*d+l*l)}}),s.extend(s.noncentralt,{pdf:function(d,l,p){return g.abs(p)<1e-14?s.studentt.pdf(d,l):g.abs(d)<1e-14?g.exp(s.gammaln((l+1)/2)-p*p/2-.5*g.log(g.PI*l)-s.gammaln(l/2)):l/d*(s.noncentralt.cdf(d*g.sqrt(1+2/l),l+2,p)-s.noncentralt.cdf(d,l,p))},cdf:function(d,l,p){var j=1e-14;if(g.abs(p)<j)return s.studentt.cdf(d,l);var f=!1;d<0&&(f=!0,p=-p);for(var h=s.normal.cdf(-p,0,1),w=j+1,A=w,D=d*d/(d*d+l),E=0,C=g.exp(-p*p/2),M=g.exp(-p*p/2-.5*g.log(2)-s.gammaln(1.5))*p;E<200||A>j||w>j;)A=w,E>0&&(C*=p*p/(2*E),M*=p*p/(2*(E+.5))),h+=.5*(w=C*s.beta.cdf(D,E+.5,l/2)+M*s.beta.cdf(D,E+1,l/2)),E++;return f?1-h:h}}),s.extend(s.normal,{pdf:function(d,l,p){return g.exp(-.5*g.log(2*g.PI)-g.log(p)-g.pow(d-l,2)/(2*p*p))},cdf:function(d,l,p){return .5*(1+s.erf((d-l)/g.sqrt(2*p*p)))},inv:function(d,l,p){return-1.4142135623730951*p*s.erfcinv(2*d)+l},mean:function(d){return d},median:function(d){return d},mode:function(d){return d},sample:function(d,l){return s.randn()*l+d},variance:function(d,l){return l*l}}),s.extend(s.pareto,{pdf:function(d,l,p){return d<l?0:p*g.pow(l,p)/g.pow(d,p+1)},cdf:function(d,l,p){return d<l?0:1-g.pow(l/d,p)},inv:function(d,l,p){return l/g.pow(1-d,1/p)},mean:function(d,l){if(!(l<=1))return l*g.pow(d,l)/(l-1)},median:function(d,l){return d*(l*g.SQRT2)},mode:function(d){return d},variance:function(d,l){if(!(l<=2))return d*d*l/(g.pow(l-1,2)*(l-2))}}),s.extend(s.studentt,{pdf:function(d,l){return l=l>1e100?1e100:l,1/(g.sqrt(l)*s.betafn(.5,l/2))*g.pow(1+d*d/l,-(l+1)/2)},cdf:function(d,l){var p=l/2;return s.ibeta((d+g.sqrt(d*d+l))/(2*g.sqrt(d*d+l)),p,p)},inv:function(d,l){var p=s.ibetainv(2*g.min(d,1-d),.5*l,.5);return p=g.sqrt(l*(1-p)/p),d>.5?p:-p},mean:function(d){return d>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(d){return s.randn()*g.sqrt(d/(2*s.randg(d/2)))},variance:function(d){return d>2?d/(d-2):d>1?1/0:void 0}}),s.extend(s.weibull,{pdf:function(d,l,p){return d<0||l<0||p<0?0:p/l*g.pow(d/l,p-1)*g.exp(-g.pow(d/l,p))},cdf:function(d,l,p){return d<0?0:1-g.exp(-g.pow(d/l,p))},inv:function(d,l,p){return l*g.pow(-g.log(1-d),1/p)},mean:function(d,l){return d*s.gammafn(1+1/l)},median:function(d,l){return d*g.pow(g.log(2),1/l)},mode:function(d,l){return l<=1?0:d*g.pow((l-1)/l,1/l)},sample:function(d,l){return d*g.pow(-g.log(s._random_fn()),1/l)},variance:function(d,l){return d*d*s.gammafn(1+2/l)-g.pow(s.weibull.mean(d,l),2)}}),s.extend(s.uniform,{pdf:function(d,l,p){return d<l||d>p?0:1/(p-l)},cdf:function(d,l,p){return d<l?0:d<p?(d-l)/(p-l):1},inv:function(d,l,p){return l+d*(p-l)},mean:function(d,l){return .5*(d+l)},median:function(d,l){return s.mean(d,l)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(d,l){return d/2+l/2+(l/2-d/2)*(2*s._random_fn()-1)},variance:function(d,l){return g.pow(l-d,2)/12}}),s.extend(s.binomial,{pdf:function(d,l,p){return p===0||p===1?l*p===d?1:0:s.combination(l,d)*g.pow(p,d)*g.pow(1-p,l-d)},cdf:function(d,l,p){var j,f=1e-10;if(d<0)return 0;if(d>=l)return 1;if(p<0||p>1||l<=0)return NaN;var h=p,w=(d=g.floor(d))+1,A=l-d,D=w+A,E=g.exp(s.gammaln(D)-s.gammaln(A)-s.gammaln(w)+w*g.log(h)+A*g.log(1-h));return j=h<(w+1)/(D+2)?E*S(h,w,A,f):1-E*S(1-h,A,w,f),g.round(1/f*(1-j))/(1/f)}}),s.extend(s.negbin,{pdf:function(d,l,p){return d===d>>>0&&(d<0?0:s.combination(d+l-1,l-1)*g.pow(1-p,d)*g.pow(p,l))},cdf:function(d,l,p){var j=0,f=0;if(d<0)return 0;for(;f<=d;f++)j+=s.negbin.pdf(f,l,p);return j}}),s.extend(s.hypgeom,{pdf:function(d,l,p,j){if(d!=d|0)return!1;if(d<0||d<p-(l-j)||d>j||d>p)return 0;if(2*p>l)return 2*j>l?s.hypgeom.pdf(l-p-j+d,l,l-p,l-j):s.hypgeom.pdf(j-d,l,l-p,j);if(2*j>l)return s.hypgeom.pdf(p-d,l,p,l-j);if(p<j)return s.hypgeom.pdf(d,l,j,p);for(var f=1,h=0,w=0;w<d;w++){for(;f>1&&h<j;)f*=1-p/(l-h),h++;f*=(j-w)*(p-w)/((w+1)*(l-p-j+w+1))}for(;h<j;h++)f*=1-p/(l-h);return g.min(1,g.max(0,f))},cdf:function(d,l,p,j){if(d<0||d<p-(l-j))return 0;if(d>=j||d>=p)return 1;if(2*p>l)return 2*j>l?s.hypgeom.cdf(l-p-j+d,l,l-p,l-j):1-s.hypgeom.cdf(j-d-1,l,l-p,j);if(2*j>l)return 1-s.hypgeom.cdf(p-d-1,l,p,l-j);if(p<j)return s.hypgeom.cdf(d,l,j,p);for(var f=1,h=1,w=0,A=0;A<d;A++){for(;f>1&&w<j;){var D=1-p/(l-w);h*=D,f*=D,w++}f+=h*=(j-A)*(p-A)/((A+1)*(l-p-j+A+1))}for(;w<j;w++)f*=1-p/(l-w);return g.min(1,g.max(0,f))}}),s.extend(s.poisson,{pdf:function(d,l){return l<0||d%1!=0||d<0?0:g.pow(l,d)*g.exp(-l)/s.factorial(d)},cdf:function(d,l){var p=[],j=0;if(d<0)return 0;for(;j<=d;j++)p.push(s.poisson.pdf(j,l));return s.sum(p)},mean:function(d){return d},variance:function(d){return d},sampleSmall:function(d){var l=1,p=0,j=g.exp(-d);do p++,l*=s._random_fn();while(l>j);return p-1},sampleLarge:function(d){var l,p,j,f,h,w,A,D,E,C,M=d;for(f=g.sqrt(M),h=g.log(M),w=.02483*(A=.931+2.53*f)-.059,D=1.1239+1.1328/(A-3.4),E=.9277-3.6224/(A-2);;)if(p=g.random()-.5,j=g.random(),C=.5-g.abs(p),l=g.floor((2*w/C+A)*p+M+.43),C>=.07&&j<=E||!(l<0||C<.013&&j>C)&&g.log(j)+g.log(D)-g.log(w/(C*C)+A)<=l*h-M-s.loggam(l+1))return l},sample:function(d){return d<10?this.sampleSmall(d):this.sampleLarge(d)}}),s.extend(s.triangular,{pdf:function(d,l,p,j){return p<=l||j<l||j>p?NaN:d<l||d>p?0:d<j?2*(d-l)/((p-l)*(j-l)):d===j?2/(p-l):2*(p-d)/((p-l)*(p-j))},cdf:function(d,l,p,j){return p<=l||j<l||j>p?NaN:d<=l?0:d>=p?1:d<=j?g.pow(d-l,2)/((p-l)*(j-l)):1-g.pow(p-d,2)/((p-l)*(p-j))},inv:function(d,l,p,j){return p<=l||j<l||j>p?NaN:d<=(j-l)/(p-l)?l+(p-l)*g.sqrt(d*((j-l)/(p-l))):l+(p-l)*(1-g.sqrt((1-d)*(1-(j-l)/(p-l))))},mean:function(d,l,p){return(d+l+p)/3},median:function(d,l,p){return p<=(d+l)/2?l-g.sqrt((l-d)*(l-p))/g.sqrt(2):p>(d+l)/2?d+g.sqrt((l-d)*(p-d))/g.sqrt(2):void 0},mode:function(d,l,p){return p},sample:function(d,l,p){var j=s._random_fn();return j<(p-d)/(l-d)?d+g.sqrt(j*(l-d)*(p-d)):l-g.sqrt((1-j)*(l-d)*(l-p))},variance:function(d,l,p){return(d*d+l*l+p*p-d*l-d*p-l*p)/18}}),s.extend(s.arcsine,{pdf:function(d,l,p){return p<=l?NaN:d<=l||d>=p?0:2/g.PI*g.pow(g.pow(p-l,2)-g.pow(2*d-l-p,2),-.5)},cdf:function(d,l,p){return d<l?0:d<p?2/g.PI*g.asin(g.sqrt((d-l)/(p-l))):1},inv:function(d,l,p){return l+(.5-.5*g.cos(g.PI*d))*(p-l)},mean:function(d,l){return l<=d?NaN:(d+l)/2},median:function(d,l){return l<=d?NaN:(d+l)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(d,l){return(d+l)/2+(l-d)/2*g.sin(2*g.PI*s.uniform.sample(0,1))},variance:function(d,l){return l<=d?NaN:g.pow(l-d,2)/8}}),s.extend(s.laplace,{pdf:function(d,l,p){return p<=0?0:g.exp(-g.abs(d-l)/p)/(2*p)},cdf:function(d,l,p){return p<=0?0:d<l?.5*g.exp((d-l)/p):1-.5*g.exp(-(d-l)/p)},mean:function(d){return d},median:function(d){return d},mode:function(d){return d},variance:function(d,l){return 2*l*l},sample:function(d,l){var p,j=s._random_fn()-.5;return d-l*((p=j)/g.abs(p))*g.log(1-2*g.abs(j))}}),s.extend(s.tukey,{cdf:function(d,l,p){var j=l,f=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],h=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(d<=0)return 0;if(p<2||j<2)return NaN;if(!Number.isFinite(d))return 1;if(p>25e3)return T(d,1,j);var w,A=.5*p,D=A*g.log(p)-p*g.log(2)-s.gammaln(A),E=A-1,C=.25*p;w=p<=100?1:p<=800?.5:p<=5e3?.25:.125,D+=g.log(w);for(var M=0,k=1;k<=50;k++){for(var F=0,P=(2*k-1)*w,q=1;q<=16;q++){var _,z;8<q?(_=q-8-1,z=D+E*g.log(P+f[_]*w)-(f[_]*w+P)*C):(_=q-1,z=D+E*g.log(P-f[_]*w)+(f[_]*w-P)*C),z>=-30&&(F+=T(8<q?d*g.sqrt(.5*(f[_]*w+P)):d*g.sqrt(.5*(-f[_]*w+P)),1,j)*h[_]*g.exp(z))}if(k*w>=1&&F<=1e-14)break;M+=F}if(F>1e-14)throw new Error("tukey.cdf failed to converge");return M>1&&(M=1),M},inv:function(d,l,p){if(p<2||l<2)return NaN;if(d<0||d>1)return NaN;if(d===0)return 0;if(d===1)return 1/0;var j,f=function(E,C,M){var k=.5-.5*E,F=g.sqrt(g.log(1/(k*k))),P=F+((((-453642210148e-16*F-.204231210125)*F-.342242088547)*F-1)*F+.322232421088)/((((.0038560700634*F+.10353775285)*F+.531103462366)*F+.588581570495)*F+.099348462606);M<120&&(P+=(P*P*P+P)/M/4);var q=.8832-.2368*P;return M<120&&(q+=-1.214/M+1.208*P/M),P*(q*g.log(C-1)+1.4142)}(d,l,p),h=s.tukey.cdf(f,l,p)-d;j=h>0?g.max(0,f-1):f+1;for(var w,A=s.tukey.cdf(j,l,p)-d,D=1;D<50;D++)if(w=j-A*(j-f)/(A-h),h=A,f=j,w<0&&(w=0,A=-d),A=s.tukey.cdf(w,l,p)-d,j=w,g.abs(j-f)<1e-4)return w;throw new Error("tukey.inv failed to converge")}})}(b,Math),function(s,g){var S,T,d=Array.prototype.push,l=s.utils.isArray;function p(j){return l(j)||j instanceof s}s.extend({add:function(j,f){return p(f)?(p(f[0])||(f=[f]),s.map(j,function(h,w,A){return h+f[w][A]})):s.map(j,function(h){return h+f})},subtract:function(j,f){return p(f)?(p(f[0])||(f=[f]),s.map(j,function(h,w,A){return h-f[w][A]||0})):s.map(j,function(h){return h-f})},divide:function(j,f){return p(f)?(p(f[0])||(f=[f]),s.multiply(j,s.inv(f))):s.map(j,function(h){return h/f})},multiply:function(j,f){var h,w,A,D,E,C,M,k;if(j.length===void 0&&f.length===void 0)return j*f;if(E=j.length,C=j[0].length,M=s.zeros(E,A=p(f)?f[0].length:C),k=0,p(f)){for(;k<A;k++)for(h=0;h<E;h++){for(D=0,w=0;w<C;w++)D+=j[h][w]*f[w][k];M[h][k]=D}return E===1&&k===1?M[0][0]:M}return s.map(j,function(F){return F*f})},outer:function(j,f){return s.multiply(j.map(function(h){return[h]}),[f])},dot:function(j,f){p(j[0])||(j=[j]),p(f[0])||(f=[f]);for(var h,w,A=j[0].length===1&&j.length!==1?s.transpose(j):j,D=f[0].length===1&&f.length!==1?s.transpose(f):f,E=[],C=0,M=A.length,k=A[0].length;C<M;C++){for(E[C]=[],h=0,w=0;w<k;w++)h+=A[C][w]*D[C][w];E[C]=h}return E.length===1?E[0]:E},pow:function(j,f){return s.map(j,function(h){return g.pow(h,f)})},exp:function(j){return s.map(j,function(f){return g.exp(f)})},log:function(j){return s.map(j,function(f){return g.log(f)})},abs:function(j){return s.map(j,function(f){return g.abs(f)})},norm:function(j,f){var h=0,w=0;for(isNaN(f)&&(f=2),p(j[0])&&(j=j[0]);w<j.length;w++)h+=g.pow(g.abs(j[w]),f);return g.pow(h,1/f)},angle:function(j,f){return g.acos(s.dot(j,f)/(s.norm(j)*s.norm(f)))},aug:function(j,f){var h,w=[];for(h=0;h<j.length;h++)w.push(j[h].slice());for(h=0;h<w.length;h++)d.apply(w[h],f[h]);return w},inv:function(j){for(var f,h=j.length,w=j[0].length,A=s.identity(h,w),D=s.gauss_jordan(j,A),E=[],C=0;C<h;C++)for(E[C]=[],f=w;f<D[0].length;f++)E[C][f-w]=D[C][f];return E},det:function j(f){if(f.length===2)return f[0][0]*f[1][1]-f[0][1]*f[1][0];for(var h=0,w=0;w<f.length;w++){for(var A=[],D=1;D<f.length;D++){A[D-1]=[];for(var E=0;E<f.length;E++)E<w?A[D-1][E]=f[D][E]:E>w&&(A[D-1][E-1]=f[D][E])}var C=w%2?-1:1;h+=j(A)*f[0][w]*C}return h},gauss_elimination:function(j,f){var h,w,A,D,E=0,C=0,M=j.length,k=j[0].length,F=1,P=0,q=[];for(h=(j=s.aug(j,f))[0].length,E=0;E<M;E++){for(w=j[E][E],C=E,D=E+1;D<k;D++)w<g.abs(j[D][E])&&(w=j[D][E],C=D);if(C!=E)for(D=0;D<h;D++)A=j[E][D],j[E][D]=j[C][D],j[C][D]=A;for(C=E+1;C<M;C++)for(F=j[C][E]/j[E][E],D=E;D<h;D++)j[C][D]=j[C][D]-F*j[E][D]}for(E=M-1;E>=0;E--){for(P=0,C=E+1;C<=M-1;C++)P+=q[C]*j[E][C];q[E]=(j[E][h-1]-P)/j[E][E]}return q},gauss_jordan:function(j,f){var h,w,A,D=s.aug(j,f),E=D.length,C=D[0].length,M=0;for(w=0;w<E;w++){var k=w;for(A=w+1;A<E;A++)g.abs(D[A][w])>g.abs(D[k][w])&&(k=A);var F=D[w];for(D[w]=D[k],D[k]=F,A=w+1;A<E;A++)for(M=D[A][w]/D[w][w],h=w;h<C;h++)D[A][h]-=D[w][h]*M}for(w=E-1;w>=0;w--){for(M=D[w][w],A=0;A<w;A++)for(h=C-1;h>w-1;h--)D[A][h]-=D[w][h]*D[A][w]/M;for(D[w][w]/=M,h=E;h<C;h++)D[w][h]/=M}return D},triaUpSolve:function(j,f){var h,w=j[0].length,A=s.zeros(1,w)[0],D=!1;return f[0].length!=null&&(f=f.map(function(E){return E[0]}),D=!0),s.arange(w-1,-1,-1).forEach(function(E){h=s.arange(E+1,w).map(function(C){return A[C]*j[E][C]}),A[E]=(f[E]-s.sum(h))/j[E][E]}),D?A.map(function(E){return[E]}):A},triaLowSolve:function(j,f){var h,w=j[0].length,A=s.zeros(1,w)[0],D=!1;return f[0].length!=null&&(f=f.map(function(E){return E[0]}),D=!0),s.arange(w).forEach(function(E){h=s.arange(E).map(function(C){return j[E][C]*A[C]}),A[E]=(f[E]-s.sum(h))/j[E][E]}),D?A.map(function(E){return[E]}):A},lu:function(j){var f,h=j.length,w=s.identity(h),A=s.zeros(j.length,j[0].length);return s.arange(h).forEach(function(D){A[0][D]=j[0][D]}),s.arange(1,h).forEach(function(D){s.arange(D).forEach(function(E){f=s.arange(E).map(function(C){return w[D][C]*A[C][E]}),w[D][E]=(j[D][E]-s.sum(f))/A[E][E]}),s.arange(D,h).forEach(function(E){f=s.arange(D).map(function(C){return w[D][C]*A[C][E]}),A[D][E]=j[f.length][E]-s.sum(f)})}),[w,A]},cholesky:function(j){var f,h=j.length,w=s.zeros(j.length,j[0].length);return s.arange(h).forEach(function(A){f=s.arange(A).map(function(D){return g.pow(w[A][D],2)}),w[A][A]=g.sqrt(j[A][A]-s.sum(f)),s.arange(A+1,h).forEach(function(D){f=s.arange(A).map(function(E){return w[A][E]*w[D][E]}),w[D][A]=(j[A][D]-s.sum(f))/w[A][A]})}),w},gauss_jacobi:function(j,f,h,w){for(var A,D,E,C,M=0,k=0,F=j.length,P=[],q=[],_=[];M<F;M++)for(P[M]=[],q[M]=[],_[M]=[],k=0;k<F;k++)M>k?(P[M][k]=j[M][k],q[M][k]=_[M][k]=0):M<k?(q[M][k]=j[M][k],P[M][k]=_[M][k]=0):(_[M][k]=j[M][k],P[M][k]=q[M][k]=0);for(E=s.multiply(s.multiply(s.inv(_),s.add(P,q)),-1),D=s.multiply(s.inv(_),f),A=h,C=s.add(s.multiply(E,h),D),M=2;g.abs(s.norm(s.subtract(C,A)))>w;)A=C,C=s.add(s.multiply(E,A),D),M++;return C},gauss_seidel:function(j,f,h,w){for(var A,D,E,C,M,k=0,F=j.length,P=[],q=[],_=[];k<F;k++)for(P[k]=[],q[k]=[],_[k]=[],A=0;A<F;A++)k>A?(P[k][A]=j[k][A],q[k][A]=_[k][A]=0):k<A?(q[k][A]=j[k][A],P[k][A]=_[k][A]=0):(_[k][A]=j[k][A],P[k][A]=q[k][A]=0);for(C=s.multiply(s.multiply(s.inv(s.add(_,P)),q),-1),E=s.multiply(s.inv(s.add(_,P)),f),D=h,M=s.add(s.multiply(C,h),E),k=2;g.abs(s.norm(s.subtract(M,D)))>w;)D=M,M=s.add(s.multiply(C,D),E),k+=1;return M},SOR:function(j,f,h,w,A){for(var D,E,C,M,k,F=0,P=j.length,q=[],_=[],z=[];F<P;F++)for(q[F]=[],_[F]=[],z[F]=[],D=0;D<P;D++)F>D?(q[F][D]=j[F][D],_[F][D]=z[F][D]=0):F<D?(_[F][D]=j[F][D],q[F][D]=z[F][D]=0):(z[F][D]=j[F][D],q[F][D]=_[F][D]=0);for(M=s.multiply(s.inv(s.add(z,s.multiply(q,A))),s.subtract(s.multiply(z,1-A),s.multiply(_,A))),C=s.multiply(s.multiply(s.inv(s.add(z,s.multiply(q,A))),f),A),E=h,k=s.add(s.multiply(M,h),C),F=2;g.abs(s.norm(s.subtract(k,E)))>w;)E=k,k=s.add(s.multiply(M,E),C),F++;return k},householder:function(j){for(var f,h,w,A,D=j.length,E=j[0].length,C=0,M=[],k=[];C<D-1;C++){for(f=0,A=C+1;A<E;A++)f+=j[A][C]*j[A][C];for(f=(j[C+1][C]>0?-1:1)*g.sqrt(f),h=g.sqrt((f*f-j[C+1][C]*f)/2),(M=s.zeros(D,1))[C+1][0]=(j[C+1][C]-f)/(2*h),w=C+2;w<D;w++)M[w][0]=j[w][C]/(2*h);k=s.subtract(s.identity(D,E),s.multiply(s.multiply(M,s.transpose(M)),2)),j=s.multiply(k,s.multiply(j,k))}return j},QR:(S=s.sum,T=s.arange,function(j){var f,h,w,A=j.length,D=j[0].length,E=s.zeros(D,D);for(j=s.copy(j),h=0;h<D;h++){for(E[h][h]=g.sqrt(S(T(A).map(function(C){return j[C][h]*j[C][h]}))),f=0;f<A;f++)j[f][h]=j[f][h]/E[h][h];for(w=h+1;w<D;w++)for(E[h][w]=S(T(A).map(function(C){return j[C][h]*j[C][w]})),f=0;f<A;f++)j[f][w]=j[f][w]-j[f][h]*E[h][w]}return[j,E]}),lstsq:function(j,f){var h=!1;f[0].length===void 0&&(f=f.map(function(P){return[P]}),h=!0);var w=s.QR(j),A=w[0],D=w[1],E=j[0].length,C=s.slice(A,{col:{end:E}}),M=function(P){var q=(P=s.copy(P)).length,_=s.identity(q);return s.arange(q-1,-1,-1).forEach(function(z){s.sliceAssign(_,{row:z},s.divide(s.slice(_,{row:z}),P[z][z])),s.sliceAssign(P,{row:z},s.divide(s.slice(P,{row:z}),P[z][z])),s.arange(z).forEach(function(W){var U=s.multiply(P[W][z],-1),B=s.slice(P,{row:W}),Z=s.multiply(s.slice(P,{row:z}),U);s.sliceAssign(P,{row:W},s.add(B,Z));var ne=s.slice(_,{row:W}),ee=s.multiply(s.slice(_,{row:z}),U);s.sliceAssign(_,{row:W},s.add(ne,ee))})}),_}(s.slice(D,{row:{end:E}})),k=s.transpose(C);k[0].length===void 0&&(k=[k]);var F=s.multiply(s.multiply(M,k),f);return F.length===void 0&&(F=[[F]]),h?F.map(function(P){return P[0]}):F},jacobi:function(j){for(var f,h,w,A,D,E,C,M=1,k=j.length,F=s.identity(k,k),P=[];M===1;){for(D=j[0][1],w=0,A=1,f=0;f<k;f++)for(h=0;h<k;h++)f!=h&&D<g.abs(j[f][h])&&(D=g.abs(j[f][h]),w=f,A=h);for(E=j[w][w]===j[A][A]?j[w][A]>0?g.PI/4:-g.PI/4:g.atan(2*j[w][A]/(j[w][w]-j[A][A]))/2,(C=s.identity(k,k))[w][w]=g.cos(E),C[w][A]=-g.sin(E),C[A][w]=g.sin(E),C[A][A]=g.cos(E),F=s.multiply(F,C),j=s.multiply(s.multiply(s.inv(C),j),C),M=0,f=1;f<k;f++)for(h=1;h<k;h++)f!=h&&g.abs(j[f][h])>.001&&(M=1)}for(f=0;f<k;f++)P.push(j[f][f]);return[F,P]},rungekutta:function(j,f,h,w,A,D){var E,C,M;if(D===2)for(;w<=h;)A+=((E=f*j(w,A))+(C=f*j(w+f,A+E)))/2,w+=f;if(D===4)for(;w<=h;)A+=((E=f*j(w,A))+2*(C=f*j(w+f/2,A+E/2))+2*(M=f*j(w+f/2,A+C/2))+f*j(w+f,A+M))/6,w+=f;return A},romberg:function(j,f,h,w){for(var A,D,E,C,M,k=0,F=(h-f)/2,P=[],q=[],_=[];k<w/2;){for(M=j(f),E=f,C=0;E<=h;E+=F,C++)P[C]=E;for(A=P.length,E=1;E<A-1;E++)M+=(E%2!=0?4:2)*j(P[E]);M=F/3*(M+j(h)),_[k]=M,F/=2,k++}for(D=_.length,A=1;D!==1;){for(E=0;E<D-1;E++)q[E]=(g.pow(4,A)*_[E+1]-_[E])/(g.pow(4,A)-1);D=q.length,_=q,q=[],A++}return _},richardson:function(j,f,h,w){function A(z,W){for(var U,B=0,Z=z.length;B<Z;B++)z[B]===W&&(U=B);return U}for(var D,E,C,M,k,F=g.abs(h-j[A(j,h)+1]),P=0,q=[],_=[];w>=F;)D=A(j,h+w),E=A(j,h),q[P]=(f[D]-2*f[E]+f[2*E-D])/(w*w),w/=2,P++;for(M=q.length,C=1;M!=1;){for(k=0;k<M-1;k++)_[k]=(g.pow(4,C)*q[k+1]-q[k])/(g.pow(4,C)-1);M=_.length,q=_,_=[],C++}return q},simpson:function(j,f,h,w){for(var A,D=(h-f)/w,E=j(f),C=[],M=f,k=0,F=1;M<=h;M+=D,k++)C[k]=M;for(A=C.length;F<A-1;F++)E+=(F%2!=0?4:2)*j(C[F]);return D/3*(E+j(h))},hermite:function(j,f,h,w){for(var A,D=j.length,E=0,C=0,M=[],k=[],F=[],P=[];C<D;C++){for(M[C]=1,A=0;A<D;A++)C!=A&&(M[C]*=(w-j[A])/(j[C]-j[A]));for(k[C]=0,A=0;A<D;A++)C!=A&&(k[C]+=1/(j[C]-j[A]));F[C]=(1-2*(w-j[C])*k[C])*(M[C]*M[C]),P[C]=(w-j[C])*(M[C]*M[C]),E+=F[C]*f[C]+P[C]*h[C]}return E},lagrange:function(j,f,h){for(var w,A,D=0,E=0,C=j.length;E<C;E++){for(A=f[E],w=0;w<C;w++)E!=w&&(A*=(h-j[w])/(j[E]-j[w]));D+=A}return D},cubic_spline:function(j,f,h){for(var w,A,D=j.length,E=0,C=[],M=[],k=[],F=[],P=[],q=[];E<D-1;E++)F[E]=j[E+1]-j[E];for(k[0]=0,E=1;E<D-1;E++)k[E]=3/F[E]*(f[E+1]-f[E])-3/F[E-1]*(f[E]-f[E-1]);for(E=1;E<D-1;E++)C[E]=[],M[E]=[],C[E][E-1]=F[E-1],C[E][E]=2*(F[E-1]+F[E]),C[E][E+1]=F[E],M[E][0]=k[E];for(A=s.multiply(s.inv(C),M),w=0;w<D-1;w++)P[w]=(f[w+1]-f[w])/F[w]-F[w]*(A[w+1][0]+2*A[w][0])/3,q[w]=(A[w+1][0]-A[w][0])/(3*F[w]);for(w=0;w<D&&!(j[w]>h);w++);return f[w-=1]+(h-j[w])*P[w]+s.sq(h-j[w])*A[w]+(h-j[w])*s.sq(h-j[w])*q[w]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(j){var f,h,w,A,D,E=j.length,C=j[0].length,M=0,k=[],F=[],P=[],q=[],_=[],z=[],W=[];for(M=0;M<E;M++)k[M]=s.sum(j[M])/C;for(M=0;M<C;M++)for(_[M]=[],f=0;f<E;f++)_[M][f]=j[f][M]-k[f];for(_=s.transpose(_),M=0;M<E;M++)for(z[M]=[],f=0;f<E;f++)z[M][f]=s.dot([_[M]],[_[f]])/(C-1);for(D=(w=s.jacobi(z))[0],F=w[1],W=s.transpose(D),M=0;M<F.length;M++)for(f=M;f<F.length;f++)F[M]<F[f]&&(h=F[M],F[M]=F[f],F[f]=h,P=W[M],W[M]=W[f],W[f]=P);for(A=s.transpose(_),M=0;M<E;M++)for(q[M]=[],f=0;f<A.length;f++)q[M][f]=s.dot([W[M]],[A[f]]);return[j,F,W,q]}}),function(j){for(var f=0;f<j.length;f++)(function(h){s.fn[h]=function(w,A){var D=this;return A?(setTimeout(function(){A.call(D,s.fn[h].call(D,w))},15),this):typeof s[h](this,w)=="number"?s[h](this,w):s(s[h](this,w))}})(j[f])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(b,Math),function(s,g){var S=[].slice,T=s.utils.isNumber,d=s.utils.isArray;function l(p,j,f,h){if(p>1||f>1||p<=0||f<=0)throw new Error("Proportions should be greater than 0 and less than 1");var w=(p*j+f*h)/(j+h);return(p-f)/g.sqrt(w*(1-w)*(1/j+1/h))}s.extend({zscore:function(){var p=S.call(arguments);return T(p[1])?(p[0]-p[1])/p[2]:(p[0]-s.mean(p[1]))/s.stdev(p[1],p[2])},ztest:function(){var p,j=S.call(arguments);return d(j[1])?(p=s.zscore(j[0],j[1],j[3]),j[2]===1?s.normal.cdf(-g.abs(p),0,1):2*s.normal.cdf(-g.abs(p),0,1)):j.length>2?(p=s.zscore(j[0],j[1],j[2]),j[3]===1?s.normal.cdf(-g.abs(p),0,1):2*s.normal.cdf(-g.abs(p),0,1)):(p=j[0],j[1]===1?s.normal.cdf(-g.abs(p),0,1):2*s.normal.cdf(-g.abs(p),0,1))}}),s.extend(s.fn,{zscore:function(p,j){return(p-this.mean())/this.stdev(j)},ztest:function(p,j,f){var h=g.abs(this.zscore(p,f));return j===1?s.normal.cdf(-h,0,1):2*s.normal.cdf(-h,0,1)}}),s.extend({tscore:function(){var p=S.call(arguments);return p.length===4?(p[0]-p[1])/(p[2]/g.sqrt(p[3])):(p[0]-s.mean(p[1]))/(s.stdev(p[1],!0)/g.sqrt(p[1].length))},ttest:function(){var p,j=S.call(arguments);return j.length===5?(p=g.abs(s.tscore(j[0],j[1],j[2],j[3])),j[4]===1?s.studentt.cdf(-p,j[3]-1):2*s.studentt.cdf(-p,j[3]-1)):T(j[1])?(p=g.abs(j[0]),j[2]==1?s.studentt.cdf(-p,j[1]-1):2*s.studentt.cdf(-p,j[1]-1)):(p=g.abs(s.tscore(j[0],j[1])),j[2]==1?s.studentt.cdf(-p,j[1].length-1):2*s.studentt.cdf(-p,j[1].length-1))}}),s.extend(s.fn,{tscore:function(p){return(p-this.mean())/(this.stdev(!0)/g.sqrt(this.cols()))},ttest:function(p,j){return j===1?1-s.studentt.cdf(g.abs(this.tscore(p)),this.cols()-1):2*s.studentt.cdf(-g.abs(this.tscore(p)),this.cols()-1)}}),s.extend({anovafscore:function(){var p,j,f,h,w,A,D,E,C=S.call(arguments);if(C.length===1){for(w=new Array(C[0].length),D=0;D<C[0].length;D++)w[D]=C[0][D];C=w}for(j=new Array,D=0;D<C.length;D++)j=j.concat(C[D]);for(f=s.mean(j),p=0,D=0;D<C.length;D++)p+=C[D].length*g.pow(s.mean(C[D])-f,2);for(p/=C.length-1,A=0,D=0;D<C.length;D++)for(h=s.mean(C[D]),E=0;E<C[D].length;E++)A+=g.pow(C[D][E]-h,2);return p/(A/(j.length-C.length))},anovaftest:function(){var p,j,f,h,w=S.call(arguments);if(T(w[0]))return 1-s.centralF.cdf(w[0],w[1],w[2]);var A=s.anovafscore(w);for(p=w.length-1,f=0,h=0;h<w.length;h++)f+=w[h].length;return j=f-p-1,1-s.centralF.cdf(A,p,j)},ftest:function(p,j,f){return 1-s.centralF.cdf(p,j,f)}}),s.extend(s.fn,{anovafscore:function(){return s.anovafscore(this.toArray())},anovaftes:function(){var p,j=0;for(p=0;p<this.length;p++)j+=this[p].length;return s.ftest(this.anovafscore(),this.length-1,j-this.length)}}),s.extend({qscore:function(){var p,j,f,h,w,A=S.call(arguments);return T(A[0])?(p=A[0],j=A[1],f=A[2],h=A[3],w=A[4]):(p=s.mean(A[0]),j=s.mean(A[1]),f=A[0].length,h=A[1].length,w=A[2]),g.abs(p-j)/(w*g.sqrt((1/f+1/h)/2))},qtest:function(){var p,j=S.call(arguments);j.length===3?(p=j[0],j=j.slice(1)):j.length===7?(p=s.qscore(j[0],j[1],j[2],j[3],j[4]),j=j.slice(5)):(p=s.qscore(j[0],j[1],j[2]),j=j.slice(3));var f=j[0],h=j[1];return 1-s.tukey.cdf(p,h,f-h)},tukeyhsd:function(p){for(var j=s.pooledstdev(p),f=p.map(function(C){return s.mean(C)}),h=p.reduce(function(C,M){return C+M.length},0),w=[],A=0;A<p.length;++A)for(var D=A+1;D<p.length;++D){var E=s.qtest(f[A],f[D],p[A].length,p[D].length,j,h,p.length);w.push([[A,D],E])}return w}}),s.extend({normalci:function(){var p,j=S.call(arguments),f=new Array(2);return p=j.length===4?g.abs(s.normal.inv(j[1]/2,0,1)*j[2]/g.sqrt(j[3])):g.abs(s.normal.inv(j[1]/2,0,1)*s.stdev(j[2])/g.sqrt(j[2].length)),f[0]=j[0]-p,f[1]=j[0]+p,f},tci:function(){var p,j=S.call(arguments),f=new Array(2);return p=j.length===4?g.abs(s.studentt.inv(j[1]/2,j[3]-1)*j[2]/g.sqrt(j[3])):g.abs(s.studentt.inv(j[1]/2,j[2].length-1)*s.stdev(j[2],!0)/g.sqrt(j[2].length)),f[0]=j[0]-p,f[1]=j[0]+p,f},significant:function(p,j){return p<j}}),s.extend(s.fn,{normalci:function(p,j){return s.normalci(p,j,this.toArray())},tci:function(p,j){return s.tci(p,j,this.toArray())}}),s.extend(s.fn,{oneSidedDifferenceOfProportions:function(p,j,f,h){var w=l(p,j,f,h);return s.ztest(w,1)},twoSidedDifferenceOfProportions:function(p,j,f,h){var w=l(p,j,f,h);return s.ztest(w,2)}})}(b,Math),b.models=function(){function s(g,S){var T=g.length,d=S[0].length-1,l=T-d-1,p=b.lstsq(S,g),j=b.multiply(S,p.map(function(E){return[E]})).map(function(E){return E[0]}),f=b.subtract(g,j),h=b.mean(g),w=b.sum(j.map(function(E){return Math.pow(E-h,2)})),A=b.sum(g.map(function(E,C){return Math.pow(E-j[C],2)})),D=w+A;return{exog:S,endog:g,nobs:T,df_model:d,df_resid:l,coef:p,predict:j,resid:f,ybar:h,SST:D,SSE:w,SSR:A,R2:w/D}}return{ols:function(g,S){var T=s(g,S),d=function(j){var f,h,w=(f=j.exog,h=f[0].length,b.arange(h).map(function(F){var P=b.arange(h).filter(function(q){return q!==F});return s(b.col(f,F).map(function(q){return q[0]}),b.col(f,P))})),A=Math.sqrt(j.SSR/j.df_resid),D=w.map(function(F){var P=F.SST,q=F.R2;return A/Math.sqrt(P*(1-q))}),E=j.coef.map(function(F,P){return(F-0)/D[P]}),C=E.map(function(F){var P=b.studentt.cdf(F,j.df_resid);return 2*(P>.5?1-P:P)}),M=b.studentt.inv(.975,j.df_resid),k=j.coef.map(function(F,P){var q=M*D[P];return[F-q,F+q]});return{se:D,t:E,p:C,sigmaHat:A,interval95:k}}(T),l=function(j){var f,h,w,A=j.R2/j.df_model/((1-j.R2)/j.df_resid);return{F_statistic:A,pvalue:1-(f=A,h=j.df_model,w=j.df_resid,b.beta.cdf(f/(w/h+f),h/2,w/2))}}(T),p=1-(1-T.R2)*((T.nobs-1)/T.df_resid);return T.t=d,T.f=l,T.adjust_R2=p,T}}}(),b.extend({buildxmatrix:function(){for(var s=new Array(arguments.length),g=0;g<arguments.length;g++)s[g]=[1].concat(arguments[g]);return b(s)},builddxmatrix:function(){for(var s=new Array(arguments[0].length),g=0;g<arguments[0].length;g++)s[g]=[1].concat(arguments[0][g]);return b(s)},buildjxmatrix:function(s){for(var g=new Array(s.length),S=0;S<s.length;S++)g[S]=s[S];return b.builddxmatrix(g)},buildymatrix:function(s){return b(s).transpose()},buildjymatrix:function(s){return s.transpose()},matrixmult:function(s,g){var S,T,d,l,p;if(s.cols()==g.rows()){if(g.rows()>1){for(l=[],S=0;S<s.rows();S++)for(l[S]=[],T=0;T<g.cols();T++){for(p=0,d=0;d<s.cols();d++)p+=s.toArray()[S][d]*g.toArray()[d][T];l[S][T]=p}return b(l)}for(l=[],S=0;S<s.rows();S++)for(l[S]=[],T=0;T<g.cols();T++){for(p=0,d=0;d<s.cols();d++)p+=s.toArray()[S][d]*g.toArray()[T];l[S][T]=p}return b(l)}},regress:function(s,g){var S=b.xtranspxinv(s),T=s.transpose(),d=b.matrixmult(b(S),T);return b.matrixmult(d,g)},regresst:function(s,g,S){var T=b.regress(s,g),d={anova:{}},l=b.jMatYBar(s,T);d.yBar=l;var p=g.mean();d.anova.residuals=b.residuals(g,l),d.anova.ssr=b.ssr(l,p),d.anova.msr=d.anova.ssr/(s[0].length-1),d.anova.sse=b.sse(g,l),d.anova.mse=d.anova.sse/(g.length-(s[0].length-1)-1),d.anova.sst=b.sst(g,p),d.anova.mst=d.anova.sst/(g.length-1),d.anova.r2=1-d.anova.sse/d.anova.sst,d.anova.r2<0&&(d.anova.r2=0),d.anova.fratio=d.anova.msr/d.anova.mse,d.anova.pvalue=b.anovaftest(d.anova.fratio,s[0].length-1,g.length-(s[0].length-1)-1),d.anova.rmse=Math.sqrt(d.anova.mse),d.anova.r2adj=1-d.anova.mse/d.anova.mst,d.anova.r2adj<0&&(d.anova.r2adj=0),d.stats=new Array(s[0].length);for(var j,f,h,w=b.xtranspxinv(s),A=0;A<T.length;A++)j=Math.sqrt(d.anova.mse*Math.abs(w[A][A])),f=Math.abs(T[A]/j),h=b.ttest(f,g.length-s[0].length-1,S),d.stats[A]=[T[A],j,f,h];return d.regress=T,d},xtranspx:function(s){return b.matrixmult(s.transpose(),s)},xtranspxinv:function(s){var g=b.matrixmult(s.transpose(),s);return b.inv(g)},jMatYBar:function(s,g){var S=b.matrixmult(s,g);return new b(S)},residuals:function(s,g){return b.matrixsubtract(s,g)},ssr:function(s,g){for(var S=0,T=0;T<s.length;T++)S+=Math.pow(s[T]-g,2);return S},sse:function(s,g){for(var S=0,T=0;T<s.length;T++)S+=Math.pow(s[T]-g[T],2);return S},sst:function(s,g){for(var S=0,T=0;T<s.length;T++)S+=Math.pow(s[T]-g,2);return S},matrixsubtract:function(s,g){for(var S=new Array(s.length),T=0;T<s.length;T++){S[T]=new Array(s[T].length);for(var d=0;d<s[T].length;d++)S[T][d]=s[T][d]-g[T][d]}return b(S)}}),b.jStat=b,b)},960:function(O,b,s){const g=s(592);O.exports=function(S){function T(A,D){const E=D.split(".");let C=A;for(const M of E){if(C==null)return;C=C[M]}return C}for(let A=0;A<Object.keys(g).length;A++){let D,E=Object.keys(g)[A],C=[];if(typeof g[E]=="object"){C=Object.keys(g[E]),D=Object.values(g[E]);for(let M=0;M<D.length;M++)if(typeof D[M]=="object"){let k=C[M];g[E][k]&&(C=[...C,...Object.keys(g[E][k]).map(F=>k+"."+F)],C.splice(C.indexOf(k),1))}}if(C.length<1)S[E]=g[E];else for(let M=0;M<C.length;M++)typeof T(g[E],C[M])=="function"&&(S[E]=T(g[E],C[M]))}let d=function(A){return typeof A=="number"&&(A=parseInt(A)),A},l=null,p=null,j=null;S.TABLE=function(){return j},S.COLUMN=S.COL=function(){return j.tracking&&j.tracking.push(w.getColumnNameFromCoords(d(l),d(p))),d(l)+1},S.ROW=function(){return j.tracking&&j.tracking.push(w.getColumnNameFromCoords(d(l),d(p))),d(p)+1},S.CELL=function(){return w.getColumnNameFromCoords(l,p)},S.VALUE=function(A,D,E){return j.getValueFromCoords(d(A)-1,d(D)-1,E)},S.THISROWCELL=function(A){return j.getValueFromCoords(d(A)-1,d(p))};const f=function(A,D){for(let E=0;E<A.length;E++){let C=w.getTokensFromRange(A[E]);D=D.replace(A[E],"["+C.join(",")+"]")}return D},h=function(A){return typeof A=="string"&&(A=A.trim()),!isNaN(A)&&A!==null&&A!==""},w=function(A,D,E,C,M){j=M,l=E,p=C;let k="",F={};if(D)if(D.size){let _,z=null;D.forEach(function(W,U){_=U.replace(/!/g,"."),_.indexOf(".")!==-1&&(_=_.split("."),F[_[0]]=!0)}),_=Object.keys(F);for(let W=0;W<_.length;W++)k+="var "+_[W]+" = {};";D.forEach(function(W,U){_=U.replace(/!/g,"."),W===null||h(W)||(z=W.match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g),z&&z.length&&(W=updateRanges(z,W))),_.indexOf(".")>0?k+=_+" = "+D.get(U)+`;
`:k+="var "+_+" = "+W+`;
`})}else{let _=Object.keys(D);if(_.length){let z,W={};for(let U=0;U<_.length;U++)if(z=_[U].replace(/\!/g,"."),z.indexOf(".")>0){let B=B.split(".");W[B[0]]={}}z=Object.keys(W);for(let U=0;U<z.length;U++)k+="var "+z[U]+" = {};";for(let U=0;U<_.length;U++){if(z=_[U].replace(/!/g,"."),D[_[U]]!==null&&!h(D[_[U]])){let B=D[_[U]].match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g);B&&B.length&&(D[_[U]]=f(B,D[_[U]]))}z.indexOf(".")>0?k+=z+" = "+D[_[U]]+`;
`:k+="var "+z+" = "+D[_[U]]+`;
`}}}let P=(A=function(_,z){let W="",U=0,B=["=","!",">","<"];for(let Z=0;Z<_.length;Z++)_[Z]==='"'&&(U=U===0?1:0),U===1?W+=_[Z]:(W+=_[Z].toUpperCase(),Z>0&&_[Z]==="="&&B.indexOf(_[Z-1])===-1&&B.indexOf(_[Z+1])===-1&&(W+="="));return W=W.replace(/\^/g,"**"),W=W.replace(/<>/g,"!="),W=W.replace(/&/g,"+"),W=W.replace(/\$/g,""),W}(A=(A=A.replace(/\$/g,"")).replace(/!/g,"."))).match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g);P&&P.length&&(A=f(P,A));let q=new Function(k+"; return "+A)();return q===null&&(q=0),q};return w.getColumnNameFromCoords=function(A,D){return C="",(E=parseInt(A))>701?(C+=String.fromCharCode(64+parseInt(E/676)),C+=String.fromCharCode(64+parseInt(E%676/26))):E>25&&(C+=String.fromCharCode(64+parseInt(E/26))),C+String.fromCharCode(65+E%26)+(parseInt(D)+1);var E,C},w.getCoordsFromColumnName=function(A){var D=/^[a-zA-Z]+/.exec(A);if(D){for(var E=0,C=0;C<D[0].length;C++)E+=parseInt(D[0].charCodeAt(C)-64)*Math.pow(26,D[0].length-1-C);--E<0&&(E=0);var M=parseInt(/[0-9]+$/.exec(A))||null;return M>0&&M--,[E,M]}},w.getRangeFromTokens=function(A){A=A.filter(function(M){return M!="#REF!"});for(var D="",E="",C=0;C<A.length;C++)A[C].indexOf(".")>=0?D=".":A[C].indexOf("!")>=0&&(D="!"),D&&(E=A[C].split(D),A[C]=E[1],E=E[0]+D);return A.sort(function(M,k){var F=Helpers.getCoordsFromColumnName(M),P=Helpers.getCoordsFromColumnName(k);return F[1]>P[1]?1:F[1]<P[1]?-1:F[0]>P[0]?1:F[0]<P[0]?-1:0}),A.length?E+(A[0]+":")+A[A.length-1]:"#REF!"},w.getTokensFromRange=function(A){if(A.indexOf(".")>0){var D=A.split(".");A=D[1],D=D[0]+"."}else A.indexOf("!")>0?(D=A.split("!"),A=D[1],D=D[0]+"!"):D="";A=A.split(":");var E=w.getCoordsFromColumnName(A[0]),C=w.getCoordsFromColumnName(A[1]);if(E[0]<=C[0])var M=E[0],k=C[0];else M=C[0],k=E[0];if(E[1]===null&&C[1]==null)for(var F=null,P=null,q=Object.keys(vars),_=0;_<q.length;_++){var z=w.getCoordsFromColumnName(q[_]);z[0]===E[0]&&(F===null||z[1]<F)&&(F=z[1]),z[0]===C[0]&&(P===null||z[1]>P)&&(P=z[1])}else E[1]<=C[1]?(F=E[1],P=C[1]):(F=C[1],P=E[1]);for(var W=[],U=F;U<=P;U++){var B=[];for(_=M;_<=k;_++)B.push(D+w.getColumnNameFromCoords(_,U));W.push(B)}return W},w.setFormula=function(A){let D=Object.keys(A);for(let E=0;E<D.length;E++)typeof A[D[E]]=="function"&&(S[D[E]]=A[D[E]])},w.basic=!0,w}(typeof window>"u"?s.g:window)},592:function(O,b,s){"use strict";var g=s(162),S=s(765);const T=new Error("#NULL!"),d=new Error("#DIV/0!"),l=new Error("#VALUE!"),p=new Error("#REF!"),j=new Error("#NAME?"),f=new Error("#NUM!"),h=new Error("#N/A"),w=new Error("#ERROR!"),A=new Error("#GETTING_DATA");var D=Object.freeze({__proto__:null,data:A,div0:d,error:w,na:h,name:j,nil:T,num:f,ref:p,value:l});function E(e){const t=[];return C(e,n=>{t.push(n)}),t}function C(e,t){let n=-1;const u=e.length;for(;++n<u&&t(e[n],n,e)!==!1;);return e}function M(e){let t,n=e.length;for(;n--;)if(t=e[n],typeof t!="number")if(t!==!0)if(t!==!1){if(typeof t=="string"){const u=L(t);e[n]=u instanceof Error?0:u}}else e[n]=0;else e[n]=1;return e}function k(e,t){if(!e)return l;e.every(v=>Array.isArray(v))&&e.length!==0||(e=[[...e]]),e.map((v,I)=>{v.map((R,H)=>{R||(e[I][H]=0)})});const n=e.reduce((v,I,R)=>I.length>e[v].length?R:v,0),u=e[n].length;return e.map(v=>[...v,...Array(u-v.length).fill(t||0)])}function F(){let e;if(arguments.length===1){const n=arguments[0];e=(t=n)!=null&&typeof t.length=="number"&&typeof t!="string"?E.apply(null,arguments):[n]}else e=Array.from(arguments);for(var t;!q(e);)e=P(e);return e}function P(e){return e&&e.reduce?e.reduce((t,n)=>{const u=Array.isArray(t),v=Array.isArray(n);return u&&v?t.concat(n):u?(t.push(n),t):v?[t].concat(n):[t,n]}):[e]}function q(e){if(!e)return!1;for(let t=0;t<e.length;++t)if(Array.isArray(e[t]))return!1;return!0}function _(e,t){return t=t||1,e&&typeof e.slice=="function"?e.slice(t):e}function z(e){return e?e[0].map((t,n)=>e.map(u=>u[n])):l}function W(e,t){let n=null;return C(e,(u,v)=>{if(u[0]===t)return n=v,!1}),n??l}function U(){for(let e=0;e<arguments.length;e++)if(arguments[e]instanceof Error)return arguments[e]}function B(){let e=arguments.length;for(;e--;)if(arguments[e]instanceof Error)return!0;return!1}function Z(e){return Math.round(e*1e14)/1e14}function ne(){return F.apply(null,arguments).filter(e=>typeof e=="number")}function ee(e){if(typeof e=="boolean"||e instanceof Error)return e;if(typeof e=="number")return e!==0;if(typeof e=="string"){const t=e.toUpperCase();if(t==="TRUE")return!0;if(t==="FALSE")return!1}return e instanceof Date&&!isNaN(e)||l}function J(e){if(!isNaN(e)){if(e instanceof Date)return new Date(e);const t=parseFloat(e);return t<0||t>=2958466?f:function(n){n<60&&(n+=1);const u=Math.floor(n-25569),v=new Date(86400*u*1e3),I=n-Math.floor(n)+1e-7;let R=Math.floor(86400*I);const H=R%60;R-=H;const V=Math.floor(R/3600),Y=Math.floor(R/60)%60;let G=v.getUTCDate(),Q=v.getUTCMonth();return n>=60&&n<61&&(G=29,Q=1),new Date(v.getUTCFullYear(),Q,G,V,Y,H)}(t)}return typeof e!="string"||(e=/(\d{4})-(\d\d?)-(\d\d?)$/.test(e)?new Date(e+"T00:00:00.000"):new Date(e),isNaN(e))?l:e}function de(e){let t,n=e.length;for(;n--;){if(t=J(e[n]),t===l)return t;e[n]=t}return e}function L(e){return e instanceof Error?e:e==null?0:(typeof e=="boolean"&&(e=+e),isNaN(e)||e===""?l:parseFloat(e))}function X(e){let t,n;if(!e||(t=e.length)===0)return l;for(;t--;){if(e[t]instanceof Error)return e[t];if(n=L(e[t]),n instanceof Error)return n;e[t]=n}return e}function oe(e){return e instanceof Error?e:e==null?"":e.toString()}function He(){let e=arguments.length;for(;e--;)if(typeof arguments[e]=="string")return!0;return!1}function ue(e){return e!=null}const ae="=",ce=[">",">=","<","<=","=","<>"],je="operator",pe="literal",Ce=[je,pe],Te=je,be=pe;function me(e,t){if(Ce.indexOf(t)===-1)throw new Error("Unsupported token type: "+t);return{value:e,type:t}}function Fe(e){return function(t){let n="";const u=[];for(let v=0;v<t.length;v++){const I=t[v];v===0&&ce.indexOf(I)>=0?u.push(me(I,Te)):n+=I}return n.length>0&&u.push(me(function(v){return typeof v!="string"||/^\d+(\.\d+)?$/.test(v)&&(v=v.indexOf(".")===-1?parseInt(v,10):parseFloat(v)),v}(n),be)),u.length>0&&u[0].type!==Te&&u.unshift(me(ae,Te)),u}(function(t){const n=t.length,u=[];let v=0,I="",R="";for(;v<n;){const H=t.charAt(v);switch(H){case">":case"<":case"=":R+=H,I.length>0&&(u.push(I),I="");break;default:R.length>0&&(u.push(R),R=""),I+=H}v++}return I.length>0&&u.push(I),R.length>0&&u.push(R),u}(e))}const xe=function(e){const t=[];let n;for(let u=0;u<e.length;u++){const v=e[u];switch(v.type){case Te:n=v.value;break;case be:t.push(v.value)}}return function(u,v){let I=!1;switch(v){case">":I=u[0]>u[1];break;case">=":I=u[0]>=u[1];break;case"<":I=u[0]<u[1];break;case"<=":I=u[0]<=u[1];break;case"=":I=u[0]==u[1];break;case"<>":I=u[0]!=u[1]}return I}(t,n)},kt={};function Ht(e){return[l,p,d,f,j,T].indexOf(e)>=0||typeof e=="number"&&(isNaN(e)||!isFinite(e))}function Ze(e){return Ht(e)||e===h}function Bt(e){return e===!0||e===!1}function et(e){return typeof e=="number"&&!isNaN(e)&&isFinite(e)}function Pt(e){return typeof e=="string"}function ft(){const e=[];for(let t=0;t<arguments.length;++t){let n=!1;const u=arguments[t];for(let v=0;v<e.length&&(n=e[v]===u,!n);++v);n||e.push(u)}return e}function _t(e,t,n,u){if(!t||!n)return h;u=!(u===0||u===!1);let v=h;const I=typeof e=="number";let R=!1;for(let H=0;H<t.length;H++){const V=t[H];if(V[0]===e){v=n<V.length+1?V[n-1]:p;break}!R&&(I&&u&&V[0]<=e||u&&typeof V[0]=="string"&&V[0].localeCompare(e)<0)&&(v=n<V.length+1?V[n-1]:p),I&&V[0]>e&&(R=!0)}return v}function Ue(){const e=F(arguments).filter(ue);if(e.length===0)return d;const t=U.apply(void 0,e);if(t)return t;const n=ne(e),u=n.length;let v,I=0,R=0;for(let H=0;H<u;H++)I+=n[H],R+=1;return v=I/R,isNaN(v)&&(v=f),v}function dt(){const e=F(arguments).filter(ue);if(e.length===0)return d;const t=U.apply(void 0,e);if(t)return t;const n=e,u=n.length;let v,I=0,R=0;for(let H=0;H<u;H++){const V=n[H];typeof V=="number"&&(I+=V),V===!0&&I++,V!==null&&R++}return v=I/R,isNaN(v)&&(v=f),v}kt.TYPE=e=>{switch(e){case T:return 1;case d:return 2;case l:return 3;case p:return 4;case j:return 5;case f:return 6;case h:return 7;case A:return 8}return h};const pt={DIST:function(e,t,n,u,v,I){return arguments.length<4?l:(v=v===void 0?0:v,I=I===void 0?1:I,B(e=L(e),t=L(t),n=L(n),v=L(v),I=L(I))?l:(e=(e-v)/(I-v),u?g.beta.cdf(e,t,n):g.beta.pdf(e,t,n)))},INV:(e,t,n,u,v)=>(u=u===void 0?0:u,v=v===void 0?1:v,B(e=L(e),t=L(t),n=L(n),u=L(u),v=L(v))?l:g.beta.inv(e,t,n)*(v-u)+u)},We={DIST:(e,t,n,u)=>B(e=L(e),t=L(t),n=L(n),u=L(u))?l:u?g.binomial.cdf(e,t,n):g.binomial.pdf(e,t,n)};We.DIST.RANGE=(e,t,n,u)=>{if(u=u===void 0?n:u,B(e=L(e),t=L(t),n=L(n),u=L(u)))return l;let v=0;for(let I=n;I<=u;I++)v+=Ye(e,I)*Math.pow(t,I)*Math.pow(1-t,e-I);return v},We.INV=(e,t,n)=>{if(B(e=L(e),t=L(t),n=L(n)))return l;let u=0;for(;u<=e;){if(g.binomial.cdf(u,e,t)>=n)return u;u++}};const Ne={DIST:(e,t,n)=>B(e=L(e),t=L(t))?l:n?g.chisquare.cdf(e,t):g.chisquare.pdf(e,t)};Ne.DIST.RT=(e,t)=>!e|!t?h:e<1||t>Math.pow(10,10)?f:typeof e!="number"||typeof t!="number"?l:1-g.chisquare.cdf(e,t),Ne.INV=(e,t)=>B(e=L(e),t=L(t))?l:g.chisquare.inv(e,t),Ne.INV.RT=(e,t)=>!e|!t?h:e<0||e>1||t<1||t>Math.pow(10,10)?f:typeof e!="number"||typeof t!="number"?l:g.chisquare.inv(1-e,t),Ne.TEST=function(e,t){if(arguments.length!==2)return h;if(!(e instanceof Array&&t instanceof Array)||e.length!==t.length||e[0]&&t[0]&&e[0].length!==t[0].length)return l;const n=e.length;let u,v,I;for(v=0;v<n;v++)e[v]instanceof Array||(u=e[v],e[v]=[],e[v].push(u)),t[v]instanceof Array||(u=t[v],t[v]=[],t[v].push(u));const R=e[0].length,H=R===1?n-1:(n-1)*(R-1);let V=0;const Y=Math.PI;for(v=0;v<n;v++)for(I=0;I<R;I++)V+=Math.pow(e[v][I]-t[v][I],2)/t[v][I];return Math.round(1e6*function(G,Q){let K=Math.exp(-.5*G);Q%2==1&&(K*=Math.sqrt(2*G/Y));let te=Q;for(;te>=2;)K=K*G/te,te-=2;let re=K,le=Q;for(;re>1e-10*K;)le+=2,re=re*G/le,K+=re;return 1-K}(V,H))/1e6};const bt={};function tt(){return ne(F(arguments)).length}function ot(){const e=F(arguments);return e.length-Vt(e)}function Vt(){const e=F(arguments);let t,n=0;for(let u=0;u<e.length;u++)t=e[u],t!=null&&t!==""||n++;return n}bt.NORM=(e,t,n)=>B(e=L(e),t=L(t),n=L(n))?l:g.normalci(1,e,t,n)[1]-1,bt.T=(e,t,n)=>B(e=L(e),t=L(t),n=L(n))?l:g.tci(1,e,t,n)[1]-1;const nt={P:(e,t)=>{if(B(e=X(F(e)),t=X(F(t))))return l;const n=g.mean(e),u=g.mean(t);let v=0;const I=e.length;for(let R=0;R<I;R++)v+=(e[R]-n)*(t[R]-u);return v/I},S:(e,t)=>B(e=X(F(e)),t=X(F(t)))?l:g.covariance(e,t)},qt={DIST:(e,t,n)=>B(e=L(e),t=L(t))?l:n?g.exponential.cdf(e,t):g.exponential.pdf(e,t)},Ee={};function Ut(e,t,n){if(B(e=L(e),t=X(F(t)),n=X(F(n))))return l;const u=g.mean(n),v=g.mean(t),I=n.length;let R=0,H=0;for(let Y=0;Y<I;Y++)R+=(n[Y]-u)*(t[Y]-v),H+=Math.pow(n[Y]-u,2);const V=R/H;return v-V*u+V*e}function Xe(e){return(e=L(e))instanceof Error?e:e===0||parseInt(e,10)===e&&e<0?f:g.gammafn(e)}function jt(e){return(e=L(e))instanceof Error?e:g.gammaln(e)}Ee.DIST=(e,t,n,u)=>B(e=L(e),t=L(t),n=L(n))?l:u?g.centralF.cdf(e,t,n):g.centralF.pdf(e,t,n),Ee.DIST.RT=function(e,t,n){return arguments.length!==3?h:e<0||t<1||n<1?f:typeof e!="number"||typeof t!="number"||typeof n!="number"?l:1-g.centralF.cdf(e,t,n)},Ee.INV=(e,t,n)=>B(e=L(e),t=L(t),n=L(n))?l:e<=0||e>1?f:g.centralF.inv(e,t,n),Ee.INV.RT=function(e,t,n){return arguments.length!==3?h:e<0||e>1||t<1||t>Math.pow(10,10)||n<1||n>Math.pow(10,10)?f:typeof e!="number"||typeof t!="number"||typeof n!="number"?l:g.centralF.inv(1-e,t,n)},Ee.TEST=(e,t)=>{if(!e||!t||!(e instanceof Array&&t instanceof Array))return h;if(e.length<2||t.length<2)return d;const n=(I,R)=>{let H=0;for(let V=0;V<I.length;V++)H+=Math.pow(I[V]-R,2);return H},u=Pe(e)/e.length,v=Pe(t)/t.length;return n(e,u)/(e.length-1)/(n(t,v)/(t.length-1))},Xe.DIST=function(e,t,n,u){return arguments.length!==4?h:e<0||t<=0||n<=0||typeof e!="number"||typeof t!="number"||typeof n!="number"?l:u?g.gamma.cdf(e,t,n,!0):g.gamma.pdf(e,t,n,!1)},Xe.INV=function(e,t,n){return arguments.length!==3?h:e<0||e>1||t<=0||n<=0?f:typeof e!="number"||typeof t!="number"||typeof n!="number"?l:g.gamma.inv(e,t,n)},jt.PRECISE=function(e){return arguments.length!==1?h:e<=0?f:typeof e!="number"?l:g.gammaln(e)};const gt={};function zt(e,t){return B(e=X(F(e)),t=L(t))?e:t<0||e.length<t?l:e.sort((n,u)=>u-n)[t-1]}function ht(e,t){if(B(e=X(F(e)),t=X(F(t))))return l;const n=g.mean(e),u=g.mean(t),v=t.length;let I=0,R=0;for(let V=0;V<v;V++)I+=(t[V]-u)*(e[V]-n),R+=Math.pow(t[V]-u,2);const H=I/R;return[H,n-H*u]}gt.DIST=(e,t,n,u,v)=>{if(B(e=L(e),t=L(t),n=L(n),u=L(u)))return l;function I(R,H,V,Y){return Ye(V,R)*Ye(Y-V,H-R)/Ye(Y,H)}return v?function(R,H,V,Y){let G=0;for(let Q=0;Q<=R;Q++)G+=I(Q,H,V,Y);return G}(e,t,n,u):I(e,t,n,u)};const ze={};function mt(){const e=F(arguments),t=U.apply(void 0,e);if(t)return t;const n=ne(e);return n.length===0?0:Math.max.apply(Math,n)}function Yt(){const e=F(arguments),t=U.apply(void 0,e);if(t)return t;const n=M(e);let u=g.median(n);return isNaN(u)&&(u=f),u}function vt(){const e=F(arguments),t=U.apply(void 0,e);if(t)return t;const n=ne(e);return n.length===0?0:Math.min.apply(Math,n)}ze.DIST=(e,t,n,u)=>B(e=L(e),t=L(t),n=L(n))?l:u?g.lognormal.cdf(e,t,n):g.lognormal.pdf(e,t,n),ze.INV=(e,t,n)=>B(e=L(e),t=L(t),n=L(n))?l:g.lognormal.inv(e,t,n);const Ge={MULT:function(){const e=X(F(arguments));if(e instanceof Error)return e;const t=e.length,n={};let u,v=[],I=0;for(let R=0;R<t;R++)u=e[R],n[u]=n[u]?n[u]+1:1,n[u]>I&&(I=n[u],v=[]),n[u]===I&&(v[v.length]=u);return v},SNGL:function(){const e=X(F(arguments));return e instanceof Error?e:Ge.MULT(e).sort((t,n)=>t-n)[0]}},Wt={DIST:(e,t,n,u)=>B(e=L(e),t=L(t),n=L(n))?l:u?g.negbin.cdf(e,t,n):g.negbin.pdf(e,t,n)},Me={};function Xt(e,t){if(B(t=X(F(t)),e=X(F(e))))return l;const n=g.mean(e),u=g.mean(t),v=e.length;let I=0,R=0,H=0;for(let V=0;V<v;V++)I+=(e[V]-n)*(t[V]-u),R+=Math.pow(e[V]-n,2),H+=Math.pow(t[V]-u,2);return I/Math.sqrt(R*H)}Me.DIST=(e,t,n,u)=>B(e=L(e),t=L(t),n=L(n))?l:n<=0?f:u?g.normal.cdf(e,t,n):g.normal.pdf(e,t,n),Me.INV=(e,t,n)=>B(e=L(e),t=L(t),n=L(n))?l:g.normal.inv(e,t,n),Me.S={},Me.S.DIST=(e,t)=>(e=L(e))instanceof Error?l:t?g.normal.cdf(e,0,1):g.normal.pdf(e,0,1),Me.S.INV=e=>(e=L(e))instanceof Error?l:g.normal.inv(e,0,1);const Ie={EXC:(e,t)=>{if(B(e=X(F(e)),t=L(t)))return l;const n=(e=e.sort((I,R)=>I-R)).length;if(t<1/(n+1)||t>1-1/(n+1))return f;const u=t*(n+1)-1,v=Math.floor(u);return Z(u===v?e[u]:e[v]+(u-v)*(e[v+1]-e[v]))},INC:(e,t)=>{if(B(e=X(F(e)),t=L(t)))return l;const n=t*((e=e.sort((v,I)=>v-I)).length-1),u=Math.floor(n);return Z(n===u?e[n]:e[u]+(n-u)*(e[u+1]-e[u]))}},yt={EXC:(e,t,n)=>{if(n=n===void 0?3:n,B(e=X(F(e)),t=L(t),n=L(n)))return l;e=e.sort((G,Q)=>G-Q);const u=ft.apply(null,e),v=e.length,I=u.length,R=Math.pow(10,n);let H=0,V=!1,Y=0;for(;!V&&Y<I;)t===u[Y]?(H=(e.indexOf(u[Y])+1)/(v+1),V=!0):t>=u[Y]&&(t<u[Y+1]||Y===I-1)&&(H=(e.indexOf(u[Y])+1+(t-u[Y])/(u[Y+1]-u[Y]))/(v+1),V=!0),Y++;return Math.floor(H*R)/R},INC:(e,t,n)=>{if(n=n===void 0?3:n,B(e=X(F(e)),t=L(t),n=L(n)))return l;e=e.sort((G,Q)=>G-Q);const u=ft.apply(null,e),v=e.length,I=u.length,R=Math.pow(10,n);let H=0,V=!1,Y=0;for(;!V&&Y<I;)t===u[Y]?(H=e.indexOf(u[Y])/(v-1),V=!0):t>=u[Y]&&(t<u[Y+1]||Y===I-1)&&(H=(e.indexOf(u[Y])+(t-u[Y])/(u[Y+1]-u[Y]))/(v-1),V=!0),Y++;return Math.floor(H*R)/R}},Gt={DIST:(e,t,n)=>B(e=L(e),t=L(t))?l:n?g.poisson.cdf(e,t):g.poisson.pdf(e,t)},Ke={EXC:(e,t)=>{if(B(e=X(F(e)),t=L(t)))return l;switch(t){case 1:return Ie.EXC(e,.25);case 2:return Ie.EXC(e,.5);case 3:return Ie.EXC(e,.75);default:return f}},INC:(e,t)=>{if(B(e=X(F(e)),t=L(t)))return l;switch(t){case 1:return Ie.INC(e,.25);case 2:return Ie.INC(e,.5);case 3:return Ie.INC(e,.75);default:return f}}},$e={};function Ct(){const e=X(F(arguments));if(e instanceof Error)return e;const t=g.mean(e),n=e.length;let u=0;for(let v=0;v<n;v++)u+=Math.pow(e[v]-t,3);return n*u/((n-1)*(n-2)*Math.pow(g.stdev(e,!0),3))}function Kt(e,t){return B(e=X(F(e)),t=L(t))?e:e.sort((n,u)=>n-u)[t-1]}$e.AVG=(e,t,n)=>{if(B(e=L(e),t=X(F(t))))return l;const u=(n=n||!1)?(R,H)=>R-H:(R,H)=>H-R,v=(t=(t=F(t)).sort(u)).length;let I=0;for(let R=0;R<v;R++)t[R]===e&&I++;return I>1?(2*t.indexOf(e)+I+1)/2:t.indexOf(e)+1},$e.EQ=(e,t,n)=>{if(B(e=L(e),t=X(F(t))))return l;const u=(n=n||!1)?(v,I)=>v-I:(v,I)=>I-v;return(t=t.sort(u)).indexOf(e)+1},Ct.P=function(){const e=X(F(arguments));if(e instanceof Error)return e;const t=g.mean(e),n=e.length;let u=0,v=0;for(let I=0;I<n;I++)v+=Math.pow(e[I]-t,3),u+=Math.pow(e[I]-t,2);return v/=n,u/=n,v/Math.pow(u,1.5)};const Se={P:function(){const e=ve.P.apply(this,arguments);let t=Math.sqrt(e);return isNaN(t)&&(t=f),t},S:function(){const e=ve.S.apply(this,arguments);return Math.sqrt(e)}},we={DIST:(e,t,n)=>n!==1&&n!==2?f:n===1?we.DIST.RT(e,t):we.DIST["2T"](e,t)};we.DIST["2T"]=function(e,t){return arguments.length!==2?h:e<0||t<1?f:typeof e!="number"||typeof t!="number"?l:2*(1-g.studentt.cdf(e,t))},we.DIST.RT=function(e,t){return arguments.length!==2?h:e<0||t<1?f:typeof e!="number"||typeof t!="number"?l:1-g.studentt.cdf(e,t)},we.INV=(e,t)=>B(e=L(e),t=L(t))?l:g.studentt.inv(e,t),we.INV["2T"]=(e,t)=>(e=L(e),t=L(t),e<=0||e>1||t<1?f:B(e,t)?l:Math.abs(g.studentt.inv(e/2,t))),we.TEST=(e,t)=>{if(B(e=X(F(e)),t=X(F(t))))return l;const n=g.mean(e),u=g.mean(t);let v,I=0,R=0;for(v=0;v<e.length;v++)I+=Math.pow(e[v]-n,2);for(v=0;v<t.length;v++)R+=Math.pow(t[v]-u,2);I/=e.length-1,R/=t.length-1;const H=Math.abs(n-u)/Math.sqrt(I/e.length+R/t.length);return we.DIST["2T"](H,e.length+t.length-2)};const ve={};function $t(){const e=F(arguments),t=e.length;let n=0,u=0;const v=dt(e);for(let I=0;I<t;I++){const R=e[I];n+=Math.pow(typeof R=="number"?R-v:R===!0?1-v:0-v,2),R!==null&&u++}return n/(u-1)}function Jt(){const e=F(arguments),t=e.length;let n=0,u=0;const v=dt(e);let I;for(let R=0;R<t;R++){const H=e[R];n+=Math.pow(typeof H=="number"?H-v:H===!0?1-v:0-v,2),H!==null&&u++}return I=n/u,isNaN(I)&&(I=f),I}ve.P=function(){const e=ne(F(arguments)),t=e.length;let n=0;const u=Ue(e);let v;for(let I=0;I<t;I++)n+=Math.pow(e[I]-u,2);return v=n/t,isNaN(v)&&(v=f),v},ve.S=function(){const e=ne(F(arguments)),t=e.length;let n=0;const u=Ue(e);for(let v=0;v<t;v++)n+=Math.pow(e[v]-u,2);return n/(t-1)};const Qt={DIST:(e,t,n,u)=>B(e=L(e),t=L(t),n=L(n))?l:u?1-Math.exp(-Math.pow(e/n,t)):Math.pow(e,t-1)*Math.exp(-Math.pow(e/n,t))*t/Math.pow(n,t)},xt={};function Le(e,t,n){const u=U(e=L(e),t=L(t),n=L(n));if(u)return u;if(t===0)return 0;t=Math.abs(t);const v=-Math.floor(Math.log(t)/Math.log(10));return e>=0?De(Math.ceil(e/t)*t,v):n===0?-De(Math.floor(Math.abs(e)/t)*t,v):-De(Math.ceil(Math.abs(e)/t)*t,v)}function Ye(e,t){return U(e=L(e),t=L(t))||(e<t?f:Re(e)/(Re(t)*Re(e-t)))}xt.TEST=(e,t,n)=>{if(B(e=X(F(e)),t=L(t)))return l;n=n||Se.S(e);const u=e.length;return 1-Me.S.DIST((Ue(e)-t)/(n/Math.sqrt(u)),!0)},Le.MATH=Le,Le.PRECISE=Le;const wt=[];function Re(e){if((e=L(e))instanceof Error)return e;const t=Math.floor(e);return t===0||t===1?1:(wt[t]>0||(wt[t]=Re(t-1)*t),wt[t])}function Be(e,t){const n=U(e=L(e),t=L(t));if(n)return n;if(t===0)return 0;if(!(e>=0&&t>0||e<=0&&t<0))return f;t=Math.abs(t);const u=-Math.floor(Math.log(t)/Math.log(10));return e>=0?De(Math.floor(e/t)*t,u):-De(Math.ceil(Math.abs(e)/t),u)}Be.MATH=(e,t,n)=>{if(t instanceof Error)return t;t=t===void 0?0:t;const u=U(e=L(e),t=L(t),n=L(n));if(u)return u;if(t===0)return 0;t=t?Math.abs(t):1;const v=-Math.floor(Math.log(t)/Math.log(10));return e>=0?De(Math.floor(e/t)*t,v):n===0||n===void 0?-De(Math.ceil(Math.abs(e)/t)*t,v):-De(Math.floor(Math.abs(e)/t)*t,v)},Be.PRECISE=Be.MATH;const uo={CEILING:Le};function Zt(e,t){const n=U(e=L(e),t=L(t));if(n)return n;if(e===0&&t===0)return f;const u=Math.pow(e,t);return isNaN(u)?f:u}function At(){const e=F(arguments).filter(u=>u!=null);if(e.length===0)return 0;const t=X(e);if(t instanceof Error)return t;let n=1;for(let u=0;u<t.length;u++)n*=t[u];return n}function De(e,t){return U(e=L(e),t=L(t))||+(Math.round(+(e+"e"+t))+"e"+-1*t)}function Pe(){let e=0;return C(E(arguments),t=>{if(e instanceof Error)return!1;if(t instanceof Error)e=t;else if(typeof t=="number")e+=t;else if(typeof t=="string"){const n=parseFloat(t);!isNaN(n)&&(e+=n)}else if(Array.isArray(t)){const n=Pe.apply(null,t);n instanceof Error?e=n:e+=n}}),e}var co=Object.freeze({__proto__:null,ADD:function(e,t){return arguments.length!==2?h:U(e=L(e),t=L(t))||e+t},DIVIDE:function(e,t){return arguments.length!==2?h:U(e=L(e),t=L(t))||(t===0?d:e/t)},EQ:function(e,t){return arguments.length!==2?h:e instanceof Error?e:t instanceof Error?t:(e===null&&(e=void 0),t===null&&(t=void 0),e===t)},GT:function(e,t){return arguments.length!==2?h:e instanceof Error?e:t instanceof Error?t:(He(e,t)?(e=oe(e),t=oe(t)):(e=L(e),t=L(t)),U(e,t)||e>t)},GTE:function(e,t){return arguments.length!==2?h:(He(e,t)?(e=oe(e),t=oe(t)):(e=L(e),t=L(t)),U(e,t)||e>=t)},LT:function(e,t){return arguments.length!==2?h:(He(e,t)?(e=oe(e),t=oe(t)):(e=L(e),t=L(t)),U(e,t)||e<t)},LTE:function(e,t){return arguments.length!==2?h:(He(e,t)?(e=oe(e),t=oe(t)):(e=L(e),t=L(t)),U(e,t)||e<=t)},MINUS:function(e,t){return arguments.length!==2?h:U(e=L(e),t=L(t))||e-t},MULTIPLY:function(e,t){return arguments.length!==2?h:U(e=L(e),t=L(t))||e*t},NE:function(e,t){return arguments.length!==2?h:e instanceof Error?e:t instanceof Error?t:(e===null&&(e=void 0),t===null&&(t=void 0),e!==t)},POW:function(e,t){return arguments.length!==2?h:Zt(e,t)}});const fo=new Date(Date.UTC(1900,0,1)),po=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],bo=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],rt=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];function Je(e,t,n){n=n.toUpperCase(),e=J(e),t=J(t);const u=e.getFullYear(),v=e.getMonth(),I=e.getDate(),R=t.getFullYear(),H=t.getMonth(),V=t.getDate();let Y;switch(n){case"Y":Y=Math.floor(Mt(e,t));break;case"D":Y=_e(t,e);break;case"M":Y=H-v+12*(R-u),V<I&&Y--;break;case"MD":I<=V?Y=V-I:(H===0?(e.setFullYear(R-1),e.setMonth(12)):(e.setFullYear(R),e.setMonth(H-1)),Y=_e(t,e));break;case"YM":Y=H-v+12*(R-u),V<I&&Y--,Y%=12;break;case"YD":H>v||H===v&&V<I?e.setFullYear(R):e.setFullYear(R-1),Y=_e(t,e)}return Y}function lt(e){const t=new Date(e);return t.setHours(0,0,0,0),t}function _e(e,t){return e=J(e),t=J(t),e instanceof Error?e:t instanceof Error?t:to(lt(e))-to(lt(t))}function Oe(e,t,n){if(n=ee(n||"false"),e=J(e),t=J(t),e instanceof Error)return e;if(t instanceof Error)return t;if(n instanceof Error)return n;const u=e.getMonth();let v,I,R=t.getMonth();if(n)v=e.getDate()===31?30:e.getDate(),I=t.getDate()===31?30:t.getDate();else{const H=new Date(e.getFullYear(),u+1,0).getDate(),V=new Date(t.getFullYear(),R+1,0).getDate();v=e.getDate()===H?30:e.getDate(),t.getDate()===V?v<30?(R++,I=1):I=30:I=t.getDate()}return 360*(t.getFullYear()-e.getFullYear())+30*(R-u)+(I-v)}function eo(e){if((e=J(e))instanceof Error)return e;(e=lt(e)).setDate(e.getDate()+4-(e.getDay()||7));const t=new Date(e.getFullYear(),0,1);return Math.ceil(((e-t)/864e5+1)/7)}function it(e,t,n){return it.INTL(e,t,1,n)}function st(e,t,n){return st.INTL(e,t,1,n)}function Et(e){return new Date(e,1,29).getMonth()===1}function at(e,t){return Math.ceil((t-e)/1e3/60/60/24)}function Mt(e,t,n){if((e=J(e))instanceof Error)return e;if((t=J(t))instanceof Error)return t;n=n||0;let u=e.getDate();const v=e.getMonth()+1,I=e.getFullYear();let R=t.getDate();const H=t.getMonth()+1,V=t.getFullYear();switch(n){case 0:return u===31&&R===31?(u=30,R=30):u===31?u=30:u===30&&R===31&&(R=30),(R+30*H+360*V-(u+30*v+360*I))/360;case 1:{const Y=(te,re)=>{const le=te.getFullYear(),he=new Date(le,2,1);if(Et(le)&&te<he&&re>=he)return!0;const fe=re.getFullYear(),ke=new Date(fe,2,1);return Et(fe)&&re>=ke&&te<ke};let G=365;if(I===V||I+1===V&&(v>H||v===H&&u>=R))return(I===V&&Et(I)||Y(e,t)||H===1&&R===29)&&(G=366),at(e,t)/G;const Q=V-I+1,K=(new Date(V+1,0,1)-new Date(I,0,1))/1e3/60/60/24/Q;return at(e,t)/K}case 2:return at(e,t)/360;case 3:return at(e,t)/365;case 4:return(R+30*H+360*V-(u+30*v+360*I))/360}}function to(e){const t=e>-22038912e5?2:1;return Math.ceil((e-fo)/864e5)+t}function oo(e){return(e=L(e))===0?l:e instanceof Error?e:String.fromCharCode(e)}function no(e){if(B(e))return e;let t=(e=e||"").charCodeAt(0);return isNaN(t)&&(t=l),t}function ro(){const e=F(arguments),t=U.apply(void 0,e);if(t)return t;let n=0;for(;(n=e.indexOf(!0))>-1;)e[n]="TRUE";let u=0;for(;(u=e.indexOf(!1))>-1;)e[u]="FALSE";return e.join("")}it.INTL=(e,t,n,u)=>{if((e=J(e))instanceof Error)return e;if((t=J(t))instanceof Error)return t;let v=!1;const I=[],R=[1,2,3,4,5,6,0],H=new RegExp("^[0|1]{7}$");if(n===void 0)n=rt[1];else if(typeof n=="string"&&H.test(n)){v=!0,n=n.split("");for(let Q=0;Q<n.length;Q++)n[Q]==="1"&&I.push(R[Q])}else n=rt[n];if(!(n instanceof Array))return l;u===void 0?u=[]:u instanceof Array||(u=[u]);for(let Q=0;Q<u.length;Q++){const K=J(u[Q]);if(K instanceof Error)return K;u[Q]=K}const V=Math.round((t-e)/864e5)+1;let Y=V;const G=e;for(let Q=0;Q<V;Q++){const K=new Date().getTimezoneOffset()>0?G.getUTCDay():G.getDay();let te=v?I.includes(K):K===n[0]||K===n[1];for(let re=0;re<u.length;re++){const le=u[re];if(le.getDate()===G.getDate()&&le.getMonth()===G.getMonth()&&le.getFullYear()===G.getFullYear()){te=!0;break}}te&&Y--,G.setDate(G.getDate()+1)}return Y},st.INTL=(e,t,n,u)=>{if((e=J(e))instanceof Error)return e;if((t=L(t))instanceof Error)return t;if(t<0)return f;if(!((n=n===void 0?rt[1]:rt[n])instanceof Array))return l;u===void 0?u=[]:u instanceof Array||(u=[u]);for(let I=0;I<u.length;I++){const R=J(u[I]);if(R instanceof Error)return R;u[I]=R}let v=0;for(;v<t;){e.setDate(e.getDate()+1);const I=e.getDay();if(I!==n[0]&&I!==n[1]){for(let R=0;R<u.length;R++){const H=u[R];if(H.getDate()===e.getDate()&&H.getMonth()===e.getMonth()&&H.getFullYear()===e.getFullYear()){v--;break}}v++}}return e};const jo=ro;function lo(e,t=2,n=!1){if(e=L(e),isNaN(e)||(t=L(t),isNaN(t)))return l;if(t<0){const u=Math.pow(10,-t);e=Math.round(e/u)*u}else e=e.toFixed(t);if(n)e=e.toString().replace(/,/g,"");else{const u=e.toString().split(".");u[0]=u[0].replace(/\B(?=(\d{3})+$)/g,","),e=u.join(".")}return e}function ye(e,t){return U(e,t)||(e=oe(e),(t=L(t))instanceof Error?t:new Array(t+1).join(e))}const go=oo,ho=no;function It(e){return/^[01]{1,10}$/.test(e)}function ge(e,t,n){if(B(e=L(e),t=L(t)))return e;if((n=n===void 0?"i":n)!=="i"&&n!=="j")return l;if(e===0&&t===0)return 0;if(e===0)return t===1?n:t.toString()+n;if(t===0)return e.toString();{const u=t>0?"+":"";return e.toString()+u+(t===1?n:t.toString()+n)}}function Nt(e,t){return t=t===void 0?0:t,B(e=L(e),t=L(t))?l:g.erf(e)}function St(e){return isNaN(e)?l:g.erfc(e)}function Dt(e){const t=se(e),n=ie(e);return B(t,n)?l:Math.sqrt(Math.pow(t,2)+Math.pow(n,2))}function ie(e){if(e===void 0||e===!0||e===!1)return l;if(e===0||e==="0")return 0;if(["i","j"].indexOf(e)>=0)return 1;let t=(e=(e+="").replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j")).indexOf("+"),n=e.indexOf("-");t===0&&(t=e.indexOf("+",1)),n===0&&(n=e.indexOf("-",1));const u=e.substring(e.length-1,e.length),v=u==="i"||u==="j";return t>=0||n>=0?v?t>=0?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?f:Number(e.substring(t+1,e.length-1)):isNaN(e.substring(0,n))||isNaN(e.substring(n+1,e.length-1))?f:-Number(e.substring(n+1,e.length-1)):f:v?isNaN(e.substring(0,e.length-1))?f:e.substring(0,e.length-1):isNaN(e)?f:0}function Tt(e){const t=se(e),n=ie(e);return B(t,n)?l:t===0&&n===0?d:t===0&&n>0?Math.PI/2:t===0&&n<0?-Math.PI/2:n===0&&t>0?0:n===0&&t<0?-Math.PI:t>0?Math.atan(n/t):t<0&&n>=0?Math.atan(n/t)+Math.PI:Math.atan(n/t)-Math.PI}function ut(e){const t=se(e),n=ie(e);if(B(t,n))return l;let u=e.substring(e.length-1);return u=u==="i"||u==="j"?u:"i",ge(Math.cos(t)*(Math.exp(n)+Math.exp(-n))/2,-Math.sin(t)*(Math.exp(n)-Math.exp(-n))/2,u)}function io(e){const t=se(e),n=ie(e);if(B(t,n))return l;let u=e.substring(e.length-1);return u=u==="i"||u==="j"?u:"i",ge(Math.cos(n)*(Math.exp(t)+Math.exp(-t))/2,Math.sin(n)*(Math.exp(t)-Math.exp(-t))/2,u)}function Ve(e,t){const n=se(e),u=ie(e),v=se(t),I=ie(t);if(B(n,u,v,I))return l;const R=e.substring(e.length-1),H=t.substring(t.length-1);let V="i";if((R==="j"||H==="j")&&(V="j"),v===0&&I===0)return f;const Y=v*v+I*I;return ge((n*v+u*I)/Y,(u*v-n*I)/Y,V)}function se(e){if(e===void 0||e===!0||e===!1)return l;if(e===0||e==="0"||["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(e)>=0)return 0;let t=(e+="").indexOf("+"),n=e.indexOf("-");t===0&&(t=e.indexOf("+",1)),n===0&&(n=e.indexOf("-",1));const u=e.substring(e.length-1,e.length),v=u==="i"||u==="j";return t>=0||n>=0?v?t>=0?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?f:Number(e.substring(0,t)):isNaN(e.substring(0,n))||isNaN(e.substring(n+1,e.length-1))?f:Number(e.substring(0,n)):f:v?isNaN(e.substring(0,e.length-1))?f:0:isNaN(e)?f:e}function ct(e){const t=se(e),n=ie(e);if(B(t,n))return l;let u=e.substring(e.length-1);return u=u==="i"||u==="j"?u:"i",ge(Math.sin(t)*(Math.exp(n)+Math.exp(-n))/2,Math.cos(t)*(Math.exp(n)-Math.exp(-n))/2,u)}function so(e){const t=se(e),n=ie(e);if(B(t,n))return l;let u=e.substring(e.length-1);return u=u==="i"||u==="j"?u:"i",ge(Math.cos(n)*(Math.exp(t)-Math.exp(-t))/2,Math.sin(n)*(Math.exp(t)+Math.exp(-t))/2,u)}Nt.PRECISE=()=>{throw new Error("ERF.PRECISE is not implemented")},St.PRECISE=()=>{throw new Error("ERFC.PRECISE is not implemented")};const mo=pt.DIST,vo=pt.INV,yo=We.DIST,Co=Le.MATH,xo=Le.PRECISE,wo=Ne.DIST,Ao=Ne.DIST.RT,Eo=Ne.INV,Mo=Ne.INV.RT,Io=Ne.TEST,No=nt.P,So=nt.P,Do=nt.S,To=We.INV,Fo=St.PRECISE,Lo=Nt.PRECISE,Ro=qt.DIST,Oo=Ee.DIST,ko=Ee.DIST.RT,Ho=Ee.INV,Bo=Ee.INV.RT,Po=Be.MATH,_o=Be.PRECISE,Vo=Ee.TEST,qo=Xe.DIST,Uo=Xe.INV,zo=jt.PRECISE,Yo=gt.DIST,Wo=ze.INV,Xo=ze.DIST,Go=ze.INV,Ko=Ge.MULT,$o=Ge.SNGL,Jo=Wt.DIST,Qo=it.INTL,Zo=Me.DIST,en=Me.INV,tn=Me.S.DIST,on=Me.S.INV,nn=Ie.EXC,rn=Ie.INC,ln=yt.EXC,sn=yt.INC,an=Gt.DIST,un=Ke.EXC,cn=Ke.INC,fn=$e.AVG,dn=$e.EQ,pn=Ct.P,bn=Se.P,jn=Se.S,gn=we.DIST,hn=we.DIST.RT,mn=we.INV,vn=we.TEST,yn=ve.P,Cn=ve.S,xn=Qt.DIST,wn=st.INTL,An=xt.TEST;function Ft(e){const t=[];return C(e,n=>{n&&t.push(n)}),t}function Ae(e,t){const n={};for(let I=1;I<e[0].length;++I)n[I]=!0;let u=t[0].length;for(let I=1;I<t.length;++I)t[I].length>u&&(u=t[I].length);for(let I=1;I<e.length;++I)for(let R=1;R<e[I].length;++R){let H=!1,V=!1;for(let Y=0;Y<t.length;++Y){const G=t[Y];if(G.length<u)continue;const Q=G[0];if(e[I][0]===Q){V=!0;for(let K=1;K<G.length;++K)if(!H)if(G[K]===void 0||G[K]==="*")H=!0;else{const te=Fe(G[K]+""),re=[me(e[I][R],be)].concat(te);H=xe(re)}}}V&&(n[R]=n[R]&&H)}const v=[];for(let I=0;I<e[0].length;++I)n[I]&&v.push(I-1);return v}function Lt(e){return e&&e.getTime&&!isNaN(e.getTime())}function Rt(e){return e instanceof Date?e:new Date(e)}function qe(e,t,n,u,v){if(u=u||0,v=v||0,B(e=L(e),t=L(t),n=L(n),u=L(u),v=L(v)))return l;let I;if(e===0)I=u+n*t;else{const R=Math.pow(1+e,t);I=v===1?u*R+n*(1+e)*(R-1)/e:u*R+n*(R-1)/e}return-I}function ao(e,t,n,u,v,I){if(v=v||0,I=I||0,B(e=L(e),t=L(t),n=L(n),u=L(u),v=L(v),I=L(I)))return l;const R=Qe(e,n,u,v,I);return(t===1?I===1?0:-u:I===1?qe(e,t-2,R,u,1)-R:qe(e,t-1,R,u,0))*e}function Ot(){const e=X(F(arguments));if(e instanceof Error)return e;const t=e[0];let n=0;for(let u=1;u<e.length;u++)n+=e[u]/Math.pow(1+t,u);return n}function Qe(e,t,n,u,v){if(u=u||0,v=v||0,B(e=L(e),t=L(t),n=L(n),u=L(u),v=L(v)))return l;let I;if(e===0)I=(n+u)/t;else{const R=Math.pow(1+e,t);I=v===1?(u*e/(R-1)+n*e/(1-1/R))/(1+e):u*e/(R-1)+n*e/(1-1/R)}return-I}const En={errors:D,symbols:co};b.ABS=function(e){return(e=L(e))instanceof Error?e:Math.abs(e)},b.ACCRINT=function(e,t,n,u,v,I,R){return e=Rt(e),t=Rt(t),n=Rt(n),Lt(e)&&Lt(t)&&Lt(n)?u<=0||v<=0||[1,2,4].indexOf(I)===-1||[0,1,2,3,4].indexOf(R)===-1||n<=e?f:(v=v||0)*u*Mt(e,n,R=R||0):l},b.ACCRINTM=function(){throw new Error("ACCRINTM is not implemented")},b.ACOS=function(e){if((e=L(e))instanceof Error)return e;let t=Math.acos(e);return isNaN(t)&&(t=f),t},b.ACOSH=function(e){if((e=L(e))instanceof Error)return e;let t=Math.log(e+Math.sqrt(e*e-1));return isNaN(t)&&(t=f),t},b.ACOT=function(e){return(e=L(e))instanceof Error?e:Math.atan(1/e)},b.ACOTH=function(e){if((e=L(e))instanceof Error)return e;let t=.5*Math.log((e+1)/(e-1));return isNaN(t)&&(t=f),t},b.AGGREGATE=function(e,t,n,u){if(B(e=L(e),L(e)))return l;switch(e){case 1:return Ue(n);case 2:return tt(n);case 3:return ot(n);case 4:return mt(n);case 5:return vt(n);case 6:return At(n);case 7:return Se.S(n);case 8:return Se.P(n);case 9:return Pe(n);case 10:return ve.S(n);case 11:return ve.P(n);case 12:return Yt(n);case 13:return Ge.SNGL(n);case 14:return zt(n,u);case 15:return Kt(n,u);case 16:return Ie.INC(n,u);case 17:return Ke.INC(n,u);case 18:return Ie.EXC(n,u);case 19:return Ke.EXC(n,u)}},b.AMORDEGRC=function(){throw new Error("AMORDEGRC is not implemented")},b.AMORLINC=function(){throw new Error("AMORLINC is not implemented")},b.AND=function(){const e=F(arguments);let t=l;for(let n=0;n<e.length;n++){if(e[n]instanceof Error)return e[n];e[n]!==void 0&&e[n]!==null&&typeof e[n]!="string"&&(t===l&&(t=!0),e[n]||(t=!1))}return t},b.ARABIC=function(e){if(e==null)return 0;if(e instanceof Error)return e;if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(e))return l;let t=0;return e.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,n=>{t+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[n]}),t},b.ASC=function(){throw new Error("ASC is not implemented")},b.ASIN=function(e){if((e=L(e))instanceof Error)return e;let t=Math.asin(e);return isNaN(t)&&(t=f),t},b.ASINH=function(e){return(e=L(e))instanceof Error?e:Math.log(e+Math.sqrt(e*e+1))},b.ATAN=function(e){return(e=L(e))instanceof Error?e:Math.atan(e)},b.ATAN2=function(e,t){return U(e=L(e),t=L(t))||Math.atan2(e,t)},b.ATANH=function(e){if((e=L(e))instanceof Error)return e;let t=Math.log((1+e)/(1-e))/2;return isNaN(t)&&(t=f),t},b.AVEDEV=function(){const e=F(arguments).filter(ue);if(e.length===0)return f;const t=X(e);return t instanceof Error?t:g.sum(g(t).subtract(g.mean(t)).abs()[0])/t.length},b.AVERAGE=Ue,b.AVERAGEA=dt,b.AVERAGEIF=function(e,t,n){if(arguments.length<=1)return h;if(n=X(F(n=n||e).filter(ue)),e=F(e),n instanceof Error)return n;let u=0,v=0;const I=t===void 0||t==="*",R=I?null:Fe(t+"");for(let H=0;H<e.length;H++){const V=e[H];if(I)v+=n[H],u++;else{const Y=[me(V,be)].concat(R);xe(Y)&&(v+=n[H],u++)}}return v/u},b.AVERAGEIFS=function(){const e=E(arguments),t=(e.length-1)/2,n=F(e[0]);let u=0,v=0;for(let R=0;R<n.length;R++){let H=!1;for(let V=0;V<t;V++){const Y=e[2*V+1][R],G=e[2*V+2];let Q=!1;if(G===void 0||G==="*")Q=!0;else{const K=Fe(G+""),te=[me(Y,be)].concat(K);Q=xe(te)}if(!Q){H=!1;break}H=!0}H&&(v+=n[R],u++)}const I=v/u;return isNaN(I)?0:I},b.BAHTTEXT=function(){throw new Error("BAHTTEXT is not implemented")},b.BASE=function(e,t,n){const u=U(e=L(e),t=L(t),n=L(n));if(u)return u;if(t===0)return f;const v=e.toString(t);return new Array(Math.max(n+1-v.length,0)).join("0")+v},b.BESSELI=function(e,t){return B(e=L(e),t=L(t))?l:S.besseli(e,t)},b.BESSELJ=function(e,t){return B(e=L(e),t=L(t))?l:S.besselj(e,t)},b.BESSELK=function(e,t){return B(e=L(e),t=L(t))?l:S.besselk(e,t)},b.BESSELY=function(e,t){return B(e=L(e),t=L(t))?l:S.bessely(e,t)},b.BETA=pt,b.BETADIST=mo,b.BETAINV=vo,b.BIN2DEC=function(e){if(!It(e))return f;const t=parseInt(e,2),n=e.toString();return n.length===10&&n.substring(0,1)==="1"?parseInt(n.substring(1),2)-512:t},b.BIN2HEX=function(e,t){if(!It(e))return f;const n=e.toString();if(n.length===10&&n.substring(0,1)==="1")return(0xfffffffe00+parseInt(n.substring(1),2)).toString(16);const u=parseInt(e,2).toString(16);return t===void 0?u:isNaN(t)?l:t<0?f:(t=Math.floor(t))>=u.length?ye("0",t-u.length)+u:f},b.BIN2OCT=function(e,t){if(!It(e))return f;const n=e.toString();if(n.length===10&&n.substring(0,1)==="1")return(1073741312+parseInt(n.substring(1),2)).toString(8);const u=parseInt(e,2).toString(8);return t===void 0?u:isNaN(t)?l:t<0?f:(t=Math.floor(t))>=u.length?ye("0",t-u.length)+u:f},b.BINOM=We,b.BINOMDIST=yo,b.BITAND=function(e,t){return B(e=L(e),t=L(t))?l:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?f:e&t},b.BITLSHIFT=function(e,t){return B(e=L(e),t=L(t))?l:e<0||Math.floor(e)!==e||e>0xffffffffffff||Math.abs(t)>53?f:t>=0?e<<t:e>>-t},b.BITOR=function(e,t){return B(e=L(e),t=L(t))?l:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?f:e|t},b.BITRSHIFT=function(e,t){return B(e=L(e),t=L(t))?l:e<0||Math.floor(e)!==e||e>0xffffffffffff||Math.abs(t)>53?f:t>=0?e>>t:e<<-t},b.BITXOR=function(e,t){return B(e=L(e),t=L(t))?l:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?f:e^t},b.CEILING=Le,b.CEILINGMATH=Co,b.CEILINGPRECISE=xo,b.CELL=function(){throw new Error("CELL is not implemented")},b.CHAR=oo,b.CHIDIST=wo,b.CHIDISTRT=Ao,b.CHIINV=Eo,b.CHIINVRT=Mo,b.CHISQ=Ne,b.CHITEST=Io,b.CHOOSE=function(){if(arguments.length<2)return h;const e=arguments[0];return e<1||e>254||arguments.length<e+1?l:arguments[e]},b.CLEAN=function(e){return B(e)?e:(e=e||"").replace(/[\0-\x1F]/g,"")},b.CODE=no,b.COLUMN=function(e,t){return arguments.length!==2?h:t<0?f:e instanceof Array&&typeof t=="number"?e.length!==0?g.col(e,t):void 0:l},b.COLUMNS=function(e){return arguments.length!==1?h:e instanceof Array?e.length===0?0:g.cols(e):l},b.COMBIN=Ye,b.COMBINA=function(e,t){return U(e=L(e),t=L(t))||(e<t?f:e===0&&t===0?1:Ye(e+t-1,e-1))},b.COMPLEX=ge,b.CONCAT=jo,b.CONCATENATE=ro,b.CONFIDENCE=bt,b.CONVERT=function(e,t,n){if((e=L(e))instanceof Error)return e;const u=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["\xE5ngstr\xF6m","\xC5",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic \xE5ngstr\xF6m","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,416818182544058e-5],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,758660370370369e-22],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","\xB0",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519538e-3],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["\u0153rsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","\u03A9",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdest\xE4rke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square \xE5ngstr\xF6m","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988110336e-6],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],v={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,1152921504606847e3,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},I={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]};let R,H=null,V=null,Y=t,G=n,Q=1,K=1;for(let te=0;te<u.length;te++)R=u[te][2]===null?[]:u[te][2],(u[te][1]===Y||R.indexOf(Y)>=0)&&(H=u[te]),(u[te][1]===G||R.indexOf(G)>=0)&&(V=u[te]);if(H===null){const te=v[t.substring(0,2)];let re=I[t.substring(0,1)];t.substring(0,2)==="da"&&(re=["dekao",10,"da"]),te?(Q=te[2],Y=t.substring(2)):re&&(Q=re[1],Y=t.substring(re[2].length));for(let le=0;le<u.length;le++)R=u[le][2]===null?[]:u[le][2],(u[le][1]===Y||R.indexOf(Y)>=0)&&(H=u[le])}if(V===null){const te=v[n.substring(0,2)];let re=I[n.substring(0,1)];n.substring(0,2)==="da"&&(re=["dekao",10,"da"]),te?(K=te[2],G=n.substring(2)):re&&(K=re[1],G=n.substring(re[2].length));for(let le=0;le<u.length;le++)R=u[le][2]===null?[]:u[le][2],(u[le][1]===G||R.indexOf(G)>=0)&&(V=u[le])}return H===null||V===null||H[3]!==V[3]?h:e*H[6]*Q/(V[6]*K)},b.CORREL=function(e,t){return B(e=X(F(e)),t=X(F(t)))?l:g.corrcoeff(e,t)},b.COS=function(e){return(e=L(e))instanceof Error?e:Math.cos(e)},b.COSH=function(e){return(e=L(e))instanceof Error?e:(Math.exp(e)+Math.exp(-e))/2},b.COT=function(e){return(e=L(e))instanceof Error?e:e===0?d:1/Math.tan(e)},b.COTH=function(e){if((e=L(e))instanceof Error)return e;if(e===0)return d;const t=Math.exp(2*e);return(t+1)/(t-1)},b.COUNT=tt,b.COUNTA=ot,b.COUNTBLANK=Vt,b.COUNTIF=function(e,t){if(e=F(e),t===void 0||t==="*")return e.length;let n=0;const u=Fe(t+"");for(let v=0;v<e.length;v++){const I=[me(e[v],be)].concat(u);xe(I)&&n++}return n},b.COUNTIFS=function(){const e=E(arguments),t=new Array(F(e[0]).length);for(let u=0;u<t.length;u++)t[u]=!0;for(let u=0;u<e.length;u+=2){const v=F(e[u]),I=e[u+1];if(I!==void 0&&I!=="*"){const R=Fe(I+"");for(let H=0;H<v.length;H++){const V=[me(v[H],be)].concat(R);t[H]=t[H]&&xe(V)}}}let n=0;for(let u=0;u<t.length;u++)t[u]&&n++;return n},b.COUPDAYBS=function(){throw new Error("COUPDAYBS is not implemented")},b.COUPDAYS=function(){throw new Error("COUPDAYS is not implemented")},b.COUPDAYSNC=function(){throw new Error("COUPDAYSNC is not implemented")},b.COUPNCD=function(){throw new Error("COUPNCD is not implemented")},b.COUPNUM=function(){throw new Error("COUPNUM is not implemented")},b.COUPPCD=function(){throw new Error("COUPPCD is not implemented")},b.COVAR=No,b.COVARIANCE=nt,b.COVARIANCEP=So,b.COVARIANCES=Do,b.CRITBINOM=To,b.CSC=function(e){return(e=L(e))instanceof Error?e:e===0?d:1/Math.sin(e)},b.CSCH=function(e){return(e=L(e))instanceof Error?e:e===0?d:2/(Math.exp(e)-Math.exp(-e))},b.CUMIPMT=function(e,t,n,u,v,I){if(B(e=L(e),t=L(t),n=L(n)))return l;if(e<=0||t<=0||n<=0||u<1||v<1||u>v||I!==0&&I!==1)return f;const R=Qe(e,t,n,0,I);let H=0;u===1&&(I===0&&(H=-n),u++);for(let V=u;V<=v;V++)H+=I===1?qe(e,V-2,R,n,1)-R:qe(e,V-1,R,n,0);return H*=e,H},b.CUMPRINC=function(e,t,n,u,v,I){if(B(e=L(e),t=L(t),n=L(n)))return l;if(e<=0||t<=0||n<=0||u<1||v<1||u>v||I!==0&&I!==1)return f;const R=Qe(e,t,n,0,I);let H=0;u===1&&(H=I===0?R+n*e:R,u++);for(let V=u;V<=v;V++)H+=I>0?R-(qe(e,V-2,R,n,1)-R)*e:R-qe(e,V-1,R,n,0)*e;return H},b.DATE=function(e,t,n){let u;return B(e=L(e),t=L(t),n=L(n))?u=l:(u=new Date(e,t-1,n),u.getFullYear()<0&&(u=f)),u},b.DATEDIF=Je,b.DATEVALUE=function(e){if(typeof e!="string")return l;const t=Date.parse(e);return isNaN(t)?l:new Date(e)},b.DAVERAGE=function(e,t,n){if(isNaN(t)&&typeof t!="string")return l;const u=Ae(e,n);let v=[];if(typeof t=="string"){const R=W(e,t);v=_(e[R])}else v=_(e[t]);let I=0;return C(u,R=>{I+=v[R]}),u.length===0?d:I/u.length},b.DAY=function(e){const t=J(e);return t instanceof Error?t:t.getDate()},b.DAYS=_e,b.DAYS360=Oe,b.DB=function(e,t,n,u,v){if(v=v===void 0?12:v,B(e=L(e),t=L(t),n=L(n),u=L(u),v=L(v)))return l;if(e<0||t<0||n<0||u<0||[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(v)===-1||u>n)return f;if(t>=e)return 0;const I=(1-Math.pow(t/e,1/n)).toFixed(3),R=e*I*v/12;let H=R,V=0;const Y=u===n?n-1:u;for(let G=2;G<=Y;G++)V=(e-H)*I,H+=V;return u===1?R:u===n?(e-H)*I:V},b.DBCS=function(){throw new Error("DBCS is not implemented")},b.DCOUNT=function(e,t,n){if(isNaN(t)&&typeof t!="string")return l;const u=Ae(e,n);let v=[];if(typeof t=="string"){const R=W(e,t);v=_(e[R])}else v=_(e[t]);const I=[];return C(u,R=>{I.push(v[R])}),tt(I)},b.DCOUNTA=function(e,t,n){if(isNaN(t)&&typeof t!="string")return l;const u=Ae(e,n);let v=[];if(typeof t=="string"){const R=W(e,t);v=_(e[R])}else v=_(e[t]);const I=[];return C(u,R=>{I.push(v[R])}),ot(I)},b.DDB=function(e,t,n,u,v){if(v=v===void 0?2:v,B(e=L(e),t=L(t),n=L(n),u=L(u),v=L(v)))return l;if(e<0||t<0||n<0||u<0||v<=0||u>n)return f;if(t>=e)return 0;let I=0,R=0;for(let H=1;H<=u;H++)R=Math.min(v/n*(e-I),e-t-I),I+=R;return R},b.DEC2BIN=function(e,t){if((e=L(e))instanceof Error)return e;if(!/^-?[0-9]{1,3}$/.test(e)||e<-512||e>511)return f;if(e<0)return"1"+ye("0",9-(512+e).toString(2).length)+(512+e).toString(2);const n=parseInt(e,10).toString(2);return t===void 0?n:isNaN(t)?l:t<0?f:(t=Math.floor(t))>=n.length?ye("0",t-n.length)+n:f},b.DEC2HEX=function(e,t){if((e=L(e))instanceof Error)return e;if(!/^-?[0-9]{1,12}$/.test(e)||e<-549755813888||e>549755813887)return f;if(e<0)return(1099511627776+e).toString(16);const n=parseInt(e,10).toString(16);return t===void 0?n:isNaN(t)?l:t<0?f:(t=Math.floor(t))>=n.length?ye("0",t-n.length)+n:f},b.DEC2OCT=function(e,t){if((e=L(e))instanceof Error)return e;if(!/^-?[0-9]{1,9}$/.test(e)||e<-536870912||e>536870911)return f;if(e<0)return(1073741824+e).toString(8);const n=parseInt(e,10).toString(8);return t===void 0?n:isNaN(t)?l:t<0?f:(t=Math.floor(t))>=n.length?ye("0",t-n.length)+n:f},b.DECIMAL=function(e,t){return arguments.length<1?l:U(e=L(e),t=L(t))||(t===0?f:parseInt(e,t))},b.DEGREES=function(e){return(e=L(e))instanceof Error?e:180*e/Math.PI},b.DELTA=function(e,t){return t=t===void 0?0:t,B(e=L(e),t=L(t))?l:e===t?1:0},b.DEVSQ=function(){const e=X(F(arguments));if(e instanceof Error)return e;const t=g.mean(e);let n=0;for(let u=0;u<e.length;u++)n+=Math.pow(e[u]-t,2);return n},b.DGET=function(e,t,n){if(isNaN(t)&&typeof t!="string")return l;const u=Ae(e,n);let v=[];return v=_(typeof t=="string"?e[W(e,t)]:e[t]),u.length===0?l:u.length>1?f:v[u[0]]},b.DISC=function(e,t,n,u,v){if(B(e=J(e),t=J(t),n=L(n),u=L(u),v=(v=L(v))||0))return l;if(n<=0||u<=0)return f;if(e>=t)return l;let I,R;switch(v){case 0:I=360,R=Oe(e,t,!1);break;case 1:case 3:I=365,R=Je(e,t,"D");break;case 2:I=360,R=Je(e,t,"D");break;case 4:I=360,R=Oe(e,t,!0);break;default:return f}return(u-n)/u*I/R},b.DMAX=function(e,t,n){if(isNaN(t)&&typeof t!="string")return l;const u=Ae(e,n);let v=[];if(typeof t=="string"){const R=W(e,t);v=_(e[R])}else v=_(e[t]);let I=v[u[0]];return C(u,R=>{I<v[R]&&(I=v[R])}),I},b.DMIN=function(e,t,n){if(isNaN(t)&&typeof t!="string")return l;const u=Ae(e,n);let v=[];if(typeof t=="string"){const R=W(e,t);v=_(e[R])}else v=_(e[t]);let I=v[u[0]];return C(u,R=>{I>v[R]&&(I=v[R])}),I},b.DOLLAR=function(e,t=2){if(e=L(e),isNaN(e))return l;const n={style:"currency",currency:"USD",minimumFractionDigits:t>=0?t:0,maximumFractionDigits:t>=0?t:0},u=(e=De(e,t)).toLocaleString("en-US",n);return e<0?"$("+u.slice(2)+")":u},b.DOLLARDE=function(e,t){if(B(e=L(e),t=L(t)))return l;if(t<0)return f;if(t>=0&&t<1)return d;t=parseInt(t,10);let n=parseInt(e,10);n+=e%1*Math.pow(10,Math.ceil(Math.log(t)/Math.LN10))/t;const u=Math.pow(10,Math.ceil(Math.log(t)/Math.LN2)+1);return n=Math.round(n*u)/u,n},b.DOLLARFR=function(e,t){if(B(e=L(e),t=L(t)))return l;if(t<0)return f;if(t>=0&&t<1)return d;t=parseInt(t,10);let n=parseInt(e,10);return n+=e%1*Math.pow(10,-Math.ceil(Math.log(t)/Math.LN10))*t,n},b.DPRODUCT=function(e,t,n){if(isNaN(t)&&typeof t!="string")return l;const u=Ae(e,n);let v=[];if(typeof t=="string"){const H=W(e,t);v=_(e[H])}else v=_(e[t]);let I=[];C(u,H=>{I.push(v[H])}),I=Ft(I);let R=1;return C(I,H=>{R*=H}),R},b.DSTDEV=function(e,t,n){if(isNaN(t)&&typeof t!="string")return l;const u=Ae(e,n);let v=[];if(typeof t=="string"){const R=W(e,t);v=_(e[R])}else v=_(e[t]);let I=[];return C(u,R=>{I.push(v[R])}),I=Ft(I),Se.S(I)},b.DSTDEVP=function(e,t,n){if(isNaN(t)&&typeof t!="string")return l;const u=Ae(e,n);let v=[];if(typeof t=="string"){const R=W(e,t);v=_(e[R])}else v=_(e[t]);let I=[];return C(u,R=>{I.push(v[R])}),I=Ft(I),Se.P(I)},b.DSUM=function(e,t,n){if(isNaN(t)&&typeof t!="string")return l;const u=Ae(e,n);let v=[];if(typeof t=="string"){const R=W(e,t);v=_(e[R])}else v=_(e[t]);const I=[];return C(u,R=>{I.push(v[R])}),Pe(I)},b.DURATION=function(){throw new Error("DURATION is not implemented")},b.DVAR=function(e,t,n){if(isNaN(t)&&typeof t!="string")return l;const u=Ae(e,n);let v=[];if(typeof t=="string"){const R=W(e,t);v=_(e[R])}else v=_(e[t]);const I=[];return C(u,R=>{I.push(v[R])}),ve.S(I)},b.DVARP=function(e,t,n){if(isNaN(t)&&typeof t!="string")return l;const u=Ae(e,n);let v=[];if(typeof t=="string"){const R=W(e,t);v=_(e[R])}else v=_(e[t]);const I=[];return C(u,R=>{I.push(v[R])}),ve.P(I)},b.EDATE=function(e,t){return(e=J(e))instanceof Error?e:isNaN(t)?l:(t=parseInt(t,10),e.setMonth(e.getMonth()+t),e)},b.EFFECT=function(e,t){return B(e=L(e),t=L(t))?l:e<=0||t<1?f:(t=parseInt(t,10),Math.pow(1+e/t,t)-1)},b.EOMONTH=function(e,t){return(e=J(e))instanceof Error?e:isNaN(t)?l:(t=parseInt(t,10),new Date(e.getFullYear(),e.getMonth()+t+1,0))},b.ERF=Nt,b.ERFC=St,b.ERFCPRECISE=Fo,b.ERFPRECISE=Lo,b.ERROR=kt,b.EVEN=function(e){return(e=L(e))instanceof Error?e:Le(e,-2,-1)},b.EXACT=function(e,t){return arguments.length!==2?h:U(e,t)||(e=oe(e))===oe(t)},b.EXP=function(e){return arguments.length<1?h:arguments.length>1?w:(e=L(e))instanceof Error?e:e=Math.exp(e)},b.EXPON=qt,b.EXPONDIST=Ro,b.F=Ee,b.FACT=Re,b.FACTDOUBLE=function e(t){if((t=L(t))instanceof Error)return t;const n=Math.floor(t);return n<=0?1:n*e(n-2)},b.FALSE=function(){return!1},b.FDIST=Oo,b.FDISTRT=ko,b.FIND=function(e,t,n){if(arguments.length<2)return h;e=oe(e),n=n===void 0?0:n;const u=(t=oe(t)).indexOf(e,n-1);return u===-1?l:u+1},b.FINV=Ho,b.FINVRT=Bo,b.FISHER=function(e){return(e=L(e))instanceof Error?e:Math.log((1+e)/(1-e))/2},b.FISHERINV=function(e){if((e=L(e))instanceof Error)return e;const t=Math.exp(2*e);return(t-1)/(t+1)},b.FIXED=lo,b.FLOOR=Be,b.FLOORMATH=Po,b.FLOORPRECISE=_o,b.FORECAST=Ut,b.FREQUENCY=function(e,t){if(B(e=X(F(e)),t=X(F(t))))return l;const n=e.length,u=t.length,v=[];for(let I=0;I<=u;I++){v[I]=0;for(let R=0;R<n;R++)I===0?e[R]<=t[0]&&(v[0]+=1):I<u?e[R]>t[I-1]&&e[R]<=t[I]&&(v[I]+=1):I===u&&e[R]>t[u-1]&&(v[u]+=1)}return v},b.FTEST=Vo,b.FV=qe,b.FVSCHEDULE=function(e,t){if(B(e=L(e),t=X(F(t))))return l;const n=t.length;let u=e;for(let v=0;v<n;v++)u*=1+t[v];return u},b.GAMMA=Xe,b.GAMMADIST=qo,b.GAMMAINV=Uo,b.GAMMALN=jt,b.GAMMALNPRECISE=zo,b.GAUSS=function(e){return(e=L(e))instanceof Error?e:g.normal.cdf(e,0,1)-.5},b.GCD=function(){const e=X(F(arguments));if(e instanceof Error)return e;const t=e.length,n=e[0];let u=n<0?-n:n;for(let v=1;v<t;v++){const I=e[v];let R=I<0?-I:I;for(;u&&R;)u>R?u%=R:R%=u;u+=R}return u},b.GEOMEAN=function(){const e=X(F(arguments));return e instanceof Error?e:g.geomean(e)},b.GESTEP=function(e,t){return B(t=t||0,e=L(e))?e:e>=t?1:0},b.GROWTH=function(e,t,n,u){if((e=X(e))instanceof Error)return e;let v;if(t===void 0)for(t=[],v=1;v<=e.length;v++)t.push(v);if(n===void 0)for(n=[],v=1;v<=e.length;v++)n.push(v);if(B(t=X(t),n=X(n)))return l;u===void 0&&(u=!0);const I=e.length;let R,H,V=0,Y=0,G=0,Q=0;for(v=0;v<I;v++){const te=t[v],re=Math.log(e[v]);V+=te,Y+=re,G+=te*re,Q+=te*te}V/=I,Y/=I,G/=I,Q/=I,u?(R=(G-V*Y)/(Q-V*V),H=Y-R*V):(R=G/Q,H=0);const K=[];for(v=0;v<n.length;v++)K.push(Math.exp(H+R*n[v]));return K},b.HARMEAN=function(){const e=X(F(arguments));if(e instanceof Error)return e;const t=e.length;let n=0;for(let u=0;u<t;u++)n+=1/e[u];return t/n},b.HEX2BIN=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return f;const n=!(e.length!==10||e.substring(0,1).toLowerCase()!=="f"),u=n?parseInt(e,16)-1099511627776:parseInt(e,16);if(u<-512||u>511)return f;if(n)return"1"+ye("0",9-(512+u).toString(2).length)+(512+u).toString(2);const v=u.toString(2);return t===void 0?v:isNaN(t)?l:t<0?f:(t=Math.floor(t))>=v.length?ye("0",t-v.length)+v:f},b.HEX2DEC=function(e){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return f;const t=parseInt(e,16);return t>=549755813888?t-1099511627776:t},b.HEX2OCT=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return f;const n=parseInt(e,16);if(n>536870911&&n<0xffe0000000)return f;if(n>=0xffe0000000)return(n-0xffc0000000).toString(8);const u=n.toString(8);return t===void 0?u:isNaN(t)?l:t<0?f:(t=Math.floor(t))>=u.length?ye("0",t-u.length)+u:f},b.HLOOKUP=function(e,t,n,u){return _t(e,z(t),n,u)},b.HOUR=function(e){return(e=J(e))instanceof Error?e:e.getHours()},b.HYPGEOM=gt,b.HYPGEOMDIST=Yo,b.IF=function(e,t,n){return e instanceof Error?e:((t=!(arguments.length>=2)||t)==null&&(t=0),(n=arguments.length===3&&n)==null&&(n=0),e?t:n)},b.IFERROR=function(e,t){return Ze(e)?t:e},b.IFNA=function(e,t){return e===h?t:e},b.IFS=function(){for(let e=0;e<arguments.length/2;e++)if(arguments[2*e])return arguments[2*e+1];return h},b.IMABS=Dt,b.IMAGINARY=ie,b.IMARGUMENT=Tt,b.IMCONJUGATE=function(e){const t=se(e),n=ie(e);if(B(t,n))return l;let u=e.substring(e.length-1);return u=u==="i"||u==="j"?u:"i",n!==0?ge(t,-n,u):e},b.IMCOS=ut,b.IMCOSH=io,b.IMCOT=function(e){return B(se(e),ie(e))?l:Ve(ut(e),ct(e))},b.IMCSC=function(e){return e===!0||e===!1?l:B(se(e),ie(e))?f:Ve("1",ct(e))},b.IMCSCH=function(e){return e===!0||e===!1?l:B(se(e),ie(e))?f:Ve("1",so(e))},b.IMDIV=Ve,b.IMEXP=function(e){const t=se(e),n=ie(e);if(B(t,n))return l;let u=e.substring(e.length-1);u=u==="i"||u==="j"?u:"i";const v=Math.exp(t);return ge(v*Math.cos(n),v*Math.sin(n),u)},b.IMLN=function(e){const t=se(e),n=ie(e);if(B(t,n))return l;let u=e.substring(e.length-1);return u=u==="i"||u==="j"?u:"i",ge(Math.log(Math.sqrt(t*t+n*n)),Math.atan(n/t),u)},b.IMLOG10=function(e){const t=se(e),n=ie(e);if(B(t,n))return l;let u=e.substring(e.length-1);return u=u==="i"||u==="j"?u:"i",ge(Math.log(Math.sqrt(t*t+n*n))/Math.log(10),Math.atan(n/t)/Math.log(10),u)},b.IMLOG2=function(e){const t=se(e),n=ie(e);if(B(t,n))return l;let u=e.substring(e.length-1);return u=u==="i"||u==="j"?u:"i",ge(Math.log(Math.sqrt(t*t+n*n))/Math.log(2),Math.atan(n/t)/Math.log(2),u)},b.IMPOWER=function(e,t){if(B(t=L(t),se(e),ie(e)))return l;let n=e.substring(e.length-1);n=n==="i"||n==="j"?n:"i";const u=Math.pow(Dt(e),t),v=Tt(e);return ge(u*Math.cos(t*v),u*Math.sin(t*v),n)},b.IMPRODUCT=function(){let e=arguments[0];if(!arguments.length)return l;for(let t=1;t<arguments.length;t++){const n=se(e),u=ie(e),v=se(arguments[t]),I=ie(arguments[t]);if(B(n,u,v,I))return l;e=ge(n*v-u*I,n*I+u*v)}return e},b.IMREAL=se,b.IMSEC=function(e){return e===!0||e===!1||B(se(e),ie(e))?l:Ve("1",ut(e))},b.IMSECH=function(e){return B(se(e),ie(e))?l:Ve("1",io(e))},b.IMSIN=ct,b.IMSINH=so,b.IMSQRT=function(e){if(B(se(e),ie(e)))return l;let t=e.substring(e.length-1);t=t==="i"||t==="j"?t:"i";const n=Math.sqrt(Dt(e)),u=Tt(e);return ge(n*Math.cos(u/2),n*Math.sin(u/2),t)},b.IMSUB=function(e,t){const n=se(e),u=ie(e),v=se(t),I=ie(t);if(B(n,u,v,I))return l;const R=e.substring(e.length-1),H=t.substring(t.length-1);let V="i";return(R==="j"||H==="j")&&(V="j"),ge(n-v,u-I,V)},b.IMSUM=function(){if(!arguments.length)return l;const e=F(arguments);let t=e[0];for(let n=1;n<e.length;n++){const u=se(t),v=ie(t),I=se(e[n]),R=ie(e[n]);if(B(u,v,I,R))return l;t=ge(u+I,v+R)}return t},b.IMTAN=function(e){return e===!0||e===!1||B(se(e),ie(e))?l:Ve(ct(e),ut(e))},b.INDEX=function(e,t,n){const u=U(e,t,n);if(u)return u;if(!Array.isArray(e))return l;const v=e.length>0&&!Array.isArray(e[0]);return v&&!n?(n=t,t=1):(n=n||1,t=t||1),n<0||t<0?l:v&&t===1&&n<=e.length?e[n-1]:t<=e.length&&n<=e[t-1].length?e[t-1][n-1]:p},b.INFO=function(){throw new Error("INFO is not implemented")},b.INT=function(e){return(e=L(e))instanceof Error?e:Math.floor(e)},b.INTERCEPT=function(e,t){return B(e=X(e),t=X(t))?l:e.length!==t.length?h:Ut(0,e,t)},b.INTRATE=function(){throw new Error("INTRATE is not implemented")},b.IPMT=ao,b.IRR=function(e,t){if(t=t||0,B(e=X(F(e)),t=L(t)))return l;const n=(K,te,re)=>{const le=re+1;let he=K[0];for(let fe=1;fe<K.length;fe++)he+=K[fe]/Math.pow(le,(te[fe]-te[0])/365);return he},u=(K,te,re)=>{const le=re+1;let he=0;for(let fe=1;fe<K.length;fe++){const ke=(te[fe]-te[0])/365;he-=ke*K[fe]/Math.pow(le,ke+1)}return he},v=[];let I=!1,R=!1;for(let K=0;K<e.length;K++)v[K]=K===0?0:v[K-1]+365,e[K]>0&&(I=!0),e[K]<0&&(R=!0);if(!I||!R)return f;let H,V,Y,G=t=t===void 0?.1:t,Q=!0;do Y=n(e,v,G),H=G-Y/u(e,v,G),V=Math.abs(H-G),G=H,Q=V>1e-10&&Math.abs(Y)>1e-10;while(Q);return G},b.ISBLANK=function(e){return e===null},b.ISERR=Ht,b.ISERROR=Ze,b.ISEVEN=function(e){return!(1&Math.floor(Math.abs(e)))},b.ISFORMULA=function(){throw new Error("ISFORMULA is not implemented")},b.ISLOGICAL=Bt,b.ISNA=function(e){return e===h},b.ISNONTEXT=function(e){return typeof e!="string"},b.ISNUMBER=et,b.ISO=uo,b.ISODD=function(e){return!!(1&Math.floor(Math.abs(e)))},b.ISOWEEKNUM=eo,b.ISPMT=function(e,t,n,u){return B(e=L(e),t=L(t),n=L(n),u=L(u))?l:u*e*(t/n-1)},b.ISREF=function(){throw new Error("ISREF is not implemented")},b.ISTEXT=Pt,b.KURT=function(){const e=X(F(arguments));if(e instanceof Error)return e;const t=g.mean(e),n=e.length;let u=0;for(let v=0;v<n;v++)u+=Math.pow(e[v]-t,4);return u/=Math.pow(g.stdev(e,!0),4),n*(n+1)/((n-1)*(n-2)*(n-3))*u-3*(n-1)*(n-1)/((n-2)*(n-3))},b.LARGE=zt,b.LCM=function(){const e=X(F(arguments));if(e instanceof Error)return e;for(var t,n,u,v,I=1;(u=e.pop())!==void 0;){if(u===0)return 0;for(;u>1;){if(u%2){for(t=3,n=Math.floor(Math.sqrt(u));t<=n&&u%t;t+=2);v=t<=n?t:u}else v=2;for(u/=v,I*=v,t=e.length;t;e[--t]%v==0&&(e[t]/=v)==1&&e.splice(t,1));}}return I},b.LEFT=function(e,t){return U(e,t)||(e=oe(e),(t=L(t=t===void 0?1:t))instanceof Error||typeof e!="string"?l:e.substring(0,t))},b.LEN=function(e){return arguments.length===0?w:e instanceof Error?e:Array.isArray(e)?l:oe(e).length},b.LINEST=ht,b.LN=function(e){return(e=L(e))instanceof Error?e:e===0?f:Math.log(e)},b.LOG=function(e,t){return U(e=L(e),t=L(t))||(e===0||t===0?f:Math.log(e)/Math.log(t))},b.LOG10=function(e){return(e=L(e))instanceof Error?e:e===0?f:Math.log(e)/Math.log(10)},b.LOGEST=function(e,t){if(B(e=X(F(e)),t=X(F(t)))||e.length!==t.length)return l;for(let u=0;u<e.length;u++)e[u]=Math.log(e[u]);const n=ht(e,t);return n[0]=Math.round(1e6*Math.exp(n[0]))/1e6,n[1]=Math.round(1e6*Math.exp(n[1]))/1e6,n},b.LOGINV=Wo,b.LOGNORM=ze,b.LOGNORMDIST=Xo,b.LOGNORMINV=Go,b.LOOKUP=function(e,t,n){t=F(t),n=n?F(n):t;const u=typeof e=="number";let v=h;for(let I=0;I<t.length;I++){if(t[I]===e)return n[I];if(u&&t[I]<=e||typeof t[I]=="string"&&t[I].localeCompare(e)<0)v=n[I];else if(u&&t[I]>e)return v}return v},b.LOWER=function(e){return arguments.length!==1?l:B(e=oe(e))?e:e.toLowerCase()},b.MATCH=function(e,t,n){if(!e||!t||(arguments.length===2&&(n=1),!((t=F(t))instanceof Array))||n!==-1&&n!==0&&n!==1)return h;let u,v;for(let I=0;I<t.length;I++)if(n===1){if(t[I]===e)return I+1;t[I]<e&&(v?t[I]>v&&(u=I+1,v=t[I]):(u=I+1,v=t[I]))}else if(n===0){if(typeof e=="string"&&typeof t[I]=="string"){const R=e.toLowerCase().replace(/\?/g,".").replace(/\*/g,".*").replace(/~/g,"\\");if(new RegExp("^"+R+"$").test(t[I].toLowerCase()))return I+1}else if(t[I]===e)return I+1}else if(n===-1){if(t[I]===e)return I+1;t[I]>e&&(v?t[I]<v&&(u=I+1,v=t[I]):(u=I+1,v=t[I]))}return u||h},b.MAX=mt,b.MAXA=function(){const e=F(arguments),t=U.apply(void 0,e);if(t)return t;let n=M(e);return n=n.map(u=>u??0),n.length===0?0:Math.max.apply(Math,n)},b.MDURATION=function(){throw new Error("MDURATION is not implemented")},b.MEDIAN=Yt,b.MID=function(e,t,n){if(t==null)return l;if(B(t=L(t),n=L(n))||typeof e!="string")return n;const u=t-1,v=u+n;return e.substring(u,v)},b.MIN=vt,b.MINA=function(){const e=F(arguments),t=U.apply(void 0,e);if(t)return t;let n=M(e);return n=n.map(u=>u??0),n.length===0?0:Math.min.apply(Math,n)},b.MINUTE=function(e){return(e=J(e))instanceof Error?e:e.getMinutes()},b.MIRR=function(e,t,n){if(B(e=X(F(e)),t=L(t),n=L(n)))return l;const u=e.length,v=[],I=[];for(let V=0;V<u;V++)e[V]<0?v.push(e[V]):I.push(e[V]);const R=-Ot(n,I)*Math.pow(1+n,u-1),H=Ot(t,v)*(1+t);return Math.pow(R/H,1/(u-1))-1},b.MMULT=function(e,t){return!Array.isArray(e)||!Array.isArray(t)||e.some(n=>!n.length)||t.some(n=>!n.length)||P(e).some(n=>typeof n!="number")||P(t).some(n=>typeof n!="number")||e[0].length!==t.length?l:Array(e.length).fill(0).map(()=>Array(t[0].length).fill(0)).map((n,u)=>n.map((v,I)=>e[u].reduce((R,H,V)=>R+H*t[V][I],0)))},b.MOD=function(e,t){const n=U(e=L(e),t=L(t));if(n)return n;if(t===0)return d;let u=Math.abs(e%t);return u=e<0?t-u:u,t>0?u:-u},b.MODE=Ge,b.MODEMULT=Ko,b.MODESNGL=$o,b.MONTH=function(e){return(e=J(e))instanceof Error?e:e.getMonth()+1},b.MROUND=function(e,t){return U(e=L(e),t=L(t))||(e*t==0?0:e*t<0?f:Math.round(e/t)*t)},b.MULTINOMIAL=function(){const e=X(F(arguments));if(e instanceof Error)return e;let t=0,n=1;for(let u=0;u<e.length;u++)t+=e[u],n*=Re(e[u]);return Re(t)/n},b.MUNIT=function(e){return arguments.length>1?h:!(e=parseInt(e))||e<=0?l:Array(e).fill(0).map(()=>Array(e).fill(0)).map((t,n)=>(t[n]=1,t))},b.N=function(e){return et(e)?e:e instanceof Date?e.getTime():e===!0?1:e===!1?0:Ze(e)?e:0},b.NA=function(){return h},b.NEGBINOM=Wt,b.NEGBINOMDIST=Jo,b.NETWORKDAYS=it,b.NETWORKDAYSINTL=Qo,b.NOMINAL=function(e,t){return B(e=L(e),t=L(t))?l:e<=0||t<1?f:(t=parseInt(t,10),(Math.pow(e+1,1/t)-1)*t)},b.NORM=Me,b.NORMDIST=Zo,b.NORMINV=en,b.NORMSDIST=tn,b.NORMSINV=on,b.NOT=function(e){return typeof e=="string"?l:e instanceof Error?e:!e},b.NOW=function(){return new Date},b.NPER=function(e,t,n,u,v){if(v=v===void 0?0:v,u=u===void 0?0:u,B(e=L(e),t=L(t),n=L(n),u=L(u),v=L(v)))return l;if(e===0)return-(n+u)/t;{const I=t*(1+e*v)-u*e,R=n*e+t*(1+e*v);return Math.log(I/R)/Math.log(1+e)}},b.NPV=Ot,b.NUMBERVALUE=function(e,t,n){return typeof(e=ue(e)?e:"")=="number"?e:typeof e!="string"?h:(t=t===void 0?".":t,n=n===void 0?",":n,Number(e.replace(t,".").replace(n,"")))},b.OCT2BIN=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return f;const n=!(e.length!==10||e.substring(0,1)!=="7"),u=n?parseInt(e,8)-1073741824:parseInt(e,8);if(u<-512||u>511)return f;if(n)return"1"+ye("0",9-(512+u).toString(2).length)+(512+u).toString(2);const v=u.toString(2);return t===void 0?v:isNaN(t)?l:t<0?f:(t=Math.floor(t))>=v.length?ye("0",t-v.length)+v:f},b.OCT2DEC=function(e){if(!/^[0-7]{1,10}$/.test(e))return f;const t=parseInt(e,8);return t>=536870912?t-1073741824:t},b.OCT2HEX=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return f;const n=parseInt(e,8);if(n>=536870912)return"ff"+(n+3221225472).toString(16);const u=n.toString(16);return t===void 0?u:isNaN(t)?l:t<0?f:(t=Math.floor(t))>=u.length?ye("0",t-u.length)+u:f},b.ODD=function(e){if((e=L(e))instanceof Error)return e;let t=Math.ceil(Math.abs(e));return t=1&t?t:t+1,e>=0?t:-t},b.ODDFPRICE=function(){throw new Error("ODDFPRICE is not implemented")},b.ODDFYIELD=function(){throw new Error("ODDFYIELD is not implemented")},b.ODDLPRICE=function(){throw new Error("ODDLPRICE is not implemented")},b.ODDLYIELD=function(){throw new Error("ODDLYIELD is not implemented")},b.OR=function(){const e=F(arguments);let t=l;for(let n=0;n<e.length;n++){if(e[n]instanceof Error)return e[n];e[n]!==void 0&&e[n]!==null&&typeof e[n]!="string"&&(t===l&&(t=!1),e[n]&&(t=!0))}return t},b.PDURATION=function(e,t,n){return B(e=L(e),t=L(t),n=L(n))?l:e<=0?f:(Math.log(n)-Math.log(t))/Math.log(1+e)},b.PEARSON=Xt,b.PERCENTILE=Ie,b.PERCENTILEEXC=nn,b.PERCENTILEINC=rn,b.PERCENTRANK=yt,b.PERCENTRANKEXC=ln,b.PERCENTRANKINC=sn,b.PERMUT=function(e,t){return B(e=L(e),t=L(t))?l:Re(e)/Re(e-t)},b.PERMUTATIONA=function(e,t){return B(e=L(e),t=L(t))?l:Math.pow(e,t)},b.PHI=function(e){return(e=L(e))instanceof Error?l:Math.exp(-.5*e*e)/2.5066282746310002},b.PI=function(){return Math.PI},b.PMT=Qe,b.POISSON=Gt,b.POISSONDIST=an,b.POWER=Zt,b.PPMT=function(e,t,n,u,v,I){return v=v||0,I=I||0,B(e=L(e),n=L(n),u=L(u),v=L(v),I=L(I))?l:Qe(e,n,u,v,I)-ao(e,t,n,u,v,I)},b.PRICE=function(){throw new Error("PRICE is not implemented")},b.PRICEDISC=function(e,t,n,u,v){if(B(e=J(e),t=J(t),n=L(n),u=L(u),v=(v=L(v))||0))return l;if(n<=0||u<=0)return f;if(e>=t)return l;let I,R;switch(v){case 0:I=360,R=Oe(e,t,!1);break;case 1:case 3:I=365,R=Je(e,t,"D");break;case 2:I=360,R=Je(e,t,"D");break;case 4:I=360,R=Oe(e,t,!0);break;default:return f}return u-n*u*R/I},b.PRICEMAT=function(){throw new Error("PRICEMAT is not implemented")},b.PROB=function(e,t,n,u){if(n===void 0)return 0;if(u=u===void 0?n:u,B(e=X(F(e)),t=X(F(t)),n=L(n),u=L(u)))return l;if(n===u)return e.indexOf(n)>=0?t[e.indexOf(n)]:0;const v=e.sort((H,V)=>H-V),I=v.length;let R=0;for(let H=0;H<I;H++)v[H]>=n&&v[H]<=u&&(R+=t[e.indexOf(v[H])]);return R},b.PRODUCT=At,b.PRONETIC=function(){throw new Error("PRONETIC is not implemented")},b.PROPER=function(e){return B(e)?e:isNaN(e)&&typeof e=="number"?l:(e=oe(e)).replace(/\w\S*/g,t=>t.charAt(0).toUpperCase()+t.substr(1).toLowerCase())},b.PV=function(e,t,n,u,v){return u=u||0,v=v||0,B(e=L(e),t=L(t),n=L(n),u=L(u),v=L(v))?l:e===0?-n*t-u:((1-Math.pow(1+e,t))/e*n*(1+e*v)-u)/Math.pow(1+e,t)},b.QUARTILE=Ke,b.QUARTILEEXC=un,b.QUARTILEINC=cn,b.QUOTIENT=function(e,t){return U(e=L(e),t=L(t))||parseInt(e/t,10)},b.RADIANS=function(e){return(e=L(e))instanceof Error?e:e*Math.PI/180},b.RAND=function(){return Math.random()},b.RANDBETWEEN=function(e,t){return U(e=L(e),t=L(t))||e+Math.ceil((t-e+1)*Math.random())-1},b.RANK=$e,b.RANKAVG=fn,b.RANKEQ=dn,b.RATE=function(e,t,n,u,v,I){if(I=I===void 0?.01:I,u=u===void 0?0:u,v=v===void 0?0:v,B(e=L(e),t=L(t),n=L(n),u=L(u),v=L(v),I=L(I)))return l;const R=1e-10;let H=I;v=v?1:0;for(let V=0;V<20;V++){if(H<=-1)return f;let Y,G,Q;if(Math.abs(H)<R?Y=n*(1+e*H)+t*(1+H*v)*e+u:(G=Math.pow(1+H,e),Y=n*G+t*(1/H+v)*(G-1)+u),Math.abs(Y)<R)return H;if(Math.abs(H)<R)Q=n*e+t*v*e;else{G=Math.pow(1+H,e);const K=e*Math.pow(1+H,e-1);Q=n*K+t*(1/H+v)*K+t*(-1/(H*H))*(G-1)}H-=Y/Q}return H},b.RECEIVED=function(){throw new Error("RECEIVED is not implemented")},b.REPLACE=function(e,t,n,u){return B(t=L(t),n=L(n))||typeof e!="string"||typeof u!="string"?l:e.substr(0,t-1)+u+e.substr(t-1+n)},b.REPT=ye,b.RIGHT=function(e,t){return U(e,t)||(e=oe(e),(t=L(t=t===void 0?1:t))instanceof Error?t:e.substring(e.length-t))},b.ROMAN=function(e){if((e=L(e))instanceof Error)return e;const t=String(e).split(""),n=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"];let u="",v=3;for(;v--;)u=(n[+t.pop()+10*v]||"")+u;return new Array(+t.join("")+1).join("M")+u},b.ROUND=De,b.ROUNDDOWN=function(e,t){return U(e=L(e),t=L(t))||(e>0?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},b.ROUNDUP=function(e,t){return U(e=L(e),t=L(t))||(e>0?1:-1)*Math.ceil(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},b.ROW=function(e,t){return arguments.length!==2?h:t<0?f:e instanceof Array&&typeof t=="number"?e.length!==0?g.row(e,t):void 0:l},b.ROWS=function(e){return arguments.length!==1?h:e instanceof Array?e.length===0?0:g.rows(e):l},b.RRI=function(e,t,n){return B(e=L(e),t=L(t),n=L(n))?l:e===0||t===0?f:Math.pow(n/t,1/e)-1},b.RSQ=function(e,t){return B(e=X(F(e)),t=X(F(t)))?l:Math.pow(Xt(e,t),2)},b.SEARCH=function(e,t,n){let u;return typeof e!="string"||typeof t!="string"?l:(n=n===void 0?0:n,u=t.toLowerCase().indexOf(e.toLowerCase(),n-1)+1,u===0?l:u)},b.SEC=function(e){return(e=L(e))instanceof Error?e:1/Math.cos(e)},b.SECH=function(e){return(e=L(e))instanceof Error?e:2/(Math.exp(e)+Math.exp(-e))},b.SECOND=function(e){return(e=J(e))instanceof Error?e:e.getSeconds()},b.SERIESSUM=function(e,t,n,u){if(B(e=L(e),t=L(t),n=L(n),u=X(u)))return l;let v=u[0]*Math.pow(e,t);for(let I=1;I<u.length;I++)v+=u[I]*Math.pow(e,t+I*n);return v},b.SHEET=function(){throw new Error("SHEET is not implemented")},b.SHEETS=function(){throw new Error("SHEETS is not implemented")},b.SIGN=function(e){return(e=L(e))instanceof Error?e:e<0?-1:e===0?0:1},b.SIN=function(e){return(e=L(e))instanceof Error?e:Math.sin(e)},b.SINH=function(e){return(e=L(e))instanceof Error?e:(Math.exp(e)-Math.exp(-e))/2},b.SKEW=Ct,b.SKEWP=pn,b.SLN=function(e,t,n){return B(e=L(e),t=L(t),n=L(n))?l:n===0?f:(e-t)/n},b.SLOPE=function(e,t){if(B(e=X(F(e)),t=X(F(t))))return l;const n=g.mean(t),u=g.mean(e),v=t.length;let I=0,R=0;for(let H=0;H<v;H++)I+=(t[H]-n)*(e[H]-u),R+=Math.pow(t[H]-n,2);return I/R},b.SMALL=Kt,b.SORT=function(e,t=1,n=1,u=!1){if(!e||!Array.isArray(e))return h;if(e.length===0)return 0;if(!(t=L(t))||t<1||(n=L(n))!==1&&n!==-1)return l;if(typeof(u=ee(u))!="boolean")return j;const v=H=>H.sort((V,Y)=>(V=oe(V[t-1]),Y=oe(Y[t-1]),n===1?V<Y?-1*n:n:V>Y?n:-1*n)),I=k(e),R=u?z(I):I;return t>=1&&t<=R[0].length?u?z(v(R)):v(R):l},b.SQRT=function(e){return(e=L(e))instanceof Error?e:e<0?f:Math.sqrt(e)},b.SQRTPI=function(e){return(e=L(e))instanceof Error?e:Math.sqrt(e*Math.PI)},b.STANDARDIZE=function(e,t,n){return B(e=L(e),t=L(t),n=L(n))?l:(e-t)/n},b.STDEV=Se,b.STDEVA=function(){const e=$t.apply(this,arguments);return Math.sqrt(e)},b.STDEVP=bn,b.STDEVPA=function(){const e=Jt.apply(this,arguments);let t=Math.sqrt(e);return isNaN(t)&&(t=f),t},b.STDEVS=jn,b.STEYX=function(e,t){if(B(e=X(F(e)),t=X(F(t))))return l;const n=g.mean(t),u=g.mean(e),v=t.length;let I=0,R=0,H=0;for(let V=0;V<v;V++)I+=Math.pow(e[V]-u,2),R+=(t[V]-n)*(e[V]-u),H+=Math.pow(t[V]-n,2);return Math.sqrt((I-R*R/H)/(v-2))},b.SUBSTITUTE=function(e,t,n,u){if(arguments.length<3)return h;if(e&&t){if(u===void 0)return e.split(t).join(n);{if(u=Math.floor(Number(u)),Number.isNaN(u)||u<=0)return l;let v=0,I=0;for(;v>-1&&e.indexOf(t,v)>-1;)if(v=e.indexOf(t,v+1),I++,v>-1&&I===u)return e.substring(0,v)+n+e.substring(v+t.length);return e}}return e},b.SUBTOTAL=function(e,t){if((e=L(e))instanceof Error)return e;switch(e){case 1:case 101:return Ue(t);case 2:case 102:return tt(t);case 3:case 103:return ot(t);case 4:case 104:return mt(t);case 5:case 105:return vt(t);case 6:case 106:return At(t);case 7:case 107:return Se.S(t);case 8:case 108:return Se.P(t);case 9:case 109:return Pe(t);case 10:case 110:return ve.S(t);case 11:case 111:return ve.P(t)}},b.SUM=Pe,b.SUMIF=function(e,t,n){if(e=F(e),n=n?F(n):e,e instanceof Error)return e;if(t==null||t instanceof Error)return 0;let u=0;const v=t==="*",I=v?null:Fe(t+"");for(let R=0;R<e.length;R++){const H=e[R],V=n[R];if(v)u+=H;else{const Y=[me(H,be)].concat(I);u+=xe(Y)?V:0}}return u},b.SUMIFS=function(){const e=E(arguments),t=X(F(e.shift()));if(t instanceof Error)return t;const n=e,u=n.length/2;for(let I=0;I<u;I++)n[2*I]=F(n[2*I]);let v=0;for(let I=0;I<t.length;I++){let R=!1;for(let H=0;H<u;H++){const V=n[2*H][I],Y=n[2*H+1];let G=!1;if(Y===void 0||Y==="*")G=!0;else{const Q=Fe(Y+""),K=[me(V,be)].concat(Q);G=xe(K)}if(!G){R=!1;break}R=!0}R&&(v+=t[I])}return v},b.SUMPRODUCT=function(){if(!arguments||arguments.length===0)return l;const e=arguments.length+1;let t,n,u,v,I=0;for(let R=0;R<arguments[0].length;R++)if(arguments[0][R]instanceof Array)for(let H=0;H<arguments[0][R].length;H++){for(t=1,n=1;n<e;n++){const V=arguments[n-1][R][H];if(V instanceof Error)return V;if(v=L(V),v instanceof Error)return v;t*=v}I+=t}else{for(t=1,n=1;n<e;n++){const H=arguments[n-1][R];if(H instanceof Error)return H;if(u=L(H),u instanceof Error)return u;t*=u}I+=t}return I},b.SUMSQ=function(){const e=X(F(arguments));if(e instanceof Error)return e;let t=0;const n=e.length;for(let u=0;u<n;u++)t+=et(e[u])?e[u]*e[u]:0;return t},b.SUMX2MY2=function(e,t){if(B(e=X(F(e)),t=X(F(t))))return l;let n=0;for(let u=0;u<e.length;u++)n+=e[u]*e[u]-t[u]*t[u];return n},b.SUMX2PY2=function(e,t){if(B(e=X(F(e)),t=X(F(t))))return l;let n=0;e=X(F(e)),t=X(F(t));for(let u=0;u<e.length;u++)n+=e[u]*e[u]+t[u]*t[u];return n},b.SUMXMY2=function(e,t){if(B(e=X(F(e)),t=X(F(t))))return l;let n=0;e=F(e),t=F(t);for(let u=0;u<e.length;u++)n+=Math.pow(e[u]-t[u],2);return n},b.SWITCH=function(){let e;if(arguments.length>0){const t=arguments[0],n=arguments.length-1,u=Math.floor(n/2);let v=!1;const I=n%2!=0,R=n%2==0?null:arguments[arguments.length-1];if(u){for(let H=0;H<u;H++)if(t===arguments[2*H+1]){e=arguments[2*H+2],v=!0;break}}v||(e=I?R:h)}else e=l;return e},b.SYD=function(e,t,n,u){return B(e=L(e),t=L(t),n=L(n),u=L(u))?l:n===0||u<1||u>n?f:(e-t)*(n-(u=parseInt(u,10))+1)*2/(n*(n+1))},b.T=function(e){return e instanceof Error||typeof e=="string"?e:""},b.TAN=function(e){return(e=L(e))instanceof Error?e:Math.tan(e)},b.TANH=function(e){if((e=L(e))instanceof Error)return e;const t=Math.exp(2*e);return(t-1)/(t+1)},b.TBILLEQ=function(e,t,n){return B(e=J(e),t=J(t),n=L(n))?l:n<=0||e>t||t-e>31536e6?f:365*n/(360-n*Oe(e,t,!1))},b.TBILLPRICE=function(e,t,n){return B(e=J(e),t=J(t),n=L(n))?l:n<=0||e>t||t-e>31536e6?f:100*(1-n*Oe(e,t,!1)/360)},b.TBILLYIELD=function(e,t,n){return B(e=J(e),t=J(t),n=L(n))?l:n<=0||e>t||t-e>31536e6?f:360*(100-n)/(n*Oe(e,t,!1))},b.TDIST=gn,b.TDISTRT=hn,b.TEXT=function(e,t){if(e===void 0||e instanceof Error||t instanceof Error)return h;if(t==null)return"";if(typeof t=="number")return String(t);if(typeof t!="string")return l;const n=t.startsWith("$")?"$":"",u=t.endsWith("%");return u&&(e*=100),e=(e=lo(e,(t=t.replace(/%/g,"").replace(/\$/g,"")).split(".")[1].match(/0/g).length,!t.includes(","))).startsWith("-")?"-"+n+(e=e.replace("-","")):n+e,u&&(e+="%"),e},b.TEXTJOIN=function(e,t,...n){if(typeof t!="boolean"&&(t=ee(t)),arguments.length<3)return h;e=e??"";let u=F(n),v=t?u.filter(I=>I):u;if(Array.isArray(e)){e=F(e);let I=v.map(H=>[H]),R=0;for(let H=0;H<I.length-1;H++)I[H].push(e[R]),R++,R===e.length&&(R=0);return v=F(I),v.join("")}return v.join(e)},b.TIME=function(e,t,n){return B(e=L(e),t=L(t),n=L(n))?l:e<0||t<0||n<0?f:(3600*e+60*t+n)/86400},b.TIMEVALUE=function(e){return(e=J(e))instanceof Error?e:(3600*e.getHours()+60*e.getMinutes()+e.getSeconds())/86400},b.TINV=mn,b.TODAY=function(){return lt(new Date)},b.TRANSPOSE=function(e){return e?z(k(e)):h},b.TREND=function(e,t,n){if(B(e=X(F(e)),t=X(F(t)),n=X(F(n))))return l;const u=ht(e,t),v=u[0],I=u[1],R=[];return n.forEach(H=>{R.push(v*H+I)}),R},b.TRIM=function(e){return(e=oe(e))instanceof Error?e:e.replace(/\s+/g," ").trim()},b.TRIMMEAN=function(e,t){if(B(e=X(F(e)),t=L(t)))return l;const n=Be(e.length*t,2)/2;return g.mean((v=(v=n)||1,(u=_(e.sort((I,R)=>I-R),n))&&typeof u.slice=="function"?u.slice(0,u.length-v):u));var u,v},b.TRUE=function(){return!0},b.TRUNC=function(e,t){return U(e=L(e),t=L(t))||(e>0?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},b.TTEST=vn,b.TYPE=function(e){return et(e)?1:Pt(e)?2:Bt(e)?4:Ze(e)?16:Array.isArray(e)?64:void 0},b.UNICHAR=go,b.UNICODE=ho,b.UNIQUE=ft,b.UPPER=function(e){return(e=oe(e))instanceof Error?e:e.toUpperCase()},b.VALUE=function(e){const t=U(e);if(t)return t;if(typeof e=="number")return e;if(ue(e)||(e=""),typeof e!="string")return l;const n=/(%)$/.test(e)||/^(%)/.test(e);if((e=(e=(e=e.replace(/^[^0-9-]{0,3}/,"")).replace(/[^0-9]{0,3}$/,"")).replace(/[ ,]/g,""))==="")return 0;let u=Number(e);return isNaN(u)?l:(u=u||0,n&&(u*=.01),u)},b.VAR=ve,b.VARA=$t,b.VARP=yn,b.VARPA=Jt,b.VARS=Cn,b.VDB=function(){throw new Error("VDB is not implemented")},b.VLOOKUP=_t,b.WEEKDAY=function(e,t){if((e=J(e))instanceof Error)return e;t===void 0&&(t=1);const n=e.getDay();return bo[t][n]},b.WEEKNUM=function(e,t){if((e=J(e))instanceof Error)return e;if(t===void 0&&(t=1),t===21)return eo(e);const n=po[t];let u=new Date(e.getFullYear(),0,1);const v=u.getDay()<n?1:0;return u-=24*Math.abs(u.getDay()-n)*60*60*1e3,Math.floor((e-u)/864e5/7+1)+v},b.WEIBULL=Qt,b.WEIBULLDIST=xn,b.WORKDAY=st,b.WORKDAYINTL=wn,b.XIRR=function(e,t,n){if(B(e=X(F(e)),t=de(F(t)),n=L(n)))return l;const u=(K,te,re)=>{const le=re+1;let he=K[0];for(let fe=1;fe<K.length;fe++)he+=K[fe]/Math.pow(le,_e(te[fe],te[0])/365);return he},v=(K,te,re)=>{const le=re+1;let he=0;for(let fe=1;fe<K.length;fe++){const ke=_e(te[fe],te[0])/365;he-=ke*K[fe]/Math.pow(le,ke+1)}return he};let I=!1,R=!1;for(let K=0;K<e.length;K++)e[K]>0&&(I=!0),e[K]<0&&(R=!0);if(!I||!R)return f;let H,V,Y,G=n=n||.1,Q=!0;do Y=u(e,t,G),H=G-Y/v(e,t,G),V=Math.abs(H-G),G=H,Q=V>1e-10&&Math.abs(Y)>1e-10;while(Q);return G},b.XNPV=function(e,t,n){if(B(e=L(e),t=X(F(t)),n=de(F(n))))return l;let u=0;for(let v=0;v<t.length;v++)u+=t[v]/Math.pow(1+e,_e(n[v],n[0])/365);return u},b.XOR=function(){const e=F(arguments);let t=l;for(let n=0;n<e.length;n++){if(e[n]instanceof Error)return e[n];e[n]!==void 0&&e[n]!==null&&typeof e[n]!="string"&&(t===l&&(t=0),e[n]&&t++)}return t===l?t:!!(1&Math.floor(Math.abs(t)))},b.YEAR=function(e){return(e=J(e))instanceof Error?e:e.getFullYear()},b.YEARFRAC=Mt,b.YIELD=function(){throw new Error("YIELD is not implemented")},b.YIELDDISC=function(){throw new Error("YIELDDISC is not implemented")},b.YIELDMAT=function(){throw new Error("YIELDMAT is not implemented")},b.Z=xt,b.ZTEST=An,b.utils=En}},c={};function m(O){var b=c[O];if(b!==void 0)return b.exports;var s=c[O]={exports:{}};return a[O].call(s.exports,s,s.exports,m),s.exports}m.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}();var N=m(960);r=N}(),r)},44:function(module,__unused_webpack_exports,__webpack_require__){if(!formula)var formula=__webpack_require__(463);var factory;factory=function(){"use strict";var Version=(info={title:"Jspreadsheet",version:"4.15.0",type:"CE",host:"https://bossanova.uk/jspreadsheet",license:"MIT",print:function(){return[this.title+" "+this.type+" "+this.version,this.host,this.license].join(`\r
`)}},function(){return info}),info,isFormula=function(o){var r=(""+o)[0];return r=="="||r=="#"},getMask=function(o){if(o.format||o.mask||o.locale){var r={};return o.mask?r.mask=o.mask:o.format?r.mask=o.format:(r.locale=o.locale,r.options=o.options),o.decimal&&(r.options||(r.options={}),r.options={decimal:o.decimal}),r}return null},jexcel=function(el,options){var obj={options:{}};if(!(el instanceof Element||el instanceof HTMLDocument))return console.error("Jspreadsheet: el is not a valid DOM element"),!1;if(el.tagName=="TABLE"){if(!(options=jexcel.createFromTable(el,options)))return console.error("Jspreadsheet: el is not a valid DOM element"),!1;var div=document.createElement("div");el.parentNode.insertBefore(div,el),el.remove(),el=div}var defaults={url:null,method:"GET",requestVariables:null,data:null,sorting:null,copyCompatibility:!1,root:null,rows:[],columns:[],colHeaders:[],colWidths:[],colAlignments:[],nestedHeaders:null,defaultColWidth:50,defaultColAlign:"center",defaultRowHeight:null,minSpareRows:0,minSpareCols:0,minDimensions:[0,0],allowExport:!0,includeHeadersOnDownload:!1,includeHeadersOnCopy:!1,columnSorting:!0,columnDrag:!1,columnResize:!0,rowResize:!1,rowDrag:!0,editable:!0,allowInsertRow:!0,allowManualInsertRow:!0,allowInsertColumn:!0,allowManualInsertColumn:!0,allowDeleteRow:!0,allowDeletingAllRows:!1,allowDeleteColumn:!0,allowRenameColumn:!0,allowComments:!1,wordWrap:!1,imageOptions:null,csv:null,csvFileName:"jspreadsheet",csvHeaders:!0,csvDelimiter:",",parseTableFirstRowAsHeader:!1,parseTableAutoCellType:!1,selectionCopy:!0,mergeCells:{},toolbar:null,search:!1,pagination:!1,paginationOptions:null,fullscreen:!1,lazyLoading:!1,loadingSpin:!1,tableOverflow:!1,tableHeight:"300px",tableWidth:null,textOverflow:!1,meta:null,style:null,classes:null,parseFormulas:!0,autoIncrement:!0,autoCasting:!0,secureFormulas:!0,stripHTML:!0,stripHTMLOnCopy:!1,filters:!1,footers:null,onundo:null,onredo:null,onload:null,onchange:null,oncomments:null,onbeforechange:null,onafterchanges:null,onbeforeinsertrow:null,oninsertrow:null,onbeforeinsertcolumn:null,oninsertcolumn:null,onbeforedeleterow:null,ondeleterow:null,onbeforedeletecolumn:null,ondeletecolumn:null,onmoverow:null,onmovecolumn:null,onresizerow:null,onresizecolumn:null,onsort:null,onselection:null,oncopy:null,onpaste:null,onbeforepaste:null,onmerge:null,onfocus:null,onblur:null,onchangeheader:null,oncreateeditor:null,oneditionstart:null,oneditionend:null,onchangestyle:null,onchangemeta:null,onchangepage:null,onbeforesave:null,onsave:null,onevent:null,persistance:!1,updateTable:null,detachForUpdates:!1,freezeColumns:null,text:{noRecordsFound:"No records found",showingPage:"Showing page {0} of {1} entries",show:"Show ",search:"Search",entries:" entries",columnName:"Column name",insertANewColumnBefore:"Insert a new column before",insertANewColumnAfter:"Insert a new column after",deleteSelectedColumns:"Delete selected columns",renameThisColumn:"Rename this column",orderAscending:"Order ascending",orderDescending:"Order descending",insertANewRowBefore:"Insert a new row before",insertANewRowAfter:"Insert a new row after",deleteSelectedRows:"Delete selected rows",editComments:"Edit comments",addComments:"Add comments",comments:"Comments",clearComments:"Clear comments",copy:"Copy...",paste:"Paste...",saveAs:"Save as...",about:"About",areYouSureToDeleteTheSelectedRows:"Are you sure to delete the selected rows?",areYouSureToDeleteTheSelectedColumns:"Are you sure to delete the selected columns?",thisActionWillDestroyAnyExistingMergedCellsAreYouSure:"This action will destroy any existing merged cells. Are you sure?",thisActionWillClearYourSearchResultsAreYouSure:"This action will clear your search results. Are you sure?",thereIsAConflictWithAnotherMergedCell:"There is a conflict with another merged cell",invalidMergeProperties:"Invalid merged properties",cellAlreadyMerged:"Cell already merged",noCellsSelected:"No cells selected"},about:!0};for(var property in defaults)if(options&&options.hasOwnProperty(property))if(property==="text")for(var textKey in obj.options[property]=defaults[property],options[property])options[property].hasOwnProperty(textKey)&&(obj.options[property][textKey]=options[property][textKey]);else obj.options[property]=options[property];else obj.options[property]=defaults[property];obj.el=el,obj.corner=null,obj.contextMenu=null,obj.textarea=null,obj.ads=null,obj.content=null,obj.table=null,obj.thead=null,obj.tbody=null,obj.rows=[],obj.results=null,obj.searchInput=null,obj.toolbar=null,obj.pagination=null,obj.pageNumber=null,obj.headerContainer=null,obj.colgroupContainer=null,obj.headers=[],obj.records=[],obj.history=[],obj.formula=[],obj.colgroup=[],obj.selection=[],obj.highlighted=[],obj.selectedCell=null,obj.selectedContainer=null,obj.style=[],obj.data=null,obj.filter=null,obj.filters=[],obj.cursor=null,obj.historyIndex=-1,obj.ignoreEvents=!1,obj.ignoreHistory=!1,obj.edition=null,obj.hashString=null,obj.resizing=null,obj.dragging=null,obj.options.lazyLoading==1&&obj.options.tableOverflow==0&&obj.options.fullscreen==0&&(console.error("Jspreadsheet: The lazyloading only works when tableOverflow = yes or fullscreen = yes"),obj.options.lazyLoading=!1),obj.fullscreen=function(o){o==null&&(o=!obj.options.fullscreen),obj.options.fullscreen!=o&&(obj.options.fullscreen=o,o==1?el.classList.add("fullscreen"):el.classList.remove("fullscreen"))},obj.dispatch=function(o){if(!obj.ignoreEvents){if(typeof obj.options.onevent=="function")var r=obj.options.onevent.apply(this,arguments);typeof obj.options[o]=="function"&&(r=obj.options[o].apply(this,Array.prototype.slice.call(arguments,1)))}if(o=="onafterchanges"&&obj.options.persistance){var a=obj.options.persistance==1?obj.options.url:obj.options.persistance,c=obj.prepareJson(arguments[2]);obj.save(a,c)}return r},obj.prepareTable=function(){var o=obj.options.columns.length;if(obj.options.data&&obj.options.data[0]!==void 0){var r=Object.keys(obj.options.data[0]);r.length>o&&(o=r.length)}obj.options.minDimensions[0]>o&&(o=obj.options.minDimensions[0]);for(var a=[],c=0;c<o;c++)obj.options.colHeaders[c]||(obj.options.colHeaders[c]=""),obj.options.colWidths[c]||(obj.options.colWidths[c]=obj.options.defaultColWidth),obj.options.colAlignments[c]||(obj.options.colAlignments[c]=obj.options.defaultColAlign),obj.options.columns[c]?obj.options.columns[c].type||(obj.options.columns[c].type="text"):obj.options.columns[c]={type:"text"},obj.options.columns[c].name||(obj.options.columns[c].name=r&&r[c]?r[c]:c),obj.options.columns[c].source||(obj.options.columns[c].source=[]),obj.options.columns[c].options||(obj.options.columns[c].options=[]),obj.options.columns[c].editor||(obj.options.columns[c].editor=null),obj.options.columns[c].allowEmpty||(obj.options.columns[c].allowEmpty=!1),obj.options.columns[c].title||(obj.options.columns[c].title=obj.options.colHeaders[c]?obj.options.colHeaders[c]:""),obj.options.columns[c].width||(obj.options.columns[c].width=obj.options.colWidths[c]?obj.options.colWidths[c]:obj.options.defaultColWidth),obj.options.columns[c].align||(obj.options.columns[c].align=obj.options.colAlignments[c]?obj.options.colAlignments[c]:"center"),obj.options.columns[c].type=="autocomplete"||obj.options.columns[c].type=="dropdown"?obj.options.columns[c].url&&a.push({url:obj.options.columns[c].url,index:c,method:"GET",dataType:"json",success:function(m){for(var N=0;N<m.length;N++)obj.options.columns[this.index].source.push(m[N])}}):obj.options.columns[c].type=="calendar"&&(obj.options.columns[c].options.format||(obj.options.columns[c].options.format="DD/MM/YYYY"));a.length?jSuites.ajax(a,function(){obj.createTable()}):obj.createTable()},obj.createTable=function(){obj.table=document.createElement("table"),obj.thead=document.createElement("thead"),obj.tbody=document.createElement("tbody"),obj.headers=[],obj.colgroup=[],obj.content=document.createElement("div"),obj.content.classList.add("jexcel_content"),obj.content.onscroll=function(j){obj.scrollControls(j)},obj.content.onwheel=function(j){obj.wheelControls(j)},obj.toolbar=document.createElement("div"),obj.toolbar.classList.add("jexcel_toolbar");var o=document.createElement("div"),r=document.createTextNode(obj.options.text.search+": ");obj.searchInput=document.createElement("input"),obj.searchInput.classList.add("jexcel_search"),o.appendChild(r),o.appendChild(obj.searchInput),obj.searchInput.onfocus=function(){obj.resetSelection()};var a=document.createElement("div");if(obj.options.pagination>0&&obj.options.paginationOptions&&obj.options.paginationOptions.length>0){obj.paginationDropdown=document.createElement("select"),obj.paginationDropdown.classList.add("jexcel_pagination_dropdown"),obj.paginationDropdown.onchange=function(){obj.options.pagination=parseInt(this.value),obj.page(0)};for(var c=0;c<obj.options.paginationOptions.length;c++){var m=document.createElement("option");m.value=obj.options.paginationOptions[c],m.innerHTML=obj.options.paginationOptions[c],obj.paginationDropdown.appendChild(m)}obj.paginationDropdown.value=obj.options.pagination,a.appendChild(document.createTextNode(obj.options.text.show)),a.appendChild(obj.paginationDropdown),a.appendChild(document.createTextNode(obj.options.text.entries))}var N,O=document.createElement("div");if(O.classList.add("jexcel_filter"),O.appendChild(a),O.appendChild(o),obj.colgroupContainer=document.createElement("colgroup"),(N=document.createElement("col")).setAttribute("width","50"),obj.colgroupContainer.appendChild(N),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(var b=0;b<obj.options.nestedHeaders.length;b++)obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders[b]));else obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders));for(obj.headerContainer=document.createElement("tr"),(N=document.createElement("td")).classList.add("jexcel_selectall"),obj.headerContainer.appendChild(N),c=0;c<obj.options.columns.length;c++)obj.createCellHeader(c),obj.headerContainer.appendChild(obj.headers[c]),obj.colgroupContainer.appendChild(obj.colgroup[c]);if(obj.thead.appendChild(obj.headerContainer),obj.options.filters==1){obj.filter=document.createElement("tr");var s=document.createElement("td");for(obj.filter.appendChild(s),c=0;c<obj.options.columns.length;c++)(s=document.createElement("td")).innerHTML="&nbsp;",s.setAttribute("data-x",c),s.className="jexcel_column_filter",obj.options.columns[c].type=="hidden"&&(s.style.display="none"),obj.filter.appendChild(s);obj.thead.appendChild(obj.filter)}obj.table=document.createElement("table"),obj.table.classList.add("jexcel"),obj.table.setAttribute("cellpadding","0"),obj.table.setAttribute("cellspacing","0"),obj.table.setAttribute("unselectable","yes"),obj.table.appendChild(obj.colgroupContainer),obj.table.appendChild(obj.thead),obj.table.appendChild(obj.tbody),obj.options.textOverflow||obj.table.classList.add("jexcel_overflow"),obj.corner=document.createElement("div"),obj.corner.className="jexcel_corner",obj.corner.setAttribute("unselectable","on"),obj.corner.setAttribute("onselectstart","return false"),obj.options.selectionCopy==0&&(obj.corner.style.display="none"),obj.textarea=document.createElement("textarea"),obj.textarea.className="jexcel_textarea",obj.textarea.id="jexcel_textarea",obj.textarea.tabIndex="-1",obj.contextMenu=document.createElement("div"),obj.contextMenu.className="jexcel_contextmenu",jSuites.contextmenu(obj.contextMenu,{onclick:function(){obj.contextMenu.contextmenu.close(!1)}});var g=document.createElement("a");g.setAttribute("href","https://bossanova.uk/jspreadsheet/"),obj.ads=document.createElement("div"),obj.ads.className="jexcel_about";var S=document.createElement("span");S.innerHTML="Jspreadsheet CE",g.appendChild(S),obj.ads.appendChild(g),document.createElement("div").classList.add("jexcel_table"),obj.pagination=document.createElement("div"),obj.pagination.classList.add("jexcel_pagination");var T=document.createElement("div"),d=document.createElement("div");if(obj.pagination.appendChild(T),obj.pagination.appendChild(d),obj.options.pagination||(obj.pagination.style.display="none"),obj.options.search==1&&el.appendChild(O),obj.content.appendChild(obj.table),obj.content.appendChild(obj.corner),obj.content.appendChild(obj.textarea),el.appendChild(obj.toolbar),el.appendChild(obj.content),el.appendChild(obj.pagination),el.appendChild(obj.contextMenu),el.appendChild(obj.ads),el.classList.add("jexcel_container"),obj.options.toolbar&&obj.options.toolbar.length&&obj.createToolbar(),obj.options.fullscreen==1?el.classList.add("fullscreen"):obj.options.tableOverflow==1&&(obj.options.tableHeight&&(obj.content.style["overflow-y"]="auto",obj.content.style["box-shadow"]="rgb(221 221 221) 2px 2px 5px 0.1px",obj.content.style.maxHeight=obj.options.tableHeight),obj.options.tableWidth&&(obj.content.style["overflow-x"]="auto",obj.content.style.width=obj.options.tableWidth)),obj.options.tableOverflow!=1&&obj.options.toolbar&&el.classList.add("with-toolbar"),obj.options.columnDrag==1&&obj.thead.classList.add("draggable"),obj.options.columnResize==1&&obj.thead.classList.add("resizable"),obj.options.rowDrag==1&&obj.tbody.classList.add("draggable"),obj.options.rowResize==1&&obj.tbody.classList.add("resizable"),obj.setData(),obj.options.style&&obj.setStyle(obj.options.style,null,null,1,1),obj.options.classes){var l=Object.keys(obj.options.classes);for(c=0;c<l.length;c++){var p=jexcel.getIdFromColumnName(l[c],!0);obj.records[p[1]][p[0]].classList.add(obj.options.classes[l[c]])}}},obj.refresh=function(){obj.options.url?(obj.options.loadingSpin==1&&jSuites.loading.show(),jSuites.ajax({url:obj.options.url,method:obj.options.method,data:obj.options.requestVariables,dataType:"json",success:function(o){obj.options.data=o.data?o.data:o,obj.setData(),obj.options.loadingSpin==1&&jSuites.loading.hide()}})):obj.setData()},obj.setData=function(o){if(o&&(typeof o=="string"&&(o=JSON.parse(o)),obj.options.data=o),obj.options.data||(obj.options.data=[]),obj.options.data&&obj.options.data[0]&&!Array.isArray(obj.options.data[0])){o=[];for(var r=0;r<obj.options.data.length;r++){for(var a=[],c=0;c<obj.options.columns.length;c++)a[c]=obj.options.data[r][obj.options.columns[c].name];o.push(a)}obj.options.data=o}r=0,c=0;var m=obj.options.columns.length,N=obj.options.data.length,O=obj.options.minDimensions[0],b=obj.options.minDimensions[1],s=O>m?O:m,g=b>N?b:N;for(r=0;r<g;r++)for(c=0;c<s;c++)obj.options.data[r]==null&&(obj.options.data[r]=[]),obj.options.data[r][c]==null&&(obj.options.data[r][c]="");if(obj.rows=[],obj.results=null,obj.records=[],obj.history=[],obj.historyIndex=-1,obj.tbody.innerHTML="",obj.options.lazyLoading==1){var S=0,T=obj.options.data.length<100?obj.options.data.length:100;obj.options.pagination&&(obj.options.pagination=!1,console.error("Jspreadsheet: Pagination will be disable due the lazyLoading"))}else obj.options.pagination?(obj.pageNumber||(obj.pageNumber=0),obj.options.pagination,S=obj.options.pagination*obj.pageNumber,T=obj.options.pagination*obj.pageNumber+obj.options.pagination,obj.options.data.length<T&&(T=obj.options.data.length)):(S=0,T=obj.options.data.length);for(r=0;r<obj.options.data.length;r++){var d=obj.createRow(r,obj.options.data[r]);r>=S&&r<T&&obj.tbody.appendChild(d)}if(obj.options.lazyLoading==1||obj.options.pagination&&obj.updatePagination(),obj.options.mergeCells){var l=Object.keys(obj.options.mergeCells);for(c=0;c<l.length;c++){var p=obj.options.mergeCells[l[c]];obj.setMerge(l[c],p[0],p[1],1)}}obj.updateTable(),obj.dispatch("onload",el,obj)},obj.getData=function(o,r){for(var a=[],c=0,m=0,N=r==1||obj.options.copyCompatibility==0,O=obj.options.columns.length,b=obj.options.data.length,s=0;s<b;s++){c=0;for(var g=0;g<O;g++)o&&!obj.records[s][g].classList.contains("highlight")||(a[m]||(a[m]=[]),a[m][c]=N?obj.options.data[s][g]:obj.records[s][g].innerHTML,c++);c>0&&m++}return a},obj.getJsonRow=function(o){for(var r=obj.options.data[o],a=obj.options.columns.length,c={},m=0;m<a;m++)obj.options.columns[m].name||(obj.options.columns[m].name=m),c[obj.options.columns[m].name]=r[m];return c},obj.getJson=function(o){for(var r=[],a=obj.options.columns.length,c=obj.options.data.length,m=0;m<c;m++){for(var N=null,O=0;O<a;O++)o&&!obj.records[m][O].classList.contains("highlight")||(N==null&&(N={}),obj.options.columns[O].name||(obj.options.columns[O].name=O),N[obj.options.columns[O].name]=obj.options.data[m][O]);N!=null&&r.push(N)}return r},obj.prepareJson=function(o){for(var r=[],a=0;a<o.length;a++){var c=o[a].x,m=o[a].y,N=obj.options.columns[c].name?obj.options.columns[c].name:c;r[m]||(r[m]={row:m,data:{}}),r[m].data[N]=o[a].newValue}return r.filter(function(O){return O!=null})},obj.save=function(o,r){var a=obj.dispatch("onbeforesave",el,obj,r);if(a)r=a;else if(a===!1)return!1;jSuites.ajax({url:o,method:"POST",dataType:"json",data:{data:JSON.stringify(r)},success:function(c){obj.dispatch("onsave",el,obj,r)}})},obj.getRowData=function(o){return obj.options.data[o]},obj.setRowData=function(o,r){for(var a=0;a<obj.headers.length;a++){var c=jexcel.getColumnNameFromId([a,o]);r[a]!=null&&obj.setValue(c,r[a])}},obj.getColumnData=function(o){for(var r=[],a=0;a<obj.options.data.length;a++)r.push(obj.options.data[a][o]);return r},obj.setColumnData=function(o,r){for(var a=0;a<obj.rows.length;a++){var c=jexcel.getColumnNameFromId([o,a]);r[a]!=null&&obj.setValue(c,r[a])}},obj.createRow=function(o,r){obj.records[o]||(obj.records[o]=[]),r||(r=obj.options.data[o]),obj.rows[o]=document.createElement("tr"),obj.rows[o].setAttribute("data-y",o);var a=null;obj.options.defaultRowHeight&&(obj.rows[o].style.height=obj.options.defaultRowHeight+"px"),obj.options.rows[o]&&(obj.options.rows[o].height&&(obj.rows[o].style.height=obj.options.rows[o].height),obj.options.rows[o].title&&(a=obj.options.rows[o].title)),a||(a=parseInt(o+1));var c=document.createElement("td");c.innerHTML=a,c.setAttribute("data-y",o),c.className="jexcel_row",obj.rows[o].appendChild(c);for(var m=0;m<obj.options.columns.length;m++)obj.records[o][m]=obj.createCell(m,o,r[m]),obj.rows[o].appendChild(obj.records[o][m]);return obj.rows[o]},obj.parseValue=function(o,r,a,c){(""+a).substr(0,1)=="="&&obj.options.parseFormulas==1&&(a=obj.executeFormula(a,o,r));var m=obj.options.columns[o];if(m&&!isFormula(a)){var N=null;if(N=getMask(m)){a&&a==Number(a)&&(a=Number(a));var O=jSuites.mask.render(a,N,!0);if(c&&N.mask){var b=N.mask.split(";");b[1]&&(b[1].match(new RegExp("\\[Red\\]","gi"))&&(a<0?c.classList.add("red"):c.classList.remove("red")),b[1].match(new RegExp("\\(","gi"))&&a<0&&(O="("+O+")"))}O&&(a=O)}}return a};var validDate=function(o){return(o=""+o).substr(4,1)=="-"&&o.substr(7,1)=="-"||(o=o.split("-"))[0].length==4&&o[0]==Number(o[0])&&o[1].length==2&&o[1]==Number(o[1])};obj.createCell=function(o,r,a){var c=document.createElement("td");if(c.setAttribute("data-x",o),c.setAttribute("data-y",r),(""+a).substr(0,1)=="="&&obj.options.secureFormulas==1){var m=secureFormula(a);m!=a&&(a=m)}if(obj.options.columns[o].editor)obj.options.stripHTML===!1||obj.options.columns[o].stripHTML===!1?c.innerHTML=a:c.textContent=a,typeof obj.options.columns[o].editor.createCell=="function"&&(c=obj.options.columns[o].editor.createCell(c));else if(obj.options.columns[o].type=="hidden")c.style.display="none",c.textContent=a;else if(obj.options.columns[o].type=="checkbox"||obj.options.columns[o].type=="radio"){var N=document.createElement("input");N.type=obj.options.columns[o].type,N.name="c"+o,N.checked=a==1||a==1||a=="true",N.onclick=function(){obj.setValue(c,this.checked)},obj.options.columns[o].readOnly!=1&&obj.options.editable!=0||N.setAttribute("disabled","disabled"),c.appendChild(N),obj.options.data[r][o]=N.checked}else if(obj.options.columns[o].type=="calendar"){var O=null;if(!validDate(a)){var b=jSuites.calendar.extractDateFromString(a,obj.options.columns[o].options.format);b&&(O=b)}c.textContent=jSuites.calendar.getDateString(O||a,obj.options.columns[o].options.format)}else if(obj.options.columns[o].type=="dropdown"||obj.options.columns[o].type=="autocomplete")c.classList.add("jexcel_dropdown"),c.textContent=obj.getDropDownValue(o,a);else if(obj.options.columns[o].type=="color")if(obj.options.columns[o].render=="square"){var s=document.createElement("div");s.className="color",s.style.backgroundColor=a,c.appendChild(s)}else c.style.color=a,c.textContent=a;else if(obj.options.columns[o].type=="image"){if(a&&a.substr(0,10)=="data:image"){var g=document.createElement("img");g.src=a,c.appendChild(g)}}else obj.options.columns[o].type=="html"||obj.options.stripHTML===!1||obj.options.columns[o].stripHTML===!1?c.innerHTML=stripScript(obj.parseValue(o,r,a,c)):c.textContent=obj.parseValue(o,r,a,c);obj.options.columns[o].readOnly==1&&(c.className="readonly");var S=obj.options.columns[o].align?obj.options.columns[o].align:"center";return c.style.textAlign=S,obj.options.columns[o].wordWrap!=0&&(obj.options.wordWrap==1||obj.options.columns[o].wordWrap==1||c.innerHTML.length>200)&&(c.style.whiteSpace="pre-wrap"),o>0&&this.options.textOverflow==1&&(a||c.innerHTML?obj.records[r][o-1].style.overflow="hidden":o==obj.options.columns.length-1&&(c.style.overflow="hidden")),c},obj.createCellHeader=function(o){var r=obj.options.columns[o].width?obj.options.columns[o].width:obj.options.defaultColWidth,a=obj.options.columns[o].align?obj.options.columns[o].align:obj.options.defaultColAlign;obj.headers[o]=document.createElement("td"),obj.options.stripHTML?obj.headers[o].textContent=obj.options.columns[o].title?obj.options.columns[o].title:jexcel.getColumnName(o):obj.headers[o].innerHTML=obj.options.columns[o].title?obj.options.columns[o].title:jexcel.getColumnName(o),obj.headers[o].setAttribute("data-x",o),obj.headers[o].style.textAlign=a,obj.options.columns[o].title&&obj.headers[o].setAttribute("title",obj.headers[o].innerText),obj.options.columns[o].id&&obj.headers[o].setAttribute("id",obj.options.columns[o].id),obj.colgroup[o]=document.createElement("col"),obj.colgroup[o].setAttribute("width",r),obj.options.columns[o].type=="hidden"&&(obj.headers[o].style.display="none",obj.colgroup[o].style.display="none")},obj.updateNestedHeader=function(o,r,a){obj.options.nestedHeaders[r][o].title&&(obj.options.nestedHeaders[r][o].title=a,obj.options.nestedHeaders[r].element.children[o+1].textContent=a)},obj.createNestedHeader=function(o){var r=document.createElement("tr");r.classList.add("jexcel_nested");var a=document.createElement("td");r.appendChild(a),o.element=r;for(var c=0,m=0;m<o.length;m++){o[m].colspan||(o[m].colspan=1),o[m].align||(o[m].align="center"),o[m].title||(o[m].title=""),o[m].id||(o[m].id="");for(var N=o[m].colspan,O=[],b=0;b<N;b++)obj.options.columns[c]&&obj.options.columns[c].type=="hidden"&&N++,O.push(c),c++;(a=document.createElement("td")).setAttribute("data-column",O.join(",")),a.setAttribute("colspan",o[m].colspan),a.setAttribute("align",o[m].align),a.setAttribute("id",o[m].id),a.textContent=o[m].title,r.appendChild(a)}return r},obj.createToolbar=function(o){o?obj.options.toolbar=o:o=obj.options.toolbar;for(var r=0;r<o.length;r++)if(o[r].type=="i")(N=document.createElement("i")).classList.add("jexcel_toolbar_item"),N.classList.add("material-icons"),N.setAttribute("data-k",o[r].k),N.setAttribute("data-v",o[r].v),N.setAttribute("id",o[r].id),o[r].tooltip&&N.setAttribute("title",o[r].tooltip),o[r].onclick&&(o[r].onclick,1)?N.onclick=function(O){var b=O;return function(){o[b].onclick(el,obj,this)}}(r):N.onclick=function(){var O=this.getAttribute("data-k"),b=this.getAttribute("data-v");obj.setStyle(obj.highlighted,O,b)},N.textContent=o[r].content,obj.toolbar.appendChild(N);else if(o[r].type=="select"){var a=!1;(N=document.createElement("select")).classList.add("jexcel_toolbar_item"),N.setAttribute("data-k",o[r].k),o[r].tooltip&&N.setAttribute("title",o[r].tooltip),o[r].onchange&&(o[r].onchange,1)?(N.onchange=o[r].onchange,a=!0):N.onchange=function(){var O=this.getAttribute("data-k");obj.setStyle(obj.highlighted,O,this.value)};for(var c=0;c<o[r].v.length;c++){var m=document.createElement("option");m.value=o[r].v[c],m.textContent=o[r].v[c],o[r].selectedValue&&m.value===o[r].selectedValue&&(m.selected=!0),N.appendChild(m)}a&&N.dispatchEvent(new Event("change")),obj.toolbar.appendChild(N)}else if(o[r].type=="color"){var N;(N=document.createElement("i")).classList.add("jexcel_toolbar_item"),N.classList.add("material-icons"),N.setAttribute("data-k",o[r].k),N.setAttribute("data-v",""),o[r].tooltip&&N.setAttribute("title",o[r].tooltip),obj.toolbar.appendChild(N),N.textContent=o[r].content,jSuites.color(N,{onchange:function(O,b){var s=O.getAttribute("data-k");obj.setStyle(obj.highlighted,s,b)}})}},obj.setMerge=function(o,r,a,c){var m=!1;if(!o){if(!obj.highlighted.length)return alert(obj.options.text.noCellsSelected),null;var N=parseInt(obj.highlighted[0].getAttribute("data-x")),O=parseInt(obj.highlighted[0].getAttribute("data-y")),b=parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute("data-x")),s=parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute("data-y"));o=jexcel.getColumnNameFromId([N,O]),r=b-N+1,a=s-O+1}var g=jexcel.getIdFromColumnName(o,!0);if(obj.options.mergeCells[o])obj.records[g[1]][g[0]].getAttribute("data-merged")&&(m=obj.options.text.cellAlreadyMerged);else if((!r||r<2)&&(!a||a<2))m=obj.options.text.invalidMergeProperties;else for(var S=g[1];S<g[1]+a;S++)for(var T=g[0];T<g[0]+r;T++)jexcel.getColumnNameFromId([T,S]),obj.records[S][T].getAttribute("data-merged")&&(m=obj.options.text.thereIsAConflictWithAnotherMergedCell);if(m)alert(m);else{r>1?obj.records[g[1]][g[0]].setAttribute("colspan",r):r=1,a>1?obj.records[g[1]][g[0]].setAttribute("rowspan",a):a=1,obj.options.mergeCells[o]=[r,a,[]],obj.records[g[1]][g[0]].setAttribute("data-merged","true"),obj.records[g[1]][g[0]].style.overflow="hidden";for(var d=[],l=g[1];l<g[1]+a;l++)for(var p=g[0];p<g[0]+r;p++)g[0]==p&&g[1]==l||(d.push(obj.options.data[l][p]),obj.updateCell(p,l,"",!0),obj.options.mergeCells[o][2].push(obj.records[l][p]),obj.records[l][p].style.display="none",obj.records[l][p]=obj.records[g[1]][g[0]]);obj.updateSelection(obj.records[g[1]][g[0]]),c||(obj.setHistory({action:"setMerge",column:o,colspan:r,rowspan:a,data:d}),obj.dispatch("onmerge",el,o,r,a))}},obj.getMerge=function(o){var r={};if(o)r=obj.options.mergeCells[o]?[obj.options.mergeCells[o][0],obj.options.mergeCells[o][1]]:null;else if(obj.options.mergeCells){obj.options.mergeCells;for(var a=Object.keys(obj.options.mergeCells),c=0;c<a.length;c++)r[a[c]]=[obj.options.mergeCells[a[c]][0],obj.options.mergeCells[a[c]][1]]}return r},obj.removeMerge=function(o,r,a){if(obj.options.mergeCells[o]){var c=jexcel.getIdFromColumnName(o,!0);obj.records[c[1]][c[0]].removeAttribute("colspan"),obj.records[c[1]][c[0]].removeAttribute("rowspan"),obj.records[c[1]][c[0]].removeAttribute("data-merged");for(var m=obj.options.mergeCells[o],N=0,O=0;O<m[1];O++)for(var b=0;b<m[0];b++)(O>0||b>0)&&(obj.records[c[1]+O][c[0]+b]=m[2][N],obj.records[c[1]+O][c[0]+b].style.display="",r&&r[N]&&obj.updateCell(c[0]+b,c[1]+O,r[N]),N++);obj.updateSelection(obj.records[c[1]][c[0]],obj.records[c[1]+O-1][c[0]+b-1]),a||delete obj.options.mergeCells[o]}},obj.destroyMerged=function(o){if(obj.options.mergeCells){obj.options.mergeCells;for(var r=Object.keys(obj.options.mergeCells),a=0;a<r.length;a++)obj.removeMerge(r[a],null,o)}},obj.isColMerged=function(o,r){var a=[];if(obj.options.mergeCells)for(var c=Object.keys(obj.options.mergeCells),m=0;m<c.length;m++){var N=jexcel.getIdFromColumnName(c[m],!0),O=obj.options.mergeCells[c[m]][0],b=N[0],s=N[0]+(O>1?O-1:0);r==null?b<=o&&s>=o&&a.push(c[m]):r?b<o&&s>=o&&a.push(c[m]):b<=o&&s>o&&a.push(c[m])}return a},obj.isRowMerged=function(o,r){var a=[];if(obj.options.mergeCells)for(var c=Object.keys(obj.options.mergeCells),m=0;m<c.length;m++){var N=jexcel.getIdFromColumnName(c[m],!0),O=obj.options.mergeCells[c[m]][1],b=N[1],s=N[1]+(O>1?O-1:0);r==null?b<=o&&s>=o&&a.push(c[m]):r?b<o&&s>=o&&a.push(c[m]):b<=o&&s>o&&a.push(c[m])}return a},obj.openFilter=function(o){if(obj.options.filters){o=parseInt(o),obj.resetSelection();var r=[];if(obj.options.columns[o].type=="checkbox")r.push({id:"true",name:"True"}),r.push({id:"false",name:"False"});else{for(var a=[],c=!1,m=0;m<obj.options.data.length;m++){var N=obj.options.data[m][o],O=obj.records[m][o].innerHTML;N&&O?a[N]=O:c=!0}var b=Object.keys(a);for(r=[],m=0;m<b.length;m++)r.push({id:b[m],name:a[b[m]]});c&&r.push({value:"",id:"",name:"(Blanks)"})}var s=document.createElement("div");obj.filter.children[o+1].innerHTML="",obj.filter.children[o+1].appendChild(s),obj.filter.children[o+1].style.paddingLeft="0px",obj.filter.children[o+1].style.paddingRight="0px",obj.filter.children[o+1].style.overflow="initial";var g={data:r,multiple:!0,autocomplete:!0,opened:!0,value:obj.filters[o]!==void 0?obj.filters[o]:null,width:"100%",position:obj.options.tableOverflow==1||obj.options.fullscreen==1,onclose:function(S){obj.resetFilters(),obj.filters[o]=S.dropdown.getValue(!0),obj.filter.children[o+1].innerHTML=S.dropdown.getText(),obj.filter.children[o+1].style.paddingLeft="",obj.filter.children[o+1].style.paddingRight="",obj.filter.children[o+1].style.overflow="",obj.closeFilter(o),obj.refreshSelection()}};jSuites.dropdown(s,g)}else console.log("Jspreadsheet: filters not enabled.")},obj.resetFilters=function(){if(obj.options.filters)for(var o=0;o<obj.filter.children.length;o++)obj.filter.children[o].innerHTML="&nbsp;",obj.filters[o]=null;obj.results=null,obj.updateResult()},obj.closeFilter=function(o){if(!o)for(var r=0;r<obj.filter.children.length;r++)obj.filters[r]&&(o=r);var a=function(N,O,b){for(var s=0;s<N.length;s++){var g=""+obj.options.data[b][O],S=""+obj.records[b][O].innerHTML;if(N[s]==g||N[s]==S)return!0}return!1},c=obj.filters[o];obj.results=[];for(var m=0;m<obj.options.data.length;m++)a(c,o,m)&&obj.results.push(m);obj.results.length||(obj.results=null),obj.updateResult()},obj.openEditor=function(o,r,a){var c=o.getAttribute("data-y"),m=o.getAttribute("data-x");obj.dispatch("oneditionstart",el,o,m,c),m>0&&(obj.records[c][m-1].style.overflow="hidden");var N=function(w){var A=o.getBoundingClientRect(),D=document.createElement(w);return D.style.width=A.width+"px",D.style.height=A.height-2+"px",D.style.minHeight=A.height-2+"px",o.classList.add("editor"),o.innerHTML="",o.appendChild(D),obj.dispatch("oncreateeditor",el,o,m,c,D),D};if(o.classList.contains("readonly")!=1){if(obj.edition=[obj.records[c][m],obj.records[c][m].innerHTML,m,c],obj.options.columns[m].editor)obj.options.columns[m].editor.openEditor(o,el,r,a);else if(obj.options.columns[m].type!="hidden")if(obj.options.columns[m].type=="checkbox"||obj.options.columns[m].type=="radio"){var O=!o.children[0].checked;obj.setValue(o,O),obj.edition=null}else if(obj.options.columns[m].type=="dropdown"||obj.options.columns[m].type=="autocomplete"){if(O=obj.options.data[c][m],obj.options.columns[m].multiple&&!Array.isArray(O)&&(O=O.split(";")),typeof obj.options.columns[m].filter=="function")var b=obj.options.columns[m].filter(el,o,m,c,obj.options.columns[m].source);else b=obj.options.columns[m].source;for(var s=[],g=0;g<b.length;g++)s.push(b[g]);var S=N("div"),T={data:s,multiple:!!obj.options.columns[m].multiple,autocomplete:!(!obj.options.columns[m].autocomplete&&obj.options.columns[m].type!="autocomplete"),opened:!0,value:O,width:"100%",height:S.style.minHeight,position:obj.options.tableOverflow==1||obj.options.fullscreen==1,onclose:function(){obj.closeEditor(o,!0)}};obj.options.columns[m].options&&obj.options.columns[m].options.type&&(T.type=obj.options.columns[m].options.type),jSuites.dropdown(S,T)}else if(obj.options.columns[m].type=="calendar"||obj.options.columns[m].type=="color")O=obj.options.data[c][m],(S=N("input")).value=O,obj.options.tableOverflow!=1&&obj.options.fullscreen!=1||(obj.options.columns[m].options.position=!0),obj.options.columns[m].options.value=obj.options.data[c][m],obj.options.columns[m].options.opened=!0,obj.options.columns[m].options.onclose=function(w,A){obj.closeEditor(o,!0)},obj.options.columns[m].type=="color"?jSuites.color(S,obj.options.columns[m].options):jSuites.calendar(S,obj.options.columns[m].options),S.focus();else if(obj.options.columns[m].type=="html"){O=obj.options.data[c][m],(S=N("div")).style.position="relative",(p=document.createElement("div")).classList.add("jexcel_richtext"),S.appendChild(p),jSuites.editor(p,{focus:!0,value:O});var d=o.getBoundingClientRect(),l=p.getBoundingClientRect();window.innerHeight<d.bottom+l.height?p.style.top=d.top-(l.height+2)+"px":p.style.top=d.top+"px"}else if(obj.options.columns[m].type=="image"){var p,j=o.children[0];(S=N("div")).style.position="relative",(p=document.createElement("div")).classList.add("jclose"),j&&j.src&&p.appendChild(j),S.appendChild(p),jSuites.image(p,obj.options.imageOptions),d=o.getBoundingClientRect(),l=p.getBoundingClientRect(),window.innerHeight<d.bottom+l.height?p.style.top=d.top-(l.height+2)+"px":p.style.top=d.top+"px"}else{O=r==1?"":obj.options.data[c][m],obj.options.columns[m].wordWrap==0||obj.options.wordWrap!=1&&obj.options.columns[m].wordWrap!=1?S=N("input"):S=N("textarea"),S.focus(),S.value=O,T=obj.options.columns[m];var f=null;if(!isFormula(O)&&(f=getMask(T))){if(!T.disabledMaskOnEdition)if(T.mask){var h=T.mask.split(";");S.setAttribute("data-mask",h[0])}else T.locale&&S.setAttribute("data-locale",T.locale);f.input=S,S.mask=f,jSuites.mask.render(O,f,!1)}S.onblur=function(){obj.closeEditor(o,!0)},S.scrollLeft=S.scrollWidth}}},obj.closeEditor=function(o,r){var a=parseInt(o.getAttribute("data-x")),c=parseInt(o.getAttribute("data-y"));if(r==1){if(obj.options.columns[a].editor)var m=obj.options.columns[a].editor.closeEditor(o,r);else if(!(obj.options.columns[a].type=="checkbox"||obj.options.columns[a].type=="radio"||obj.options.columns[a].type=="hidden"))if(obj.options.columns[a].type=="dropdown"||obj.options.columns[a].type=="autocomplete")m=o.children[0].dropdown.close(!0);else if(obj.options.columns[a].type=="calendar")m=o.children[0].calendar.close(!0);else if(obj.options.columns[a].type=="color")m=o.children[0].color.close(!0);else if(obj.options.columns[a].type=="html")m=o.children[0].children[0].editor.getData();else if(obj.options.columns[a].type=="image"){var N=o.children[0].children[0].children[0];m=N&&N.tagName=="IMG"?N.src:""}else if(obj.options.columns[a].type=="numeric")(""+(m=o.children[0].value)).substr(0,1)!="="&&m==""&&(m=obj.options.columns[a].allowEmpty?"":0),o.children[0].onblur=null;else{m=o.children[0].value,o.children[0].onblur=null;var O,b=obj.options.columns[a];if((O=getMask(b))&&m!==""&&!isFormula(m)&&typeof m!="number"){var s=jSuites.mask.extract(m,O,!0);s&&s.value!==""&&(m=s.value)}}obj.options.data[c][a]==m?o.innerHTML=obj.edition[1]:obj.setValue(o,m)}else obj.options.columns[a].editor?obj.options.columns[a].editor.closeEditor(o,r):obj.options.columns[a].type=="dropdown"||obj.options.columns[a].type=="autocomplete"?o.children[0].dropdown.close(!0):obj.options.columns[a].type=="calendar"?o.children[0].calendar.close(!0):obj.options.columns[a].type=="color"?o.children[0].color.close(!0):o.children[0].onblur=null,o.innerHTML=obj.edition&&obj.edition[1]?obj.edition[1]:"";obj.dispatch("oneditionend",el,o,a,c,m,r),o.classList.remove("editor"),obj.edition=null},obj.getCell=function(o){var r=(o=jexcel.getIdFromColumnName(o,!0))[0],a=o[1];return obj.records[a][r]},obj.getColumnOptions=function(o,r){var a=obj.options.columns[o];return a||(a={type:"text"}),a},obj.getCellFromCoords=function(o,r){return obj.records[r][o]},obj.getLabel=function(o){var r=(o=jexcel.getIdFromColumnName(o,!0))[0],a=o[1];return obj.records[a][r].innerHTML},obj.getLabelFromCoords=function(o,r){return obj.records[r][o].innerHTML},obj.getValue=function(o,r){if(typeof o=="object")var a=o.getAttribute("data-x"),c=o.getAttribute("data-y");else a=(o=jexcel.getIdFromColumnName(o,!0))[0],c=o[1];var m=null;return a!=null&&c!=null&&(obj.records[c]&&obj.records[c][a]&&(r||obj.options.copyCompatibility==1)?m=obj.records[c][a].innerHTML:obj.options.data[c]&&obj.options.data[c][a]!="undefined"&&(m=obj.options.data[c][a])),m},obj.getValueFromCoords=function(o,r,a){var c=null;return o!=null&&r!=null&&(obj.records[r]&&obj.records[r][o]&&a||obj.options.copyCompatibility==1?c=obj.records[r][o].innerHTML:obj.options.data[r]&&obj.options.data[r][o]!="undefined"&&(c=obj.options.data[r][o])),c},obj.setValue=function(o,r,a){var c=[];if(typeof o=="string"){var m=(s=jexcel.getIdFromColumnName(o,!0))[0],N=s[1];c.push(obj.updateCell(m,N,r,a)),obj.updateFormulaChain(m,N,c)}else if(m=null,N=null,o&&o.getAttribute&&(m=o.getAttribute("data-x"),N=o.getAttribute("data-y")),m!=null&&N!=null)c.push(obj.updateCell(m,N,r,a)),obj.updateFormulaChain(m,N,c);else{var O=Object.keys(o);if(O.length>0)for(var b=0;b<O.length;b++){var s;typeof o[b]=="string"?(m=(s=jexcel.getIdFromColumnName(o[b],!0))[0],N=s[1]):o[b].x!=null&&o[b].y!=null?(m=o[b].x,N=o[b].y,o[b].newValue!=null?r=o[b].newValue:o[b].value!=null&&(r=o[b].value)):(m=o[b].getAttribute("data-x"),N=o[b].getAttribute("data-y")),m!=null&&N!=null&&(c.push(obj.updateCell(m,N,r,a)),obj.updateFormulaChain(m,N,c))}}obj.setHistory({action:"setValue",records:c,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,c)},obj.setValueFromCoords=function(o,r,a,c){var m=[];m.push(obj.updateCell(o,r,a,c)),obj.updateFormulaChain(o,r,m),obj.setHistory({action:"setValue",records:m,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,m)},obj.setCheckRadioValue=function(){for(var o=[],r=Object.keys(obj.highlighted),a=0;a<r.length;a++){var c=obj.highlighted[a].getAttribute("data-x"),m=obj.highlighted[a].getAttribute("data-y");obj.options.columns[c].type!="checkbox"&&obj.options.columns[c].type!="radio"||o.push(obj.updateCell(c,m,!obj.options.data[m][c]))}o.length&&(obj.setHistory({action:"setValue",records:o,selection:obj.selectedCell}),obj.onafterchanges(el,o))};var stripScript=function(o){var r=new Option;r.innerHTML=o;var a=null;for(o=r.getElementsByTagName("script");a=o[0];)a.parentNode.removeChild(a);return r.innerHTML};obj.updateCell=function(o,r,a,c){if(obj.records[r][o].classList.contains("readonly")!=1||c){var m;(""+a).substr(0,1)=="="&&obj.options.secureFormulas==1&&(m=secureFormula(a))!=a&&(a=m),(m=obj.dispatch("onbeforechange",el,obj.records[r][o],o,r,a))!=null&&(a=m),obj.options.columns[o].editor&&typeof obj.options.columns[o].editor.updateCell=="function"&&(a=obj.options.columns[o].editor.updateCell(obj.records[r][o],a,c)),S={x:o,y:r,col:o,row:r,newValue:a,oldValue:obj.options.data[r][o]};let T=obj.options.columns[o].editor;if(T)obj.options.data[r][o]=a,typeof T.setValue=="function"&&T.setValue(obj.records[r][o],a);else if(obj.options.columns[o].type=="checkbox"||obj.options.columns[o].type=="radio"){if(obj.options.columns[o].type=="radio")for(var N=0;N<obj.options.data.length;N++)obj.options.data[N][o]=!1;obj.records[r][o].children[0].checked=a==1||a==1||a=="true"||a=="TRUE",obj.options.data[r][o]=obj.records[r][o].children[0].checked}else if(obj.options.columns[o].type=="dropdown"||obj.options.columns[o].type=="autocomplete")obj.options.data[r][o]=a,obj.records[r][o].textContent=obj.getDropDownValue(o,a);else if(obj.options.columns[o].type=="calendar"){var O=null;if(!validDate(a)){var b=jSuites.calendar.extractDateFromString(a,obj.options.columns[o].options.format);b&&(O=b)}obj.options.data[r][o]=a,obj.records[r][o].textContent=jSuites.calendar.getDateString(O||a,obj.options.columns[o].options.format)}else if(obj.options.columns[o].type=="color")if(obj.options.data[r][o]=a,obj.options.columns[o].render=="square"){var s=document.createElement("div");s.className="color",s.style.backgroundColor=a,obj.records[r][o].textContent="",obj.records[r][o].appendChild(s)}else obj.records[r][o].style.color=a,obj.records[r][o].textContent=a;else if(obj.options.columns[o].type=="image"){if(a=""+a,obj.options.data[r][o]=a,obj.records[r][o].innerHTML="",a&&a.substr(0,10)=="data:image"){var g=document.createElement("img");g.src=a,obj.records[r][o].appendChild(g)}}else obj.options.data[r][o]=a,obj.options.columns[o].type=="html"?obj.records[r][o].innerHTML=stripScript(obj.parseValue(o,r,a)):obj.options.stripHTML===!1||obj.options.columns[o].stripHTML===!1?obj.records[r][o].innerHTML=stripScript(obj.parseValue(o,r,a,obj.records[r][o])):obj.records[r][o].textContent=obj.parseValue(o,r,a,obj.records[r][o]),obj.options.columns[o].wordWrap!=0&&(obj.options.wordWrap==1||obj.options.columns[o].wordWrap==1||obj.records[r][o].innerHTML.length>200)?obj.records[r][o].style.whiteSpace="pre-wrap":obj.records[r][o].style.whiteSpace="";o>0&&(obj.records[r][o-1].style.overflow=a?"hidden":""),obj.dispatch("onchange",el,obj.records[r]&&obj.records[r][o]?obj.records[r][o]:null,o,r,a,S.oldValue)}else var S={x:o,y:r,col:o,row:r};return S},obj.copyData=function(o,r){var a=obj.getData(!0,!0),c=obj.selectedContainer,m=parseInt(o.getAttribute("data-x")),N=parseInt(o.getAttribute("data-y")),O=parseInt(r.getAttribute("data-x")),b=parseInt(r.getAttribute("data-y")),s=[],g=!1;if(c[0]==m){if(N<c[1])var S=N-c[1];else S=1;var T=0}else T=m<c[0]?m-c[0]:1,S=0;for(var d=0,l=0,p=N;p<=b;p++)if(!obj.rows[p]||obj.rows[p].style.display!="none"){a[l]==null&&(l=0),d=0,c[0]!=m&&(T=m<c[0]?m-c[0]:1);for(var j=m;j<=O;j++){if(obj.records[p][j]&&!obj.records[p][j].classList.contains("readonly")&&obj.records[p][j].style.display!="none"&&g==0){if(!obj.selection.length&&obj.options.data[p][j]!=""){g=!0;continue}(a[l]==null||a[l][d]==null)&&(d=0);var f=a[l][d];if(f&&!a[1]&&obj.options.autoIncrement==1){if(obj.options.columns[j].type=="text"||obj.options.columns[j].type=="number")if((""+f).substr(0,1)=="="){var h=f.match(/([A-Z]+[0-9]+)/g);if(h){for(var w=[],A=0;A<h.length;A++){var D=jexcel.getIdFromColumnName(h[A],1);D[0]+=T,D[1]+=S,D[1]<0&&(D[1]=0);var E=jexcel.getColumnNameFromId([D[0],D[1]]);E!=h[A]&&(w[h[A]]=E)}w&&(f=obj.updateFormula(f,w))}}else f==Number(f)&&(f=Number(f)+S);else if(obj.options.columns[j].type=="calendar"){var C=new Date(f);C.setDate(C.getDate()+S),f=C.getFullYear()+"-"+jexcel.doubleDigitFormat(parseInt(C.getMonth()+1))+"-"+jexcel.doubleDigitFormat(C.getDate())+" 00:00:00"}}s.push(obj.updateCell(j,p,f)),obj.updateFormulaChain(j,p,s)}d++,c[0]!=m&&T++}l++,S++}obj.setHistory({action:"setValue",records:s,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,s)},obj.refreshSelection=function(){obj.selectedCell&&obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])},obj.conditionalSelectionUpdate=function(o,r,a){if(o==1){if(obj.selectedCell&&(r>=obj.selectedCell[1]&&r<=obj.selectedCell[3]||a>=obj.selectedCell[1]&&a<=obj.selectedCell[3]))return void obj.resetSelection()}else if(obj.selectedCell&&(r>=obj.selectedCell[0]&&r<=obj.selectedCell[2]||a>=obj.selectedCell[0]&&a<=obj.selectedCell[2]))return void obj.resetSelection()},obj.resetSelection=function(o){if(obj.highlighted.length){g=1;for(var r=0;r<obj.highlighted.length;r++){obj.highlighted[r].classList.remove("highlight"),obj.highlighted[r].classList.remove("highlight-left"),obj.highlighted[r].classList.remove("highlight-right"),obj.highlighted[r].classList.remove("highlight-top"),obj.highlighted[r].classList.remove("highlight-bottom"),obj.highlighted[r].classList.remove("highlight-selected");var a=parseInt(obj.highlighted[r].getAttribute("data-x")),c=parseInt(obj.highlighted[r].getAttribute("data-y"));if(obj.highlighted[r].getAttribute("data-merged"))var m=parseInt(obj.highlighted[r].getAttribute("colspan")),N=parseInt(obj.highlighted[r].getAttribute("rowspan")),O=m>0?a+(m-1):a,b=N>0?c+(N-1):c;else O=a,b=c;for(var s=a;s<=O;s++)obj.headers[s]&&obj.headers[s].classList.remove("selected");for(s=c;s<=b;s++)obj.rows[s]&&obj.rows[s].classList.remove("selected")}}else var g=0;return obj.highlighted=[],obj.selectedCell=null,obj.corner.style.top="-2000px",obj.corner.style.left="-2000px",o==1&&g==1&&obj.dispatch("onblur",el),g},obj.updateSelection=function(o,r,a){var c=o.getAttribute("data-x"),m=o.getAttribute("data-y");if(r)var N=r.getAttribute("data-x"),O=r.getAttribute("data-y");else N=c,O=m;obj.updateSelectionFromCoords(c,m,N,O,a)},obj.updateSelectionFromCoords=function(o,r,a,c,m){var N=obj.resetSelection();if(r==null&&(r=0,c=obj.rows.length-1),a==null&&(a=o),c==null&&(c=r),o>=obj.headers.length&&(o=obj.headers.length-1),r>=obj.rows.length&&(r=obj.rows.length-1),a>=obj.headers.length&&(a=obj.headers.length-1),c>=obj.rows.length&&(c=obj.rows.length-1),obj.selectedCell=[o,r,a,c],o!=null){if(obj.records[r][o]&&obj.records[r][o].classList.add("highlight-selected"),parseInt(o)<parseInt(a))var O=parseInt(o),b=parseInt(a);else O=parseInt(a),b=parseInt(o);if(parseInt(r)<parseInt(c))var s=parseInt(r),g=parseInt(c);else s=parseInt(c),g=parseInt(r);for(var S=O;S<=b;S++)for(var T=s;T<=g;T++)if(obj.records[T][S]&&obj.records[T][S].getAttribute("data-merged")){var d=parseInt(obj.records[T][S].getAttribute("data-x")),l=parseInt(obj.records[T][S].getAttribute("data-y")),p=parseInt(obj.records[T][S].getAttribute("colspan")),j=parseInt(obj.records[T][S].getAttribute("rowspan"));p>1&&(d<O&&(O=d),d+p>b&&(b=d+p-1)),j&&(l<s&&(s=l),l+j>g&&(g=l+j-1))}var f=null,h=null,w=null,A=null;for(T=s;T<=g;T++)obj.rows[T].style.display!="none"&&(w==null&&(w=T),A=T);for(S=O;S<=b;S++){for(T=s;T<=g;T++)obj.rows[T].style.display!="none"&&obj.records[T][S].style.display!="none"&&(obj.records[T][S].classList.add("highlight"),obj.highlighted.push(obj.records[T][S]));obj.options.columns[S].type!="hidden"&&(f==null&&(f=S),h=S)}for(f||(f=0),h||(h=0),S=f;S<=h;S++)obj.options.columns[S].type!="hidden"&&obj.colgroup[S].style&&obj.colgroup[S].style.display!="none"&&(obj.records[w]&&obj.records[w][S]&&obj.records[w][S].classList.add("highlight-top"),obj.records[A]&&obj.records[A][S]&&obj.records[A][S].classList.add("highlight-bottom"),obj.headers[S].classList.add("selected"));for(T=w;T<=A;T++)obj.rows[T]&&obj.rows[T].style.display!="none"&&(obj.records[T][f].classList.add("highlight-left"),obj.records[T][h].classList.add("highlight-right"),obj.rows[T].classList.add("selected"));obj.selectedContainer=[f,w,h,A]}N==0&&(obj.dispatch("onfocus",el),obj.removeCopyingSelection()),obj.dispatch("onselection",el,f,w,h,A,m),obj.updateCornerPosition()},obj.removeCopySelection=function(){for(var o=0;o<obj.selection.length;o++)obj.selection[o].classList.remove("selection"),obj.selection[o].classList.remove("selection-left"),obj.selection[o].classList.remove("selection-right"),obj.selection[o].classList.remove("selection-top"),obj.selection[o].classList.remove("selection-bottom");obj.selection=[]},obj.updateCopySelection=function(o,r){obj.removeCopySelection();var a=obj.selectedContainer[0],c=obj.selectedContainer[1],m=obj.selectedContainer[2],N=obj.selectedContainer[3];if(o!=null&&r!=null){if(o-m>0)var O=parseInt(m)+1,b=parseInt(o);else O=parseInt(o),b=parseInt(a)-1;if(r-N>0)var s=parseInt(N)+1,g=parseInt(r);else s=parseInt(r),g=parseInt(c)-1;b-O<=g-s?(O=parseInt(a),b=parseInt(m)):(s=parseInt(c),g=parseInt(N));for(var S=s;S<=g;S++)for(var T=O;T<=b;T++)obj.records[S][T]&&obj.rows[S].style.display!="none"&&obj.records[S][T].style.display!="none"&&(obj.records[S][T].classList.add("selection"),obj.records[s][T].classList.add("selection-top"),obj.records[g][T].classList.add("selection-bottom"),obj.records[S][O].classList.add("selection-left"),obj.records[S][b].classList.add("selection-right"),obj.selection.push(obj.records[S][T]))}},obj.updateCornerPosition=function(){if(obj.highlighted.length){var o=obj.highlighted[obj.highlighted.length-1],r=o.getAttribute("data-x"),a=obj.content.getBoundingClientRect(),c=a.left,m=a.top,N=o.getBoundingClientRect(),O=N.left,b=N.top,s=N.width,g=N.height,S=O-c+obj.content.scrollLeft+s-4,T=b-m+obj.content.scrollTop+g-4;if(obj.corner.style.top=T+"px",obj.corner.style.left=S+"px",obj.options.freezeColumns){var d=obj.getFreezeWidth();r>obj.options.freezeColumns-1&&O-c+s<d?obj.corner.style.display="none":obj.options.selectionCopy==1&&(obj.corner.style.display="")}else obj.options.selectionCopy==1&&(obj.corner.style.display="")}else obj.corner.style.top="-2000px",obj.corner.style.left="-2000px"},obj.updateScroll=function(o){var r=obj.content.getBoundingClientRect(),a=r.left,c=r.top,m=r.width,N=r.height,O=obj.records[obj.selectedCell[3]][obj.selectedCell[2]].getBoundingClientRect(),b=O.left,s=O.top,g=O.width,S=O.height;if(o==0||o==1)var T=b-a+obj.content.scrollLeft,d=s-c+obj.content.scrollTop-2;else T=b-a+obj.content.scrollLeft+g,d=s-c+obj.content.scrollTop+S;d>obj.content.scrollTop+30&&d<obj.content.scrollTop+N||(d<obj.content.scrollTop+30?obj.content.scrollTop=d-S:obj.content.scrollTop=d-(N-2));var l=obj.getFreezeWidth();T>obj.content.scrollLeft+l&&T<obj.content.scrollLeft+m||(T<obj.content.scrollLeft+30?(obj.content.scrollLeft=T,obj.content.scrollLeft<50&&(obj.content.scrollLeft=0)):T<obj.content.scrollLeft+l?obj.content.scrollLeft=T-l-1:obj.content.scrollLeft=T-(m-20))},obj.getWidth=function(o){if(o===void 0)for(var r=[],a=0;a<obj.headers.length;a++)r.push(obj.options.columns[a].width);else typeof o=="object"&&(o=o.getAttribute("data-x")),r=obj.colgroup[o].getAttribute("width");return r},obj.setWidth=function(o,r,a){if(r){if(Array.isArray(o)){a||(a=[]);for(var c=0;c<o.length;c++){a[c]||(a[c]=obj.colgroup[o[c]].getAttribute("width"));var m=Array.isArray(r)&&r[c]?r[c]:r;obj.colgroup[o[c]].setAttribute("width",m),obj.options.columns[o[c]].width=m}}else a||(a=obj.colgroup[o].getAttribute("width")),obj.colgroup[o].setAttribute("width",r),obj.options.columns[o].width=r;obj.setHistory({action:"setWidth",column:o,oldValue:a,newValue:r}),obj.dispatch("onresizecolumn",el,o,r,a),obj.updateCornerPosition()}},obj.setHeight=function(o,r,a){r>0&&(typeof o=="object"&&(o=o.getAttribute("data-y")),a||(a=obj.rows[o].getAttribute("height"))||(a=obj.rows[o].getBoundingClientRect().height),r=parseInt(r),obj.rows[o].style.height=r+"px",obj.options.rows[o]||(obj.options.rows[o]={}),obj.options.rows[o].height=r,obj.setHistory({action:"setHeight",row:o,oldValue:a,newValue:r}),obj.dispatch("onresizerow",el,o,r,a),obj.updateCornerPosition())},obj.getHeight=function(o){if(o===void 0)for(var r=[],a=0;a<obj.rows.length;a++){var c=obj.rows[a].style.height;c&&(r[a]=c)}else typeof o=="object"&&(o=$(o).getAttribute("data-y")),r=obj.rows[o].style.height;return r},obj.setFooter=function(o){if(o&&(obj.options.footers=o),obj.options.footers){obj.tfoot||(obj.tfoot=document.createElement("tfoot"),obj.table.appendChild(obj.tfoot));for(var r=0;r<obj.options.footers.length;r++){if(obj.tfoot.children[r])var a=obj.tfoot.children[r];else{a=document.createElement("tr");var c=document.createElement("td");a.appendChild(c),obj.tfoot.appendChild(a)}for(var m=0;m<obj.headers.length;m++){if(obj.options.footers[r][m]||(obj.options.footers[r][m]=""),obj.tfoot.children[r].children[m+1])c=obj.tfoot.children[r].children[m+1];else{c=document.createElement("td"),a.appendChild(c);var N=obj.options.columns[m].align?obj.options.columns[m].align:"center";c.style.textAlign=N}c.textContent=obj.parseValue(+obj.records.length+m,r,obj.options.footers[r][m]),c.style.display=obj.colgroup[m].style.display}}}},obj.getHeader=function(o){return obj.headers[o].textContent},obj.setHeader=function(o,r){if(obj.headers[o]){var a=obj.headers[o].textContent;r||(r=prompt(obj.options.text.columnName,a)),r&&(obj.headers[o].textContent=r,obj.headers[o].setAttribute("title",r),obj.options.columns[o].title=r),obj.setHistory({action:"setHeader",column:o,oldValue:a,newValue:r}),obj.dispatch("onchangeheader",el,o,a,r)}},obj.getHeaders=function(o){for(var r=[],a=0;a<obj.headers.length;a++)r.push(obj.getHeader(a));return o?r:r.join(obj.options.csvDelimiter)},obj.getMeta=function(o,r){return o?r?obj.options.meta[o]&&obj.options.meta[o][r]?obj.options.meta[o][r]:null:obj.options.meta[o]?obj.options.meta[o]:null:obj.options.meta},obj.setMeta=function(o,r,a){if(obj.options.meta||(obj.options.meta={}),r&&a)obj.options.meta[o]||(obj.options.meta[o]={}),obj.options.meta[o][r]=a;else for(var c=Object.keys(o),m=0;m<c.length;m++){obj.options.meta[c[m]]||(obj.options.meta[c[m]]={});for(var N=Object.keys(o[c[m]]),O=0;O<N.length;O++)obj.options.meta[c[m]][N[O]]=o[c[m]][N[O]]}obj.dispatch("onchangemeta",el,o,r,a)},obj.updateMeta=function(o){if(obj.options.meta){for(var r={},a=Object.keys(obj.options.meta),c=0;c<a.length;c++)o[a[c]]?r[o[a[c]]]=obj.options.meta[a[c]]:r[a[c]]=obj.options.meta[a[c]];obj.options.meta=r}},obj.getStyle=function(o,r){if(o)return o=jexcel.getIdFromColumnName(o,!0),r?obj.records[o[1]][o[0]].style[r]:obj.records[o[1]][o[0]].getAttribute("style");for(var a={},c=obj.options.data[0].length,m=obj.options.data.length,N=0;N<m;N++)for(var O=0;O<c;O++){var b=r?obj.records[N][O].style[r]:obj.records[N][O].getAttribute("style");b&&(a[jexcel.getColumnNameFromId([O,N])]=b)}return a},obj.resetStyle=function(o,r){for(var a=Object.keys(o),c=0;c<a.length;c++){var m=jexcel.getIdFromColumnName(a[c],!0);obj.records[m[1]]&&obj.records[m[1]][m[0]]&&obj.records[m[1]][m[0]].setAttribute("style","")}obj.setStyle(o,null,null,null,r)},obj.setStyle=function(o,r,a,c,m){var N={},O={},b=function(f,h,w){var A=jexcel.getIdFromColumnName(f,!0);if(obj.records[A[1]]&&obj.records[A[1]][A[0]]&&(obj.records[A[1]][A[0]].classList.contains("readonly")==0||c)){var D=obj.records[A[1]][A[0]].style[h];D!=w||c?obj.records[A[1]][A[0]].style[h]=w:(w="",obj.records[A[1]][A[0]].style[h]=""),O[f]||(O[f]=[]),N[f]||(N[f]=[]),O[f].push([h+":"+D]),N[f].push([h+":"+w])}};if(r&&a)if(typeof o=="string")b(o,r,a);else for(var s=[],g=0;g<o.length;g++){var S=o[g].getAttribute("data-x"),T=o[g].getAttribute("data-y"),d=jexcel.getColumnNameFromId([S,T]);s[d]||(b(d,r,a),s[d]=!0)}else{var l=Object.keys(o);for(g=0;g<l.length;g++){var p=o[l[g]];typeof p=="string"&&(p=p.split(";"));for(var j=0;j<p.length;j++)typeof p[j]=="string"&&(p[j]=p[j].split(":")),p[j][0].trim()&&b(l[g],p[j][0].trim(),p[j][1])}}for(l=Object.keys(O),g=0;g<l.length;g++)O[l[g]]=O[l[g]].join(";");for(l=Object.keys(N),g=0;g<l.length;g++)N[l[g]]=N[l[g]].join(";");m||obj.setHistory({action:"setStyle",oldValue:O,newValue:N}),obj.dispatch("onchangestyle",el,o,r,a)},obj.getComments=function(o,r){if(o)return typeof o=="string"&&(o=jexcel.getIdFromColumnName(o,!0)),r?[obj.records[o[1]][o[0]].getAttribute("title"),obj.records[o[1]][o[0]].getAttribute("author")]:obj.records[o[1]][o[0]].getAttribute("title")||"";for(var a={},c=0;c<obj.options.data.length;c++)for(var m=0;m<obj.options.columns.length;m++){var N=obj.records[c][m].getAttribute("title");N&&(a[o=jexcel.getColumnNameFromId([m,c])]=N)}return a},obj.setComments=function(o,r,a){if(typeof o=="string")var c=jexcel.getIdFromColumnName(o,!0);else c=o;var m=obj.records[c[1]][c[0]].getAttribute("title"),N=[m,a=obj.records[c[1]][c[0]].getAttribute("data-author")];obj.records[c[1]][c[0]].setAttribute("title",r||""),obj.records[c[1]][c[0]].setAttribute("data-author",a||""),r?obj.records[c[1]][c[0]].classList.add("jexcel_comments"):obj.records[c[1]][c[0]].classList.remove("jexcel_comments"),obj.setHistory({action:"setComments",column:o,newValue:[r,a],oldValue:N}),obj.dispatch("oncomments",el,r,m,c,c[0],c[1])},obj.getConfig=function(){var o=obj.options;return o.style=obj.getStyle(),o.mergeCells=obj.getMerge(),o.comments=obj.getComments(),o},obj.orderBy=function(o,r){if(o>=0){if(Object.keys(obj.options.mergeCells).length>0){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}r=r==null?obj.headers[o].classList.contains("arrow-down")?1:0:r?1:0;var a=[];if(obj.options.columns[o].type=="number"||obj.options.columns[o].type=="numeric"||obj.options.columns[o].type=="percentage"||obj.options.columns[o].type=="autonumber"||obj.options.columns[o].type=="color")for(var c=0;c<obj.options.data.length;c++)a[c]=[c,Number(obj.options.data[c][o])];else if(obj.options.columns[o].type=="calendar"||obj.options.columns[o].type=="checkbox"||obj.options.columns[o].type=="radio")for(c=0;c<obj.options.data.length;c++)a[c]=[c,obj.options.data[c][o]];else for(c=0;c<obj.options.data.length;c++)a[c]=[c,obj.records[c][o].textContent.toLowerCase()];typeof obj.options.sorting!="function"&&(obj.options.sorting=function(N){return function(O,b){var s=O[1],g=b[1];return N?s===""&&g!==""?1:s!==""&&g===""||s>g?-1:s<g?1:0:s===""&&g!==""?1:s!==""&&g===""?-1:s>g?1:s<g?-1:0}}),a=a.sort(obj.options.sorting(r));var m=[];for(c=0;c<a.length;c++)m[c]=a[c][0];return obj.setHistory({action:"orderBy",rows:m,column:o,order:r}),obj.updateOrderArrow(o,r),obj.updateOrder(m),obj.dispatch("onsort",el,o,r),!0}},obj.updateOrderArrow=function(o,r){for(var a=0;a<obj.headers.length;a++)obj.headers[a].classList.remove("arrow-up"),obj.headers[a].classList.remove("arrow-down");r?obj.headers[o].classList.add("arrow-up"):obj.headers[o].classList.add("arrow-down")},obj.updateOrder=function(o){for(var r=[],a=0;a<o.length;a++)r[a]=obj.options.data[o[a]];for(obj.options.data=r,r=[],a=0;a<o.length;a++)r[a]=obj.records[o[a]];for(obj.records=r,r=[],a=0;a<o.length;a++)r[a]=obj.rows[o[a]];if(obj.rows=r,obj.updateTableReferences(),obj.results&&obj.results.length)obj.searchInput.value?obj.search(obj.searchInput.value):obj.closeFilter();else if(obj.results=null,obj.pageNumber=0,obj.options.pagination>0)obj.page(0);else if(obj.options.lazyLoading==1)obj.loadPage(0);else for(a=0;a<obj.rows.length;a++)obj.tbody.appendChild(obj.rows[a])},obj.moveRow=function(o,r,a){if(Object.keys(obj.options.mergeCells).length>0){if(o>r)var c=1;else c=0;if(obj.isRowMerged(o).length||obj.isRowMerged(r,c).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}}if(obj.options.search==1){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}a||(Array.prototype.indexOf.call(obj.tbody.children,obj.rows[r])>=0?o>r?obj.tbody.insertBefore(obj.rows[o],obj.rows[r]):obj.tbody.insertBefore(obj.rows[o],obj.rows[r].nextSibling):obj.tbody.removeChild(obj.rows[o])),obj.rows.splice(r,0,obj.rows.splice(o,1)[0]),obj.records.splice(r,0,obj.records.splice(o,1)[0]),obj.options.data.splice(r,0,obj.options.data.splice(o,1)[0]),obj.options.pagination>0&&obj.tbody.children.length!=obj.options.pagination&&obj.page(obj.pageNumber),obj.setHistory({action:"moveRow",oldValue:o,newValue:r}),obj.updateTableReferences(),obj.dispatch("onmoverow",el,o,r)},obj.insertRow=function(o,r,a){if(obj.options.allowInsertRow==1){var c=[];if(o>0)var m=o;else m=1,o&&(c=o);a=!!a;var N=obj.options.data.length-1;if((r==null||r>=parseInt(N)||r<0)&&(r=N),obj.dispatch("onbeforeinsertrow",el,r,m,a)===!1)return!1;if(Object.keys(obj.options.mergeCells).length>0&&obj.isRowMerged(r,a).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}if(obj.options.search==1){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}for(var O=a?r:r+1,b=obj.records.splice(O),s=obj.options.data.splice(O),g=obj.rows.splice(O),S=[],T=[],d=[],l=O;l<m+O;l++){obj.options.data[l]=[];for(var p=0;p<obj.options.columns.length;p++)obj.options.data[l][p]=c[p]?c[p]:"";var j=obj.createRow(l,obj.options.data[l]);g[0]?Array.prototype.indexOf.call(obj.tbody.children,g[0])>=0&&obj.tbody.insertBefore(j,g[0]):Array.prototype.indexOf.call(obj.tbody.children,obj.rows[r])>=0&&obj.tbody.appendChild(j),S.push(obj.records[l]),T.push(obj.options.data[l]),d.push(j)}Array.prototype.push.apply(obj.records,b),Array.prototype.push.apply(obj.options.data,s),Array.prototype.push.apply(obj.rows,g),obj.options.pagination>0&&obj.page(obj.pageNumber),obj.setHistory({action:"insertRow",rowNumber:r,numOfRows:m,insertBefore:a,rowRecords:S,rowData:T,rowNode:d}),obj.updateTableReferences(),obj.dispatch("oninsertrow",el,r,m,S,a)}},obj.deleteRow=function(o,r){if(obj.options.allowDeleteRow==1)if(obj.options.allowDeletingAllRows==1||obj.options.data.length>1){if(o==null){var a=obj.getSelectedRows();a[0]?(o=parseInt(a[0].getAttribute("data-y")),r=a.length):(o=obj.options.data.length-1,r=1)}var c=obj.options.data.length-1;if((o==null||o>c||o<0)&&(o=c),r||(r=1),o+r>=obj.options.data.length&&(r=obj.options.data.length-o),obj.dispatch("onbeforedeleterow",el,o,r)===!1)return!1;if(parseInt(o)>-1){var m=!1;if(Object.keys(obj.options.mergeCells).length>0)for(var N=o;N<o+r;N++)obj.isRowMerged(N,!1).length&&(m=!0);if(m){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}if(obj.options.search==1){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}for(obj.options.allowDeletingAllRows==0&&c+1===r&&(r--,console.error("Jspreadsheet: It is not possible to delete the last row")),N=o;N<o+r;N++)Array.prototype.indexOf.call(obj.tbody.children,obj.rows[N])>=0&&(obj.rows[N].className="",obj.rows[N].parentNode.removeChild(obj.rows[N]));var O=obj.records.splice(o,r),b=obj.options.data.splice(o,r),s=obj.rows.splice(o,r);obj.options.pagination>0&&obj.tbody.children.length!=obj.options.pagination&&obj.page(obj.pageNumber),obj.conditionalSelectionUpdate(1,o,o+r-1),obj.setHistory({action:"deleteRow",rowNumber:o,numOfRows:r,insertBefore:1,rowRecords:O,rowData:b,rowNode:s}),obj.updateTableReferences(),obj.dispatch("ondeleterow",el,o,r,O)}}else console.error("Jspreadsheet: It is not possible to delete the last row")},obj.moveColumn=function(o,r){if(Object.keys(obj.options.mergeCells).length>0){if(o>r)var a=1;else a=0;if(obj.isColMerged(o).length||obj.isColMerged(r,a).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}}if((o=parseInt(o))>(r=parseInt(r))){obj.headerContainer.insertBefore(obj.headers[o],obj.headers[r]),obj.colgroupContainer.insertBefore(obj.colgroup[o],obj.colgroup[r]);for(var c=0;c<obj.rows.length;c++)obj.rows[c].insertBefore(obj.records[c][o],obj.records[c][r])}else for(obj.headerContainer.insertBefore(obj.headers[o],obj.headers[r].nextSibling),obj.colgroupContainer.insertBefore(obj.colgroup[o],obj.colgroup[r].nextSibling),c=0;c<obj.rows.length;c++)obj.rows[c].insertBefore(obj.records[c][o],obj.records[c][r].nextSibling);for(obj.options.columns.splice(r,0,obj.options.columns.splice(o,1)[0]),obj.headers.splice(r,0,obj.headers.splice(o,1)[0]),obj.colgroup.splice(r,0,obj.colgroup.splice(o,1)[0]),c=0;c<obj.rows.length;c++)obj.options.data[c].splice(r,0,obj.options.data[c].splice(o,1)[0]),obj.records[c].splice(r,0,obj.records[c].splice(o,1)[0]);if(obj.options.footers)for(c=0;c<obj.options.footers.length;c++)obj.options.footers[c].splice(r,0,obj.options.footers[c].splice(o,1)[0]);obj.setHistory({action:"moveColumn",oldValue:o,newValue:r}),obj.updateTableReferences(),obj.dispatch("onmovecolumn",el,o,r)},obj.insertColumn=function(o,r,a,c){if(obj.options.allowInsertColumn==1){var m=[];if(o>0)var N=o;else N=1,o&&(m=o);a=!!a;var O=obj.options.columns.length-1;if((r==null||r>=parseInt(O)||r<0)&&(r=O),obj.dispatch("onbeforeinsertcolumn",el,r,N,a)===!1)return!1;if(Object.keys(obj.options.mergeCells).length>0&&obj.isColMerged(r,a).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}c||(c=[]);for(var b=0;b<N;b++)c[b]||(c[b]={type:"text",source:[],options:[],width:obj.options.defaultColWidth,align:obj.options.defaultColAlign});var s=a?r:r+1;obj.options.columns=jexcel.injectArray(obj.options.columns,s,c);for(var g=obj.headers.splice(s),S=obj.colgroup.splice(s),T=[],d=[],l=[],p=[],j=[],f=s;f<N+s;f++)obj.createCellHeader(f),obj.headerContainer.insertBefore(obj.headers[f],obj.headerContainer.children[f+1]),obj.colgroupContainer.insertBefore(obj.colgroup[f],obj.colgroupContainer.children[f+1]),T.push(obj.headers[f]),d.push(obj.colgroup[f]);if(obj.options.footers)for(var h=0;h<obj.options.footers.length;h++){for(j[h]=[],b=0;b<N;b++)j[h].push("");obj.options.footers[h].splice(s,0,j[h])}for(var w=0;w<obj.options.data.length;w++){var A=obj.options.data[w].splice(s),D=obj.records[w].splice(s);for(p[w]=[],l[w]=[],f=s;f<N+s;f++){var E=m[w]?m[w]:"";obj.options.data[w][f]=E;var C=obj.createCell(f,w,obj.options.data[w][f]);obj.records[w][f]=C,obj.rows[w]&&obj.rows[w].insertBefore(C,obj.rows[w].children[f+1]),p[w].push(E),l[w].push(C)}Array.prototype.push.apply(obj.options.data[w],A),Array.prototype.push.apply(obj.records[w],D)}if(Array.prototype.push.apply(obj.headers,g),Array.prototype.push.apply(obj.colgroup,S),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(h=0;h<obj.options.nestedHeaders.length;h++){var M=parseInt(obj.options.nestedHeaders[h][obj.options.nestedHeaders[h].length-1].colspan)+N;obj.options.nestedHeaders[h][obj.options.nestedHeaders[h].length-1].colspan=M,obj.thead.children[h].children[obj.thead.children[h].children.length-1].setAttribute("colspan",M);var k=obj.thead.children[h].children[obj.thead.children[h].children.length-1].getAttribute("data-column");for(k=k.split(","),f=s;f<N+s;f++)k.push(f);obj.thead.children[h].children[obj.thead.children[h].children.length-1].setAttribute("data-column",k)}else M=parseInt(obj.options.nestedHeaders[0].colspan)+N,obj.options.nestedHeaders[0].colspan=M,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",M);obj.setHistory({action:"insertColumn",columnNumber:r,numOfColumns:N,insertBefore:a,columns:c,headers:T,colgroup:d,records:l,footers:j,data:p}),obj.updateTableReferences(),obj.dispatch("oninsertcolumn",el,r,N,l,a)}},obj.deleteColumn=function(o,r){if(obj.options.allowDeleteColumn==1)if(obj.headers.length>1){if(o==null){var a=obj.getSelectedColumns(!0);a.length?(o=parseInt(a[0]),r=parseInt(a.length)):(o=obj.headers.length-1,r=1)}var c=obj.options.data[0].length-1;if((o==null||o>c||o<0)&&(o=c),r||(r=1),r>obj.options.data[0].length-o&&(r=obj.options.data[0].length-o),obj.dispatch("onbeforedeletecolumn",el,o,r)===!1)return!1;if(parseInt(o)>-1){var m=!1;if(Object.keys(obj.options.mergeCells).length>0)for(var N=o;N<o+r;N++)obj.isColMerged(N,!1).length&&(m=!0);if(m){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}var O=obj.options.columns.splice(o,r);for(N=o;N<o+r;N++)obj.colgroup[N].className="",obj.headers[N].className="",obj.colgroup[N].parentNode.removeChild(obj.colgroup[N]),obj.headers[N].parentNode.removeChild(obj.headers[N]);for(var b=obj.headers.splice(o,r),s=obj.colgroup.splice(o,r),g=[],S=[],T=[],d=0;d<obj.options.data.length;d++)for(N=o;N<o+r;N++)obj.records[d][N].className="",obj.records[d][N].parentNode.removeChild(obj.records[d][N]);for(d=0;d<obj.options.data.length;d++)S[d]=obj.options.data[d].splice(o,r),g[d]=obj.records[d].splice(o,r);if(obj.options.footers)for(d=0;d<obj.options.footers.length;d++)T[d]=obj.options.footers[d].splice(o,r);if(obj.conditionalSelectionUpdate(0,o,o+r-1),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(var l=0;l<obj.options.nestedHeaders.length;l++){var p=parseInt(obj.options.nestedHeaders[l][obj.options.nestedHeaders[l].length-1].colspan)-r;obj.options.nestedHeaders[l][obj.options.nestedHeaders[l].length-1].colspan=p,obj.thead.children[l].children[obj.thead.children[l].children.length-1].setAttribute("colspan",p)}else p=parseInt(obj.options.nestedHeaders[0].colspan)-r,obj.options.nestedHeaders[0].colspan=p,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",p);obj.setHistory({action:"deleteColumn",columnNumber:o,numOfColumns:r,insertBefore:1,columns:O,headers:b,colgroup:s,records:g,footers:T,data:S}),obj.updateTableReferences(),obj.dispatch("ondeletecolumn",el,o,r,g)}}else console.error("Jspreadsheet: It is not possible to delete the last column")},obj.getSelectedRows=function(o){for(var r=[],a=0;a<obj.rows.length;a++)obj.rows[a].classList.contains("selected")&&(o?r.push(a):r.push(obj.rows[a]));return r},obj.getSelectedColumns=function(){for(var o=[],r=0;r<obj.headers.length;r++)obj.headers[r].classList.contains("selected")&&o.push(r);return o},obj.getHighlighted=function(){return obj.highlighted},obj.updateTableReferences=function(){for(var o=0;o<obj.headers.length;o++)(N=obj.headers[o].getAttribute("data-x"))!=o&&(obj.headers[o].setAttribute("data-x",o),obj.headers[o].getAttribute("title")||(obj.headers[o].innerHTML=jexcel.getColumnName(o)));for(var r=0;r<obj.rows.length;r++)obj.rows[r]&&(O=obj.rows[r].getAttribute("data-y"))!=r&&(obj.rows[r].setAttribute("data-y",r),obj.rows[r].children[0].setAttribute("data-y",r),obj.rows[r].children[0].innerHTML=r+1);var a=[],c=[],m=function(l,p,j,f){if(l!=j&&obj.records[f][j].setAttribute("data-x",j),p!=f&&obj.records[f][j].setAttribute("data-y",f),l!=j||p!=f){var h=jexcel.getColumnNameFromId([l,p]),w=jexcel.getColumnNameFromId([j,f]);a[h]=w}};for(r=0;r<obj.records.length;r++)for(o=0;o<obj.records[0].length;o++)if(obj.records[r][o]){var N=obj.records[r][o].getAttribute("data-x"),O=obj.records[r][o].getAttribute("data-y");if(obj.records[r][o].getAttribute("data-merged")){var b=jexcel.getColumnNameFromId([N,O]),s=jexcel.getColumnNameFromId([o,r]);if(c[b]==null)if(b==s)c[b]=!1;else{var g=parseInt(o-N),S=parseInt(r-O);c[b]=[s,g,S]}}else m(N,O,o,r)}var T=Object.keys(c);if(T.length){for(o=0;o<T.length;o++)if(c[T[o]]){var d=jexcel.getIdFromColumnName(T[o],!0);for(m(N=d[0],O=d[1],N+c[T[o]][1],O+c[T[o]][2]),b=T[o],s=c[T[o]][0],r=0;r<obj.options.mergeCells[b][2].length;r++)N=parseInt(obj.options.mergeCells[b][2][r].getAttribute("data-x")),O=parseInt(obj.options.mergeCells[b][2][r].getAttribute("data-y")),obj.options.mergeCells[b][2][r].setAttribute("data-x",N+c[T[o]][1]),obj.options.mergeCells[b][2][r].setAttribute("data-y",O+c[T[o]][2]);obj.options.mergeCells[s]=obj.options.mergeCells[b],delete obj.options.mergeCells[b]}}obj.updateFormulas(a),obj.updateMeta(a),obj.refreshSelection(),obj.updateTable()},obj.updateTable=function(){if(obj.options.minSpareRows>0){for(var o=0,r=obj.rows.length-1;r>=0;r--){for(var a=!1,c=0;c<obj.headers.length;c++)obj.options.data[r][c]&&(a=!0);if(a)break;o++}obj.options.minSpareRows-o>0&&obj.insertRow(obj.options.minSpareRows-o)}if(obj.options.minSpareCols>0){var m=0;for(c=obj.headers.length-1;c>=0;c--){for(a=!1,r=0;r<obj.rows.length;r++)obj.options.data[r][c]&&(a=!0);if(a)break;m++}obj.options.minSpareCols-m>0&&obj.insertColumn(obj.options.minSpareCols-m)}if(typeof obj.options.updateTable=="function"){for(obj.options.detachForUpdates&&el.removeChild(obj.content),r=0;r<obj.rows.length;r++)for(c=0;c<obj.headers.length;c++)obj.options.updateTable(el,obj.records[r][c],c,r,obj.options.data[r][c],obj.records[r][c].textContent,jexcel.getColumnNameFromId([c,r]));obj.options.detachForUpdates&&el.insertBefore(obj.content,obj.pagination)}obj.options.footers&&obj.setFooter(),setTimeout(function(){obj.updateCornerPosition()},0)},obj.isReadOnly=function(o){if(o=obj.getCell(o))return!!o.classList.contains("readonly")},obj.setReadOnly=function(o,r){(o=obj.getCell(o))&&(r?o.classList.add("readonly"):o.classList.remove("readonly"))},obj.showRow=function(o){obj.rows[o].style.display=""},obj.hideRow=function(o){obj.rows[o].style.display="none"},obj.showColumn=function(o){obj.headers[o].style.display="",obj.colgroup[o].style.display="",obj.filter&&obj.filter.children.length>o+1&&(obj.filter.children[o+1].style.display="");for(var r=0;r<obj.options.data.length;r++)obj.records[r][o].style.display="";obj.options.footers&&obj.setFooter(),obj.resetSelection()},obj.hideColumn=function(o){obj.headers[o].style.display="none",obj.colgroup[o].style.display="none",obj.filter&&obj.filter.children.length>o+1&&(obj.filter.children[o+1].style.display="none");for(var r=0;r<obj.options.data.length;r++)obj.records[r][o].style.display="none";obj.options.footers&&obj.setFooter(),obj.resetSelection()},obj.showIndex=function(){obj.table.classList.remove("jexcel_hidden_index")},obj.hideIndex=function(){obj.table.classList.add("jexcel_hidden_index")};var chainLoopProtection=[];obj.updateFormulaChain=function(o,r,a){var c=jexcel.getColumnNameFromId([o,r]);if(obj.formula[c]&&obj.formula[c].length>0)if(chainLoopProtection[c])obj.records[r][o].innerHTML="#ERROR",obj.formula[c]="";else{chainLoopProtection[c]=!0;for(var m=0;m<obj.formula[c].length;m++){var N=jexcel.getIdFromColumnName(obj.formula[c][m],!0),O=""+obj.options.data[N[1]][N[0]];O.substr(0,1)=="="?a.push(obj.updateCell(N[0],N[1],O,!0)):Object.keys(obj.formula)[m]=null,obj.updateFormulaChain(N[0],N[1],a)}}chainLoopProtection=[]},obj.updateFormulas=function(o){for(var r=0;r<obj.options.data.length;r++)for(var a=0;a<obj.options.data[0].length;a++)if((b=""+obj.options.data[r][a]).substr(0,1)=="="){var c=obj.updateFormula(b,o);c!=b&&(obj.options.data[r][a]=c)}var m=[],N=Object.keys(obj.formula);for(r=0;r<N.length;r++){var O=N[r],b=obj.formula[O];for(o[O]&&(O=o[O]),m[O]=[],a=0;a<b.length;a++){var s=b[a];o[s]&&(s=o[s]),m[O].push(s)}}obj.formula=m},obj.updateFormula=function(o,r){for(var a=/[A-Z]/,c=/[0-9]/,m="",N=null,O=null,b="",s=0;s<o.length;s++)a.exec(o[s])?(N=1,O=0,b+=o[s]):c.exec(o[s])?(O=N?1:0,b+=o[s]):(N&&O&&(b=r[b]?r[b]:b),m+=b,m+=o[s],N=0,O=0,b="");return b&&(N&&O&&(b=r[b]?r[b]:b),m+=b),m};var secureFormula=function(o){for(var r="",a=0,c=0;c<o.length;c++)o[c]=='"'&&(a=a==0?1:0),r+=a==1?o[c]:o[c].toUpperCase();return r};obj.executeFormula=function(expression,x,y){var formulaResults=[],formulaLoopProtection=[],execute=function(expression,x,y){var parentId=jexcel.getColumnNameFromId([x,y]);if(formulaLoopProtection[parentId])return console.error("Reference loop detected"),"#ERROR";formulaLoopProtection[parentId]=!0;var tokensUpdate=function(o){for(var r=0;r<o.length;r++){var a=[],c=o[r].split(":"),m=jexcel.getIdFromColumnName(c[0],!0),N=jexcel.getIdFromColumnName(c[1],!0);if(m[0]<=N[0])var O=m[0],b=N[0];else O=N[0],b=m[0];if(m[1]<=N[1])var s=m[1],g=N[1];else s=N[1],g=m[1];for(var S=s;S<=g;S++)for(var T=O;T<=b;T++)a.push(jexcel.getColumnNameFromId([T,S]));expression=expression.replace(o[r],a.join(","))}};expression=expression.replace(/\$?([A-Z]+)\$?([0-9]+)/g,"$1$2");var tokens=expression.match(/([A-Z]+[0-9]+)\:([A-Z]+[0-9]+)/g);tokens&&tokens.length&&tokensUpdate(tokens);var tokens=expression.match(/([A-Z]+[0-9]+)/g);if(tokens&&tokens.indexOf(parentId)>-1)return console.error("Self Reference detected"),"#ERROR";var formulaExpressions={};if(tokens){for(var i=0;i<tokens.length;i++)if(obj.formula[tokens[i]]||(obj.formula[tokens[i]]=[]),obj.formula[tokens[i]].indexOf(parentId)<0&&obj.formula[tokens[i]].push(parentId),eval("typeof("+tokens[i]+') == "undefined"')){var position=jexcel.getIdFromColumnName(tokens[i],1);if(obj.options.data[position[1]]!==void 0&&obj.options.data[position[1]][position[0]]!==void 0)var value=obj.options.data[position[1]][position[0]];else var value="";if((""+value).substr(0,1)=="="&&(formulaResults[tokens[i]]!==void 0?value=formulaResults[tokens[i]]:(value=execute(value,position[0],position[1]),formulaResults[tokens[i]]=value)),(""+value).trim()=="")formulaExpressions[tokens[i]]=null;else if(value==Number(value)&&obj.options.autoCasting==1)formulaExpressions[tokens[i]]=Number(value);else{var number=obj.parseNumber(value,position[0]);obj.options.autoCasting==1&&number?formulaExpressions[tokens[i]]=number:formulaExpressions[tokens[i]]='"'+value+'"'}}}try{var res=jexcel.formula(expression.substr(1),formulaExpressions,x,y,obj)}catch(o){var res="#ERROR";console.log(o)}return res};return execute(expression,x,y)},obj.parseNumber=function(o,r){var a=r&&obj.options.columns[r].decimal?obj.options.columns[r].decimal:".",c=""+o;return(c=c.split(a))[0]=c[0].match(/[+-]?[0-9]/g),c[0]&&(c[0]=c[0].join("")),c[1]&&(c[1]=c[1].match(/[0-9]*/g).join("")),c[0]&&Number.isInteger(Number(c[0]))?c[1]?o=+(c[0]+"."+c[1]):o=+(c[0]+".00"):o=null,o},obj.row=function(o){},obj.col=function(o){},obj.up=function(o,r){if(o?obj.selectedCell[3]>0&&obj.up.visible(1,r?0:1):(obj.selectedCell[1]>0&&obj.up.visible(0,r?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.options.lazyLoading==1)if(obj.selectedCell[1]==0||obj.selectedCell[3]==0)obj.loadPage(0),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);else if(obj.loadValidation())obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);else{var a=parseInt(obj.tbody.firstChild.getAttribute("data-y"));obj.selectedCell[1]-a<30&&(obj.loadUp(),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]))}else if(obj.options.pagination>0){var c=obj.whichPage(obj.selectedCell[3]);c!=obj.pageNumber&&obj.page(c)}obj.updateScroll(1)},obj.up.visible=function(o,r){if(o==0)var a=parseInt(obj.selectedCell[0]),c=parseInt(obj.selectedCell[1]);else a=parseInt(obj.selectedCell[2]),c=parseInt(obj.selectedCell[3]);if(r==0){for(var m=0;m<c;m++)if(obj.records[m][a].style.display!="none"&&obj.rows[m].style.display!="none"){c=m;break}}else c=obj.up.get(a,c);o==0?(obj.selectedCell[0]=a,obj.selectedCell[1]=c):(obj.selectedCell[2]=a,obj.selectedCell[3]=c)},obj.up.get=function(o,r){o=parseInt(o);for(var a=(r=parseInt(r))-1;a>=0;a--)if(obj.records[a][o].style.display!="none"&&obj.rows[a].style.display!="none"){if(obj.records[a][o].getAttribute("data-merged")&&obj.records[a][o]==obj.records[r][o])continue;r=a;break}return r},obj.down=function(o,r){if(o?obj.selectedCell[3]<obj.records.length-1&&obj.down.visible(1,r?0:1):(obj.selectedCell[1]<obj.records.length-1&&obj.down.visible(0,r?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.options.lazyLoading==1)obj.selectedCell[1]==obj.records.length-1||obj.selectedCell[3]==obj.records.length-1?(obj.loadPage(-1),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])):obj.loadValidation()?obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]):parseInt(obj.tbody.lastChild.getAttribute("data-y"))-obj.selectedCell[3]<30&&(obj.loadDown(),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]));else if(obj.options.pagination>0){var a=obj.whichPage(obj.selectedCell[3]);a!=obj.pageNumber&&obj.page(a)}obj.updateScroll(3)},obj.down.visible=function(o,r){if(o==0)var a=parseInt(obj.selectedCell[0]),c=parseInt(obj.selectedCell[1]);else a=parseInt(obj.selectedCell[2]),c=parseInt(obj.selectedCell[3]);if(r==0){for(var m=obj.rows.length-1;m>c;m--)if(obj.records[m][a].style.display!="none"&&obj.rows[m].style.display!="none"){c=m;break}}else c=obj.down.get(a,c);o==0?(obj.selectedCell[0]=a,obj.selectedCell[1]=c):(obj.selectedCell[2]=a,obj.selectedCell[3]=c)},obj.down.get=function(o,r){o=parseInt(o);for(var a=(r=parseInt(r))+1;a<obj.rows.length;a++)if(obj.records[a][o].style.display!="none"&&obj.rows[a].style.display!="none"){if(obj.records[a][o].getAttribute("data-merged")&&obj.records[a][o]==obj.records[r][o])continue;r=a;break}return r},obj.right=function(o,r){o?obj.selectedCell[2]<obj.headers.length-1&&obj.right.visible(1,r?0:1):(obj.selectedCell[0]<obj.headers.length-1&&obj.right.visible(0,r?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(2)},obj.right.visible=function(o,r){if(o==0)var a=parseInt(obj.selectedCell[0]),c=parseInt(obj.selectedCell[1]);else a=parseInt(obj.selectedCell[2]),c=parseInt(obj.selectedCell[3]);if(r==0){for(var m=obj.headers.length-1;m>a;m--)if(obj.records[c][m].style.display!="none"){a=m;break}}else a=obj.right.get(a,c);o==0?(obj.selectedCell[0]=a,obj.selectedCell[1]=c):(obj.selectedCell[2]=a,obj.selectedCell[3]=c)},obj.right.get=function(o,r){o=parseInt(o),r=parseInt(r);for(var a=o+1;a<obj.headers.length;a++)if(obj.records[r][a].style.display!="none"){if(obj.records[r][a].getAttribute("data-merged")&&obj.records[r][a]==obj.records[r][o])continue;o=a;break}return o},obj.left=function(o,r){o?obj.selectedCell[2]>0&&obj.left.visible(1,r?0:1):(obj.selectedCell[0]>0&&obj.left.visible(0,r?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(0)},obj.left.visible=function(o,r){if(o==0)var a=parseInt(obj.selectedCell[0]),c=parseInt(obj.selectedCell[1]);else a=parseInt(obj.selectedCell[2]),c=parseInt(obj.selectedCell[3]);if(r==0){for(var m=0;m<a;m++)if(obj.records[c][m].style.display!="none"){a=m;break}}else a=obj.left.get(a,c);o==0?(obj.selectedCell[0]=a,obj.selectedCell[1]=c):(obj.selectedCell[2]=a,obj.selectedCell[3]=c)},obj.left.get=function(o,r){o=parseInt(o),r=parseInt(r);for(var a=o-1;a>=0;a--)if(obj.records[r][a].style.display!="none"){if(obj.records[r][a].getAttribute("data-merged")&&obj.records[r][a]==obj.records[r][o])continue;o=a;break}return o},obj.first=function(o,r){if(o?r?obj.selectedCell[3]=0:obj.left.visible(1,0):(r?obj.selectedCell[1]=0:obj.left.visible(0,0),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.options.lazyLoading!=1||obj.selectedCell[1]!=0&&obj.selectedCell[3]!=0){if(obj.options.pagination>0){var a=obj.whichPage(obj.selectedCell[3]);a!=obj.pageNumber&&obj.page(a)}}else obj.loadPage(0);obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(1)},obj.last=function(o,r){if(o?r?obj.selectedCell[3]=obj.records.length-1:obj.right.visible(1,0):(r?obj.selectedCell[1]=obj.records.length-1:obj.right.visible(0,0),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.options.lazyLoading!=1||obj.selectedCell[1]!=obj.records.length-1&&obj.selectedCell[3]!=obj.records.length-1){if(obj.options.pagination>0){var a=obj.whichPage(obj.selectedCell[3]);a!=obj.pageNumber&&obj.page(a)}}else obj.loadPage(-1);obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(3)},obj.selectAll=function(){obj.selectedCell||(obj.selectedCell=[]),obj.selectedCell[0]=0,obj.selectedCell[1]=0,obj.selectedCell[2]=obj.headers.length-1,obj.selectedCell[3]=obj.records.length-1,obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])},obj.loadPage=function(o){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)r=obj.rows;else var r=obj.results;var a=100;o!=null&&o!=-1||(o=Math.ceil(r.length/a)-1);var c=o*a,m=o*a+a;m>r.length&&(m=r.length),(c=m-100)<0&&(c=0);for(var N=c;N<m;N++)obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.appendChild(obj.rows[N]):obj.tbody.appendChild(obj.rows[r[N]]),obj.tbody.children.length>a&&obj.tbody.removeChild(obj.tbody.firstChild)},obj.loadUp=function(){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)o=obj.rows;else var o=obj.results;var r=0;if(o.length>100){var a=parseInt(obj.tbody.firstChild.getAttribute("data-y"));if(obj.options.search!=1&&obj.options.filters!=1||!obj.results||(a=o.indexOf(a)),a>0)for(var c=0;c<30;c++)(a-=1)>-1&&(obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.insertBefore(obj.rows[a],obj.tbody.firstChild):obj.tbody.insertBefore(obj.rows[o[a]],obj.tbody.firstChild),obj.tbody.children.length>100&&(obj.tbody.removeChild(obj.tbody.lastChild),r=1))}return r},obj.loadDown=function(){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)o=obj.rows;else var o=obj.results;var r=0;if(o.length>100){var a=parseInt(obj.tbody.lastChild.getAttribute("data-y"));if(obj.options.search!=1&&obj.options.filters!=1||!obj.results||(a=o.indexOf(a)),a<obj.rows.length-1)for(var c=0;c<=30;c++)a<o.length&&(obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.appendChild(obj.rows[a]):obj.tbody.appendChild(obj.rows[o[a]]),obj.tbody.children.length>100&&(obj.tbody.removeChild(obj.tbody.firstChild),r=1)),a+=1}return r},obj.loadValidation=function(){if(obj.selectedCell){var o=parseInt(obj.tbody.firstChild.getAttribute("data-y"))/100,r=parseInt(obj.selectedCell[3]/100),a=parseInt(obj.rows.length/100);if(o!=r&&r<=a&&!Array.prototype.indexOf.call(obj.tbody.children,obj.rows[obj.selectedCell[3]]))return obj.loadPage(r),!0}return!1},obj.resetSearch=function(){obj.searchInput.value="",obj.search(""),obj.results=null},obj.search=function(o){if(obj.options.filters&&obj.resetFilters(),obj.resetSelection(),obj.pageNumber=0,obj.results=[],o){var r=function(c){obj.results.indexOf(c)==-1&&obj.results.push(c)},a=o.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");a=new RegExp(a,"i"),obj.options.data.forEach(function(c,m){if(function(g,S,T){for(var d=0;d<g.length;d++)if((""+g[d]).toLowerCase().search(S)>=0||(""+obj.records[T][d].innerHTML).toLowerCase().search(S)>=0)return!0;return!1}(c,a,m)){var N=obj.isRowMerged(m);if(N.length)for(var O=0;O<N.length;O++)for(var b=jexcel.getIdFromColumnName(N[O],!0),s=0;s<obj.options.mergeCells[N[O]][1];s++)r(b[1]+s);else r(m)}})}else obj.results=null;return obj.updateResult()},obj.updateResult=function(){var o,r=0;for(o=obj.options.lazyLoading==1?100:obj.options.pagination>0?obj.options.pagination:obj.results?obj.results.length:obj.rows.length;obj.tbody.firstChild;)obj.tbody.removeChild(obj.tbody.firstChild);for(var a=0;a<obj.rows.length;a++)!obj.results||obj.results.indexOf(a)>-1?(r<o&&(obj.tbody.appendChild(obj.rows[a]),r++),obj.rows[a].style.display=""):obj.rows[a].style.display="none";return obj.options.pagination>0&&obj.updatePagination(),obj.updateCornerPosition(),o},obj.whichPage=function(o){return obj.options.search!=1&&obj.options.filters!=1||!obj.results||(o=obj.results.indexOf(o)),Math.ceil((parseInt(o)+1)/parseInt(obj.options.pagination))-1},obj.page=function(o){var r=obj.pageNumber;if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)a=obj.rows;else var a=obj.results;var c=parseInt(obj.options.pagination);o!=null&&o!=-1||(o=Math.ceil(a.length/c)-1),obj.pageNumber=o;var m=o*c,N=o*c+c;for(N>a.length&&(N=a.length),m<0&&(m=0);obj.tbody.firstChild;)obj.tbody.removeChild(obj.tbody.firstChild);for(var O=m;O<N;O++)obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.appendChild(obj.rows[O]):obj.tbody.appendChild(obj.rows[a[O]]);obj.options.pagination>0&&obj.updatePagination(),obj.updateCornerPosition(),obj.dispatch("onchangepage",el,o,r)},obj.updatePagination=function(){if(obj.pagination.children[0].innerHTML="",obj.pagination.children[1].innerHTML="",obj.options.pagination){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)o=obj.rows.length;else var o=obj.results.length;if(o){var r=Math.ceil(o/obj.options.pagination);if(obj.pageNumber<6)var a=1,c=r<10?r:10;else r-obj.pageNumber<5?(c=r,(a=r-9)<1&&(a=1)):(a=obj.pageNumber-4,c=obj.pageNumber+5);a>1&&((N=document.createElement("div")).className="jexcel_page",N.innerHTML="<",N.title=1,obj.pagination.children[1].appendChild(N));for(var m=a;m<=c;m++){var N;(N=document.createElement("div")).className="jexcel_page",N.innerHTML=m,obj.pagination.children[1].appendChild(N),obj.pageNumber==m-1&&N.classList.add("jexcel_page_selected")}c<r&&((N=document.createElement("div")).className="jexcel_page",N.innerHTML=">",N.title=r,obj.pagination.children[1].appendChild(N)),obj.pagination.children[0].innerHTML=function(O){var b=Array.prototype.slice.call(arguments,1);return O.replace(/{(\d+)}/g,function(s,g){return b[g]!==void 0?b[g]:s})}(obj.options.text.showingPage,obj.pageNumber+1,r)}else obj.pagination.children[0].innerHTML=obj.options.text.noRecordsFound}},obj.download=function(o){if(obj.options.allowExport==0)console.error("Export not allowed");else{var r="";r+=obj.copy(!1,obj.options.csvDelimiter,!0,o,!0);var a=new Blob(["\uFEFF"+r],{type:"text/csv;charset=utf-8;"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(a,obj.options.csvFileName+".csv");else{var c=document.createElement("a"),m=URL.createObjectURL(a);c.href=m,c.setAttribute("download",obj.options.csvFileName+".csv"),document.body.appendChild(c),c.click(),c.parentNode.removeChild(c)}}},obj.setHistory=function(o){if(obj.ignoreHistory!=1){var r=++obj.historyIndex;obj.history=obj.history=obj.history.slice(0,r+1),obj.history[r]=o}},obj.copy=function(o,r,a,c,m){r||(r="	");for(var N=new RegExp(r,"ig"),O=[],b=[],s=[],g=[],S=[],T=obj.options.data[0].length,d=obj.options.data.length,l="",p=!1,j="",f="",h=0,w=0,A=0,D=0,E=!0,C=0;C<d;C++)for(var M=0;M<T;M++)o&&!obj.records[C][M].classList.contains("highlight")||(A<=M&&(A=M),D<=C&&(D=C));if(T===A+1&&d===D+1&&(E=!1),m&&obj.options.includeHeadersOnDownload==1||!m&&obj.options.includeHeadersOnCopy==1&&!E||c){if(obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)for(l=obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0]?obj.options.nestedHeaders:[obj.options.nestedHeaders],C=0;C<l.length;C++){var k=[];for(M=0;M<l[C].length;M++){var F=parseInt(l[C][M].colspan);k.push(l[C][M].title);for(var P=0;P<F-1;P++)k.push("")}f+=k.join(r)+`\r
`}p=!0}for(obj.style=[],C=0;C<d;C++){for(b=[],s=[],M=0;M<T;M++)if(!o||obj.records[C][M].classList.contains("highlight")){p==1&&O.push(obj.headers[M].textContent);var q=obj.options.data[C][M];if(q.match&&(q.match(N)||q.match(/,/g)||q.match(/\n/)||q.match(/\"/))&&(q='"'+(q=q.replace(new RegExp('"',"g"),'""'))+'"'),b.push(q),obj.options.columns[M].type=="checkbox"||obj.options.columns[M].type=="radio")var _=q;else(_=obj.options.stripHTMLOnCopy==1?obj.records[C][M].textContent:obj.records[C][M].innerHTML).match&&(_.match(N)||_.match(/,/g)||_.match(/\n/)||_.match(/\"/))&&(_='"'+(_=_.replace(new RegExp('"',"g"),'""'))+'"');s.push(_),l=(l=obj.records[C][M].getAttribute("style")).replace("display: none;",""),obj.style.push(l||"")}b.length&&(p&&(h=b.length,g.push(O.join(r))),g.push(b.join(r))),s.length&&(w++,p&&(S.push(O.join(r)),p=!1),S.push(s.join(r)))}T==h&&d==w&&(j=f);var z=j+g.join(`\r
`),W=j+S.join(`\r
`);if(a||(obj.options.copyCompatibility==1?obj.textarea.value=W:obj.textarea.value=z,obj.textarea.select(),document.execCommand("copy")),obj.options.copyCompatibility==1?obj.data=W:obj.data=z,obj.hashString=obj.hash(obj.data),!a){if(obj.removeCopyingSelection(),obj.highlighted)for(M=0;M<obj.highlighted.length;M++)obj.highlighted[M].classList.add("copying"),obj.highlighted[M].classList.contains("highlight-left")&&obj.highlighted[M].classList.add("copying-left"),obj.highlighted[M].classList.contains("highlight-right")&&obj.highlighted[M].classList.add("copying-right"),obj.highlighted[M].classList.contains("highlight-top")&&obj.highlighted[M].classList.add("copying-top"),obj.highlighted[M].classList.contains("highlight-bottom")&&obj.highlighted[M].classList.add("copying-bottom");obj.dispatch("oncopy",el,obj.options.copyCompatibility==1?S:g,obj.hashString)}return obj.data},obj.paste=function(o,r,a){var c=parseInt(o),m=parseInt(r),N=parseInt(obj.selectedCell[2]),O=parseInt(obj.selectedCell[3]),b=N-c+1,s=O-m+1;N<c&&(o=N.toString(),b=c-N+1),O<m&&(r=O.toString(),s=m-O+1);var g=obj.dispatch("onbeforepaste",el,a,o,r);if(g===!1)return!1;g&&(a=g);var S=obj.hash(a),T=S==obj.hashString?obj.style:null;if(obj.options.copyCompatibility==1&&S==obj.hashString&&(a=obj.data),a=obj.parseCSV(a,"	"),b>1&Number.isInteger(b/a[0].length)){T=null,l=b/a[0].length;var d=a.map(function(F,P){var q=Array.apply(null,{length:l*F.length}).map(function(_,z){return F[z%F.length]});return q});a=d}if(s>1&Number.isInteger(s/a.length)){T=null;var l=s/a.length;d=Array.apply(null,{length:l*a.length}).map(function(F,P){return a[P%a.length]}),a=d}if(o!=null&&r!=null&&a){for(var p=0,j=0,f=[],h={},w={},A=0,D=parseInt(o),E=parseInt(r),C=null;C=a[j];){for(p=0,D=parseInt(o);C[p]!=null;){var M=obj.updateCell(D,E,C[p]);if(f.push(M),obj.updateFormulaChain(D,E,f),T&&T[A]){var k=jexcel.getColumnNameFromId([D,E]);h[k]=T[A],w[k]=obj.getStyle(k),obj.records[E][D].setAttribute("style",T[A]),A++}if(C[++p]!=null){if(D>=obj.headers.length-1){if(obj.options.allowInsertColumn!=1)break;obj.insertColumn()}D=obj.right.get(D,E)}}if(j++,a[j]){if(E>=obj.rows.length-1){if(obj.options.allowInsertRow!=1)break;obj.insertRow()}E=obj.down.get(o,E)}}obj.updateSelectionFromCoords(o,r,D,E),obj.setHistory({action:"setValue",records:f,selection:obj.selectedCell,newStyle:h,oldStyle:w}),obj.updateTable(),obj.dispatch("onpaste",el,a),obj.onafterchanges(el,f)}obj.removeCopyingSelection()},obj.removeCopyingSelection=function(){for(var o=document.querySelectorAll(".jexcel .copying"),r=0;r<o.length;r++)o[r].classList.remove("copying"),o[r].classList.remove("copying-left"),o[r].classList.remove("copying-right"),o[r].classList.remove("copying-top"),o[r].classList.remove("copying-bottom")},obj.historyProcessRow=function(o,r){var a=r.insertBefore?+r.rowNumber:r.rowNumber+1;if(obj.options.search==1&&obj.results&&obj.results.length!=obj.rows.length&&obj.resetSearch(),o==1){for(var c=r.numOfRows,m=a;m<c+a;m++)obj.rows[m].parentNode.removeChild(obj.rows[m]);obj.records.splice(a,c),obj.options.data.splice(a,c),obj.rows.splice(a,c),obj.conditionalSelectionUpdate(1,a,c+a-1)}else{obj.records=jexcel.injectArray(obj.records,a,r.rowRecords),obj.options.data=jexcel.injectArray(obj.options.data,a,r.rowData),obj.rows=jexcel.injectArray(obj.rows,a,r.rowNode);var N=0;for(m=a;m<r.numOfRows+a;m++)obj.tbody.insertBefore(r.rowNode[N],obj.tbody.children[m]),N++}obj.options.pagination>0&&obj.page(obj.pageNumber),obj.updateTableReferences()},obj.historyProcessColumn=function(o,r){var a=r.insertBefore?r.columnNumber:r.columnNumber+1;if(o==1){var c=r.numOfColumns;obj.options.columns.splice(a,c);for(var m=a;m<c+a;m++)obj.headers[m].parentNode.removeChild(obj.headers[m]),obj.colgroup[m].parentNode.removeChild(obj.colgroup[m]);obj.headers.splice(a,c),obj.colgroup.splice(a,c);for(var N=0;N<r.data.length;N++){for(m=a;m<c+a;m++)obj.records[N][m].parentNode.removeChild(obj.records[N][m]);obj.records[N].splice(a,c),obj.options.data[N].splice(a,c)}if(obj.options.footers)for(N=0;N<obj.options.footers.length;N++)obj.options.footers[N].splice(a,c)}else{obj.options.columns=jexcel.injectArray(obj.options.columns,a,r.columns),obj.headers=jexcel.injectArray(obj.headers,a,r.headers),obj.colgroup=jexcel.injectArray(obj.colgroup,a,r.colgroup);var O=0;for(m=a;m<r.numOfColumns+a;m++)obj.headerContainer.insertBefore(r.headers[O],obj.headerContainer.children[m+1]),obj.colgroupContainer.insertBefore(r.colgroup[O],obj.colgroupContainer.children[m+1]),O++;for(N=0;N<r.data.length;N++)for(obj.options.data[N]=jexcel.injectArray(obj.options.data[N],a,r.data[N]),obj.records[N]=jexcel.injectArray(obj.records[N],a,r.records[N]),O=0,m=a;m<r.numOfColumns+a;m++)obj.rows[N].insertBefore(r.records[N][O],obj.rows[N].children[m+1]),O++;if(obj.options.footers)for(N=0;N<obj.options.footers.length;N++)obj.options.footers[N]=jexcel.injectArray(obj.options.footers[N],a,r.footers[N])}if(obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(N=0;N<obj.options.nestedHeaders.length;N++){if(o==1)var b=parseInt(obj.options.nestedHeaders[N][obj.options.nestedHeaders[N].length-1].colspan)-r.numOfColumns;else b=parseInt(obj.options.nestedHeaders[N][obj.options.nestedHeaders[N].length-1].colspan)+r.numOfColumns;obj.options.nestedHeaders[N][obj.options.nestedHeaders[N].length-1].colspan=b,obj.thead.children[N].children[obj.thead.children[N].children.length-1].setAttribute("colspan",b)}else b=o==1?parseInt(obj.options.nestedHeaders[0].colspan)-r.numOfColumns:parseInt(obj.options.nestedHeaders[0].colspan)+r.numOfColumns,obj.options.nestedHeaders[0].colspan=b,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",b);obj.updateTableReferences()},obj.undo=function(){var o=!!obj.ignoreEvents,r=!!obj.ignoreHistory;obj.ignoreEvents=!0,obj.ignoreHistory=!0;var a=[];if(obj.historyIndex>=0){var c=obj.history[obj.historyIndex--];if(c.action=="insertRow")obj.historyProcessRow(1,c);else if(c.action=="deleteRow")obj.historyProcessRow(0,c);else if(c.action=="insertColumn")obj.historyProcessColumn(1,c);else if(c.action=="deleteColumn")obj.historyProcessColumn(0,c);else if(c.action=="moveRow")obj.moveRow(c.newValue,c.oldValue);else if(c.action=="moveColumn")obj.moveColumn(c.newValue,c.oldValue);else if(c.action=="setMerge")obj.removeMerge(c.column,c.data);else if(c.action=="setStyle")obj.setStyle(c.oldValue,null,null,1);else if(c.action=="setWidth")obj.setWidth(c.column,c.oldValue);else if(c.action=="setHeight")obj.setHeight(c.row,c.oldValue);else if(c.action=="setHeader")obj.setHeader(c.column,c.oldValue);else if(c.action=="setComments")obj.setComments(c.column,c.oldValue[0],c.oldValue[1]);else if(c.action=="orderBy"){for(var m=[],N=0;N<c.rows.length;N++)m[c.rows[N]]=N;obj.updateOrderArrow(c.column,c.order?0:1),obj.updateOrder(m)}else if(c.action=="setValue"){for(var O=0;O<c.records.length;O++)a.push({x:c.records[O].x,y:c.records[O].y,newValue:c.records[O].oldValue}),c.oldStyle&&obj.resetStyle(c.oldStyle);obj.setValue(a),c.selection&&obj.updateSelectionFromCoords(c.selection[0],c.selection[1],c.selection[2],c.selection[3])}}obj.ignoreEvents=o,obj.ignoreHistory=r,obj.dispatch("onundo",el,c)},obj.redo=function(){var o=!!obj.ignoreEvents,r=!!obj.ignoreHistory;if(obj.ignoreEvents=!0,obj.ignoreHistory=!0,obj.historyIndex<obj.history.length-1){var a=obj.history[++obj.historyIndex];if(a.action=="insertRow")obj.historyProcessRow(0,a);else if(a.action=="deleteRow")obj.historyProcessRow(1,a);else if(a.action=="insertColumn")obj.historyProcessColumn(0,a);else if(a.action=="deleteColumn")obj.historyProcessColumn(1,a);else if(a.action=="moveRow")obj.moveRow(a.oldValue,a.newValue);else if(a.action=="moveColumn")obj.moveColumn(a.oldValue,a.newValue);else if(a.action=="setMerge")obj.setMerge(a.column,a.colspan,a.rowspan,1);else if(a.action=="setStyle")obj.setStyle(a.newValue,null,null,1);else if(a.action=="setWidth")obj.setWidth(a.column,a.newValue);else if(a.action=="setHeight")obj.setHeight(a.row,a.newValue);else if(a.action=="setHeader")obj.setHeader(a.column,a.newValue);else if(a.action=="setComments")obj.setComments(a.column,a.newValue[0],a.newValue[1]);else if(a.action=="orderBy")obj.updateOrderArrow(a.column,a.order),obj.updateOrder(a.rows);else if(a.action=="setValue"){obj.setValue(a.records);for(var c=0;c<a.records.length;c++)a.oldStyle&&obj.resetStyle(a.newStyle);a.selection&&obj.updateSelectionFromCoords(a.selection[0],a.selection[1],a.selection[2],a.selection[3])}}obj.ignoreEvents=o,obj.ignoreHistory=r,obj.dispatch("onredo",el,a)},obj.getDropDownValue=function(o,r){var a=[];if(obj.options.columns[o]&&obj.options.columns[o].source){for(var c=[],m=obj.options.columns[o].source,N=0;N<m.length;N++)typeof m[N]=="object"?c[m[N].id]=m[N].name:c[m[N]]=m[N];var O=Array.isArray(r)?r:(""+r).split(";");for(N=0;N<O.length;N++)typeof O[N]=="object"?a.push(c[O[N].id]):c[O[N]]&&a.push(c[O[N]])}else console.error("Invalid column");return a.length>0?a.join("; "):""},obj.parseCSV=function(o,r){(o=o.replace(/\r?\n$|\r$|\n$/g,"")).charCodeAt(o.length-1)==9&&(o+="\0"),r=r||",";for(var a=[],c=!1,m=0,N=0,O=0;O<o.length;O++){var b=o[O],s=o[O+1];a[m]=a[m]||[],a[m][N]=a[m][N]||"",b=='"'&&c&&s=='"'?(a[m][N]+=b,++O):b!='"'?b!=r||c?b!="\r"||s!=`
`||c?b==`
`&&!c||b=="\r"&&!c?(++m,N=0):a[m][N]+=b:(++m,N=0,++O):++N:c=!c}return a},obj.hash=function(o){var r,a=0;if(o.length===0)return a;for(r=0;r<o.length;r++)a=(a<<5)-a+o.charCodeAt(r),a|=0;return a},obj.onafterchanges=function(o,r){obj.dispatch("onafterchanges",o,r)},obj.destroy=function(){jexcel.destroy(el)},obj.init=function(){jexcel.current=obj,typeof jexcel.build=="function"&&(obj.options.root?jexcel.build(obj.options.root):(jexcel.build(document),jexcel.build=null)),el.setAttribute("tabindex",1),el.addEventListener("focus",function(o){jexcel.current&&!obj.selectedCell&&(obj.updateSelectionFromCoords(0,0,0,0),obj.left())}),obj.options.csv?(obj.options.loadingSpin==1&&jSuites.loading.show(),jSuites.ajax({url:obj.options.csv,method:obj.options.method,data:obj.options.requestVariables,dataType:"text",success:function(o){var r=obj.parseCSV(o,obj.options.csvDelimiter);if(obj.options.csvHeaders==1&&r.length>0)for(var a=r.shift(),c=0;c<a.length;c++)obj.options.columns[c]||(obj.options.columns[c]={type:"text",align:obj.options.defaultColAlign,width:obj.options.defaultColWidth}),obj.options.columns[c].title===void 0&&(obj.options.columns[c].title=a[c]);obj.options.data=r,obj.prepareTable(),obj.options.loadingSpin==1&&jSuites.loading.hide()}})):obj.options.url?(obj.options.loadingSpin==1&&jSuites.loading.show(),jSuites.ajax({url:obj.options.url,method:obj.options.method,data:obj.options.requestVariables,dataType:"json",success:function(o){obj.options.data=o.data?o.data:o,obj.prepareTable(),obj.options.loadingSpin==1&&jSuites.loading.hide()}})):obj.prepareTable()},options&&options.contextMenu!=null?obj.options.contextMenu=options.contextMenu:obj.options.contextMenu=function(o,r,a,c){var m=[];if(a==null)obj.options.allowInsertColumn==1&&m.push({title:obj.options.text.insertANewColumnBefore,onclick:function(){obj.insertColumn(1,parseInt(r),1)}}),obj.options.allowInsertColumn==1&&m.push({title:obj.options.text.insertANewColumnAfter,onclick:function(){obj.insertColumn(1,parseInt(r),0)}}),obj.options.allowDeleteColumn==1&&m.push({title:obj.options.text.deleteSelectedColumns,onclick:function(){obj.deleteColumn(obj.getSelectedColumns().length?void 0:parseInt(r))}}),obj.options.allowRenameColumn==1&&m.push({title:obj.options.text.renameThisColumn,onclick:function(){obj.setHeader(r)}}),obj.options.columnSorting==1&&(m.push({type:"line"}),m.push({title:obj.options.text.orderAscending,onclick:function(){obj.orderBy(r,0)}}),m.push({title:obj.options.text.orderDescending,onclick:function(){obj.orderBy(r,1)}}));else if(obj.options.allowInsertRow==1&&(m.push({title:obj.options.text.insertANewRowBefore,onclick:function(){obj.insertRow(1,parseInt(a),1)}}),m.push({title:obj.options.text.insertANewRowAfter,onclick:function(){obj.insertRow(1,parseInt(a))}})),obj.options.allowDeleteRow==1&&m.push({title:obj.options.text.deleteSelectedRows,onclick:function(){obj.deleteRow(obj.getSelectedRows().length?void 0:parseInt(a))}}),r&&obj.options.allowComments==1){m.push({type:"line"});var N=obj.records[a][r].getAttribute("title")||"";m.push({title:N?obj.options.text.editComments:obj.options.text.addComments,onclick:function(){var O=prompt(obj.options.text.comments,N);O&&obj.setComments([r,a],O)}}),N&&m.push({title:obj.options.text.clearComments,onclick:function(){obj.setComments([r,a],"")}})}return m.push({type:"line"}),m.push({title:obj.options.text.copy,shortcut:"Ctrl + C",onclick:function(){obj.copy(!0)}}),navigator&&navigator.clipboard&&m.push({title:obj.options.text.paste,shortcut:"Ctrl + V",onclick:function(){obj.selectedCell&&navigator.clipboard.readText().then(function(O){O&&jexcel.current.paste(obj.selectedCell[0],obj.selectedCell[1],O)})}}),obj.options.allowExport&&m.push({title:obj.options.text.saveAs,shortcut:"Ctrl + S",onclick:function(){obj.download()}}),obj.options.about&&m.push({title:obj.options.text.about,onclick:function(){obj.options.about===!0?alert(Version().print()):alert(obj.options.about)}}),m},obj.scrollControls=function(o){obj.wheelControls(),obj.options.freezeColumns>0&&obj.content.scrollLeft!=scrollLeft&&obj.updateFreezePosition(),obj.options.lazyLoading!=1&&obj.options.tableOverflow!=1||obj.edition&&o.target.className.substr(0,9)!="jdropdown"&&obj.closeEditor(obj.edition[0],!0)},obj.wheelControls=function(o){obj.options.lazyLoading==1&&jexcel.timeControlLoading==null&&(jexcel.timeControlLoading=setTimeout(function(){obj.content.scrollTop+obj.content.clientHeight>=obj.content.scrollHeight-10?obj.loadDown()&&(obj.content.scrollTop+obj.content.clientHeight>obj.content.scrollHeight-10&&(obj.content.scrollTop=obj.content.scrollTop-obj.content.clientHeight),obj.updateCornerPosition()):obj.content.scrollTop<=obj.content.clientHeight&&obj.loadUp()&&(obj.content.scrollTop<10&&(obj.content.scrollTop=obj.content.scrollTop+obj.content.clientHeight),obj.updateCornerPosition()),jexcel.timeControlLoading=null},100))},obj.getFreezeWidth=function(){var o=0;if(obj.options.freezeColumns>0)for(var r=0;r<obj.options.freezeColumns;r++)o+=parseInt(obj.options.columns[r].width);return o};var scrollLeft=0;return obj.updateFreezePosition=function(){var o=0;if((scrollLeft=obj.content.scrollLeft)>50)for(var r=0;r<obj.options.freezeColumns;r++){r>0&&obj.options.columns[r-1].type!=="hidden"&&(o+=parseInt(obj.options.columns[r-1].width)),obj.headers[r].classList.add("jexcel_freezed"),obj.headers[r].style.left=o+"px";for(var a=0;a<obj.rows.length;a++)if(obj.rows[a]&&obj.records[a][r]){var c=scrollLeft+(r>0?obj.records[a][r-1].style.width:0)-51+"px";obj.records[a][r].classList.add("jexcel_freezed"),obj.records[a][r].style.left=c}}else for(r=0;r<obj.options.freezeColumns;r++)for(obj.headers[r].classList.remove("jexcel_freezed"),obj.headers[r].style.left="",a=0;a<obj.rows.length;a++)obj.records[a][r]&&(obj.records[a][r].classList.remove("jexcel_freezed"),obj.records[a][r].style.left="");obj.updateCornerPosition()},el.addEventListener("DOMMouseScroll",obj.wheelControls),el.addEventListener("mousewheel",obj.wheelControls),el.jexcel=obj,el.jspreadsheet=obj,obj.init(),obj};jexcel.setDictionary=function(o){jSuites.setDictionary(o)},jexcel.setExtensions=function(o){for(var r=Object.keys(o),a=0;a<r.length;a++)typeof o[r[a]]=="function"&&(jexcel[r[a]]=o[r[a]],jexcel.license&&typeof o[r[a]].license=="function"&&o[r[a]].license(jexcel.license))},formula!==void 0&&(jexcel.formula=formula),jexcel.version=Version,jexcel.current=null,jexcel.timeControl=null,jexcel.timeControlLoading=null;const destroyEvents=function(o){o.removeEventListener("mouseup",jexcel.mouseUpControls),o.removeEventListener("mousedown",jexcel.mouseDownControls),o.removeEventListener("mousemove",jexcel.mouseMoveControls),o.removeEventListener("mouseover",jexcel.mouseOverControls),o.removeEventListener("dblclick",jexcel.doubleClickControls),o.removeEventListener("paste",jexcel.pasteControls),o.removeEventListener("contextmenu",jexcel.contextMenuControls),o.removeEventListener("touchstart",jexcel.touchStartControls),o.removeEventListener("touchend",jexcel.touchEndControls),o.removeEventListener("touchcancel",jexcel.touchEndControls),document.removeEventListener("keydown",jexcel.keyDownControls)};var component;return jexcel.destroy=function(o,r){if(o.jexcel){var a=o.jexcel.options.root?o.jexcel.options.root:document;o.removeEventListener("DOMMouseScroll",o.jexcel.scrollControls),o.removeEventListener("mousewheel",o.jexcel.scrollControls),o.jexcel=null,o.innerHTML="",r&&(destroyEvents(a),jexcel=null)}},jexcel.build=function(o){destroyEvents(o),o.addEventListener("mouseup",jexcel.mouseUpControls),o.addEventListener("mousedown",jexcel.mouseDownControls),o.addEventListener("mousemove",jexcel.mouseMoveControls),o.addEventListener("mouseover",jexcel.mouseOverControls),o.addEventListener("dblclick",jexcel.doubleClickControls),o.addEventListener("paste",jexcel.pasteControls),o.addEventListener("contextmenu",jexcel.contextMenuControls),o.addEventListener("touchstart",jexcel.touchStartControls),o.addEventListener("touchend",jexcel.touchEndControls),o.addEventListener("touchcancel",jexcel.touchEndControls),o.addEventListener("touchmove",jexcel.touchEndControls),document.addEventListener("keydown",jexcel.keyDownControls)},jexcel.keyDownControls=function(o){if(jexcel.current){if(jexcel.current.edition)if(o.which==27)jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!1),o.preventDefault();else if(o.which==13){if(jexcel.current.options.columns[jexcel.current.edition[2]].type=="calendar")jexcel.current.closeEditor(jexcel.current.edition[0],!0);else if(!(jexcel.current.options.columns[jexcel.current.edition[2]].type=="dropdown"||jexcel.current.options.columns[jexcel.current.edition[2]].type=="autocomplete"))if((jexcel.current.options.wordWrap==1||jexcel.current.options.columns[jexcel.current.edition[2]].wordWrap==1||jexcel.current.options.data[jexcel.current.edition[3]][jexcel.current.edition[2]].length>200)&&o.altKey){var r=jexcel.current.edition[0].children[0],a=jexcel.current.edition[0].children[0].value,c=r.selectionStart;a=a.slice(0,c)+`
`+a.slice(c),r.value=a,r.focus(),r.selectionStart=c+1,r.selectionEnd=c+1}else jexcel.current.edition[0].children[0].blur()}else o.which==9&&(["calendar","html"].includes(jexcel.current.options.columns[jexcel.current.edition[2]].type)?jexcel.current.closeEditor(jexcel.current.edition[0],!0):jexcel.current.edition[0].children[0].blur());if(!jexcel.current.edition&&jexcel.current.selectedCell)if(o.which==37)jexcel.current.left(o.shiftKey,o.ctrlKey),o.preventDefault();else if(o.which==39)jexcel.current.right(o.shiftKey,o.ctrlKey),o.preventDefault();else if(o.which==38)jexcel.current.up(o.shiftKey,o.ctrlKey),o.preventDefault();else if(o.which==40)jexcel.current.down(o.shiftKey,o.ctrlKey),o.preventDefault();else if(o.which==36)jexcel.current.first(o.shiftKey,o.ctrlKey),o.preventDefault();else if(o.which==35)jexcel.current.last(o.shiftKey,o.ctrlKey),o.preventDefault();else if(o.which==46||o.which==8)jexcel.current.options.editable==1&&(jexcel.current.selectedRow?jexcel.current.options.allowDeleteRow==1&&confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedRows)&&jexcel.current.deleteRow():jexcel.current.selectedHeader?jexcel.current.options.allowDeleteColumn==1&&confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedColumns)&&jexcel.current.deleteColumn():jexcel.current.setValue(jexcel.current.highlighted,""));else if(o.which==13)o.shiftKey?jexcel.current.up():(jexcel.current.options.allowInsertRow==1&&jexcel.current.options.allowManualInsertRow==1&&jexcel.current.selectedCell[1]==jexcel.current.options.data.length-1&&jexcel.current.insertRow(),jexcel.current.down()),o.preventDefault();else if(o.which==9)o.shiftKey?jexcel.current.left():(jexcel.current.options.allowInsertColumn==1&&jexcel.current.options.allowManualInsertColumn==1&&jexcel.current.selectedCell[0]==jexcel.current.options.data[0].length-1&&jexcel.current.insertColumn(),jexcel.current.right()),o.preventDefault();else if(!o.ctrlKey&&!o.metaKey||o.shiftKey){if(jexcel.current.selectedCell&&jexcel.current.options.editable==1){var m=jexcel.current.selectedCell[1],N=jexcel.current.selectedCell[0];jexcel.current.options.columns[N].type!="readonly"&&(o.keyCode==32?(o.preventDefault(),jexcel.current.options.columns[N].type=="checkbox"||jexcel.current.options.columns[N].type=="radio"?jexcel.current.setCheckRadioValue():jexcel.current.openEditor(jexcel.current.records[m][N],!0)):o.keyCode==113?jexcel.current.openEditor(jexcel.current.records[m][N],!1):(o.keyCode==8||o.keyCode>=48&&o.keyCode<=57||o.keyCode>=96&&o.keyCode<=111||o.keyCode>=187&&o.keyCode<=190||(String.fromCharCode(o.keyCode)==o.key||String.fromCharCode(o.keyCode).toLowerCase()==o.key.toLowerCase())&&jexcel.validLetter(String.fromCharCode(o.keyCode)))&&(jexcel.current.openEditor(jexcel.current.records[m][N],!0),jexcel.current.options.columns[N].type=="calendar"&&o.preventDefault()))}}else o.which==65?(jexcel.current.selectAll(),o.preventDefault()):o.which==83?(jexcel.current.download(),o.preventDefault()):o.which==89?(jexcel.current.redo(),o.preventDefault()):o.which==90?(jexcel.current.undo(),o.preventDefault()):o.which==67?(jexcel.current.copy(!0),o.preventDefault()):o.which==88?(jexcel.current.options.editable==1?jexcel.cutControls():jexcel.copyControls(),o.preventDefault()):o.which==86&&jexcel.pasteControls();else o.target.classList.contains("jexcel_search")&&(jexcel.timeControl&&clearTimeout(jexcel.timeControl),jexcel.timeControl=setTimeout(function(){jexcel.current.search(o.target.value)},200))}},jexcel.isMouseAction=!1,jexcel.mouseDownControls=function(o){if((o=o||window.event).buttons)var r=o.buttons;else r=o.button?o.button:o.which;var a=jexcel.getElement(o.target);if(a[0]?jexcel.current!=a[0].jexcel&&(jexcel.current&&(jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!0),jexcel.current.resetSelection()),jexcel.current=a[0].jexcel):jexcel.current&&(jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!0),jexcel.current.resetSelection(!0),jexcel.current=null),jexcel.current&&r==1){if(o.target.classList.contains("jexcel_selectall"))jexcel.current&&jexcel.current.selectAll();else if(o.target.classList.contains("jexcel_corner"))jexcel.current.options.editable==1&&(jexcel.current.selectedCorner=!0);else{if(a[1]==1){if(l=o.target.getAttribute("data-x")){var c=o.target.getBoundingClientRect();if(jexcel.current.options.columnResize==1&&c.width-o.offsetX<6){jexcel.current.resizing={mousePosition:o.pageX,column:l,width:c.width},jexcel.current.headers[l].classList.add("resizing");for(var m=0;m<jexcel.current.records.length;m++)jexcel.current.records[m][l]&&jexcel.current.records[m][l].classList.add("resizing")}else if(jexcel.current.options.columnDrag==1&&c.height-o.offsetY<6)if(jexcel.current.isColMerged(l).length)console.error("Jspreadsheet: This column is part of a merged cell.");else for(jexcel.current.resetSelection(),jexcel.current.dragging={element:o.target,column:l,destination:l},jexcel.current.headers[l].classList.add("dragging"),m=0;m<jexcel.current.records.length;m++)jexcel.current.records[m][l]&&jexcel.current.records[m][l].classList.add("dragging");else{if(jexcel.current.selectedHeader&&(o.shiftKey||o.ctrlKey))var N=jexcel.current.selectedHeader,O=l;else jexcel.current.selectedHeader==l&&jexcel.current.options.allowRenameColumn==1&&(jexcel.timeControl=setTimeout(function(){jexcel.current.setHeader(l)},800)),jexcel.current.selectedHeader=l,N=l,O=l;jexcel.current.updateSelectionFromCoords(N,0,O,jexcel.current.options.data.length-1)}}else if(o.target.parentNode.classList.contains("jexcel_nested")){if(o.target.getAttribute("data-column"))var b=o.target.getAttribute("data-column").split(","),s=parseInt(b[0]),g=parseInt(b[b.length-1]);else s=0,g=jexcel.current.options.columns.length-1;jexcel.current.updateSelectionFromCoords(s,0,g,jexcel.current.options.data.length-1)}}else jexcel.current.selectedHeader=!1;if(a[1]==2){var S=o.target.getAttribute("data-y");if(o.target.classList.contains("jexcel_row"))c=o.target.getBoundingClientRect(),jexcel.current.options.rowResize==1&&c.height-o.offsetY<6?(jexcel.current.resizing={element:o.target.parentNode,mousePosition:o.pageY,row:S,height:c.height},o.target.parentNode.classList.add("resizing")):jexcel.current.options.rowDrag==1&&c.width-o.offsetX<6?jexcel.current.isRowMerged(S).length?console.error("Jspreadsheet: This row is part of a merged cell"):jexcel.current.options.search==1&&jexcel.current.results?console.error("Jspreadsheet: Please clear your search before perform this action"):(jexcel.current.resetSelection(),jexcel.current.dragging={element:o.target.parentNode,row:S,destination:S},o.target.parentNode.classList.add("dragging")):(jexcel.current.selectedRow&&(o.shiftKey||o.ctrlKey)?(N=jexcel.current.selectedRow,O=S):(jexcel.current.selectedRow=S,N=S,O=S),jexcel.current.updateSelectionFromCoords(0,N,jexcel.current.options.data[0].length-1,O));else if(o.target.classList.contains("jclose")&&o.target.clientWidth-o.offsetX<50&&o.offsetY<50)jexcel.current.closeEditor(jexcel.current.edition[0],!0);else{var T=function(p){var j=p.getAttribute("data-x"),f=p.getAttribute("data-y");return j&&f?[j,f]:p.parentNode?T(p.parentNode):void 0},d=T(o.target);if(d){var l=d[0];S=d[1],jexcel.current.edition&&(jexcel.current.edition[2]==l&&jexcel.current.edition[3]==S||jexcel.current.closeEditor(jexcel.current.edition[0],!0)),jexcel.current.edition||(o.shiftKey?jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],l,S):jexcel.current.updateSelectionFromCoords(l,S)),jexcel.current.selectedHeader=null,jexcel.current.selectedRow=null}}}else jexcel.current.selectedRow=!1;o.target.classList.contains("jexcel_page")&&(o.target.textContent=="<"?jexcel.current.page(0):o.target.textContent==">"?jexcel.current.page(o.target.getAttribute("title")-1):jexcel.current.page(o.target.textContent-1))}jexcel.current.edition?jexcel.isMouseAction=!1:jexcel.isMouseAction=!0}else jexcel.isMouseAction=!1},jexcel.mouseUpControls=function(o){if(jexcel.current)if(jexcel.current.resizing){if(jexcel.current.resizing.column){var r=jexcel.current.colgroup[jexcel.current.resizing.column].getAttribute("width"),a=jexcel.current.getSelectedColumns();if(a.length>1){for(var c=[],m=0;m<a.length;m++)c.push(parseInt(jexcel.current.colgroup[a[m]].getAttribute("width")));c[a.indexOf(parseInt(jexcel.current.resizing.column))]=jexcel.current.resizing.width,jexcel.current.setWidth(a,r,c)}else jexcel.current.setWidth(jexcel.current.resizing.column,r,jexcel.current.resizing.width);jexcel.current.headers[jexcel.current.resizing.column].classList.remove("resizing");for(var N=0;N<jexcel.current.records.length;N++)jexcel.current.records[N][jexcel.current.resizing.column]&&jexcel.current.records[N][jexcel.current.resizing.column].classList.remove("resizing")}else{jexcel.current.rows[jexcel.current.resizing.row].children[0].classList.remove("resizing");var O=jexcel.current.rows[jexcel.current.resizing.row].getAttribute("height");jexcel.current.setHeight(jexcel.current.resizing.row,O,jexcel.current.resizing.height),jexcel.current.resizing.element.classList.remove("resizing")}jexcel.current.resizing=null}else if(jexcel.current.dragging){if(jexcel.current.dragging){if(jexcel.current.dragging.column){var b=o.target.getAttribute("data-x");for(jexcel.current.headers[jexcel.current.dragging.column].classList.remove("dragging"),N=0;N<jexcel.current.rows.length;N++)jexcel.current.records[N][jexcel.current.dragging.column]&&jexcel.current.records[N][jexcel.current.dragging.column].classList.remove("dragging");for(m=0;m<jexcel.current.headers.length;m++)jexcel.current.headers[m].classList.remove("dragging-left"),jexcel.current.headers[m].classList.remove("dragging-right");b&&jexcel.current.dragging.column!=jexcel.current.dragging.destination&&jexcel.current.moveColumn(jexcel.current.dragging.column,jexcel.current.dragging.destination)}else{if(jexcel.current.dragging.element.nextSibling){var s=parseInt(jexcel.current.dragging.element.nextSibling.getAttribute("data-y"));jexcel.current.dragging.row<s&&(s-=1)}else s=parseInt(jexcel.current.dragging.element.previousSibling.getAttribute("data-y"));jexcel.current.dragging.row!=jexcel.current.dragging.destination&&jexcel.current.moveRow(jexcel.current.dragging.row,s,!0),jexcel.current.dragging.element.classList.remove("dragging")}jexcel.current.dragging=null}}else jexcel.current.selectedCorner&&(jexcel.current.selectedCorner=!1,jexcel.current.selection.length>0&&(jexcel.current.copyData(jexcel.current.selection[0],jexcel.current.selection[jexcel.current.selection.length-1]),jexcel.current.removeCopySelection()));jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null),jexcel.isMouseAction=!1},jexcel.mouseMoveControls=function(o){if((o=o||window.event).buttons)var r=o.buttons;else r=o.button?o.button:o.which;if(r||(jexcel.isMouseAction=!1),jexcel.current)if(jexcel.isMouseAction==1){if(jexcel.current.resizing)if(jexcel.current.resizing.column){var a=o.pageX-jexcel.current.resizing.mousePosition;if(jexcel.current.resizing.width+a>0){var c=jexcel.current.resizing.width+a;jexcel.current.colgroup[jexcel.current.resizing.column].setAttribute("width",c),jexcel.current.updateCornerPosition()}}else{var m=o.pageY-jexcel.current.resizing.mousePosition;if(jexcel.current.resizing.height+m>0){var N=jexcel.current.resizing.height+m;jexcel.current.rows[jexcel.current.resizing.row].setAttribute("height",N),jexcel.current.updateCornerPosition()}}else if(jexcel.current.dragging)if(jexcel.current.dragging.column){var O=o.target.getAttribute("data-x");if(O)if(jexcel.current.isColMerged(O).length)console.error("Jspreadsheet: This column is part of a merged cell.");else{for(var b=0;b<jexcel.current.headers.length;b++)jexcel.current.headers[b].classList.remove("dragging-left"),jexcel.current.headers[b].classList.remove("dragging-right");jexcel.current.dragging.column==O?jexcel.current.dragging.destination=parseInt(O):o.target.clientWidth/2>o.offsetX?(jexcel.current.dragging.column<O?jexcel.current.dragging.destination=parseInt(O)-1:jexcel.current.dragging.destination=parseInt(O),jexcel.current.headers[O].classList.add("dragging-left")):(jexcel.current.dragging.column<O?jexcel.current.dragging.destination=parseInt(O):jexcel.current.dragging.destination=parseInt(O)+1,jexcel.current.headers[O].classList.add("dragging-right"))}}else{var s=o.target.getAttribute("data-y");if(s)if(jexcel.current.isRowMerged(s).length)console.error("Jspreadsheet: This row is part of a merged cell.");else{var g=o.target.clientHeight/2>o.offsetY?o.target.parentNode.nextSibling:o.target.parentNode;jexcel.current.dragging.element!=g&&(o.target.parentNode.parentNode.insertBefore(jexcel.current.dragging.element,g),jexcel.current.dragging.destination=Array.prototype.indexOf.call(jexcel.current.dragging.element.parentNode.children,jexcel.current.dragging.element))}}}else{var S=o.target.getAttribute("data-x"),T=o.target.getAttribute("data-y"),d=o.target.getBoundingClientRect();jexcel.current.cursor&&(jexcel.current.cursor.style.cursor="",jexcel.current.cursor=null),o.target.parentNode.parentNode&&o.target.parentNode.parentNode.className&&(o.target.parentNode.parentNode.classList.contains("resizable")&&(o.target&&S&&!T&&d.width-(o.clientX-d.left)<6?(jexcel.current.cursor=o.target,jexcel.current.cursor.style.cursor="col-resize"):o.target&&!S&&T&&d.height-(o.clientY-d.top)<6&&(jexcel.current.cursor=o.target,jexcel.current.cursor.style.cursor="row-resize")),o.target.parentNode.parentNode.classList.contains("draggable")&&(o.target&&!S&&T&&d.width-(o.clientX-d.left)<6||o.target&&S&&!T&&d.height-(o.clientY-d.top)<6)&&(jexcel.current.cursor=o.target,jexcel.current.cursor.style.cursor="move"))}},jexcel.mouseOverControls=function(o){if((o=o||window.event).buttons)var r=o.buttons;else r=o.button?o.button:o.which;if(r||(jexcel.isMouseAction=!1),jexcel.current&&jexcel.isMouseAction==1){var a=jexcel.getElement(o.target);if(a[0]){if(jexcel.current!=a[0].jexcel&&jexcel.current)return!1;var c=o.target.getAttribute("data-x"),m=o.target.getAttribute("data-y");if(!(jexcel.current.resizing||jexcel.current.dragging)){if(a[1]==1&&jexcel.current.selectedHeader){c=o.target.getAttribute("data-x");var N=jexcel.current.selectedHeader,O=c;jexcel.current.updateSelectionFromCoords(N,0,O,jexcel.current.options.data.length-1)}a[1]==2&&(o.target.classList.contains("jexcel_row")?jexcel.current.selectedRow&&(N=jexcel.current.selectedRow,O=m,jexcel.current.updateSelectionFromCoords(0,N,jexcel.current.options.data[0].length-1,O)):jexcel.current.edition||c&&m&&(jexcel.current.selectedCorner?jexcel.current.updateCopySelection(c,m):jexcel.current.selectedCell&&jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],c,m)))}}}jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null)},jexcel.doubleClickControls=function(o){if(jexcel.current)if(o.target.classList.contains("jexcel_corner")){if(jexcel.current.highlighted.length>0){var r=jexcel.current.highlighted[0].getAttribute("data-x"),a=parseInt(jexcel.current.highlighted[jexcel.current.highlighted.length-1].getAttribute("data-y"))+1,c=jexcel.current.highlighted[jexcel.current.highlighted.length-1].getAttribute("data-x"),m=jexcel.current.records.length-1;jexcel.current.copyData(jexcel.current.records[a][r],jexcel.current.records[m][c])}}else if(o.target.classList.contains("jexcel_column_filter")){var N=o.target.getAttribute("data-x");jexcel.current.openFilter(N)}else{var O=jexcel.getElement(o.target);if(O[1]==1&&jexcel.current.options.columnSorting==1&&(N=o.target.getAttribute("data-x"))&&jexcel.current.orderBy(N),O[1]==2&&jexcel.current.options.editable==1&&!jexcel.current.edition){var b=function(g){if(g.parentNode){var S=g.getAttribute("data-x"),T=g.getAttribute("data-y");return S&&T?g:b(g.parentNode)}},s=b(o.target);s&&s.classList.contains("highlight")&&jexcel.current.openEditor(s)}}},jexcel.copyControls=function(o){jexcel.current&&jexcel.copyControls.enabled&&(jexcel.current.edition||jexcel.current.copy(!0))},jexcel.cutControls=function(o){jexcel.current&&(jexcel.current.edition||(jexcel.current.copy(!0),jexcel.current.options.editable==1&&jexcel.current.setValue(jexcel.current.highlighted,"")))},jexcel.pasteControls=function(o){jexcel.current&&jexcel.current.selectedCell&&(jexcel.current.edition||jexcel.current.options.editable==1&&(o&&o.clipboardData?(jexcel.current.paste(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],o.clipboardData.getData("text")),o.preventDefault()):window.clipboardData&&jexcel.current.paste(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],window.clipboardData.getData("text"))))},jexcel.contextMenuControls=function(o){if("buttons"in(o=o||window.event)?o.buttons:o.which||o.button,jexcel.current){if(jexcel.current.edition)o.preventDefault();else if(jexcel.current.options.contextMenu&&(jexcel.current.contextMenu.contextmenu.close(),jexcel.current)){var r=o.target.getAttribute("data-x"),a=o.target.getAttribute("data-y");if(r||a){(r<parseInt(jexcel.current.selectedCell[0])||r>parseInt(jexcel.current.selectedCell[2])||a<parseInt(jexcel.current.selectedCell[1])||a>parseInt(jexcel.current.selectedCell[3]))&&jexcel.current.updateSelectionFromCoords(r,a,r,a);var c=jexcel.current.options.contextMenu(jexcel.current,r,a,o);jexcel.current.contextMenu.contextmenu.open(o,c),o.preventDefault()}}}},jexcel.touchStartControls=function(o){var r=jexcel.getElement(o.target);if(r[0]?jexcel.current!=r[0].jexcel&&(jexcel.current&&jexcel.current.resetSelection(),jexcel.current=r[0].jexcel):jexcel.current&&(jexcel.current.resetSelection(),jexcel.current=null),jexcel.current&&!jexcel.current.edition){var a=o.target.getAttribute("data-x"),c=o.target.getAttribute("data-y");a&&c&&(jexcel.current.updateSelectionFromCoords(a,c),jexcel.timeControl=setTimeout(function(){jexcel.current.options.columns[a].type=="color"?jexcel.tmpElement=null:jexcel.tmpElement=o.target,jexcel.current.openEditor(o.target,!1,o)},500))}},jexcel.touchEndControls=function(o){jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null,jexcel.tmpElement&&jexcel.tmpElement.children[0].tagName=="INPUT"&&jexcel.tmpElement.children[0].focus(),jexcel.tmpElement=null)},jexcel.tabs=function(o,r){var a=[];if(o.classList.contains("jexcel_tabs"))m=o.children[0],N=o.children[1];else{o.innerHTML="",o.classList.add("jexcel_tabs"),o.jexcel=[];var c=document.createElement("div"),m=o.appendChild(c),N=(c=document.createElement("div"),o.appendChild(c))}for(var O=[],b=[],s=0;s<r.length;s++){O[s]=document.createElement("div"),O[s].classList.add("jexcel_tab");var g=jexcel(O[s],r[s]);N.appendChild(O[s]),a[s]=o.jexcel.push(g),b[s]=document.createElement("div"),b[s].classList.add("jexcel_tab_link"),b[s].setAttribute("data-spreadsheet",o.jexcel.length-1),b[s].innerHTML=r[s].sheetName,b[s].onclick=function(){for(var T=0;T<m.children.length;T++)m.children[T].classList.remove("selected"),N.children[T].style.display="none";var d=this.getAttribute("data-spreadsheet");N.children[d].style.display="block",m.children[d].classList.add("selected")},m.appendChild(b[s])}for(var S=0;S<m.children.length;S++)m.children[S].classList.remove("selected"),N.children[S].style.display="none";return m.children[m.children.length-1].classList.add("selected"),N.children[m.children.length-1].style.display="block",a},jexcel.createTabs=jexcel.tabs,jexcel.fromSpreadsheet=function(o,r){var a,c=function(m){var N=[];return m.SheetNames.forEach(function(O){var b={rows:[],columns:[],data:[],style:{}};if(b.sheetName=O,(f=m.Sheets[O]["!cols"])&&f.length)for(var s=0;s<f.length;s++)b.columns[s]={},f[s]&&f[s].wpx&&(b.columns[s].width=f[s].wpx+"px");if((f=m.Sheets[O]["!rows"])&&f.length)for(s=0;s<f.length;s++)f[s]&&f[s].hpx&&(b.rows[s]={},b.rows[s].height=f[s].hpx+"px");if((f=m.Sheets[O]["!merges"])&&f.length>0)for(b.mergeCells=[],s=0;s<f.length;s++){var g=f[s].s.c,S=f[s].s.r,T=f[s].e.c,d=f[s].e.r,l=jexcel.getColumnNameFromId([g,S]);b.mergeCells[l]=[T-g+1,d-S+1]}var p=0,j=0,f=Object.keys(m.Sheets[O]);for(s=0;s<f.length;s++)if(f[s].substr(0,1)!="!"){var h=m.Sheets[O][f[s]],w=jexcel.getIdFromColumnName(f[s],!0);b.data[w[1]]||(b.data[w[1]]=[]),b.data[w[1]][w[0]]=h.f?"="+h.f:h.w,p<w[0]&&(p=w[0]),j<w[1]&&(j=w[1]),h.style&&Object.keys(h.style).length>0&&(b.style[f[s]]=h.style),h.s&&h.s.fgColor&&(b.style[f[s]]&&(b.style[f[s]]+=";"),b.style[f[s]]+="background-color:#"+h.s.fgColor.rgb)}for(var A=b.columns,D=0;D<=j;D++)for(s=0;s<=p;s++)b.data[D]||(b.data[D]=[]),b.data[D][s]||A<s&&(b.data[D][s]="");N.push(b)}),N};(a=new XMLHttpRequest).open("GET",o,!0),typeof Uint8Array<"u"?(a.responseType="arraybuffer",a.onload=function(m){var N=a.response,O=new Uint8Array(N),b=XLSX.read(O,{type:"array",cellFormula:!0,cellStyles:!0});r(c(b))}):(a.setRequestHeader("Accept-Charset","x-user-defined"),a.onreadystatechange=function(){if(a.readyState==4&&a.status==200){var m=convertResponseBodyToText(a.responseBody),N=XLSX.read(m,{type:"binary",cellFormula:!0,cellStyles:!0});r(c(N))}}),a.send()},jexcel.validLetter=function(o){return o.match(/([\u0041-\u005A\u0061-\u007A\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0\u08A2-\u08AC\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA793\uA7A0-\uA7AA\uA7F8-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC-\u0400-\u04FF']+)/g)?1:0},jexcel.injectArray=function(o,r,a){return o.slice(0,r).concat(a).concat(o.slice(r))},jexcel.getColumnName=function(o){return jexcel.helpers.getColumnName(o)},jexcel.getIdFromColumnName=function(o,r){var a=/^[a-zA-Z]+/.exec(o);if(a){for(var c=0,m=0;m<a[0].length;m++)c+=parseInt(a[0].charCodeAt(m)-64)*Math.pow(26,a[0].length-1-m);--c<0&&(c=0);var N=parseInt(/[0-9]+$/.exec(o));N>0&&N--,o=r==1?[c,N]:c+"-"+N}return o},jexcel.getColumnNameFromId=function(o){return Array.isArray(o)||(o=o.split("-")),jexcel.getColumnName(parseInt(o[0]))+(parseInt(o[1])+1)},jexcel.getElement=function(o){var r=0,a=0;return function c(m){m.className&&m.classList.contains("jexcel_container")&&(a=m),m.tagName=="THEAD"?r=1:m.tagName=="TBODY"&&(r=2),m.parentNode&&(a||c(m.parentNode))}(o),[a,r]},jexcel.doubleDigitFormat=function(o){return(o=""+o).length==1&&(o="0"+o),o},jexcel.createFromTable=function(o,r){if(o.tagName=="TABLE"){r||(r={}),r.columns=[],r.data=[];var a=o.querySelectorAll("colgroup > col");if(a.length)for(var c=0;c<a.length;c++){if(!(m=a[c].style.width))var m=a[c].getAttribute("width");m&&(r.columns[c]||(r.columns[c]={}),r.columns[c].width=m)}var N=function(z){var W=z.getBoundingClientRect(),U=W.width>50?W.width:50;r.columns[c]||(r.columns[c]={}),z.getAttribute("data-celltype")?r.columns[c].type=z.getAttribute("data-celltype"):r.columns[c].type="text",r.columns[c].width=U+"px",r.columns[c].title=z.innerHTML,r.columns[c].align=z.style.textAlign||"center",(W=z.getAttribute("name"))&&(r.columns[c].name=W),(W=z.getAttribute("id"))&&(r.columns[c].id=W),(W=z.getAttribute("data-mask"))&&(r.columns[c].mask=W)},O=[],b=o.querySelectorAll(":scope > thead > tr");if(b.length){for(var s=0;s<b.length-1;s++){var g=[];for(c=0;c<b[s].children.length;c++){var S={title:b[s].children[c].textContent,colspan:b[s].children[c].getAttribute("colspan")||1};g.push(S)}O.push(g)}for(b=b[b.length-1].children,c=0;c<b.length;c++)N(b[c])}var T=0,d={},l={},p={},j={},f=o.querySelectorAll(":scope > tr, :scope > tbody > tr");for(s=0;s<f.length;s++)if(r.data[T]=[],r.parseTableFirstRowAsHeader!=1||b.length||s!=0){for(c=0;c<f[s].children.length;c++){if(h=f[s].children[c].getAttribute("data-formula"))h.substr(0,1)!="="&&(h="="+h);else var h=f[s].children[c].innerHTML;r.data[T].push(h);var w=jexcel.getColumnNameFromId([c,s]),A=f[s].children[c].getAttribute("class");A&&(j[w]=A);var D=parseInt(f[s].children[c].getAttribute("colspan"))||0,E=parseInt(f[s].children[c].getAttribute("rowspan"))||0;(D||E)&&(d[w]=[D||1,E||1]),f[s].children[c].style&&f[s].children[c].style.display=="none"&&(f[s].children[c].style.display="");var C=f[s].children[c].getAttribute("style");C&&(p[w]=C),f[s].children[c].classList.contains("styleBold")&&(p[w]?p[w]+="; font-weight:bold;":p[w]="font-weight:bold;")}f[s].style&&f[s].style.height&&(l[s]={height:f[s].style.height}),T++}else for(c=0;c<f[s].children.length;c++)N(f[s].children[c]);if(Object.keys(O).length>0&&(r.nestedHeaders=O),Object.keys(p).length>0&&(r.style=p),Object.keys(d).length>0&&(r.mergeCells=d),Object.keys(l).length>0&&(r.rows=l),Object.keys(j).length>0&&(r.classes=j),(f=o.querySelectorAll("tfoot tr")).length){var M=[];for(s=0;s<f.length;s++){var k=[];for(c=0;c<f[s].children.length;c++)k.push(f[s].children[c].textContent);M.push(k)}Object.keys(M).length>0&&(r.footers=M)}if(r.parseTableAutoCellType==1){var F=[];for(c=0;c<r.columns.length;c++){var P=!0,q=!0;for(F[c]=[],s=0;s<r.data.length;s++)h=r.data[s][c],F[c][h]||(F[c][h]=0),F[c][h]++,h.length>25&&(P=!1),h.length==10&&h.substr(4,1)=="-"&&h.substr(7,1)=="-"||(q=!1);var _=Object.keys(F[c]).length;q?r.columns[c].type="calendar":P==1&&_>1&&_<=parseInt(.1*r.data.length)&&(r.columns[c].type="dropdown",r.columns[c].source=Object.keys(F[c]))}}return r}console.log("Element is not a table")},jexcel.helpers=(component={getCaretIndex:function(o){if(this.config.root)var r=this.config.root;else r=window;var a=0,c=r.getSelection();if(c&&c.rangeCount!==0){var m=c.getRangeAt(0),N=m.cloneRange();N.selectNodeContents(o),N.setEnd(m.endContainer,m.endOffset),a=N.toString().length}return a},invert:function(o){for(var r=[],a=Object.keys(o),c=0;c<a.length;c++)r[o[a[c]]]=a[c];return r},getColumnName:function(o){let r,a=o+1,c="";for(;a>0;)r=(a-1)%26,c=String.fromCharCode(65+r).toString()+c,a=parseInt((a-r)/26);return c},getColumnNameFromCoords:function(o,r){return component.getColumnName(parseInt(o))+(parseInt(r)+1)},getCoordsFromColumnName:function(o){var r=/^[a-zA-Z]+/.exec(o);if(r){for(var a=0,c=0;c<r[0].length;c++)a+=parseInt(r[0].charCodeAt(c)-64)*Math.pow(26,r[0].length-1-c);--a<0&&(a=0);var m=parseInt(/[0-9]+$/.exec(o))||null;return m>0&&m--,[a,m]}},createFromTable:function(){},injectArray:function(o,r,a){return o.slice(0,r).concat(a).concat(o.slice(r))},parseCSV:function(o,r){r=r||",";for(var a=0,c=0,m=[[]],N=0,O=null,b=!1,s=!1,g=0;g<o.length;g++)if(m[c]||(m[c]=[]),m[c][a]||(m[c][a]=""),o[g]!="\r")if(o[g]!=`
`&&o[g]!=r||b!=0&&s!=1&&O){if(o[g]=='"'&&(b=!b),O===null){if((O=b)==1)continue}else if(O===!0&&!s&&o[g]=='"'){o[g+1]=='"'?(b=!0,m[c][a]+=o[g],g++):s=!0;continue}m[c][a]+=o[g]}else{if(O=null,b=!1,s=!1,m[c][a][0]=='"'){var S=m[c][a].trim();S[S.length-1]=='"'&&(m[c][a]=S.substr(1,S.length-2))}o[g]==`
`?(a=0,c++):++a>N&&(N=a)}for(var T=0;T<m.length;T++)for(g=0;g<=N;g++)m[T][g]===void 0&&(m[T][g]="");return m}},component),typeof jQuery<"u"&&function(o){o.fn.jspreadsheet=o.fn.jexcel=function(r){var a=o(this).get(0);return a.jexcel?Array.isArray(a.jexcel)?a.jexcel[r][arguments[1]].apply(this,Array.prototype.slice.call(arguments,2)):a.jexcel[r].apply(this,Array.prototype.slice.call(arguments,1)):jexcel(o(this).get(0),arguments[0])}}(jQuery),jexcel},module.exports=factory()}},__webpack_module_cache__={};function __webpack_require__(o){var r=__webpack_module_cache__[o];if(r!==void 0)return r.exports;var a=__webpack_module_cache__[o]={exports:{}};return __webpack_modules__[o].call(a.exports,a,a.exports,__webpack_require__),a.exports}var __webpack_exports__=__webpack_require__(44);jspreadsheet=__webpack_exports__}(),jspreadsheet});
